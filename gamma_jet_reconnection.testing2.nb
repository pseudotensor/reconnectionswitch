(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    810143,      18178]
NotebookOptionsPosition[    806411,      18086]
NotebookOutlinePosition[    806757,      18101]
CellTagsIndexPosition[    806714,      18098]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4939303761429777`*^9, 3.4939303793576*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.492440158457317*^9, 3.4924401592184114`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "reconnection", " ", "transition", " ", "radius", " ", 
    "and", " ", "other", " ", "quantities"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Used", " ", "with", " ", "gamma_jet", 
    RowBox[{"_wrapper", ".", "nb"}], " ", "or", " ", "gamma_jet", "_wrapper", 
    "_", "1", 
    RowBox[{"value", ".", "nb"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.4689746560897856`*^9, 3.4689746774404864`*^9}, {
  3.468974746860307*^9, 3.4689747623325553`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"TO", " ", "test", " ", "this", " ", "file"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"can", " ", 
        RowBox[{
        "do", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "getconstants"}]}], ";", "\[IndentingNewLine]", "getPUNQ", ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "..."}], "and", " ", 
     "then", " ", "try", " ", "some", " ", "function", " ", 
     RowBox[{"calls", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"$MinPrecision", "=", "5"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"allowed", " ", "for", " ", "print", " ", "outs"}], " ", "*)"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lowestprec", "=", "30"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"might", " ", "not", " ", "specify", " ", "precision"}], ",", 
     " ", 
     RowBox[{
     "but", " ", "using", " ", "machine", " ", "precision", " ", "may", " ", 
      "not", " ", "be", " ", 
      RowBox[{"enough", ".", "  ", "Also"}]}], ",", " ", 
     RowBox[{
     "even", " ", "if", " ", "use", " ", "more", " ", "prec", " ", "in", " ", 
      "some", " ", "steps"}], ",", " ", 
     RowBox[{
     "the", " ", "machine", " ", "prec", " ", "values", " ", "will", " ", 
      "truncate", " ", "those", " ", "more", " ", "precise", " ", 
      RowBox[{"values", ".", "  ", "This"}], " ", "is", " ", "especially", 
      " ", "a", " ", "problem", " ", "for", " ", "FindRoot"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slowprec", "=", "15"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Used", " ", "for", " ", "some", " ", "special", " ", "cases", " ", 
     "where", " ", "still", " ", "ok", " ", "to", " ", "use", " ", "lower", 
     " ", "prec", " ", "but", " ", 
     RowBox[{"can", "'"}], "t", " ", "use", " ", "lowestprec"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"slowprec", "=", "MachinePrecision"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"CAREFUL", ":", " ", 
     RowBox[{
     "Using", " ", "high", " ", "WorkingPrecision", " ", "can", " ", "lead", 
      " ", "to", " ", "FindRoot", " ", "offsetting", " ", 
      RowBox[{"indep", "'"}], "s", " ", "by", " ", "too", " ", "small", " ", 
      "a", " ", "value", " ", "to", " ", "show", " ", "up", " ", "as", " ", 
      "new", " ", "function", " ", "value"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myprecfindroot", "=", "MachinePrecision"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RELTOLAum", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pairsintprec", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"synchintprec", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "2"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pairsnumintprec", "=", 
      RowBox[{"{", 
       RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}], "}"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "about", " ", "2", "X", " ", "as", " ", "fast", " ", "to", " ", "use", 
       " ", "WorkingPrecision"}], "\[Rule]", 
      RowBox[{"15", " ", "instead", " ", "of", " ", "lowestprec"}]}], "=", 
     RowBox[{"30", " ", "compared", " ", "to", " ", "above"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pairsintprec", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WorkingPrecision", "\[Rule]", "15"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"synchintprec", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WorkingPrecision", "\[Rule]", "15"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "2"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pairsnumintprec", "=", 
      RowBox[{"{", 
       RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}], "}"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"most", " ", "accurate"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pairsintprec", "=", 
     RowBox[{"{", 
      RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"synchintprec", "=", 
     RowBox[{"{", 
      RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pairsnumintprec", "=", 
     RowBox[{"{", 
      RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"pairsnumintprec", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "15"}]}], "}"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.4916003568565392`*^9, 3.4916004137683744`*^9}, {
   3.4923728163841715`*^9, 3.492372887556512*^9}, {3.49237766237236*^9, 
   3.4923776836429453`*^9}, {3.4923778248960576`*^9, 
   3.4923778654243345`*^9}, {3.4923782781978736`*^9, 3.492378278408176*^9}, {
   3.4923784100574784`*^9, 3.492378410968789*^9}, {3.492380210586512*^9, 
   3.492380224176053*^9}, {3.4924528578281155`*^9, 3.492452857918245*^9}, {
   3.4924542871233406`*^9, 3.492454299250779*^9}, {3.493175655531915*^9, 
   3.493175680107253*^9}, {3.4941498695015745`*^9, 3.4941498757605743`*^9}, {
   3.494151096976597*^9, 3.494151099540283*^9}, {3.4941540782134047`*^9, 
   3.4941541101493263`*^9}, {3.4941542047153053`*^9, 3.494154223031643*^9}, {
   3.494154398133427*^9, 3.494154437089443*^9}, {3.494154522051613*^9, 
   3.494154528360685*^9}, {3.4941555578810625`*^9, 3.4941555855408354`*^9}, 
   3.4941556505943775`*^9, {3.4941558002796144`*^9, 3.4941558042953887`*^9}, {
   3.4941568301705246`*^9, 3.4941568329244847`*^9}, {3.49415729708191*^9, 
   3.4941573671025953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Constants", " ", "of", " ", "Nature"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getconstants", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Cabibbo", " ", "angle"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"g", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cm", "=", "1"}], ";"}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"thetac", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"13.04", "*", 
           RowBox[{"Pi", "/", "180"}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"costhetac", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"Cos", "[", "thetac", "]"}], ",", "lowestprec"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"AU", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"149597870.691", "*", 
           RowBox[{"10", "^", "2"}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"msun", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"1.989", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", "33", ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lsun", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"3.89", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", "33", ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rsun", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"695500", "*", 
           RowBox[{"10", "^", "3"}], "*", "100"}], ",", "lowestprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"G", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"6.672", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "8"}], ")"}]}]}], " ", ",", "lowestprec"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"2.99792458", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", "10", ")"}]}]}], " ", ",", "lowestprec"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ergPmev", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"1.60217649", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "6"}], ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"4.13566733", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "15"}], ")"}]}], "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "6"}], ")"}]}], "*", "ergPmev"}], ",", 
          "lowestprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hbar", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"h", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi"}], ")"}]}], ",", "lowestprec"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"mn", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"1.674927211", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "24"}], ")"}]}]}], ",", "lowestprec"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"mp", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"1.672621637", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "24"}], ")"}]}]}], ",", "lowestprec"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"QE", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mn", "-", "mp"}], ")"}], "*", 
           RowBox[{"c", "^", "2"}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"me", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"9.10938215", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "31"}], ")"}]}], "*", "1000"}], ",", "lowestprec"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mealso", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"0.510998910", "*", 
           RowBox[{"ergPmev", "/", 
            RowBox[{"c", "^", "2"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"mb", "=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"mn", "+", "mp"}], ")"}], "/", "2"}], ",", 
            "lowestprec"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"avo", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"6.0221367", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", "23", ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amu", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"1", "/", "avo"}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mu", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"amu", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mb", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"mu", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kb", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"1.380658", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "16"}], ")"}]}]}], ",", "lowestprec"}], "]"}]}], 
       ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"erg", "/", "K"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Print", "[", "\"\<arad\>\"", "]"}], ",", "lowestprec"}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"arad", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"8", "*", 
           RowBox[{"Pi", "^", "5"}], "*", 
           RowBox[{
            RowBox[{"kb", "^", "4"}], "/", 
            RowBox[{"(", 
             RowBox[{"15", "*", 
              RowBox[{"c", "^", "3"}], "*", 
              RowBox[{"h", "^", "3"}]}], ")"}]}]}], ",", "lowestprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"arad", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Pi", "^", "2"}], "*", 
           RowBox[{
            RowBox[{"kb", "^", "4"}], "/", 
            RowBox[{"(", 
             RowBox[{"15", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"hbar", "*", "c"}], ")"}], "^", "3"}]}], ")"}]}]}], 
          ",", "lowestprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmasb", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"arad", "*", 
           RowBox[{"c", "/", "4"}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"4.8029", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "10"}], ")"}]}]}], ",", "lowestprec"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"secPyr", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"60", "*", "60", "*", "24", "*", "365.25"}], ")"}], ",", 
          "lowestprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ry", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"1.09678", "*", 
           RowBox[{"10", "^", "5"}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RyE", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"me", "*", 
           RowBox[{
            RowBox[{"q", "^", "4"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", 
              RowBox[{"hbar", "^", "2"}]}], ")"}]}]}], ",", "lowestprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fsc", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"hbar", "*", "c"}], ")"}]}], ",", "lowestprec"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"radiuse", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"me", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}]}], ",", "lowestprec"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"radiusp", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"mp", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}]}], ",", "lowestprec"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"alpha", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"hbar", "*", "c"}], ")"}]}], ",", "lowestprec"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"km", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"10", "^", "3"}], "*", "100"}], ",", "lowestprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pc", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"3.086", "*", 
           RowBox[{"10", "^", "18"}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Mpc", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"10", "^", "6"}], "*", "pc"}], ",", "lowestprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rgalaxies", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"3", "*", "Mpc"}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ly", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "3.261"}], "*", "pc"}], ",", "lowestprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h0", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"71", "*", 
           RowBox[{
            RowBox[{"km", "/", "s"}], "/", "Mpc"}]}], ",", "lowestprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmatdiff", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"radiuse", "^", "2"}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sigmat", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", "*", 
             RowBox[{"Pi", "/", "3"}]}], ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"alpha", "*", 
              RowBox[{"hbar", "/", 
               RowBox[{"(", 
                RowBox[{"me", "*", "c"}], ")"}]}]}], ")"}], "^", "2"}]}], ",",
           "lowestprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmat2", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", "*", 
             RowBox[{"Pi", "/", "3"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q", "^", "4"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"me", "^", "2"}], "*", 
               RowBox[{"c", "^", "4"}]}], ")"}]}], ")"}]}], ",", 
          "lowestprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmakngen", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "*", "Pi", "*", 
               RowBox[{"q", "^", "4"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"me", "^", "2"}], "*", 
               RowBox[{"c", "^", "4"}]}], ")"}]}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", "alphakn"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"alphakn", "^", "2"}], ")"}]}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "alphakn"}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", "*", "alphakn"}]}], ")"}]}]}], "-", 
                 RowBox[{
                  RowBox[{"1", "/", "alphakn"}], "*", 
                  RowBox[{"Log", "[", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", "*", "alphakn"}]}], "]"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", "*", "alphakn"}], ")"}]}], "*", 
               RowBox[{"Log", "[", 
                RowBox[{"1", "+", 
                 RowBox[{"2", "*", "alphakn"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"3", "*", "alphakn"}]}], ")"}], "/", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", "*", "alphakn"}]}], ")"}], "^", "2"}]}]}], 
             ")"}]}], "//.", 
           RowBox[{"{", 
            RowBox[{"alphakn", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"h", "*", "freqgamma"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"me", "*", 
                RowBox[{"c", "^", "2"}]}], ")"}]}]}], "}"}]}], ",", 
          "lowestprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sigmat", "-", 
        RowBox[{"Limit", "[", 
         RowBox[{"sigmakn", ",", 
          RowBox[{"freqgamma", "\[Rule]", "0"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rl", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"G", "*", 
           RowBox[{"M", "/", 
            RowBox[{"c", "^", "2"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tl", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"rl", "/", "c"}], ",", "lowestprec"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.464811331758085*^9, 3.4648113319483585`*^9}, {
   3.4648113880490274`*^9, 3.4648114200450354`*^9}, {3.4648115027139072`*^9, 
   3.4648115060487022`*^9}, {3.464811573635888*^9, 3.4648115921525135`*^9}, {
   3.4649058458443503`*^9, 3.4649058871237073`*^9}, {3.465226797446333*^9, 
   3.4652269220154543`*^9}, {3.4652269811204433`*^9, 3.465227021618677*^9}, {
   3.4652270579909773`*^9, 3.4652270582213087`*^9}, {3.4665304049223967`*^9, 
   3.466530434324675*^9}, {3.466530477456696*^9, 3.4665305315244417`*^9}, {
   3.466530614153256*^9, 3.4665306150245085`*^9}, 3.4665306847948337`*^9, {
   3.466530727185789*^9, 3.466530727315976*^9}, {3.466530962634347*^9, 
   3.4665309812310877`*^9}, {3.466531139839155*^9, 3.4665311498635693`*^9}, {
   3.46653124031363*^9, 3.466531253823056*^9}, 3.46653136858808*^9, {
   3.4667868070584*^9, 3.4667868084*^9}, {3.4670886545378*^9, 
   3.4670886549434*^9}, {3.4689746827280893`*^9, 3.4689746865535903`*^9}, {
   3.477090473842821*^9, 3.4770904740130653`*^9}, {3.49125345325204*^9, 
   3.4912534556855392`*^9}, {3.491840882004717*^9, 3.4918408821649475`*^9}, {
   3.492373113691678*^9, 3.4923731244872017`*^9}, {3.4923731559224033`*^9, 
   3.492373159287242*^9}, {3.4923732555456543`*^9, 3.492373272459976*^9}, {
   3.492373454752099*^9, 3.4923735823655987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "not", " ", "called", " ", "by", " ", "normal", " ", "procedure", " ", 
    "unless", " ", "uncomment", " ", "it", " ", "in", " ", "gamma_jet", 
    RowBox[{"_wrapper", ".", "nb"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"setupvaluesothertest", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ljet", "=", 
        RowBox[{"5", "*", 
         RowBox[{"10", "^", 
          RowBox[{"(", "14", ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Ljet", "=", 
          RowBox[{"10", "^", 
           RowBox[{"(", "25", ")"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Ljet", "=", "rl"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mythfp", "=", 
        RowBox[{"Pi", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"assumption", " ", "below"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", "Lp", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"mylmode", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"mymmode", "=", "0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"ensure", " ", "precision", " ", "is", " ", "kept"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Ljet", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Ljet", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myfakemu", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"myfakemu", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"thebr0gauss", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"thebr0gauss", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mynu", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"mynu", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myrmono", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"myrmono", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mythfp", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"mythfp", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mylmode", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"mylmode", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mymmode", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"mymmode", ",", "lowestprec"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4665335984144125`*^9, 3.466533669756998*^9}, {
   3.4689747263107586`*^9, 3.468974743104907*^9}, {3.4720107120974846`*^9, 
   3.4720108011655583`*^9}, {3.472010849104491*^9, 3.472010852479344*^9}, {
   3.472010973403224*^9, 3.4720109800628*^9}, {3.4720110683297215`*^9, 
   3.472011069671651*^9}, {3.4923735907376366`*^9, 3.492373621852378*^9}, 
   3.4923751608954124`*^9, {3.493603892162069*^9, 3.4936039243984222`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.472077256212821*^9, 3.4720772632930017`*^9}, {
   3.4720773205353117`*^9, 3.4720773230088687`*^9}, {3.472077359571443*^9, 
   3.4720775023066864`*^9}, {3.4720776944329505`*^9, 3.472077727670744*^9}, {
   3.4720795713618417`*^9, 3.4720796067927885`*^9}, 3.477161354177552*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "setup", " ", "values", " ", "from", " ", "jet", " ", "solution", " ", 
    "so", " ", 
    RowBox[{"don", "'"}], "t", " ", "have", " ", "to", " ", "repeat", " ", 
    "expensive", " ", "jet", " ", "calculations"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"setupvalues", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "thetajet", ",", "gammavalue", ",", "rhobvalue", ",", "rhobingoing", 
         ",", "bsqvalue", ",", "bsqgaussvalue", ",", "bgaussvalue", ",", 
         "Tvalue", ",", "Bphivalue", ",", "omegafvalue", ",", "Rjet", ",", 
         "gammavalue", ",", "Lp", ",", "Lpnum", ",", "Pm", ",", "Um"}], "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"normal", " ", "bsq"}], ",", " ", "rhobvalue", ",", " ", 
         "Lp"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"thetajet", "=", 
        RowBox[{
         RowBox[{"thofr", "[", 
          RowBox[{"Ljet", ",", "mythfp"}], "]"}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<thetajet in degrees\>\"", "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"thetajet", "*", 
        RowBox[{"180", "/", "Pi"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gammavalue", "=", 
        RowBox[{
         RowBox[{"mygammafinal", "[", 
          RowBox[{"Ljet", ",", "thetajet"}], "]"}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rhobvalue", "=", 
        RowBox[{
         RowBox[{"rho0", "[", 
          RowBox[{"Ljet", ",", "thetajet"}], "]"}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rhobingoing", "=", "rhobvalue"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"bsqvalue", " ", "in", " ", "HL", " ", 
         RowBox[{"units", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bsqvalue", "=", 
        RowBox[{
         RowBox[{"bsq", "[", 
          RowBox[{"Ljet", ",", "thetajet"}], "]"}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bsqgaussvalue", "=", 
        RowBox[{"bsqvalue", "*", 
         RowBox[{"(", 
          RowBox[{"4", "*", "Pi"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bgaussvalue", "=", 
        RowBox[{"Sqrt", "[", "bsqgaussvalue", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tvalue", "=", 
        RowBox[{"2", "*", 
         RowBox[{"10", "^", "4"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"cold", " ", 
         RowBox[{"input", " ", "--"}], " ", 
         RowBox[{"don", "'"}], "t", " ", "go", " ", "below", " ", 
         RowBox[{"10", "^", "4"}], " ", "and", " ", "esp", " ", 
         RowBox[{"don", "'"}], "t", " ", "make", " ", "0", " ", "since", " ", 
         "expressions", " ", 
         RowBox[{"aren", "'"}], "t", " ", "written", " ", "as", " ", "limits",
          " ", "or", " ", "some", " ", "expressions", " ", "actually", " ", 
         "diverge", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"e", ".", "g", ".", " ", "free"}], "-", "free"}], ")"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Bphivalue\>\"", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Bphivalue", "=", 
        RowBox[{
         RowBox[{"Bphi", "[", 
          RowBox[{"Ljet", ",", "thetajet"}], "]"}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Brvalue", "=", 
        RowBox[{
         RowBox[{"Br", "[", 
          RowBox[{"Ljet", ",", "thetajet"}], "]"}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"omegafvalue", "=", 
        RowBox[{
         RowBox[{"omegaf", "[", 
          RowBox[{"Ljet", ",", "thetajet"}], "]"}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Rjet", "=", 
        RowBox[{"Ljet", "*", 
         RowBox[{"Sin", "[", "thetajet", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gammavalue", "*", "thetajet"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Lp", "=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lmode", "/", 
             RowBox[{"(", 
              RowBox[{"Pi", "*", "Rjet"}], ")"}]}], " ", "+", " ", 
            RowBox[{"mmode", "*", 
             RowBox[{"omegafvalue", "/", 
              RowBox[{"(", 
               RowBox[{"gammavalue", "*", "2", "*", "Pi", "*", "c"}], 
               ")"}]}]}]}], ")"}]}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lpnum", "=", 
        RowBox[{"Lp", "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"powerjet", "=", 
        RowBox[{"powervsth", "[", 
         RowBox[{"rfp", ",", 
          RowBox[{"Pi", "/", "2"}], ",", "consts"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"fcover", " ", "no", " ", "longer", " ", "fundamental"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"fcover", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"lmode", "-", "1"}], ")"}], "*", 
            RowBox[{"Rjet", "/", "deltasp"}]}], "//.", "consts"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "prelim", " ", "bsq", " ", "and", " ", "rhob", " ", "and", " ", 
         "Lp"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"thetajet", "=", "0.04"}], ";", "\[IndentingNewLine]", 
         RowBox[{"sigma", "=", 
          RowBox[{"3", "*", 
           RowBox[{"10", "^", "4"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gammavalue", "=", 
          RowBox[{"sigma", "/", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rhobvalue", "=", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"(", "10", ")"}]}], "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Ljet", "/", "rl"}], ")"}], "^", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bsqvalue", "=", 
          RowBox[{"sigma", "*", "rhob", "*", 
           RowBox[{"c", "^", "2"}], "*", "gamma"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Lp", "=", 
          RowBox[{"Ljet", "*", "thetajet"}]}], ";"}], "\[IndentingNewLine]", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"bsqvalue", " ", "is", " ", "in", " ", "HL", " ", "units"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Pm", "=", 
        RowBox[{"bsqvalue", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Um", "=", "Pm"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"ensure", " ", "precision", " ", "kept"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"thetajet", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"thetajet", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gammavalue", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"gammavalue", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rhobvalue", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"rhobvalue", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rhobingoing", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"rhobingoing", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bsqvalue", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"bsqvalue", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bsqgaussvalue", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"bsqgaussvalue", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bgaussvalue", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"bgaussvalue", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tvalue", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Tvalue", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bphivalue", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Bphivalue", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"omegafvalue", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"omegafvalue", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Rjet", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Rjet", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lp", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Lp", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lpnum", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Lpnum", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pm", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Pm", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Um", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Um", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "thetajet", ",", "gammavalue", ",", "rhobvalue", ",", "rhobingoing", 
         ",", "bsqvalue", ",", "bsqgaussvalue", ",", "bgaussvalue", ",", 
         "Tvalue", ",", "Bphivalue", ",", "omegafvalue", ",", "Rjet", ",", 
         "gammavalue", ",", "Lp", ",", "Lpnum", ",", "Pm", ",", "Um"}], "]"}],
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4649083733487234`*^9, 3.4649083834933105`*^9}, {
   3.4649085933951344`*^9, 3.4649086281851597`*^9}, {3.464908675733531*^9, 
   3.4649087624382067`*^9}, {3.464908880347752*^9, 3.464908889611072*^9}, {
   3.4649089253825088`*^9, 3.464908934105051*^9}, {3.464908966221232*^9, 
   3.46490904303168*^9}, {3.464909104419952*^9, 3.464909104570168*^9}, {
   3.4649094366476717`*^9, 3.4649094369280753`*^9}, {3.464909678365245*^9, 
   3.464909680428211*^9}, {3.465078843856786*^9, 3.4650788632847214`*^9}, {
   3.4651414157303343`*^9, 3.4651414382126627`*^9}, {3.4651439256894784`*^9, 
   3.465143948161792*^9}, {3.4651440145272207`*^9, 3.4651440437592545`*^9}, {
   3.46514411685436*^9, 3.46514421124008*^9}, {3.46514429126515*^9, 
   3.4651443153597965`*^9}, {3.4651444048284464`*^9, 3.465144408914322*^9}, {
   3.465146386227558*^9, 3.465146389151763*^9}, {3.46515524310312*^9, 
   3.465155352961088*^9}, 3.4651554231720467`*^9, {3.4651554938236384`*^9, 
   3.465155496787901*^9}, {3.465185229868435*^9, 3.465185234224699*^9}, {
   3.465185274522645*^9, 3.4651852762150784`*^9}, {3.4651855588214464`*^9, 
   3.4651855589215903`*^9}, {3.4651855913181744`*^9, 3.465185591548506*^9}, {
   3.4652450557404704`*^9, 3.4652450677877936`*^9}, {3.46524639575732*^9, 
   3.465246395907536*^9}, {3.4652466460372047`*^9, 3.4652466470486593`*^9}, {
   3.465248806423688*^9, 3.465248806674048*^9}, {3.465248860982139*^9, 
   3.465248861122341*^9}, {3.465248940967152*^9, 3.465248944622408*^9}, {
   3.4652491641680994`*^9, 3.465249174482931*^9}, {3.4652492440129104`*^9, 
   3.4652492708515024`*^9}, {3.4652501535507617`*^9, 
   3.4652501612818785`*^9}, {3.4652502475559344`*^9, 
   3.4652502484972878`*^9}, {3.46525076303716*^9, 3.4652507631473184`*^9}, {
   3.4652510866625104`*^9, 3.4652510867426257`*^9}, {3.4652512415352063`*^9, 
   3.4652512416253357`*^9}, {3.4652518547870193`*^9, 3.465251854927221*^9}, {
   3.46525195315847*^9, 3.465251953278643*^9}, {3.465252002749779*^9, 
   3.4652520044722557`*^9}, {3.4652520428975086`*^9, 
   3.4652520466929665`*^9}, {3.4652521118566675`*^9, 
   3.4652521160426865`*^9}, {3.4664662065583024`*^9, 
   3.4664662068086624`*^9}, {3.466531306268469*^9, 3.4665313426908417`*^9}, 
   3.4665313817269726`*^9, {3.466531427312522*^9, 3.466531432189534*^9}, {
   3.466533513882862*^9, 3.466533633394712*^9}, {3.4667867002248*^9, 
   3.4667867115192003`*^9}, {3.46707027001565*^9, 3.46707027017165*^9}, {
   3.4670841893324003`*^9, 3.467084193638*^9}, {3.4670844827558002`*^9, 
   3.467084489573*^9}, {3.467087165315*^9, 3.4670871655022*^9}, {
   3.4670886496238003`*^9, 3.4670886507938004`*^9}, {3.4681231245275745`*^9, 
   3.468123130506171*^9}, {3.46866630723308*^9, 3.468666329234717*^9}, {
   3.468974846733918*^9, 3.468974859992984*^9}, {3.4689752628021955`*^9, 
   3.468975270923874*^9}, {3.4720107799951167`*^9, 3.4720107880767374`*^9}, {
   3.4720108555737934`*^9, 3.4720108815311184`*^9}, {3.4720111131541758`*^9, 
   3.4720111246507072`*^9}, {3.4720111744022465`*^9, 
   3.4720111791390576`*^9}, {3.4720112746964626`*^9, 3.472011282477651*^9}, {
   3.472029746228958*^9, 3.4720297619515667`*^9}, {3.472032216060402*^9, 
   3.472032217322216*^9}, {3.4720322681352816`*^9, 3.472032270628867*^9}, {
   3.477066347350629*^9, 3.477066347611003*^9}, 3.477151453661309*^9, 
   3.477159052117352*^9, {3.477160266253194*^9, 3.4771602756366863`*^9}, {
   3.4771613810461874`*^9, 3.477161387555547*^9}, {3.4771643436662254`*^9, 
   3.4771643569753633`*^9}, {3.4771768112337074`*^9, 
   3.4771768480866995`*^9}, {3.4912535142898083`*^9, 3.491253519797728*^9}, {
   3.4913392380661583`*^9, 3.4913392395482893`*^9}, {3.491516973677416*^9, 
   3.491516978404213*^9}, {3.491835856758768*^9, 3.4918358930809965`*^9}, {
   3.4918360341939073`*^9, 3.4918360367876368`*^9}, {3.4923736412402563`*^9, 
   3.492373801370512*^9}, 3.4923751735335855`*^9, {3.4924528961432095`*^9, 
   3.4924529192063727`*^9}, {3.4934499659135714`*^9, 3.49344996743576*^9}, {
   3.493593066675784*^9, 3.493593071232336*^9}, {3.493604233312619*^9, 
   3.4936042641669855`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Note", " ", "that", " ", "instances", " ", "where", " ", "solsT", " ", 
    "or", " ", "similar", " ", "things", " ", "are", " ", "used", " ", "is", 
    " ", "because", " ", "want", " ", "to", " ", "make", " ", "it", " ", 
    "easier", " ", "on", " ", "FindRoot", " ", "to", " ", "find", " ", 
    "solution", " ", "for", " ", "T", " ", "without", " ", "the", " ", 
    "entire", " ", "set", " ", "of", " ", 
    RowBox[{"complications", ".", "  ", "As"}], " ", "long", " ", "as", " ", 
    "heads", " ", "in", " ", "right", " ", "direction", " ", "then", " ", 
    "iteration", " ", "will", " ", "work"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"setupiterguesses", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", "mynpairs", ",", "myT"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"temporary", ",", " ", 
        RowBox[{
         RowBox[{"jut", " ", "sets"}], "-", 
         RowBox[{
         "up", " ", "solsT", " ", "below", " ", "and", " ", "not", " ", 
          "otherwise", " ", "used"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mynpairs", "=", 
        RowBox[{"ne", "[", "rhobvalue", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myT", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pm", "/", "arad"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "4"}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"assumes", " ", "radiation", " ", "dominated"}], ",", " ", 
         RowBox[{"which", " ", "typically", " ", "is"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"mynpairs", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"mynpairs", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myT", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"myT", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"ITERATED", " ", "for", " ", "T"}], ",", 
         RowBox[{"npairs", " ", "loop"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"solsT", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "\[Rule]", "myT"}], ",", 
          RowBox[{"npairs", "\[Rule]", "mynpairs"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"solsTrad", "=", "solsT"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"for", " ", "radiation", " ", "terms"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"ITERATED", " ", "for", " ", "plasma", " ", "loop"}], ",", 
         " ", 
         RowBox[{"but", " ", "not", " ", "T"}], ",", 
         RowBox[{"npairs", " ", "FindRoot"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rhobcenter", "=", "rhobvalue"}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"effectively", " ", "holds", " ", "Aum", " ", 
          RowBox[{"(", 
           RowBox[{"=", 
            RowBox[{"1", " ", "here"}]}], ")"}]}], ",", " ", 
         RowBox[{"the", " ", "compression", " ", "ratio"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "netotforomegape", " ", "is", " ", "for", " ", "inside", " ", 
         "current", " ", "layer"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"netotforomegape", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ne", "[", "rhobcenter", "]"}], "+", "npairs"}], "//.", 
         "solsT"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"initial", " ", "guess"}], ",", " ", 
         RowBox[{
          RowBox[{"not", " ", "generally", " ", "simply", " ", "ne"}], "+", 
          RowBox[{"npairs", " ", "!"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"gammae", "=", "1.01"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "other", " ", "things", " ", "used", " ", "to", " ", "set", " ", 
         "fsolssp"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"myie", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "/", "2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"rhobcenter", "*", "T", "*", 
             RowBox[{"kb", "/", "mb"}]}], ")"}]}], "//.", "consts"}], "//.", 
         "solsT"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myu4vel", "=", "0.01"}], ";", "\[IndentingNewLine]", 
       RowBox[{"myb", "=", "0.001"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"ensure", " ", "precision"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"netotforomegape", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"netotforomegape", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gammae", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"gammae", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myie", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"myie", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myu4vel", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"myu4vel", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myb", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"myb", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "done", " ", "with", " ", "things", " ", "with", " ", "constants"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"now", " ", "do", " ", "non"}], "-", 
          RowBox[{"constant", " ", "assignments"}]}], ",", " ", 
         RowBox[{
         "which", " ", "includes", " ", "things", " ", "that", " ", "should", 
          " ", "be", " ", "updated", " ", "after", " ", "iterated", " ", 
          "quantities", " ", "are", " ", "iterated"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"fsolssp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "\[Rule]", "Lpnum"}], ",", 
          RowBox[{"ux", "->", "myu4vel"}], ",", 
          RowBox[{"rhoc", "\[Rule]", "rhobcenter"}], ",", 
          RowBox[{"iec", "\[Rule]", "myie"}], ",", 
          RowBox[{"rhoout", "\[Rule]", "rhobcenter"}], ",", 
          RowBox[{"ieout", "\[Rule]", "myie"}], ",", 
          RowBox[{"Bx", "\[Rule]", "myb"}], ",", 
          RowBox[{"uy", "\[Rule]", "myu4vel"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"setup", " ", "iterator", " ", 
          RowBox[{"arrays", ":", " ", 
           RowBox[{"for", " ", 
            RowBox[{"positions", ":", " ", "in"}]}]}]}], ",", "center", ",", 
         "out", ",", 
         RowBox[{"in", "-", "center"}], ",", 
         RowBox[{"center", "-", "out"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Titer", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"npairsiter", "=", "Titer"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "store", " ", "iterators", " ", "for", " ", "each", " ", "position", 
         " ", "in", " ", "SP", " ", "layer"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"storeiter", "[", "0", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"storeiter", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"storeiter", "[", "2", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"storeiter", "[", "3", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"storeiter", "[", "4", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"storeiter", "[", "5", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4918433356729183`*^9, 3.491843405242955*^9}, {
  3.491843714097066*^9, 3.4918437204061375`*^9}, {3.4922095098408947`*^9, 
  3.4922095296794205`*^9}, {3.4923738953556557`*^9, 3.492374064899448*^9}, {
  3.4924391334434195`*^9, 3.4924391376594815`*^9}, {3.492440707506811*^9, 
  3.4924407752842703`*^9}, {3.492448875191365*^9, 3.4924490402186623`*^9}, {
  3.4924491142250786`*^9, 3.4924491204340067`*^9}, {3.4924492658430943`*^9, 
  3.4924492692479906`*^9}, {3.492450203381208*^9, 3.4924502072167234`*^9}, {
  3.492452060952264*^9, 3.4924520777363987`*^9}, {3.4924521813854384`*^9, 
  3.4924521841694417`*^9}, {3.492452505962157*^9, 3.4924525235274143`*^9}, {
  3.492452884977154*^9, 3.492452885317643*^9}, {3.4924529731739745`*^9, 
  3.4924530018452015`*^9}, {3.492453040310512*^9, 3.4924531555161695`*^9}, {
  3.494115217384277*^9, 3.4941152630899982`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "store", " ", "iterator", " ", "for", " ", "any", " ", "position", " ", 
    "in", " ", "SP", " ", "layer"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"storeiter", "[", "which0_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", 
        RowBox[{"which", "=", "which0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Titer", "[", 
         RowBox[{"[", 
          RowBox[{"which", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"T", "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"npairsiter", "[", 
         RowBox[{"[", 
          RowBox[{"which", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"npairs", "//.", "solsT"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4771806973316417`*^9, 3.477180741925765*^9}, {
  3.4771807951422863`*^9, 3.4771808043355055`*^9}, {3.4771812423653617`*^9, 
  3.477181251568595*^9}, {3.477181576656048*^9, 3.4771815770666385`*^9}, {
  3.49134364620475*^9, 3.491343667024688*^9}, {3.4913466740485764`*^9, 
  3.4913466750099583`*^9}, {3.491346708888674*^9, 3.491346709098976*^9}, {
  3.4915140815587535`*^9, 3.49151408712676*^9}, {3.4917462098228045`*^9, 
  3.4917462545871725`*^9}, {3.4917469604221134`*^9, 3.491746969044512*^9}, {
  3.491749110023088*^9, 3.4917491105438366`*^9}, {3.491827041953701*^9, 
  3.491827043345702*^9}, {3.491843701408821*^9, 3.4918437024503183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "get", " ", "set", " ", "of", " ", "independent", " ", "variables", " ", 
    "for", " ", "a", " ", "given", " ", "position", " ", "in", " ", "the", 
    " ", "SP", " ", "layer"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", " ", "that", " ", 
     RowBox[{"Q", "@", "center"}], " ", "should", " ", "be", " ", "used", " ",
      "for", " ", "emission", " ", "from", " ", "face"}], ",", " ", 
    RowBox[{"while", " ", 
     RowBox[{"Q", "@", "out"}], " ", "can", " ", "be", " ", "used", " ", 
     "for", " ", "emission", " ", "from", " ", "sides"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Q", "@", "in"}], " ", "is", " ", "not", " ", "used", " ", "for",
      " ", "emission", " ", "since", " ", "want", " ", "to", " ", "have", " ",
      "that", " ", "part", " ", "remain", " ", "cold", " ", "as", " ", "it", 
     " ", "really", " ", "is", " ", "at", " ", "face"}], ",", " ", 
    RowBox[{
    "while", " ", "the", " ", "rest", " ", "can", " ", "be", " ", "hot", " ", 
     "with", " ", "little", " ", "error", " ", "in", " ", "averaging", " ", 
     "T"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"chooseposition", "[", "which0_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", 
        RowBox[{"which", "=", "which0"}], ",", "Trad", ",", "myT", ",", 
        "mynpairs", ",", "gammaout", ",", "bxout"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"choose", " ", "iterator"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myT", "=", 
        RowBox[{"Titer", "[", 
         RowBox[{"[", 
          RowBox[{"which", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mynpairs", "=", 
        RowBox[{"npairsiter", "[", 
         RowBox[{"[", 
          RowBox[{"which", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"REVERSION", ":", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"rhobrad", " ", "\\", "sim"}], " ", "rhobvalue", " ", 
           "with", " ", "no", " ", "rhoc", " ", "or", " ", "rhobcenter", " ", 
           "since", " ", "assume", " ", "current", " ", "layer", " ", "is", 
           " ", "much", " ", "smaller", " ", "than", " ", "radiation", " ", 
           "region", " ", "and", " ", "radiation", " ", "comes", " ", "from", 
           " ", "distributed", " ", "region", " ", "in", " ", "steady"}], "-",
           "state"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"in", " ", "--"}], " ", "NOT", " ", "distributed", " ", 
         "for", " ", "radiation", " ", "or", " ", "pairs"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"which", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rhobnorm", "=", "rhobingoing"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bgaussnorm", "=", "bgaussvalue"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"solsT", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "\[Rule]", "myT"}], ",", 
             RowBox[{"npairs", "\[Rule]", "mynpairs"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rhobrad", "=", "rhobingoing"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Trad", "=", "Tvalue"}], ";", "\[IndentingNewLine]", 
          RowBox[{"solsTrad", "=", "solsT"}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"no", " ", "different"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", "bgaussvalue"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"center", " ", "--"}], " ", "distributed", " ", "for", " ", 
          "radiation", " ", "and", " ", "also", " ", "for", " ", "non"}], "-", 
         RowBox[{"radiative", " ", "magnetic", " ", "field"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"which", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rhobnorm", "=", 
           RowBox[{"rhoc", "//.", "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "to", " ", "be", " ", "used", " ", "for", " ", "everything", " ", 
            "except", " ", "directly", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"solsT", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "\[Rule]", "myT"}], ",", 
             RowBox[{"npairs", "\[Rule]", "mynpairs"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rhobrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"rhobingoing", "+", "rhoc"}], ")"}]}], "//.", 
            "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "assume", " ", "by", " ", "rhobrad", " ", "mean", " ", "to", " ", 
            "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"rhobrad", "=", "rhobingoing"}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Trad", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"Tvalue", "+", "Tc"}], ")"}]}], "//.", "fsolssp"}]}], 
            ";"}], "  ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "assume", " ", "by", " ", "Trad", " ", "mean", " ", "to", " ", 
             "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Assume", " ", "Tc", " ", "is", " ", "good", " ", "for", " ", 
            "central", " ", 
            RowBox[{"temperature", ".", "  ", "As"}], " ", "if", " ", "rest", 
            " ", "of", " ", "region", " ", "is", " ", "heated", " ", "up", 
            " ", "to", " ", "same", " ", "temperature"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"solsTrad", "=", "solsT"}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"no", " ", "different"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"bgaussvalue", "+", "0"}], ")"}]}], "//.", 
            "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "assume", " ", "by", " ", "central", " ", "mean", " ", "non"}], 
             "-", 
             RowBox[{"zero", " ", "field"}]}], ",", " ", 
            RowBox[{
            "which", " ", "in", " ", "SP", " ", "language", " ", "is", " ", 
             "mostly", " ", "bbarx"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", "bgaussvalue"}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussnorm", "=", "bgaussrad"}], ";"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"don", "'"}], "t", " ", "use", " ", "exactly", " ", 
          RowBox[{"zero", " ", "--"}], " ", "assume", " ", "distributed"}], 
         " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"out", " ", "--"}], " ", "distributed", " ", "for", " ", 
          "radiation", " ", "and", " ", "also", " ", "for", " ", "non"}], "-", 
         RowBox[{"radiative", " ", "magnetic", " ", "field"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"which", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rhobnorm", "=", 
           RowBox[{"rhoout", "//.", "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "to", " ", "be", " ", "used", " ", "for", " ", "everything", " ", 
            "except", " ", "directly", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"solsT", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "\[Rule]", "myT"}], ",", 
             RowBox[{"npairs", "\[Rule]", "mynpairs"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rhobrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"rhoc", "+", "rhoout"}], ")"}]}], "//.", "fsolssp"}]}], 
          ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "assume", " ", "by", " ", "rhobrad", " ", "mean", " ", "to", " ", 
            "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"rhobrad", "=", 
           RowBox[{"rhobout", "//.", "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Trad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"Tc", "+", "Tout"}], ")"}]}], "//.", "fsolssp"}]}], ";",
           "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "assume", " ", "by", " ", "Trad", " ", "mean", " ", "to", " ", 
            "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"solsTrad", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "\[Rule]", "Trad"}], ",", 
             RowBox[{"npairs", "\[Rule]", "mynpairs"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gammaout", "=", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "+", 
              RowBox[{"uy", "^", "2"}]}], "]"}], "//.", "fsolssp"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bxout", "=", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"Bx", "/", "gammaout"}], "//.", "fsolssp"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"0", "+", "bxout"}], ")"}]}], "//.", "fsolssp"}]}], ";",
           " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "assume", " ", "by", " ", "central", " ", "mean", " ", "non"}], 
             "-", 
             RowBox[{"zero", " ", "field"}]}], ",", " ", 
            RowBox[{
            "which", " ", "in", " ", "SP", " ", "language", " ", "is", " ", 
             "mostly", " ", "bbarx"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", 
           RowBox[{"bxout", "//.", "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussnorm", "=", "bgaussrad"}], ";"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"don", "'"}], "t", " ", "use", " ", "exactly", " ", "zero",
            " ", "for", " ", "bc"}], ",", " ", 
          RowBox[{"assume", " ", "distributed"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"between", " ", "in", " ", "and", " ", 
         RowBox[{"center", " ", "--"}], " ", "for", " ", "radiation", " ", 
         "term", " ", "in", " ", "SP", " ", "solution"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"which", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rhobrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"rhobingoing", "+", "rhoc"}], ")"}]}], "//.", 
            "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "assume", " ", "by", " ", "rhobrad", " ", "mean", " ", "to", " ", 
            "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"rhobrad", "=", 
           RowBox[{"rhobingoing", "//.", "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"rhobnorm", "=", "rhobrad"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Trad", "=", 
             RowBox[{
              RowBox[{"0.5", "*", 
               RowBox[{"(", 
                RowBox[{"Tvalue", "+", "Tc"}], ")"}]}], "//.", "fsolssp"}]}], 
            ";"}], "  ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "assume", " ", "by", " ", "Trad", " ", "mean", " ", "to", " ", 
             "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Assume", " ", "Tc", " ", "is", " ", "good", " ", "for", " ", 
            "central", " ", 
            RowBox[{"temperature", ".", "  ", "As"}], " ", "if", " ", "rest", 
            " ", "of", " ", "region", " ", "is", " ", "heated", " ", "up", 
            " ", "to", " ", "same", " ", "temperature"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Trad", "=", 
           RowBox[{"Tc", "//.", "fsolssp"}]}], ";", "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "assume", " ", "by", " ", "Trad", " ", "mean", " ", "to", " ", 
            "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"solsTrad", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "\[Rule]", "Trad"}], ",", 
             RowBox[{"npairs", "\[Rule]", "mynpairs"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"solsT", "=", "solsTrad"}], ";", "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"bgaussvalue", "+", "0"}], ")"}]}], "//.", 
            "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "assume", " ", "by", " ", "central", " ", "mean", " ", "non"}], 
             "-", 
             RowBox[{"zero", " ", "field"}]}], ",", " ", 
            RowBox[{
            "which", " ", "in", " ", "SP", " ", "language", " ", "is", " ", 
             "mostly", " ", "bbarx"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", "bgaussvalue"}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussnorm", "=", "bgaussrad"}], ";"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"don", "'"}], "t", " ", "use", " ", "exactly", " ", 
          RowBox[{"zero", " ", "--"}], " ", "assume", " ", "distributed"}], 
         " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"between", " ", "center", " ", "and", " ", 
         RowBox[{"out", " ", "--"}], " ", "for", " ", "radiation", " ", 
         "term", " ", "in", " ", "SP", " ", "solution"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"which", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rhobrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"rhoc", "+", "rhoout"}], ")"}]}], "//.", "fsolssp"}]}], 
          ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "assume", " ", "by", " ", "rhobrad", " ", "mean", " ", "to", " ", 
            "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"rhobrad", "=", 
           RowBox[{"rhoout", "//.", "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"rhobnorm", "=", "rhobrad"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Trad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"Tc", "+", "Tout"}], ")"}]}], "//.", "fsolssp"}]}], ";",
           "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "assume", " ", "by", " ", "Trad", " ", "mean", " ", "to", " ", 
            "be", " ", "used", " ", "for", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"solsTrad", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "\[Rule]", "Trad"}], ",", 
             RowBox[{"npairs", "\[Rule]", "mynpairs"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"solsT", "=", "solsTrad"}], ";", "\[IndentingNewLine]", 
          RowBox[{"gammaout", "=", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "+", 
              RowBox[{"uy", "^", "2"}]}], "]"}], "//.", "fsolssp"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bxout", "=", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"Bx", "/", "gammaout"}], "//.", "fsolssp"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"0", "+", "bxout"}], ")"}]}], "//.", "fsolssp"}]}], ";",
           " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "assume", " ", "by", " ", "central", " ", "mean", " ", "non"}], 
             "-", 
             RowBox[{"zero", " ", "field"}]}], ",", " ", 
            RowBox[{
            "which", " ", "in", " ", "SP", " ", "language", " ", "is", " ", 
             "mostly", " ", "bbarx"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", 
           RowBox[{"bxout", "//.", "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussnorm", "=", "bgaussrad"}], ";"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"don", "'"}], "t", " ", "use", " ", "exactly", " ", "zero",
            " ", "for", " ", "bc"}], ",", " ", 
          RowBox[{"assume", " ", "distributed"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"center", " ", "--"}], " ", "true", " ", 
         RowBox[{"center", " ", "--"}], " ", "completely", " ", 
         "undistributed", " ", "except", " ", "for", " ", "mangetic", " ", 
         "field"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"which", "\[Equal]", "5"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rhobnorm", "=", 
           RowBox[{"rhoc", "//.", "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "to", " ", "be", " ", "used", " ", "for", " ", "everything", " ", 
            "except", " ", "directly", " ", "Q"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"solsT", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "\[Rule]", "myT"}], ",", 
             RowBox[{"npairs", "\[Rule]", "mynpairs"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rhobrad", "=", "rhobnorm"}], ";", "\[IndentingNewLine]", 
          RowBox[{"solsTrad", "=", "solsT"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "b", " ", "must", " ", "remain", " ", "distributed", " ", 
             "somewhat"}], ",", " ", 
            RowBox[{
            "so", " ", "assume", " ", "field", " ", "goes", " ", "from", " ", 
             "external", " ", "value", " ", "to", " ", "0", " ", "within", 
             " ", "layer"}], ",", " ", 
            RowBox[{
            "so", " ", "that", " ", "typical", " ", "value", " ", "is", " ", 
             "average", " ", "of", " ", "those", " ", "two", " ", 
             "values"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"bgaussvalue", "+", "0"}], ")"}]}], "//.", 
            "fsolssp"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "assume", " ", "by", " ", "central", " ", "mean", " ", "non"}], 
             "-", 
             RowBox[{"zero", " ", "field"}]}], ",", " ", 
            RowBox[{
            "which", " ", "in", " ", "SP", " ", "language", " ", "is", " ", 
             "mostly", " ", "bbarx"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussrad", "=", "bgaussvalue"}], ";", " ", 
          RowBox[{"(*", " ", "reversion", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"bgaussnorm", "=", "bgaussrad"}], ";"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"don", "'"}], "t", " ", "use", " ", "exactly", " ", 
          RowBox[{"zero", " ", "--"}], " ", "assume", " ", "distributed"}], 
         " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"return", " ", "value"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "rhobnorm", ",", "bgaussnorm", ",", "solsT", ",", "rhobrad", ",", 
         "bgaussrad", ",", "solsTrad"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4771601239485693`*^9, 3.477160322674323*^9}, {
   3.477160506889211*^9, 3.4771606507560816`*^9}, {3.4771607084290113`*^9, 
   3.477160711142914*^9}, {3.4771607800019283`*^9, 3.4771608199193263`*^9}, {
   3.4771608973206244`*^9, 3.477160918821541*^9}, {3.4771609793485746`*^9, 
   3.477160994600506*^9}, {3.477161061727029*^9, 3.4771610945141745`*^9}, {
   3.477161126430067*^9, 3.477161150975362*^9}, {3.4771611931860576`*^9, 
   3.477161197021573*^9}, {3.4771614880600653`*^9, 3.4771615048041425`*^9}, {
   3.477161643373395*^9, 3.4771617414544287`*^9}, {3.4771620745033293`*^9, 
   3.477162095844016*^9}, {3.4771643758324785`*^9, 3.477164386017123*^9}, {
   3.477166090858565*^9, 3.477166159977954*^9}, {3.4771662195936766`*^9, 
   3.477166280911848*^9}, {3.4771663349495506`*^9, 3.4771663632802877`*^9}, {
   3.477166480398696*^9, 3.4771664870282288`*^9}, {3.4771665207967854`*^9, 
   3.4771665223189745`*^9}, {3.477166585970501*^9, 3.4771666621500416`*^9}, {
   3.47716680171072*^9, 3.4771668024618*^9}, {3.477171474129328*^9, 
   3.4771714814498544`*^9}, 3.477171560193082*^9, {3.477178515524357*^9, 
   3.4771785678996687`*^9}, {3.4771792711609087`*^9, 
   3.4771792798934655`*^9}, {3.477179869230891*^9, 3.4771798820993953`*^9}, {
   3.477180273752565*^9, 3.47718028043217*^9}, {3.477180554165779*^9, 
   3.4771806800768304`*^9}, {3.477181213313587*^9, 3.4771812327915955`*^9}, 
   3.477181578088107*^9, {3.4912562824101696`*^9, 3.4912563001256433`*^9}, {
   3.4912563614638433`*^9, 3.4912563940206575`*^9}, 3.4912564704004865`*^9, {
   3.491341233936078*^9, 3.4913412362393904`*^9}, {3.4913412810037584`*^9, 
   3.491341282966581*^9}, {3.4913421837318172`*^9, 3.491342207836478*^9}, {
   3.49134359271784*^9, 3.4913436035834637`*^9}, {3.491343650901504*^9, 
   3.4913436510316916`*^9}, {3.4913454275361795`*^9, 
   3.4913454287979937`*^9}, {3.4916020417793393`*^9, 
   3.4916020441827955`*^9}, {3.4917451769576178`*^9, 3.491745213700451*^9}, {
   3.4917453254411263`*^9, 3.491745348774678*^9}, {3.491746518396512*^9, 
   3.4917465629305487`*^9}, {3.4917466645666943`*^9, 3.4917467514316*^9}, {
   3.491746782376096*^9, 3.4917468642538304`*^9}, {3.491746945110096*^9, 
   3.4917469480443153`*^9}, {3.4918269741261697`*^9, 
   3.4918270304771986`*^9}, {3.4918432911388817`*^9, 3.491843297407896*^9}, {
   3.4918436767032957`*^9, 3.491843678525917*^9}, {3.492205304053269*^9, 
   3.492205332353963*^9}, {3.4923740782586575`*^9, 3.492374119528*^9}, {
   3.4924408846214895`*^9, 3.4924409765536814`*^9}, {3.492441033926179*^9, 
   3.492441241995368*^9}, {3.492449128285296*^9, 3.4924491909854546`*^9}, {
   3.492449286913392*^9, 3.4924492897574816`*^9}, {3.492449339468963*^9, 
   3.4924493410612526`*^9}, {3.4924494582197185`*^9, 
   3.4924495575926094`*^9}, {3.4924501915842447`*^9, 3.492450197793173*^9}, {
   3.4924521939535103`*^9, 3.4924521959263473`*^9}, {3.4931777595673695`*^9, 
   3.4931777627419343`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "New", " ", "version", " ", "that", " ", "gets", " ", "temperatures", " ", 
    "using", " ", "functions", " ", "of", " ", "things"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getfullPUNQ", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "solsguess", ",", "solstrial", ",", "solsTrial", ",", 
        "var10", ",", "var20", ",", "level1", ",", "level2", ",", "nlevel1", 
        ",", "nlevel2", ",", "Tguess", ",", "npairsguess", ",", "ii", ",", 
        "Aum", ",", "Aumold", ",", "totalAiter"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"CHOICES", ":", " ", 
        RowBox[{"whichsplevel", " ", "and", " ", "which"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "general", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"getPUNQ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "temperatures"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "CENTER", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<full center\>\"", "]"}], ";"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"0", " ", "=", " ", 
          RowBox[{"simplest", " ", "assume", " ", "SP"}]}], "  ", ";", "  ", 
         RowBox[{"1", " ", "=", " ", 
          RowBox[{"Uzdensky", " ", "McKinney", " ", "2010"}]}], "  ", ";", 
         " ", 
         RowBox[{"2", " ", "=", " ", 
          RowBox[{
          "Full", " ", "SP", " ", "rel", " ", "layer", " ", "solution"}]}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"whichsplevel", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"which", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"which", "=", "5"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "1", " ", "and", " ", "5", " ", "are", " ", "the", " ", "same", " ", 
          "if", " ", "whichsplevel"}], "\[Equal]", "0"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"fullset", "=", 
        RowBox[{"chooseposition", "[", "which", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "rhobnorm", ",", "bgaussnorm", ",", "solsT", ",", "rhobrad", ",", 
          "bgaussrad", ",", "solsTrad"}], "}"}], "=", "fullset"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Get", " ", "T"}], ",", " ", "npairs", ",", " ", 
         RowBox[{"and", " ", "Aum"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"totalAiter", "=", "100"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"don", "'"}], "t", " ", "have", " ", "new", " ", 
          "rhobcenter", " ", "yet"}], ",", " ", 
         RowBox[{
         "and", " ", "want", " ", "A", " ", "computed", " ", "witih", " ", 
          "both", " ", "new", " ", "T", " ", "and", " ", "new", " ", "rhob"}],
          ",", " ", 
         RowBox[{
         "so", " ", "need", " ", "to", " ", "iterate", " ", "to", " ", "get", 
          " ", "converged", " ", "A"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Aumold", "=", 
        RowBox[{"rhobcenter", "/", "rhobingoing"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "\[LessEqual]", "totalAiter"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "get", " ", "T", " ", "and", " ", "npairs", " ", "and", " ", 
           "maybe", " ", "rhobcenter", " ", 
           RowBox[{"(", 
            RowBox[{"i", ".", "e", ".", " ", "Aum"}], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"solsTtrial", "=", 
           RowBox[{"gettemperaturewrapper", "[", 
            RowBox[{
            "rhobnorm", ",", "rhobrad", ",", "bgaussnorm", ",", "bgaussrad"}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"update", " ", "T", " ", "and", " ", "npairs", " ", 
            RowBox[{"variables", " ", "--"}], " ", "needed", " ", "before", 
            " ", "getAum"}], " ", "*)"}], "\[IndentingNewLine]", 
          "iterateindeps", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "see", " ", "if", " ", "need", " ", "to", " ", "do", " ", "silly",
              " ", "iteration", " ", "or", " ", "already", " ", "have", " ", 
             "solution", " ", "when", " ", "npairs"}], "=", "0"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "the", " ", "below", " ", "conditional", " ", "still", " ", 
             "allows", " ", "entrance", " ", "when", " ", "computed", " ", 
             "Aum"}], ",", " ", 
            RowBox[{"such", " ", "as", " ", "when", " ", "no", " ", 
             RowBox[{"change", ".", "  ", "But"}], " ", "this", " ", 
             "redundancy", " ", "is", " ", "not", " ", "expensive"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"rhobcenter", "-", "rhobingoing"}], ")"}], "/", 
                "rhobingoing"}], "]"}], ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "10"}], ")"}]}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"npairsrad", "-", "0"}], "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "10"}], ")"}]}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ii", "=", 
              RowBox[{"totalAiter", "+", "1"}]}], ";"}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "jump", " ", "out", " ", "since", " ", "apparently", " ", 
              "already", " ", "solved", " ", "for", " ", "rhobcenter"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", " ", 
            RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"get", " ", 
              RowBox[{"rhobcenter", ".", "  ", "rhobcenter"}], " ", "is", " ",
               "then", " ", "used", " ", "in", " ", "chooseposition", " ", 
              "below", " ", "that", " ", "effectively", " ", "iterates", " ", 
              "all", " ", "\"\<norms\>\"", " ", "and", " ", "\"\<rads\>\"", 
              " ", "used", " ", "in", " ", "rest", " ", "of", " ", 
              RowBox[{"code", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"getAum", ";", "\[IndentingNewLine]", 
             RowBox[{"Aum", "=", 
              RowBox[{"rhobcenter", "/", "rhobingoing"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"limit", " ", "update"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Aum", "/", "Aumold"}], ">", "2"}], ",", 
               RowBox[{"Aum", "=", 
                RowBox[{"Aumold", "*", "2"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Aum", "/", "Aumold"}], "<", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"Aum", "=", 
                RowBox[{"Aumold", "/", "2"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"rhobcenter", "=", 
              RowBox[{"rhobingoing", "*", "Aum"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Aum=\>\"", ",", "Aum", ",", "\"\< Aumold=\>\"", ",", 
                  "Aumold"}], "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"Aum", "-", "Aumold"}], "]"}], "/", "Aumold"}], "<",
                 "RELTOLAum"}], ",", 
               RowBox[{
                RowBox[{"ii", "=", 
                 RowBox[{"totalAiter", "+", "1"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"ii", "=", 
                 RowBox[{"ii", "+", "1"}]}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Aumold", "=", "Aum"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ii", "\[Equal]", "totalAiter"}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<Maxed out Aum iterations\>\"", "]"}], 
                ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "End", " ", "if", " ", "getting", " ", "Aum", " ", "here", " ", 
          "through", " ", "silly", " ", "iteration", " ", "that", " ", 
          "barely", " ", "or", " ", 
          RowBox[{"doesn", "'"}], "t", " ", "work"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "OTHER", " ", "POSITIONS", " ", "TO", " ", "DO", " ", "LATER"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "return", " ", "did", " ", "ok", " ", "by", " ", "passing", " ", 
         "back", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", "1"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.491834053986509*^9, 3.491834159568328*^9}, {
   3.49183421820264*^9, 3.4918342833362975`*^9}, {3.491834332286685*^9, 
   3.49183434813948*^9}, {3.491834462443842*^9, 3.4918344748817263`*^9}, {
   3.4918348636908064`*^9, 3.4918349866476097`*^9}, {3.491835519774208*^9, 
   3.491835530639832*^9}, {3.491835614470374*^9, 3.491835633057101*^9}, {
   3.491835805935688*^9, 3.4918358254537535`*^9}, {3.4918359684493713`*^9, 
   3.491836003289469*^9}, {3.491844081915963*^9, 3.4918440910390816`*^9}, {
   3.4918531089662237`*^9, 3.491853143936509*^9}, {3.4918531916150675`*^9, 
   3.4918532359588304`*^9}, {3.4918533517753663`*^9, 3.49185336214027*^9}, {
   3.49218098631608*^9, 3.4921811053772817`*^9}, {3.4921910179408484`*^9, 
   3.4921910986168547`*^9}, {3.492191139605794*^9, 3.4921911414083853`*^9}, 
   3.4921915733494864`*^9, {3.492192224395645*^9, 3.492192352680109*^9}, {
   3.4921934575087748`*^9, 3.4921934694759827`*^9}, {3.492200211931157*^9, 
   3.492200253801363*^9}, {3.4922006392656336`*^9, 3.4922006418393345`*^9}, {
   3.4922015920256352`*^9, 3.49220159244624*^9}, {3.492201642738557*^9, 
   3.4922018762042637`*^9}, {3.492202330197074*^9, 3.4922023730286627`*^9}, {
   3.4922026393315873`*^9, 3.492202671367653*^9}, {3.4922031025576735`*^9, 
   3.492203147962963*^9}, {3.492203208139493*^9, 3.4922032477865024`*^9}, {
   3.492203281845477*^9, 3.492203282195981*^9}, {3.4922033191891747`*^9, 
   3.4922033558719215`*^9}, {3.492204155982424*^9, 3.492204170693578*^9}, {
   3.4922042299487824`*^9, 3.4922042548445807`*^9}, {3.492204458968096*^9, 
   3.492204576286792*^9}, {3.4922046330484114`*^9, 3.4922046392172813`*^9}, {
   3.4922049807583933`*^9, 3.492204980828494*^9}, {3.4922053352781677`*^9, 
   3.4922053448018627`*^9}, {3.492210474738349*^9, 3.492210478543821*^9}, {
   3.4924495935943775`*^9, 3.492449596778957*^9}, {3.4924502933505774`*^9, 
   3.4924503078714576`*^9}, {3.4924519644334764`*^9, 
   3.4924520528305855`*^9}, {3.4924522022654624`*^9, 
   3.4924522080337567`*^9}, {3.4924525437965603`*^9, 
   3.4924526157199807`*^9}, {3.492452816628874*^9, 3.4924528230380898`*^9}, {
   3.4924531964750657`*^9, 3.4924533282144976`*^9}, {3.4924542604049215`*^9, 
   3.4924543094254093`*^9}, {3.4924543439650755`*^9, 3.492454352597488*^9}, {
   3.492464073876*^9, 3.492464073976144*^9}, {3.493177132705987*^9, 
   3.4931772285037374`*^9}, {3.4931772955902033`*^9, 
   3.4931773192342014`*^9}, {3.493177399659848*^9, 3.4931774765003395`*^9}, {
   3.493177520603757*^9, 3.493177551378008*^9}, {3.49317904332332*^9, 
   3.4931790435636654`*^9}, {3.4931794190235505`*^9, 3.493179421767496*^9}, {
   3.4931794853589363`*^9, 3.493179492569304*^9}, {3.493179557392515*^9, 
   3.4931795838405457`*^9}, {3.4931796718170495`*^9, 3.493179730090843*^9}, {
   3.4931805018405647`*^9, 3.4931805767883344`*^9}, {3.493180654840568*^9, 
   3.4931807159884944`*^9}, {3.4931808173342223`*^9, 3.493180856670786*^9}, {
   3.493180892802741*^9, 3.493180899472331*^9}, {3.493609412012*^9, 
   3.4936094190476*^9}, {3.493609461308*^9, 3.4936094794196*^9}, {
   3.4936098471870003`*^9, 3.493609850619*^9}, {3.4939672933490944`*^9, 
   3.493967296503315*^9}, {3.494149877372893*^9, 3.494149880016694*^9}, {
   3.4941504275740433`*^9, 3.4941504689735727`*^9}, {3.494150500528947*^9, 
   3.494150742817341*^9}, {3.4941507829850993`*^9, 3.4941508246850605`*^9}, {
   3.494150874256341*^9, 3.4941509077144513`*^9}, {3.494151104387253*^9, 
   3.494151116634864*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"iterateindeps", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "ITERATED", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"solsT", "=", "solsTtrial"}], ";", "\[IndentingNewLine]", 
      RowBox[{"solsTrad", "=", "solsT"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"myie", "=", 
       RowBox[{"Ug", "[", 
        RowBox[{
        "rhobnorm", ",", "rhobrad", ",", "Tnorm", ",", "bgaussnorm", ",", 
         "bgaussrad", ",", "npairsnorm"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "rough", " ", "due", " ", "to", " ", "ambiguity", " ", "of", " ", 
        "Tnorm", " ", 
        RowBox[{"vs", ".", " ", "Trad"}], " ", "and", " ", "npairsnorm", " ", 
        RowBox[{"vs", ".", " ", "npairsrad"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"myu4vel", "=", "0.01"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "not", " ", "updated", " ", "really", " ", "until", " ", "vrel", " ", 
        "updated"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"myb", "=", "0.001"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "not", " ", "updated", " ", "really", " ", "until", " ", "Deltaspt", 
        " ", "updated"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "update", " ", "fsolssp", " ", "so", " ", "used", " ", "in", " ", 
        "chooseposition"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fsolssp", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", "\[Rule]", "Lpnum"}], ",", 
         RowBox[{"ux", "->", "myu4vel"}], ",", 
         RowBox[{"rhoc", "\[Rule]", "rhobcenter"}], ",", 
         RowBox[{"iec", "\[Rule]", "myie"}], ",", 
         RowBox[{"rhoout", "\[Rule]", "rhobcenter"}], ",", 
         RowBox[{"ieout", "\[Rule]", "myie"}], ",", 
         RowBox[{"Bx", "\[Rule]", "myb"}], ",", 
         RowBox[{"uy", "\[Rule]", "myu4vel"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "SAVE", " ", "result", " ", "for", " ", "rest", " ", "of", " ", 
        "code"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"storeiter", "[", "which", "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"only", " ", "stores", " ", "T", " ", "and", " ", "npairs"}], 
        ",", " ", 
        RowBox[{"but", " ", "not", " ", "used", " ", "right", " ", "now"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "update", " ", "norms", " ", "and", " ", "rads", " ", "and", " ", 
        RowBox[{"solT", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rhobnorm", ",", "bgaussnorm", ",", "solsT", ",", "rhobrad", ",", 
         "bgaussrad", ",", "solsTrad"}], "}"}], "=", 
       RowBox[{"chooseposition", "[", "which", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tnorm", "=", 
       RowBox[{"solsT", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"npairsnorm", "=", 
       RowBox[{"solsT", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solsTrad", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Trad", "=", 
       RowBox[{"solsTrad", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"npairsrad", "=", 
       RowBox[{"solsTrad", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"now", " ", "use", " ", "rhobnorm"}], ",", " ", "bgaussnorm", 
      ",", " ", "solsT", ",", " ", "rhobrad", ",", " ", "bgaussrad", ",", " ", 
      RowBox[{"solsTrad", " ", "and", " ", "Tnorm"}], ",", "npairsnorm", ",", 
      "Trad", ",", 
      RowBox[{
      "npairsrad", " ", "in", " ", "plasma", " ", "part", " ", "of", " ", 
       "math", " ", "code"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4931771398662834`*^9, 3.4931771479078465`*^9}, {
  3.493609387832*^9, 3.4936094073008003`*^9}, {3.493941087034483*^9, 
  3.4939410900788608`*^9}, {3.4939435081358557`*^9, 3.493943520103064*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"get", " ", "P"}], ",", " ", "U", ",", " ", 
    RowBox[{"(", "N", ")"}], ",", " ", 
    RowBox[{
    "and", " ", "Q", " ", "for", " ", "a", " ", "given", " ", "set", " ", 
     "of", " ", "independent", " ", "variables"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getPUNQ", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "Pbaryon", ",", "Ubaryon", ",", "Pe", ",", "Ue", ",", "nb", ",", "Ye",
          ",", "np", ",", "nn", ",", "ne", ",", "Pg", ",", "Ug", ",", "Qtot", 
         ",", "nuexpfactorother", ",", "Xnuc0other", ",", "Xnucother", ",", 
         "nuexpfactor", ",", "Xnuc0", ",", "Xnuc"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", 
        RowBox[{
        "Pbaryon", ",", "Ubaryon", ",", "Pe", ",", "Ue", ",", "nb", ",", "Ye",
          ",", "np", ",", "nn", ",", "ne", ",", "Pg", ",", "Ug", ",", "Qtot", 
         ",", "nuexpfactorother", ",", "Xnuc0other", ",", "Xnucother", ",", 
         "nuexpfactor", ",", "Xnuc0", ",", "Xnuc"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "baryons", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rho10", "[", "rhob_", "]"}], ":=", 
        RowBox[{"rhob", "/", 
         RowBox[{"10", "^", 
          RowBox[{"(", "10", ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rho13", "[", "rhob_", "]"}], ":=", 
        RowBox[{"rhob", "/", 
         RowBox[{"10", "^", 
          RowBox[{"(", "13", ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T11", "[", "T_", "]"}], ":=", 
        RowBox[{"T", "/", 
         RowBox[{"10", "^", "11"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tmev", "[", "T_", "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{"kb", "*", 
          RowBox[{"T", "/", "ergPmev"}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nuexpfactorother", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"7.074", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Xnuc0other", "[", 
         RowBox[{"rhob0_", ",", "T0_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"T", "=", "T0"}], ",", 
            RowBox[{"rhob", "=", "rhob0"}]}], "}"}], ",", 
          RowBox[{"26", "*", 
           RowBox[{
            RowBox[{"Tmev", "[", "T", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"9", "/", "8"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"rho10", "[", "rhob", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "/", "4"}], ")"}]}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "nuexpfactorother"}], "/", 
             RowBox[{"Tmev", "[", "T", "]"}]}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Xnucother", "[", 
         RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Tmev", "[", "T", "]"}], "<", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "10"}], ")"}]}]}], " ", "||", " ", 
           RowBox[{
            RowBox[{"Xnuc0other", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}], "<", "0"}]}], " ", ",", "0", 
          ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Xnuc0other", "[", 
              RowBox[{"rhob", ",", "T"}], "]"}], ">", "1"}], " ", ",", "1", 
            ",", 
            RowBox[{"Xnuc0other", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"avoid", " ", "Underflow", " ", "in", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "nu"}], "]"}]}], ",", " ", 
         RowBox[{"so", " ", 
          RowBox[{"don", "'"}], "t", " ", "let", " ", "nu", " ", "become", 
          " ", "too", " ", "large"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nuexpfactor", "[", "T_", "]"}], ":=", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"0.8209", ",", "lowestprec"}], "]"}], "/", 
           RowBox[{"T11", "[", "T", "]"}]}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", "5", ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Xnuc0", "[", 
         RowBox[{"rhob0_", ",", "T0_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"T", "=", "T0"}], ",", 
            RowBox[{"rhob", "=", "rhob0"}]}], "}"}], ",", 
          RowBox[{"296", "*", 
           RowBox[{
            RowBox[{"T11", "[", "T", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{"9", "/", "8"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"rho10", "[", "rhob", "]"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "/", "4"}], ")"}]}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"nuexpfactor", "[", "T", "]"}]}], "]"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Xnuc", "[", 
         RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Tmev", "[", "T", "]"}], "<", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "10"}], ")"}]}]}], " ", "||", " ", 
           RowBox[{
            RowBox[{"Xnuc0", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}], "<", "0"}]}], " ", ",", "0", 
          ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Xnuc0", "[", 
              RowBox[{"rhob", ",", "T"}], "]"}], ">", "1"}], " ", ",", "1", 
            ",", 
            RowBox[{"Xnuc0", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "assume", " ", "baryons", " ", "and", " ", "electrons", " ", 
         "compressed", " ", "in", " ", "center", " ", "of", " ", "layer"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Pbaryon", "[", 
           RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
          RowBox[{"rhob", "*", "T", "*", 
           RowBox[{"kb", "/", "mb"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ubaryon", "[", 
           RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "/", "2"}], ")"}], "*", 
           RowBox[{"Pbaryon", "[", 
            RowBox[{"rhob", ",", "T"}], "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "account", " ", "for", " ", "photodissintegration", " ", "to"}], "-", 
         RowBox[{
         "from", " ", "alphas", " ", "and", " ", "free", " ", "nucleons"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mN", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"mn", "+", "mp"}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ebin", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"283", "/", "10"}], ")"}], "*", "ergPmev"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Eratio", "=", 
        RowBox[{"Ebin", "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "mN", "*", 
           RowBox[{"c", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ubaryon", "[", 
         RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
        RowBox[{"rhob", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "*", "kb", "*", "T"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"8", "*", "mN"}], ")"}]}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "-", "Eratio"}], ")"}], "*", 
             RowBox[{"Xnuc", "[", 
              RowBox[{"rhob", ",", "T"}], "]"}]}], "+", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Eratio"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pbaryon", "[", 
         RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", "/", "3"}], "-", "1"}], ")"}], "*", 
         RowBox[{"Ubaryon", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "[", "rhob_", "]"}], ":=", 
        RowBox[{"rhob", "/", "mb"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "nucleons", " ", "are", " ", "degenerate", " ", "if", " ", "this", 
         " ", "is", " ", "greater", " ", "than", " ", "unity"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"degennuc", "[", 
         RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"nb", "[", "rhob", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"kb", "*", 
              RowBox[{"T", "/", 
               RowBox[{"(", 
                RowBox[{"hbar", "*", "c"}], ")"}]}]}], ")"}], "^", "3"}], "/", 
           RowBox[{"Pi", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"ye", "=", 
         RowBox[{"1", "/", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Ye", "=", 
        RowBox[{"1", "/", "2"}]}], ";", 
       RowBox[{"Ye", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Ye", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"np", "[", "rhob_", "]"}], ":=", 
        RowBox[{
         RowBox[{"nb", "[", "rhob", "]"}], "*", "Ye"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nn", "[", "rhob_", "]"}], ":=", 
        RowBox[{
         RowBox[{"nb", "[", "rhob", "]"}], "*", "Ye"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ne", "[", "rhob_", "]"}], ":=", 
        RowBox[{"np", "[", "rhob", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pe", "[", 
         RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
        RowBox[{"rhob", "*", "T", "*", 
         RowBox[{"kb", "/", "mb"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FactorT", "[", "T_", "]"}], ":=", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"me", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}]}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FactorU", "[", "T_", "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "/", "2"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"FactorT", "[", "T", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"FactorT", "[", "T", "]"}], "*", "3"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ue", "[", 
         RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"FactorU", "[", "T", "]"}], "*", 
         RowBox[{"Pe", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "column", " ", "depth", " ", "unaffected", " ", "by", " ", 
          "rhobcenter", " ", "due", " ", "to", " ", "total", " ", "mass", " ",
           "conservation"}], ",", " ", 
         RowBox[{
         "so", " ", "directly", " ", "probe", " ", "background", " ", 
          "density", " ", "rather", " ", "than", " ", "input", " ", 
          "density"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"neint", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rhobingoing", "/", "mb"}], ")"}], "*", "Ye", "*", "x"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nbint", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rhobingoing", "/", "mb"}], ")"}], "*", "x"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "radiation", " ", "*)"}], "\[IndentingNewLine]", 
       "getUPNrad", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "pairs", " ", "*)"}], "\[IndentingNewLine]", 
       "getUPNpairs", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "neutrinos", " ", "*)"}], "\[IndentingNewLine]", 
       "getQneutrino", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "totals", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Notice", " ", "that", " ", "\"\<rad\>\"", " ", "version", " ", 
         "used", " ", "for", " ", "all", " ", "radiation", " ", "terms"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Note", " ", "that", " ", "rhobcenter", " ", "compression", " ", 
          "will", " ", "occur", " ", "for", " ", "all", " ", "\"\<rhob\>\"", 
          " ", "terms", " ", "that", " ", 
          RowBox[{"aren", "'"}], "t", " ", "\"\<rad\>\""}], "-", "based"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Notice", " ", "that", " ", "neutrinos", " ", "are", " ", "*", "not", 
         "*", " ", "distributed", " ", "and", " ", "so", " ", 
         RowBox[{"don", "'"}], "t", " ", "use", " ", "\"\<rad\>\"", " ", 
         "since", " ", "emission", " ", "should", " ", "dominate", " ", 
         "from", " ", "within", " ", "current", " ", "layer"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pg", "[", 
         RowBox[{
         "rhob_", ",", "rhobrad_", ",", "T_", ",", "bgauss_", ",", 
          "bgaussrad_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Prad", "[", 
          RowBox[{"rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
          "]"}], "+", 
         RowBox[{"Ppairs", "[", 
          RowBox[{"rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
          "]"}], "+", 
         RowBox[{"Pbaryon", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "+", 
         RowBox[{"Pe", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "+", 
         RowBox[{"Pnu", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ug", "[", 
         RowBox[{
         "rhob_", ",", "rhobrad_", ",", "T_", ",", "bgauss_", ",", 
          "bgaussrad_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Urad", "[", 
          RowBox[{"rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
          "]"}], "+", 
         RowBox[{"Upairs", "[", 
          RowBox[{"rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
          "]"}], "+", 
         RowBox[{"Ubaryon", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "+", 
         RowBox[{"Ue", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "+", 
         RowBox[{"Unu", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Qtot", "[", 
         RowBox[{
         "rhob_", ",", "rhobrad_", ",", "T_", ",", "bgauss_", ",", 
          "bgaussrad_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Qrad", "[", 
          RowBox[{"rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
          "]"}], "+", 
         RowBox[{"Qnu", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "ABOVE", " ", "Ug", " ", "and", " ", "Pg", " ", "must", " ", "be", 
         " ", "free", " ", "of", " ", "any", " ", "T", " ", "assignment", " ",
          "using", " ", "solsT", " ", "since", " ", "have", " ", "to", " ", 
         "solve", " ", "for", " ", "T", " ", "explicitly", " ", "using", " ", 
         "FindRoot"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "Pbaryon", ",", "Ubaryon", ",", "Pe", ",", "Ue", ",", "nb", ",", "Ye",
          ",", "np", ",", "nn", ",", "ne", ",", "Pg", ",", "Ug", ",", "Qtot", 
         ",", "nuexpfactorother", ",", "Xnuc0other", ",", "Xnucother", ",", 
         "nuexpfactor", ",", "Xnuc0", ",", "Xnuc"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.464907611102667*^9, 3.4649076135061235`*^9}, {
   3.464907847392435*^9, 3.464907861432624*^9}, {3.4649080071521587`*^9, 
   3.4649080516461377`*^9}, {3.4649082022226562`*^9, 
   3.4649082057877827`*^9}, {3.464909204313592*^9, 3.4649092457131214`*^9}, {
   3.4649093101557856`*^9, 3.464909334120245*^9}, {3.4650782032055745`*^9, 
   3.465078265415027*^9}, {3.46507830784604*^9, 3.4650784745958147`*^9}, {
   3.4650785230955534`*^9, 3.4650785606195107`*^9}, {3.4650785917442656`*^9, 
   3.4650785919145107`*^9}, {3.4651442590488253`*^9, 
   3.4651442593993297`*^9}, {3.4651443859913597`*^9, 3.465144387793952*^9}, {
   3.4651494750190225`*^9, 3.46514950360012*^9}, {3.465149829869272*^9, 
   3.465149832863578*^9}, {3.465188055882043*^9, 3.4651880746590433`*^9}, {
   3.4651881363277187`*^9, 3.465188146151845*^9}, {3.4652514944488783`*^9, 
   3.465251566722803*^9}, {3.4652516337992544`*^9, 3.465251635191256*^9}, {
   3.466461615066061*^9, 3.466461615867213*^9}, {3.466463553613555*^9, 
   3.466463590136072*^9}, {3.4665314393999023`*^9, 3.46653148024864*^9}, {
   3.4666541255236144`*^9, 3.466654142488008*^9}, {3.4667867545284*^9, 
   3.4667867574611998`*^9}, {3.4670841364796*^9, 3.4670841374312*^9}, {
   3.4670842101272*^9, 3.4670842149788*^9}, {3.4671863904833856`*^9, 
   3.4671864514210095`*^9}, {3.467187033177534*^9, 3.467187035821336*^9}, {
   3.4671995575867505`*^9, 3.4671996240823665`*^9}, {3.4672001921191635`*^9, 
   3.467200247638997*^9}, {3.4672003919565153`*^9, 3.4672004048951197`*^9}, {
   3.4686579811707907`*^9, 3.468658012405704*^9}, {3.4686580463645344`*^9, 
   3.468658273250781*^9}, {3.468658352434642*^9, 3.468658357702216*^9}, {
   3.4686586192683296`*^9, 3.4686586266589565`*^9}, {3.4686586641728992`*^9, 
   3.468658664343144*^9}, {3.4686591124775295`*^9, 3.4686591261972575`*^9}, {
   3.468659333875885*^9, 3.468659342508298*^9}, {3.4686612894478593`*^9, 
   3.4686612949858227`*^9}, {3.4686615547393293`*^9, 3.468661559015478*^9}, {
   3.4686644044169645`*^9, 3.468664427830632*^9}, {3.4686679298763266`*^9, 
   3.468667937367098*^9}, 3.468667993728141*^9, {3.4689752883188868`*^9, 
   3.468975292995611*^9}, {3.46897539991936*^9, 3.46897547577844*^9}, {
   3.4689755238976316`*^9, 3.468975528554328*^9}, {3.4689755675003295`*^9, 
   3.4689755885005264`*^9}, {3.4689756608345375`*^9, 
   3.4689756761265264`*^9}, {3.468975851698987*^9, 3.468975852199707*^9}, {
   3.4689759861022496`*^9, 3.4689760787154207`*^9}, {3.46897618696107*^9, 
   3.4689762022931166`*^9}, {3.46897623311744*^9, 3.4689762802051487`*^9}, {
   3.468976342825192*^9, 3.4689763642259645`*^9}, {3.4689763944794674`*^9, 
   3.4689764491580915`*^9}, {3.468977215810483*^9, 3.4689773335798273`*^9}, {
   3.468990397915419*^9, 3.4689904193362207`*^9}, {3.4689931025344706`*^9, 
   3.4689931116275454`*^9}, {3.468993694395525*^9, 3.468993694806115*^9}, {
   3.4720002694216547`*^9, 3.472000277873808*^9}, {3.472005540841584*^9, 
   3.4720056682347665`*^9}, {3.4720115558307133`*^9, 
   3.4720116251003184`*^9}, {3.472011655604181*^9, 3.4720116584983425`*^9}, {
   3.472011707869334*^9, 3.472011848791971*^9}, {3.472011884994027*^9, 
   3.4720118884590096`*^9}, {3.472011922858474*^9, 3.4720119307898784`*^9}, {
   3.4720120602560415`*^9, 3.472012101825816*^9}, {3.4720121378375983`*^9, 
   3.472012435675869*^9}, {3.4720124904546366`*^9, 3.47201256650399*^9}, {
   3.4720171940798545`*^9, 3.4720173626722784`*^9}, {3.4720174246313715`*^9, 
   3.4720176688325152`*^9}, {3.472019802079974*^9, 3.472019804042797*^9}, {
   3.47202931449816*^9, 3.4720293309317904`*^9}, {3.4720298198648415`*^9, 
   3.4720298445703664`*^9}, {3.472030510578038*^9, 3.472030529395096*^9}, {
   3.4720308397012944`*^9, 3.472030850947466*^9}, {3.4720314372304993`*^9, 
   3.472031479841771*^9}, {3.472031514261264*^9, 3.4720315242556353`*^9}, {
   3.4720315683890963`*^9, 3.4720316502868595`*^9}, {3.472031683554696*^9, 
   3.4720317053660593`*^9}, {3.4720318213328114`*^9, 3.472031822073877*^9}, 
   3.4720318816795855`*^9, {3.4720319193838015`*^9, 3.4720319401536674`*^9}, {
   3.472032060797144*^9, 3.472032073215*^9}, {3.4720329330914416`*^9, 
   3.472032948773992*^9}, {3.4720330353584943`*^9, 3.472033041887883*^9}, 
   3.4720772314972816`*^9, {3.472077766446501*^9, 3.472077810289544*^9}, 
   3.4721666752880163`*^9, {3.47216674057189*^9, 3.4721667963520975`*^9}, {
   3.4721684539856577`*^9, 3.472168459824053*^9}, {3.472170878061307*^9, 
   3.472170883268795*^9}, {3.4770663649960012`*^9, 3.4770663652663903`*^9}, {
   3.4770663963711166`*^9, 3.47706639665152*^9}, {3.4770664377506175`*^9, 
   3.4770664619153647`*^9}, {3.4770665009815392`*^9, 
   3.4770665756489058`*^9}, {3.4770666324806256`*^9, 
   3.4770666507869487`*^9}, {3.477066963496603*^9, 3.47706696371692*^9}, {
   3.4770687427850943`*^9, 3.477068745428896*^9}, {3.47707459109455*^9, 
   3.477074613636965*^9}, {3.477086349632498*^9, 3.4770863597670703`*^9}, {
   3.4770905504429665`*^9, 3.4770905552999506`*^9}, {3.477090619912859*^9, 
   3.477090631850024*^9}, {3.477090674591483*^9, 3.4770906919965105`*^9}, {
   3.4770907224202576`*^9, 3.477090731413189*^9}, {3.4770917949024115`*^9, 
   3.4770918288612413`*^9}, {3.4770930501173215`*^9, 
   3.4770930811419325`*^9}, {3.4770936009794226`*^9, 
   3.4770936026618414`*^9}, {3.477094322557*^9, 3.4770943506874495`*^9}, {
   3.4770948623431745`*^9, 3.4770949016697235`*^9}, {3.4770949407959843`*^9, 
   3.4770950944168797`*^9}, {3.477095143938088*^9, 3.4770952749164257`*^9}, {
   3.4770953181285615`*^9, 3.47709541938416*^9}, {3.477095573375589*^9, 
   3.4770955745773168`*^9}, {3.4770956395407295`*^9, 3.477095651137405*^9}, {
   3.477096009332464*^9, 3.4770960108746815`*^9}, 3.4770971486607375`*^9, {
   3.4770972899038353`*^9, 3.4770972963230658`*^9}, {3.4771508258185153`*^9, 
   3.477150829974491*^9}, {3.4771508600477343`*^9, 3.47715087355716*^9}, {
   3.477151457196392*^9, 3.4771514574066944`*^9}, {3.4771595834814157`*^9, 
   3.477159586986456*^9}, {3.4771597025626464`*^9, 3.4771597615674915`*^9}, {
   3.477159797338928*^9, 3.477159945131443*^9}, {3.4771600370035486`*^9, 
   3.4771600379749455`*^9}, {3.4771615388531027`*^9, 3.477161625738037*^9}, {
   3.477161751078267*^9, 3.4771618109343357`*^9}, {3.4771618419889903`*^9, 
   3.4771618703497715`*^9}, {3.477161947410579*^9, 3.477161955392056*^9}, {
   3.477162100070093*^9, 3.47716212773988*^9}, {3.477163166673794*^9, 
   3.4771631733533983`*^9}, {3.4771672022266335`*^9, 3.4771672060921917`*^9}, 
   3.47717148269164*^9, {3.4771769765914803`*^9, 3.477176977232402*^9}, {
   3.477177777623307*^9, 3.4771777782341857`*^9}, 3.4771799571673374`*^9, {
   3.491256744264283*^9, 3.4912567586449614`*^9}, {3.4912568991670227`*^9, 
   3.4912569238625326`*^9}, {3.4916025027822285`*^9, 
   3.4916025348683662`*^9}, {3.491602905791728*^9, 3.4916029082552705`*^9}, {
   3.4916033633596783`*^9, 3.4916033676258125`*^9}, {3.491746915447443*^9, 
   3.4917469321013904`*^9}, {3.491826735963709*^9, 3.4918267389580145`*^9}, {
   3.491827135498211*^9, 3.4918273410437713`*^9}, {3.4918337872429504`*^9, 
   3.4918337888752975`*^9}, {3.4918344827931023`*^9, 
   3.4918345276075425`*^9}, {3.491834572201666*^9, 3.4918345907583485`*^9}, {
   3.491836055304262*^9, 3.49183607721577*^9}, {3.4918425420116897`*^9, 
   3.4918425428629136`*^9}, {3.4923741370632143`*^9, 
   3.4923741505526114`*^9}, {3.492441854245741*^9, 3.4924418563888226`*^9}, {
   3.492441908383587*^9, 3.49244190900448*^9}, {3.4924419871568575`*^9, 
   3.4924420613835907`*^9}, {3.4924421118862095`*^9, 3.492442150471693*^9}, {
   3.4924422747503967`*^9, 3.4924423050439568`*^9}, {3.4924423392431326`*^9, 
   3.492442345061499*^9}, {3.492448490508218*^9, 3.492448548351392*^9}, {
   3.4924486241704144`*^9, 3.492448639121914*^9}, {3.4924493476206846`*^9, 
   3.4924493491528883`*^9}, {3.492449417981859*^9, 3.492449447524339*^9}, {
   3.4924522169165297`*^9, 3.4924522314874816`*^9}, {3.4939528986780167`*^9, 
   3.493952899188751*^9}, {3.493953692529519*^9, 3.4939537097342587`*^9}, {
   3.493954553647746*^9, 3.4939545546992583`*^9}, {3.493967786336547*^9, 
   3.493967786526808*^9}, {3.4939678411215*^9, 3.49396795782116*^9}, {
   3.493968000940152*^9, 3.493968102168645*^9}, {3.4939682225333195`*^9, 
   3.4939682342493486`*^9}, {3.4939686224919133`*^9, 3.493968639465474*^9}, {
   3.4939689076577435`*^9, 3.49396894028303*^9}, {3.493968990182294*^9, 
   3.4939690106907606`*^9}, {3.493969356260436*^9, 3.4939694216011333`*^9}, {
   3.4939694555782957`*^9, 3.4939694673546424`*^9}, {3.4939699818468704`*^9, 
   3.4939700097862096`*^9}, {3.4939702247588944`*^9, 3.493970272395968*^9}, {
   3.493970308306531*^9, 3.493970313323595*^9}, 3.493970731872918*^9, {
   3.4939715280239105`*^9, 3.493971528915166*^9}, 3.4939772206154385`*^9, {
   3.4939772530220375`*^9, 3.4939772564870195`*^9}, {3.493977358373525*^9, 
   3.493977359194706*^9}, {3.4939774229263477`*^9, 3.4939774235372257`*^9}, {
   3.4939774605304193`*^9, 3.493977466719319*^9}, {3.49397755056989*^9, 
   3.493977556888976*^9}, {3.4939777319206595`*^9, 3.4939777667106853`*^9}, {
   3.493977825204796*^9, 3.4939778800336356`*^9}, {3.4939779132514005`*^9, 
   3.493977923736477*^9}, {3.49401925192272*^9, 3.494019252553627*^9}, 
   3.4940377245250177`*^9, {3.494037829185512*^9, 3.494037838108342*^9}, {
   3.494060400020779*^9, 3.4940604047776194`*^9}, {3.4941421300227504`*^9, 
   3.494142133858266*^9}, {3.494149882960928*^9, 3.494149886345795*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Get", " ", "photon", " ", "U"}], ",", " ", "P", ",", " ", "n", 
    ",", " ", 
    RowBox[{"and", " ", "Q"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getUPNrad", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "Nscal", ",", "Nscam", ",", "Nscalayers", ",", "sigmakn", ",", 
         "sigmaB", ",", "El1", ",", "eeB0", ",", "eeB", ",", "sigmaes", ",", 
         "dtauradscads", ",", "tauradsca", ",", "Hsca", ",", "Nabslayers", 
         ",", "urad0", ",", "Frad0", ",", "dtauradabsds", ",", "tauradabs", 
         ",", "Habs", ",", "tauradtot", ",", "damptaurad", ",", "Urad", ",", 
         "Prad", ",", "damptaurad2", ",", "Frad", ",", "Qrad", ",", "nrad", 
         ",", "nrad0"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "see", " ", "if", " ", "radiation", " ", "is", " ", "trapped", " ", 
         "over", " ", "Lpnum", " ", "to", " ", "see", " ", "what", " ", "is", 
         " ", "heating", " ", "gas"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<taurad\>\"", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Need", " ", "Klein"}], "-", 
         RowBox[{"Nishina", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"http", ":"}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"www", ".", "irs", ".", "inms", ".", "nrc", ".", "ca"}], 
            "/", "EGSnrc"}], "/", "pirs701"}], "/", 
          RowBox[{"node33", ".", "html"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"http", ":"}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"www", ".", "springerlink", ".", "com"}], "/", 
            "content"}], "/", "013232"}], 
          RowBox[{"u344rl7397", "/"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"NOTE", ":", " ", 
          RowBox[{"below", " ", "uses", " ", "Lpnum"}]}], ",", " ", 
         RowBox[{
         "but", " ", "if", " ", "only", " ", "looking", " ", "at", " ", 
          "layer"}], ",", " ", 
         RowBox[{"should", " ", "be", " ", "Deltasp"}], ",", " ", 
         RowBox[{"but", " ", 
          RowBox[{"don", "'"}], "t", " ", "have", " ", "that", " ", 
          RowBox[{"yet", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "below", " ", "ne", " ", "in", " ", "radiation", " ", "opacity", " ",
           "should", " ", "include", " ", "electrons", " ", "and", " ", 
          "positrons", " ", "in", " ", "flow"}], ",", " ", 
         RowBox[{"but", " ", 
          RowBox[{"don", "'"}], "t", " ", "have", " ", "positrons", " ", 
          "yet"}], ",", " ", 
         RowBox[{"so", " ", "have", " ", "to", " ", 
          RowBox[{"iterate", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Nscallimit", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Rjet", "/", "Hsca"}], "+", "2"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Nscal", "=", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"lmode", "-", "1"}], ",", "Nscallimit"}], "]"}], "//.", 
           "consts"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Nscal", "=", 
        RowBox[{
         RowBox[{"lmode", "-", "1"}], "//.", "consts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Nscam", "=", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"mmode", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], "//.",
          "consts"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Nscalayers", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Nscal", ",", "Nscam"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigmakn", "[", "T_", "]"}], ":=", 
        RowBox[{"sigmat", "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "*", "me", "*", 
              RowBox[{
               RowBox[{"c", "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"8", "*", "kb", "*", "T"}], ")"}]}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigmaB", "[", 
         RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{"sigmat", "/", 
         RowBox[{"(", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sqrt", "[", "5", "]"}], "*", "Pi", "*", "me", "*", 
                RowBox[{"c", "^", "2"}], "*", "kb", "*", "T"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"hbar", "*", "c", "*", "q", "*", "bgauss"}], ")"}]}], 
             " ", ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "2"}], ")"}]}]}], " ", ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Don", "'"}], "t", " ", "let", " ", "get", " ", "smaller", 
         " ", "than", " ", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "5"}], ")"}]}], " ", "electron", " ", "masses"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"El1", "[", "bgauss_", "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "5"}], ")"}]}], "*", "me", "*", 
          RowBox[{"c", "^", "2"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"me", "*", 
               RowBox[{"c", "^", "2"}]}], ")"}], "^", "2"}], "+", 
            RowBox[{"2", "*", "hbar", "*", "c", "*", "q", "*", "bgauss"}]}], 
           ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}]}], " ", "-", " ", 
         RowBox[{"me", "*", 
          RowBox[{"c", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eeB0", "[", "bgauss_", "]"}], ":=", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"me", "*", 
             RowBox[{
              RowBox[{"c", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"El1", "[", "bgauss", "]"}], ")"}]}]}], ",", 
            RowBox[{"10", "^", "4"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eeB", "[", "bgauss_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"eeB0", "[", "bgauss", "]"}], "=!=", 
           RowBox[{"Underflow", "[", "]"}]}], ",", 
          RowBox[{"eeB0", "[", "bgauss", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigmaes", "[", 
         RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"sigmaB", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}], "*", 
          RowBox[{"eeB", "[", "bgauss", "]"}]}], "+", 
         RowBox[{
          RowBox[{"sigmakn", "[", "T", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"eeB", "[", "bgauss", "]"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dtauradscads", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"sigmaes", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ne", "[", "rhob", "]"}], "+", "npairs"}], ")"}]}], "//.",
          "consts"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"columndepthsca", "[", 
         RowBox[{"rhob_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"npairs", "*", "Nscalayers", "*", "Lpnum"}], " ", "+", 
         RowBox[{"neint", "[", "Rjet", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tauradsca", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"sigmaes", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}], "*", 
          RowBox[{"columndepthsca", "[", 
           RowBox[{"rhob", ",", "npairs"}], "]"}]}], "//.", "consts"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Hsca", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tauradsca", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "/", 
           RowBox[{"dtauradscads", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           ")"}], "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Nabslayers", "=", "Nscalayers"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"urad0", "[", "T_", "]"}], ":=", 
        RowBox[{"arad", "*", 
         RowBox[{"T", "^", "4"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nrad0", "[", "T_", "]"}], ":=", 
        RowBox[{
         RowBox[{"urad0", "[", "T", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "kb", "*", "T"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Frad0", "[", "T_", "]"}], ":=", 
        RowBox[{"c", "*", 
         RowBox[{"urad0", "[", "T", "]"}]}]}], ";", "\[IndentingNewLine]", 
       "getsigmaphoton", ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "computes", " ", "nbsigmaff", " ", "and", " ", "nbsigmasynch"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dtauradabsds", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"nbsigmaff", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "+", 
         RowBox[{"nbsigmasynch", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"columndepthabs", "[", 
         RowBox[{"rhob_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"npairs", "*", "Nabslayers", "*", "Lpnum"}], "+", 
         RowBox[{"neint", "[", "Rjet", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tauradabs", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dtauradabsds", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "/", 
           RowBox[{"nb", "[", "rhob", "]"}]}], ")"}], "*", 
         RowBox[{"columndepthabs", "[", 
          RowBox[{"rhob", ",", "npairs"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Habs", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tauradabs", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "/", 
           RowBox[{"dtauradabsds", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           ")"}], "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "total", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tauradtot", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"tauradabs", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "+", 
          RowBox[{"tauradsca", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"damptaurad", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "*", 
            RowBox[{"tauradtot", "[", 
             RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
             "]"}]}], "+", 
           RowBox[{"2", "*", 
            RowBox[{"Sqrt", "[", "3", "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "*", 
            RowBox[{"tauradtot", "[", 
             RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
             "]"}]}], "+", 
           RowBox[{"2", "*", 
            RowBox[{"Sqrt", "[", "3", "]"}]}], "+", 
           RowBox[{"2", "/", 
            RowBox[{"tauradabs", "[", 
             RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
             "]"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Urad", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"urad0", "[", "T", "]"}], "*", 
         RowBox[{"damptaurad", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nrad", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"nrad0", "[", "T", "]"}], "*", 
         RowBox[{"damptaurad", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prad", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"Urad", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "/", "3"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"damptaurad2", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"tauradtot", "[", 
             RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
            "/", "2"}], "+", 
           RowBox[{"1", "/", 
            RowBox[{"Sqrt", "[", "3", "]"}]}], "+", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"3", "*", 
              RowBox[{"tauradabs", "[", 
               RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
               "]"}]}], ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Frad", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"Frad0", "[", "T", "]"}], "*", 
         RowBox[{"damptaurad2", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Qrad", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"frad", ",", "habs", ",", "result"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"frad", "=", 
            RowBox[{"Frad", "[", 
             RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"habs", "=", 
            RowBox[{"Habs", "[", 
             RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"result", "=", 
            RowBox[{"frad", "/", "habs"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Qrad: \>\"", ",", "frad", ",", "\"\< \>\"", ",", "habs", 
                ",", "\"\< \>\"", ",", "result"}], "]"}], ";"}]}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
           "result"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "Nscal", ",", "Nscam", ",", "Nscalayers", ",", "sigmakn", ",", 
         "sigmaB", ",", "El1", ",", "eeB0", ",", "eeB", ",", "sigmaes", ",", 
         "dtauradscads", ",", "tauradsca", ",", "Hsca", ",", "Nabslayers", 
         ",", "urad0", ",", "Frad0", ",", "dtauradabsds", ",", "tauradabs", 
         ",", "Habs", ",", "tauradtot", ",", "damptaurad", ",", "Urad", ",", 
         "Prad", ",", "damptaurad2", ",", "Frad", ",", "Qrad", ",", "nrad", 
         ",", "nrad0"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.477066443548955*^9, 3.4770664519710655`*^9}, {
   3.477066537183595*^9, 3.477066537373869*^9}, {3.4770668804071264`*^9, 
   3.477066881138178*^9}, {3.4770669388411503`*^9, 3.4770669589801087`*^9}, {
   3.477068426029622*^9, 3.4770684936468515`*^9}, {3.477068525732989*^9, 
   3.477068650862917*^9}, {3.4770687575963917`*^9, 3.477068773589389*^9}, {
   3.477068815369466*^9, 3.4770688625873613`*^9}, {3.4770689058395553`*^9, 
   3.4770689245764976`*^9}, {3.4770715610776*^9, 3.4770715883768544`*^9}, {
   3.477071629526024*^9, 3.4770716551228304`*^9}, {3.477071756688875*^9, 
   3.4770718355322466`*^9}, {3.477072742496397*^9, 3.4770727660502653`*^9}, {
   3.4770739306749134`*^9, 3.4770739425319633`*^9}, {3.477075109249621*^9, 
   3.477075118573027*^9}, {3.477091191654984*^9, 3.477091200517728*^9}, {
   3.477091645968254*^9, 3.4770916741087184`*^9}, {3.4770917619650497`*^9, 
   3.477091772009493*^9}, 3.477091833557995*^9, {3.4771619186291933`*^9, 
   3.477161918809453*^9}, {3.4771637186274643`*^9, 3.477163725206925*^9}, {
   3.477163778763936*^9, 3.4771638047513037`*^9}, {3.477167340775858*^9, 
   3.4771673600535774`*^9}, 3.477172902833704*^9, {3.47717413015851*^9, 
   3.477174142956914*^9}, {3.4771742250749936`*^9, 3.4771742557791443`*^9}, {
   3.4771767523690643`*^9, 3.47717676162237*^9}, {3.477177002008027*^9, 
   3.4771770524906178`*^9}, {3.4771771195570545`*^9, 
   3.4771771205584946`*^9}, {3.477177161327117*^9, 3.477177170400163*^9}, {
   3.4771772377470036`*^9, 3.4771772452377744`*^9}, {3.4771773462229843`*^9, 
   3.47717734721441*^9}, {3.477177889734515*^9, 3.4771778977560496`*^9}, {
   3.477178014433824*^9, 3.4771780222550707`*^9}, {3.4912570342913218`*^9, 
   3.49125704191228*^9}, {3.491257182574542*^9, 3.491257183646083*^9}, {
   3.4912572333475504`*^9, 3.4912572817671747`*^9}, {3.49125731580612*^9, 
   3.491257316457056*^9}, {3.49125737680383*^9, 3.491257388230261*^9}, {
   3.4912575951277647`*^9, 3.491257642876424*^9}, {3.491257711775496*^9, 
   3.491257712005827*^9}, {3.4912578230955667`*^9, 3.49125783780672*^9}, {
   3.491259111738544*^9, 3.491259159807664*^9}, 3.491339582902008*^9, {
   3.4913396448110285`*^9, 3.491339644891144*^9}, {3.4917436107555294`*^9, 
   3.4917436244351997`*^9}, {3.4917472426779776`*^9, 3.491747248446272*^9}, {
   3.491749164231035*^9, 3.49174916606367*^9}, {3.4917746732912626`*^9, 
   3.491774693420206*^9}, {3.4917747315550413`*^9, 3.4917749773885326`*^9}, {
   3.4917750828101215`*^9, 3.491775100876099*^9}, {3.4917751357262115`*^9, 
   3.4917752114651184`*^9}, {3.491775349103032*^9, 3.491775361921464*^9}, {
   3.4917754095299215`*^9, 3.4917754330737762`*^9}, {3.4918262987750626`*^9, 
   3.4918263019796705`*^9}, {3.491826356407934*^9, 3.491826447979608*^9}, {
   3.491826480656595*^9, 3.491826696687232*^9}, {3.4918273642170925`*^9, 
   3.4918273905249214`*^9}, {3.4918274214894466`*^9, 3.491827430742752*^9}, {
   3.491836083594942*^9, 3.4918361443122497`*^9}, {3.4918409951073503`*^9, 
   3.4918410020773726`*^9}, {3.492448239887843*^9, 3.4924483037096148`*^9}, {
   3.4924483895029793`*^9, 3.492448483538195*^9}, {3.4924486504181566`*^9, 
   3.492448656486883*^9}, 3.492450445128824*^9, {3.493597561959685*^9, 
   3.4935976152763505`*^9}, {3.4935976500062895`*^9, 
   3.4935977737942877`*^9}, {3.4935981015756145`*^9, 
   3.4935981361753664`*^9}, {3.4936042757536464`*^9, 3.493604287690811*^9}, {
   3.4940337122256145`*^9, 3.494033757630904*^9}, {3.494033798259325*^9, 
   3.4940338226343746`*^9}, {3.4941295837020273`*^9, 3.49412964465968*^9}, {
   3.4941297717023582`*^9, 3.494129775447744*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.493593699465691*^9, 3.4935937027504144`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getUPNpairs", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unprotect", "[", 
       RowBox[{
       "e10", ",", "e1", ",", "El1", ",", "e20", ",", "e2", ",", "uapairs0", 
        ",", "ubpairs0", ",", "ucpairs0", ",", "udpairs0", ",", "Upairs0qed", 
        ",", "Ppairs0qed", ",", "npairs0qed", ",", "npairs0", ",", "Upairs0", 
        ",", "Ppairs0", ",", "npairsfunc", ",", "Upairs", ",", "Ppairs"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "wrong", " ", "way", " ", "to", " ", "get", " ", "pair", " ", 
        "density"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"omegag", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q", "*", "bgaussrad"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"gammae", "*", "me", "*", "c"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tg", "=", 
         RowBox[{"2", "*", 
          RowBox[{"Pi", "/", "omegag"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"taupairpne", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"taupairL", ",", 
           RowBox[{"taurad", "*", 
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Tann", "/", "Tg"}]}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"damptaupair", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "*", "taupairpne"}], "+", 
            RowBox[{"2", "*", 
             RowBox[{"Sqrt", "[", "3", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "*", "taupairpne"}], "+", 
            RowBox[{"2", "*", 
             RowBox[{"Sqrt", "[", "3", "]"}]}], "+", 
            RowBox[{"2", "/", "taupairpne"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ppairs", "=", 
         RowBox[{"arad", "*", 
          RowBox[{"T", "^", "4"}], "*", 
          RowBox[{"(", 
           RowBox[{"7", "/", "12"}], ")"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "me"}], "*", 
            RowBox[{
             RowBox[{"c", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"kb", "*", "T"}], ")"}]}]}], "]"}], "*", 
          "damptaupair"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Upairs", "=", 
         RowBox[{"Ppairs", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "/", "3"}], "-", "1"}], ")"}]}]}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "npairs0qed", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "pair", " ", "density", " ", "in", " ", "new", " ", "paper", " ", 
        "revision", " ", "assuming", " ", "chemical", " ", "equilibrium", " ",
         "with", " ", "photons"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{"e10", ",", "e1", ",", "e20", ",", "e2"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e10", "[", "T_", "]"}], ":=", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"me", "*", 
            RowBox[{
             RowBox[{"c", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"kb", "*", "T"}], ")"}]}]}], ",", 
           RowBox[{"10", "^", "4"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e1", "[", "T_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"e10", "[", "T", "]"}], "]"}], "=!=", 
          RowBox[{"Underflow", "[", "]"}]}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"e10", "[", "T", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e20", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"kb", "*", 
            RowBox[{"T", "/", 
             RowBox[{"(", 
              RowBox[{"El1", "[", "bgauss", "]"}], ")"}]}]}], ",", 
           RowBox[{"10", "^", "4"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e2", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"e20", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}], "=!=", 
          RowBox[{"Underflow", "[", "]"}]}], ",", 
         RowBox[{"e20", "[", 
          RowBox[{"T", ",", "bgauss"}], "]"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{
       "uapairs0", ",", "ubpairs0", ",", "ucpairs0", ",", "udpairs0"}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"uapairs0", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"7", "/", "4"}], ")"}], "*", 
        RowBox[{"urad0", "[", "T", "]"}], "*", 
        RowBox[{"e1", "[", "T", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"e2", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ubpairs0", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}]}], "/", 
         RowBox[{"Pi", "^", 
          RowBox[{"(", 
           RowBox[{"3", "/", "2"}], ")"}]}]}], "*", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"me", "*", 
            RowBox[{"c", "^", "2"}]}], ")"}], "^", "4"}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hbar", "*", "c"}], ")"}], "^", "3"}]}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", 
           RowBox[{"T", "/", 
            RowBox[{"(", 
             RowBox[{"me", "*", 
              RowBox[{"c", "^", "2"}]}], ")"}]}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"3", "/", "2"}], ")"}]}], "*", 
        RowBox[{"e1", "[", "T", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"e2", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ucpairs0", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "12"}], ")"}], "*", "hbar", "*", "c", "*", "q", 
        "*", 
        RowBox[{"bgauss", "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hbar", "*", "c"}], ")"}], "^", "3"}]}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}], "^", "2"}], "*", 
        RowBox[{"e1", "[", "T", "]"}], "*", 
        RowBox[{"e2", "[", 
         RowBox[{"T", ",", "bgauss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"udpairs0", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hbar", "*", "c", "*", "q", "*", "bgauss"}], ")"}], "*", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"me", "*", 
            RowBox[{"c", "^", "2"}]}], ")"}], "^", "2"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "*", 
              RowBox[{"Pi", "^", "3"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"hbar", "*", "c"}], ")"}], "^", "3"}]}], ")"}]}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", 
           RowBox[{"T", "/", 
            RowBox[{"(", 
             RowBox[{"me", "*", 
              RowBox[{"c", "^", "2"}]}], ")"}]}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], "*", 
        RowBox[{"e1", "[", "T", "]"}], "*", 
        RowBox[{"e2", "[", 
         RowBox[{"T", ",", "bgauss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Upairs0qed", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"uapairs0", "[", 
         RowBox[{"T", ",", "bgauss"}], "]"}], "+", 
        RowBox[{"ubpairs0", "[", 
         RowBox[{"T", ",", "bgauss"}], "]"}], "+", 
        RowBox[{"ucpairs0", "[", 
         RowBox[{"T", ",", "bgauss"}], "]"}], "+", 
        RowBox[{"udpairs0", "[", 
         RowBox[{"T", ",", "bgauss"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ppairs0qed", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"uapairs0", "[", 
          RowBox[{"T", ",", "bgauss"}], "]"}], "/", "3"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{"ubpairs0", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}], "/", "3"}]}], "+", 
        RowBox[{
         RowBox[{"ucpairs0", "[", 
          RowBox[{"T", ",", "bgauss"}], "]"}], "/", "3"}], "+", 
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{"udpairs0", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}], "/", "3"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "density", " ", "of", " ", "pairs", " ", "is", " ", 
        "indirectly", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"due", " ", "to", " ", "pg"}], "=", "pm"}], ")"}], " ", 
        "related", " ", "to", " ", "magnetic", " ", "field", " ", 
        RowBox[{"strength", ".", " ", "So"}], " ", "below", " ", "a", " ", 
        "certain", " ", "magnetic", " ", "field", " ", "strength", " ", 
        "there", " ", "should", " ", "be", " ", "few", " ", "pairs"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"TRUE", "-", 
        RowBox[{
         RowBox[{"ITERATED", " ", "--"}], " ", "solved", " ", "with", " ", 
         "T", " ", "now", " ", "since", " ", "otherwise", " ", "simple", " ", 
         "overall", " ", "iteration", " ", "and", " ", "only", " ", "solving",
          " ", "for", " ", "T", " ", "led", " ", "to", " ", "flip"}], "-", 
        RowBox[{"flop", " ", "behavior", " ", "and", " ", "never", " ", 
         RowBox[{"converged", ".", "\[IndentingNewLine]", "So"}], " ", 
         "below", " ", "is", " ", "used", " ", "as", " ", "equation", " ", 
         "instead", " ", "when", " ", "calling", " ", "gettemperature"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"npairs0qed", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Upairs0qed", "[", 
         RowBox[{"T", ",", "bgauss"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"if", " ", "in", " ", "non"}], "-", 
         RowBox[{"QED", " ", "regime"}]}], ",", " ", 
        RowBox[{"use", " ", "more", " ", "accurate", " ", "solution"}]}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"But", " ", "this", " ", 
        RowBox[{"forces", " ", "?", "pairs"}], " ", "to", " ", "not", " ", 
        "be", " ", "function", " ", "of", " ", 
        RowBox[{"T", " ", "--"}], " ", "problem", " ", "if", " ", "photon", 
        " ", "radiation", " ", "term", " ", 
        RowBox[{"wasn", "'"}], "t", " ", "there", " ", "probably"}], " ", 
       "*)"}], "\[IndentingNewLine]", "getUPNpairsnoqed", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{"npairs0", ",", "Upairs0", ",", "Ppairs0"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "SUPERDEBUG", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"methodpairs0", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1", " ", "=", " ", 
        RowBox[{"only", " ", "simple"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2", " ", "=", " ", 
        RowBox[{
         RowBox[{"combine", " ", "--"}], " ", "most", " ", "accurate"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"methodpairs0", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"npairs0", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_"}], "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"e2", "[", 
              RowBox[{"T", ",", "bgauss"}], "]"}], "<", "0.1"}], ",", 
            RowBox[{"npairs0noqed", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}], ",", 
            RowBox[{"npairs0qed", "[", 
             RowBox[{"T", ",", "bgauss"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Upairs0", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_"}], "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"e2", "[", 
              RowBox[{"T", ",", "bgauss"}], "]"}], "<", "0.1"}], ",", 
            RowBox[{"Upairs0noqed", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}], ",", 
            RowBox[{"Upairs0qed", "[", 
             RowBox[{"T", ",", "bgauss"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ppairs0", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_"}], "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"e2", "[", 
              RowBox[{"T", ",", "bgauss"}], "]"}], "<", "0.1"}], ",", 
            RowBox[{"Ppairs0noqed", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}], ",", 
            RowBox[{"Ppairs0qed", "[", 
             RowBox[{"T", ",", "bgauss"}], "]"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"methodpairs0", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"npairs0", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_"}], "]"}], ":=", 
          RowBox[{"npairs0qed", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Upairs0", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_"}], "]"}], ":=", 
          RowBox[{"Upairs0qed", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ppairs0", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_"}], "]"}], ":=", 
          RowBox[{"Ppairs0qed", "[", 
           RowBox[{"T", ",", "bgauss"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{"npairsfunc", ",", "Upairs", ",", "Ppairs"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"npairsfunc", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"npairs0", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss"}], "]"}], "*", 
        RowBox[{"damptaurad", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}], 
      ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "npairs", " ", "should", " ", "be", " ", "left", " ", "as", " ", 
        "free", " ", "variable"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Upairs", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Upairs0", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss"}], "]"}], "*", 
        RowBox[{"damptaurad", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ppairs", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Ppairs0", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss"}], "]"}], "*", 
        RowBox[{"damptaurad", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", 
       RowBox[{
       "e10", ",", "e1", ",", "El1", ",", "e20", ",", "e2", ",", "uapairs0", 
        ",", "ubpairs0", ",", "ucpairs0", ",", "udpairs0", ",", "Upairs0qed", 
        ",", "Ppairs0qed", ",", "npairs0qed", ",", "npairs0", ",", "Upairs0", 
        ",", "Ppairs0", ",", "npairsfunc", ",", "Upairs", ",", "Ppairs"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.477066484658067*^9, 3.477066522151981*^9}, {
   3.477066902518922*^9, 3.4770669178709965`*^9}, {3.4770901698857517`*^9, 
   3.4770901723092365`*^9}, {3.477097501758467*^9, 3.477097506084688*^9}, {
   3.4771637329380417`*^9, 3.477163733088258*^9}, {3.477163815246395*^9, 
   3.477163815446683*^9}, {3.477177058909848*^9, 3.477177067271872*^9}, {
   3.477177394722723*^9, 3.4771774035854673`*^9}, {3.477179489084267*^9, 
   3.477179532226302*^9}, {3.4912587330540223`*^9, 3.491258735978227*^9}, {
   3.491608545180771*^9, 3.491608545481203*^9}, {3.491613209207312*^9, 
   3.491613252369376*^9}, {3.4916165500712385`*^9, 3.4916167034117312`*^9}, {
   3.4916178783912687`*^9, 3.4916178986203566`*^9}, {3.491618263645237*^9, 
   3.491618292016032*^9}, {3.491618377038288*^9, 3.491618404848277*^9}, {
   3.4916193411846623`*^9, 3.491619343928608*^9}, {3.4916242643438177`*^9, 
   3.4916242692709026`*^9}, {3.4917473108960705`*^9, 
   3.4917473522154846`*^9}, {3.4917491662940016`*^9, 
   3.4917491682768526`*^9}, {3.4917559899459314`*^9, 
   3.4917560306744957`*^9}, {3.491757179185974*^9, 3.4917572105410604`*^9}, {
   3.4917573916414704`*^9, 3.4917574306976304`*^9}, 3.49175751390728*^9, {
   3.491758235845376*^9, 3.4917582851262383`*^9}, {3.491758380513398*^9, 
   3.491758455771614*^9}, {3.491758534294525*^9, 3.491758811392973*^9}, {
   3.4917724688714623`*^9, 3.4917727417438335`*^9}, {3.4917728664130993`*^9, 
   3.4917728857509055`*^9}, {3.491772953157832*^9, 3.491773082093232*^9}, {
   3.4917736057762513`*^9, 3.491773619826454*^9}, {3.491773694644037*^9, 
   3.4917737135812674`*^9}, {3.491774604251989*^9, 3.4917746446400642`*^9}, {
   3.4918274418987937`*^9, 3.491827808636136*^9}, {3.491839140540614*^9, 
   3.4918392118231134`*^9}, {3.4918413749936*^9, 3.4918413816231327`*^9}, {
   3.491845007947531*^9, 3.491845057458725*^9}, {3.491845594530997*^9, 
   3.4918455976254463`*^9}, 3.492205365040965*^9, {3.492374174006336*^9, 
   3.492374195437152*^9}, 3.493174744281602*^9, {3.4931748193295155`*^9, 
   3.4931748227243967`*^9}, {3.4931755719717617`*^9, 3.493175586132123*^9}, {
   3.4931765923489923`*^9, 3.4931766054277983`*^9}, {3.4935976404926095`*^9, 
   3.4935976441879234`*^9}, {3.4939424461588078`*^9, 3.493942472476651*^9}, {
   3.4939426013119073`*^9, 3.4939426641923246`*^9}, {3.493952841615966*^9, 
   3.493952846052345*^9}, {3.4939529117768517`*^9, 3.493952977741705*^9}, {
   3.4939530184802837`*^9, 3.493953021434532*^9}, {3.4939533596608777`*^9, 
   3.4939533605321302`*^9}, {3.4939534222909355`*^9, 
   3.4939535950693784`*^9}, {3.4939536831960983`*^9, 
   3.4939536839772215`*^9}, {3.493953722742964*^9, 3.4939537256070824`*^9}, {
   3.4941499015276256`*^9, 3.4941499026292095`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"full", " ", "pairs", " ", "without", " ", "QED"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getUPNpairsnoqed", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Unprotect", "[", 
         RowBox[{
         "myprecnoqed", ",", "mecsq", ",", "getUPNpairsnoqedprefactor", ",", 
          "Yeprec", ",", "nbprec", ",", "Ee", ",", "Yefun", ",", "myetae", 
          ",", "npairs0noqed", ",", "negen", ",", "Ppairs0noqed", ",", 
          "Upairs0noqed", ",", "fplus", ",", "fminus"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Problem", " ", "is", " ", "NIntegrate", " ", "is", " ", 
           RowBox[{"inaccurate", ".", "  ", "If"}], " ", "try", " ", 
           "changing", " ", "Workprecision", " ", "or", " ", "Accuracygoal"}],
           ",", " ", 
          RowBox[{"then", " ", "gets", " ", "crazy", " ", 
           RowBox[{"answers", " ", "--"}], " ", "maybe", " ", "precision", 
           " ", "needs", " ", "to", " ", "be", " ", "forced", " ", "for", " ",
            "entire", " ", 
           RowBox[{"expression", "?"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{
         "neplus", ",", "neminus", ",", "peplus", ",", "peminus", ",", 
          "ueplus", ",", "ueminus"}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"storing", " ", "these"}], ",", " ", 
          RowBox[{"so", " ", 
           RowBox[{"don", "'"}], "t", " ", "protect"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{
         "Ee", ",", "fplus", ",", "fminus", ",", "negen", ",", "x", ",", 
          "etae"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myprecnoqed", "=", "lowestprec"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mecsq", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"me", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}], ",", "myprecnoqed"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"getUPNpairsnoqedprefactor", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Pi", "^", "2"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"hbar", "*", "c"}], ")"}], "^", "3"}]}], ")"}]}], ",",
            "myprecnoqed"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Yeprec", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"Ye", ",", "myprecnoqed"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nbprec", "[", "rhob_", "]"}], ":=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"nb", "[", "rhob", "]"}], ",", "myprecnoqed"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{
         "Ee", ",", "fplus", ",", "fminus", ",", "Yefun", ",", "myetae"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ee", "[", "x_", "]"}], ":=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"mecsq", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "enforce", " ", "precision", " ", "regardless", " ", "of", " ", 
          "how", " ", "small", " ", "Exp", " ", "results", " ", "in", " ", 
          "so", " ", "other", " ", "operations", " ", "using", " ", "the", 
          " ", "result", " ", "are", " ", "correct"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fplus", "[", 
          RowBox[{"x_", ",", "etae_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Ee", "[", "x", "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"kb", "*", "T"}], ")"}]}], "+", "etae"}], "]"}], 
              "+", "1"}], ")"}]}], ",", "lowestprec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fminus", "[", 
          RowBox[{"x_", ",", "etae_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Ee", "[", "x", "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"kb", "*", "T"}], ")"}]}], "-", "etae"}], "]"}], 
              "+", "1"}], ")"}]}], ",", "lowestprec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"neplus", "[", 
          RowBox[{
           RowBox[{"etae_", "?", "NumericQ"}], ",", 
           RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"neplus", "[", 
           RowBox[{"etae", ",", "T"}], "]"}], "=", 
          RowBox[{"getUPNpairsnoqedprefactor", "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "^", "2"}], "*", 
              RowBox[{"fplus", "[", 
               RowBox[{"x", ",", "etae", ",", "T"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"pairsnumintprec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{" ", 
           RowBox[{",", 
            RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
            RowBox[{"PrecisionGoal", "\[Rule]", "15"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"neminus", "[", 
          RowBox[{
           RowBox[{"etae_", "?", "NumericQ"}], ",", 
           RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"neminus", "[", 
           RowBox[{"etae", ",", "T"}], "]"}], "=", 
          RowBox[{"getUPNpairsnoqedprefactor", "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "^", "2"}], "*", 
              RowBox[{"fminus", "[", 
               RowBox[{"x", ",", "etae", ",", "T"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"pairsnumintprec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{" ", 
           RowBox[{",", 
            RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
            RowBox[{"PrecisionGoal", "\[Rule]", "15"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Yefun", "[", 
          RowBox[{"etae_", ",", "rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"neminus", "[", 
             RowBox[{"etae", ",", "T"}], "]"}], "-", 
            RowBox[{"neplus", "[", 
             RowBox[{"etae", ",", "T"}], "]"}]}], ")"}], "/", 
          RowBox[{"nbprec", "[", "rhob", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Yefun", " ", "is", " ", "a", " ", "function", " ", "we", " ", 
           "are", " ", "passing"}], ",", " ", 
          RowBox[{"not", " ", "a", " ", "value"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"myetae", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"getetae", "[", 
            RowBox[{
            "Yefun", ",", "Yeprec", ",", "rhob", ",", "T", ",", "slowprec"}], 
            "]"}], ",", "lowestprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"myetaetrue", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"getetaeslow", "[", 
            RowBox[{
            "Yefun", ",", "Yeprec", ",", "rhob", ",", "T", ",", "slowprec"}], 
            "]"}], ",", "lowestprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"myetae", "[", 
            RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", "0"}], ";"}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"SUPERDEBUG", ":", " ", 
           RowBox[{
            RowBox[{"hack", " ", "assuming", " ", "always", " ", "non"}], "-", 
            RowBox[{
            "degen", " ", "since", " ", "too", " ", "slow", " ", 
             "otherwise"}]}]}], " ", "*)"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "npairs0noqed", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "npairs", " ", "is", " ", "total", " ", "number", " ", "of", " ", 
           "electrons"}], "+", 
          RowBox[{"positrons", " ", "without", " ", "non"}], "-", 
          RowBox[{"pair", " ", "part"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"subtract", " ", "off", " ", "non"}], "-", 
          RowBox[{"pair", " ", "producing", " ", "part"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"and", " ", "truncate", " ", "so", " ", "pairs", " ", 
          RowBox[{"don", "'"}], "t", " ", "go", " ", "below", " ", "0", " ", 
          "when", " ", "few", " ", "pairs", " ", "and", " ", "subtraction", 
          " ", "term", " ", "not", " ", "accurate"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"npairs0noqed", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"ne", "[", "rhob", "]"}]}], "+", 
            RowBox[{"neplus", "[", 
             RowBox[{
              RowBox[{"myetae", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "T"}], "]"}], "+", 
            RowBox[{"neminus", "[", 
             RowBox[{
              RowBox[{"myetae", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "T"}], "]"}]}], ",", 
           "0"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"npairs0noqedtrue", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"ne", "[", "rhob", "]"}]}], "+", 
            RowBox[{"neplus", "[", 
             RowBox[{
              RowBox[{"myetaetrue", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "T"}], "]"}], "+", 
            RowBox[{"neminus", "[", 
             RowBox[{
              RowBox[{"myetaetrue", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "T"}], "]"}]}], ",", 
           "0"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"n_e", " ", "in", " ", "thermal", " ", "equilibrium"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"negen", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Yefun", "[", 
           RowBox[{
            RowBox[{"myetae", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}], ",", "T"}], "]"}], "*", 
          RowBox[{"nbprec", "[", "rhob", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"now", " ", "get", " ", "p", " ", "and", " ", "u"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "Ppairs0noqed", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"peplus", "[", 
          RowBox[{
           RowBox[{"etae_", "?", "NumericQ"}], ",", 
           RowBox[{"rhob_", "?", "NumericQ"}], ",", 
           RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"peplus", "[", 
           RowBox[{"etae", ",", "rhob", ",", "T"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"getUPNpairsnoqedprefactor", "/", "3"}], ")"}], "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "^", "4"}], "/", 
               RowBox[{"Ee", "[", "x", "]"}]}], "*", 
              RowBox[{"fplus", "[", 
               RowBox[{"x", ",", "etae", ",", "T"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"pairsintprec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"peminus", "[", 
          RowBox[{
           RowBox[{"etae_", "?", "NumericQ"}], ",", 
           RowBox[{"rhob_", "?", "NumericQ"}], ",", 
           RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"peminus", "[", 
           RowBox[{"etae", ",", "rhob", ",", "T"}], "]"}], "=", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"getUPNpairsnoqedprefactor", "/", "3"}], ")"}], "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "^", "4"}], "/", 
               RowBox[{"Ee", "[", "x", "]"}]}], "*", 
              RowBox[{"fminus", "[", 
               RowBox[{"x", ",", "etae", ",", "T"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"pairsintprec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{",", 
          RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"subtract", " ", "off", " ", "non"}], "-", 
          RowBox[{"pair", " ", "producing", " ", "part"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"and", " ", "truncate", " ", "so", " ", "pairs", " ", 
          RowBox[{"don", "'"}], "t", " ", "go", " ", "below", " ", "0", " ", 
          "when", " ", "few", " ", "pairs", " ", "and", " ", "subtraction", 
          " ", "term", " ", "not", " ", "accurate"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ppairs0noqed", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"peplus", "[", 
             RowBox[{
              RowBox[{"myetae", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "rhob", ",", "T"}], 
             "]"}], "+", 
            RowBox[{"peminus", "[", 
             RowBox[{
              RowBox[{"myetae", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "rhob", ",", "T"}], 
             "]"}], "-", 
            RowBox[{"Pe", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}]}], ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ppairs0noqedtrue", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"peplus", "[", 
             RowBox[{
              RowBox[{"myetaetrue", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "rhob", ",", "T"}], 
             "]"}], "+", 
            RowBox[{"peminus", "[", 
             RowBox[{
              RowBox[{"myetaetrue", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "rhob", ",", "T"}], 
             "]"}], "-", 
            RowBox[{"Pe", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}]}], ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "Upairs0noqed", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ueplus", "[", 
          RowBox[{
           RowBox[{"etae_", "?", "NumericQ"}], ",", 
           RowBox[{"rhob_", "?", "NumericQ"}], ",", 
           RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"ueplus", "[", 
           RowBox[{"etae", ",", "rhob", ",", "T"}], "]"}], "=", 
          RowBox[{"getUPNpairsnoqedprefactor", "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "^", "2"}], "*", 
              RowBox[{"Ee", "[", "x", "]"}], "*", 
              RowBox[{"fplus", "[", 
               RowBox[{"x", ",", "etae", ",", "T"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"pairsintprec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ueminus", "[", 
          RowBox[{
           RowBox[{"etae_", "?", "NumericQ"}], ",", 
           RowBox[{"rhob_", "?", "NumericQ"}], ",", 
           RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"ueminus", "[", 
           RowBox[{"etae", ",", "rhob", ",", "T"}], "]"}], "=", 
          RowBox[{"getUPNpairsnoqedprefactor", "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "^", "2"}], "*", 
              RowBox[{"Ee", "[", "x", "]"}], "*", 
              RowBox[{"fminus", "[", 
               RowBox[{"x", ",", "etae", ",", "T"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"pairsintprec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{",", 
          RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"subtract", " ", "off", " ", "non"}], "-", 
          RowBox[{"pair", " ", "producing", " ", "part"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"and", " ", "truncate", " ", "so", " ", "pairs", " ", 
          RowBox[{"don", "'"}], "t", " ", "go", " ", "below", " ", "0", " ", 
          "when", " ", "few", " ", "pairs", " ", "and", " ", "subtraction", 
          " ", "term", " ", "not", " ", "accurate"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Upairs0noqed", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ueplus", "[", 
             RowBox[{
              RowBox[{"myetae", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "rhob", ",", "T"}], 
             "]"}], "+", 
            RowBox[{"ueminus", "[", 
             RowBox[{
              RowBox[{"myetae", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "rhob", ",", "T"}], 
             "]"}], "-", 
            RowBox[{"Ue", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}]}], ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Upairs0noqedtrue", "[", 
          RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ueplus", "[", 
             RowBox[{
              RowBox[{"myetaetrue", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "rhob", ",", "T"}], 
             "]"}], "+", 
            RowBox[{"ueminus", "[", 
             RowBox[{
              RowBox[{"myetaetrue", "[", 
               RowBox[{"rhob", ",", "T"}], "]"}], ",", "rhob", ",", "T"}], 
             "]"}], "-", 
            RowBox[{"Ue", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}]}], ",", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Protect", "[", 
         RowBox[{
         "myprecnoqed", ",", "mecsq", ",", "getUPNpairsnoqedprefactor", ",", 
          "Yeprec", ",", "nbprec", ",", "Ee", ",", "Yefun", ",", "myetae", 
          ",", "npairs0noqed", ",", "negen", ",", "Ppairs0noqed", ",", 
          "Upairs0noqed", ",", "fplus", ",", "fminus"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "that", " ", "no", " ", "problems"}], " ", 
         "*)"}], "\[IndentingNewLine]", "1"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "KM02", " ", "with", " ", "Jon", " ", "correction", " ", "and", " ", 
      "noted", " ", "good", " ", "approx", " ", "even", " ", "for", " ", 
      "non"}], "-", "degen"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"npp", ",", "QQ", ",", "mue", ",", "kbT", ",", "hbarc"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solsmue", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"npp", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"QQ", "-", "mue"}], ")"}], "/", 
           RowBox[{"(", "kbT", ")"}]}], "]"}]}], "\[Equal]", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"Pi", "^", "2"}]}], ")"}]}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"mue", "/", 
            RowBox[{"(", "hbarc", ")"}]}], ")"}], "^", "3"}]}]}], ",", 
       "mue"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mymue", "=", 
     RowBox[{"solsmue", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tempmuefunc", "[", 
      RowBox[{"kbT_", ",", "QQ_", ",", "hbarc_", ",", "npp_"}], "]"}], "=", 
     RowBox[{"Evaluate", "[", "mymue", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"muefunc", "[", 
      RowBox[{"kbT_", ",", "QQ_", ",", "hbarc_", ",", "npp_"}], "]"}], "=", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"tempmuefunc", "[", 
       RowBox[{"kbT", ",", "QQ", ",", "hbarc", ",", "npp"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "getetae", "]"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"to", " ", "clear", " ", "old", " ", "stored", " ", "results"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "gives", " ", "only", " ", "VERY", " ", "approximate", " ", "order", 
       " ", "of", " ", "magnitude", " ", 
       RowBox[{"result", ".", "  ", "Can"}], " ", "be", " ", "off", " ", 
       "near", " ", "boundary", " ", 
       RowBox[{"of", " ", "\\", "eta"}]}], "=", "1"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getetae", "[", 
      RowBox[{
      "Ye0_", ",", "Yenum0_", ",", "rhob_", ",", "T_", ",", "myprec0_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"getetae", "[", 
       RowBox[{"Ye0", ",", "Yenum0", ",", "rhob", ",", "T", ",", "myprec0"}], 
       "]"}], "=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "foo", ",", "QQ", ",", "mue", ",", "etae", ",", "npp", ",", "kbT"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"QQ", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mn", "-", "mp"}], ")"}], "*", 
           RowBox[{"c", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"QQ", "=", "0"}], ";"}], " ", "*)"}], 
         RowBox[{"(*", " ", 
          RowBox[{"bad", " ", "estimate"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"npp", "=", 
          RowBox[{"rhob", "/", "mp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"kbT", "=", 
          RowBox[{"kb", "*", "T"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mue", "=", 
          RowBox[{"muefunc", "[", 
           RowBox[{"kbT", ",", "QQ", ",", 
            RowBox[{"hbar", "*", "c"}], ",", "npp"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"etae", "=", 
          RowBox[{"mue", "/", 
           RowBox[{"(", "kbT", ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"etae", "<", 
            RowBox[{"QQ", "/", 
             RowBox[{"(", "kbT", ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"etae", "=", "0"}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"etae", ",", "lowestprec"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "see", " ", "if", " ", "nucleons", " ", "are", " ", "degenerate", " ", 
      "assuming", " ", "beta"}], "-", "equilibrium"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "Yebeta", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Yebeta", "[", 
      RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "foo", ",", "QQ", ",", "kbT", ",", "QQtilde", ",", "nponn", ",", 
         "Yebeta"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"QQ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"mn", "-", "mp"}], ")"}], "*", 
          RowBox[{"c", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"kbT", "=", 
         RowBox[{"kb", "*", "T"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"QQtilde", "=", 
         RowBox[{"QQ", "/", "kbT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nponn", "=", 
         RowBox[{"Exp", "[", 
          RowBox[{"QQtilde", "-", 
           RowBox[{"myetae", "[", 
            RowBox[{"rhob", ",", "T"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"limit", " ", "to", " ", 
          RowBox[{"1", "/", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Yebeta", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"1", "/", "nponn"}]}], ")"}]}], ",", 
           RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
        "Yebeta"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "find", " ", "closest", " ", "solution", " ", "in", " ", "list", " ", 
     "to", " ", "x0", " ", "for", " ", 
     RowBox[{"list", "[", 
      RowBox[{"[", 
       RowBox[{"ii", ",", "2"}], "]"}], "]"}], " ", "and", " ", "does", " ", 
     "linear", " ", "interpolation", " ", "to", " ", "get", " ", "result", 
     " ", "of", " ", 
     RowBox[{
      RowBox[{"list", "[", 
       RowBox[{"[", 
        RowBox[{"ii", ",", "1"}], "]"}], "]"}], "\\", "approx"}], " ", "x0"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findelement", "[", 
      RowBox[{"x0_", ",", "list_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ii", ",", "dist", ",", "dist0", ",", "whichii", ",", "avgpoint", ",",
          "numele", ",", "intercept", ",", "slope"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numele", "=", 
         RowBox[{
          RowBox[{"Dimensions", "[", "list", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"numele", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dist", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"whichii", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"avgpoint", "=", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"numele", ">", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"find", " ", "element"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dist0", "=", 
            RowBox[{"10", "^", 
             RowBox[{"(", "100", ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"ii", "=", "1"}], ",", 
             RowBox[{"ii", "\[LessEqual]", "numele"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"dist", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"x0", "-", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"dist", "<", "dist0"}], ",", 
                RowBox[{
                 RowBox[{"dist0", "=", "dist"}], ";", 
                 RowBox[{"whichii", "=", "ii"}], ";"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<ii=\>\"", ",", "ii", ",", "\"\< dist=\>\"", ",", "dist",
                   ",", "\"\< whichii=\>\"", ",", "whichii"}], "]"}], ";"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"ii", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "interpolate", " ", "to", " ", "get", " ", "better", " ", 
             "root"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"whichii", "\[NotEqual]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"whichii", "\[Equal]", "numele"}], "||", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "2"}], "]"}], "]"}], ">", "x0"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"whichii", "-", "1"}], ",", "2"}], "]"}], "]"}], 
                   "<", "x0"}]}], " ", "||", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "2"}], "]"}], "]"}], "<", "x0"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"whichii", "-", "1"}], ",", "2"}], "]"}], "]"}], 
                   ">", "x0"}]}]}], " ", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"slope", "=", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"whichii", "-", "1"}], ",", "2"}], "]"}], "]"}]}],
                     ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"whichii", "-", "1"}], ",", "1"}], "]"}], "]"}]}],
                     ")"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"intercept", "=", 
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"whichii", ",", "2"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"avgpoint", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "-", "intercept"}], ")"}], "/", "slope"}], 
                   "+", 
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"whichii", "\[NotEqual]", "numele"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"whichii", "\[Equal]", "1"}], "||", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "2"}], "]"}], "]"}], ">", "x0"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"whichii", "+", "1"}], ",", "2"}], "]"}], "]"}], 
                   "<", "x0"}]}], " ", "||", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "2"}], "]"}], "]"}], "<", "x0"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"whichii", "+", "1"}], ",", "2"}], "]"}], "]"}], 
                   ">", "x0"}]}]}], " ", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"slope", "=", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"whichii", "+", "1"}], ",", "2"}], "]"}], "]"}]}],
                     ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"whichii", "+", "1"}], ",", "1"}], "]"}], "]"}]}],
                     ")"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"intercept", "=", 
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"whichii", ",", "2"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"avgpoint", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "-", "intercept"}], ")"}], "/", "slope"}], 
                   "+", 
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"whichii", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"avgpoint", "=", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"whichii", ",", "1"}], "]"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"dist0", ",", "whichii", ",", "avgpoint"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeYelist", "[", 
      RowBox[{
      "Yenum_", ",", "rhob_", ",", "T_", ",", "leta0_", ",", "leta1_", ",", 
       "num_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", "leta"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"LogPlot", "[", 
           RowBox[{
            RowBox[{"Ye", "[", 
             RowBox[{
              RowBox[{"10", "^", "leta"}], ",", "rhob", ",", "T"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"leta", ",", "leta0", ",", "leta1"}], "}"}], ",", 
            RowBox[{"PlotPoints", "\[Rule]", 
             RowBox[{"5", "*", 
              RowBox[{"num", "/", "300"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"solslist", "=", 
          RowBox[{"p1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1", ",", "3", ",", "2", ",", "1"}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"didn", "'"}], "t", " ", "find", " ", "solution"}], ",", 
           " ", 
           RowBox[{"so", " ", "try", " ", "larger", " ", "range"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"p1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"p1", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "||", 
            RowBox[{
             RowBox[{"solslist", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", "lYenum"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"p1", "=", 
             RowBox[{"LogPlot", "[", 
              RowBox[{
               RowBox[{"Ye", "[", 
                RowBox[{
                 RowBox[{"10", "^", "leta"}], ",", "rhob", ",", "T"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"leta", ",", 
                 RowBox[{"-", "25"}], ",", "4"}], "}"}], ",", 
               RowBox[{"PlotPoints", "\[Rule]", "5"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"solslist", "=", 
             RowBox[{"p1", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "3", ",", "2", ",", "1"}], "]"}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"leta", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"leta0", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"leta1", "-", "leta0"}], ")"}], "*", 
             RowBox[{"ii", "/", 
              RowBox[{"(", 
               RowBox[{"num", "-", "1"}], ")"}]}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "0", ",", 
             RowBox[{"num", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Yetable", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"leta", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", 
             RowBox[{"Log", "[", 
              RowBox[{"10", ",", 
               RowBox[{"Yefun", "[", 
                RowBox[{
                 RowBox[{"10", "^", 
                  RowBox[{"leta", "[", 
                   RowBox[{"[", "ii", "]"}], "]"}]}], ",", "rhob", ",", "T"}],
                 "]"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
        "Yetable"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "gensols", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gensols", "[", 
      RowBox[{"Yenum_", ",", "rhob_", ",", "T_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"gensols", "[", 
       RowBox[{"Yenum", ",", "rhob", ",", "T"}], "]"}], "=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "foo", ",", "leta", ",", "lYenum", ",", "yelist", ",", 
          "lowestprec0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lYenum", "=", 
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "Yenum"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lowestprec0", "=", "lowestprec"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lowestprec", "=", "10"}], ";", "\[IndentingNewLine]", 
         RowBox[{"yelist", "=", 
          RowBox[{"MakeYelist", "[", 
           RowBox[{"Yenum", ",", "rhob", ",", "T", ",", 
            RowBox[{"-", "4"}], ",", "3", ",", "100"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yelist", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", "lYenum"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Yebad30=\>\"", ",", 
              RowBox[{"yelist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"lowestprec", "=", "30"}], ";", "\[IndentingNewLine]", 
            RowBox[{"yelist", "=", 
             RowBox[{"MakeYelist", "[", 
              RowBox[{"Yenum", ",", "rhob", ",", "T", ",", 
               RowBox[{"-", "25"}], ",", 
               RowBox[{"-", "3.5"}], ",", "100"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yelist", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", "lYenum"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", "gets", " ", "here"}], ",", " ", 
             RowBox[{
             "then", " ", "just", " ", "assume", " ", "user", " ", "will", 
              " ", 
              RowBox[{"set", " ", "\\", "etae"}], " ", "to", " ", "0", " ", 
              "or", " ", "FindRoot", " ", "will", " ", "be", " ", "ok", " ", 
              "with", " ", "that"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"yelist", "=", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "30"}], ",", "lYenum"}], "}"}], "}"}]}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"lowestprec", "=", "lowestprec0"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
         "yelist"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "getetaeslow", "]"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"to", " ", "clear", " ", "old", " ", "stored", " ", "results"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getetaeslow", "[", 
      RowBox[{
      "Ye0_", ",", "Yenum0_", ",", "rhob_", ",", "T_", ",", "myprec0_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"getetaeslow", "[", 
       RowBox[{"Ye0", ",", "Yenum0", ",", "rhob", ",", "T", ",", "myprec0"}], 
       "]"}], "=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"foo", ",", 
          RowBox[{"Ye", "=", "Ye0"}], ",", 
          RowBox[{"Yenum", "=", "Yenum0"}], ",", 
          RowBox[{"myprec", "=", "myprec0"}], ",", "etae", ",", "myetae0", 
          ",", "eqdiff", ",", "solsetae0", ",", "error0", ",", "etae0", ",", 
          "solsetae", ",", "error", ",", "ii", ",", "numetae", ",", 
          "randometae", ",", "etae0list", ",", "p1", ",", "solslist", ",", 
          "letaguess", ",", "etaguess", ",", "lyenum"}], "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<inside getetae=\>\"", ",", "myprec", ",", " ", "\"\< \>\"", 
           ",", "myprec0"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"solsetae", "=", 
          RowBox[{"{", 
           RowBox[{"etae", "\[Rule]", "1"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eqdiff", "[", 
           RowBox[{
            RowBox[{"etaevar_", "?", "NumericQ"}], ",", 
            RowBox[{"rhob2_", "?", "NumericQ"}], ",", 
            RowBox[{"T2_", "?", "NumericQ"}]}], "]"}], ":=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Yenum", "-", 
             RowBox[{"Ye", "[", 
              RowBox[{"etaevar", ",", "rhob2", ",", "T2"}], "]"}]}], ")"}], 
           "/", "Yenum"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"random", " ", "error"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"error", "=", 
          RowBox[{"10", "^", 
           RowBox[{"(", "100", ")"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"find", " ", "good", " ", "guess"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<Before gensols\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"generates", " ", "log10", " ", "of", " ", "Yefun"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"solslist", "=", 
          RowBox[{"gensols", "[", 
           RowBox[{"Yenum", ",", "rhob", ",", "T"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<Before findelement\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lyenum", "=", 
          RowBox[{"Log", "[", 
           RowBox[{"10", ",", "Yenum"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"letaguess", "=", 
          RowBox[{
           RowBox[{"findelement", "[", 
            RowBox[{"lyenum", ",", "solslist"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"etaguess", "=", 
          RowBox[{"10", "^", "letaguess"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"etae0list", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "15"}], ")"}]}], ",", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "10"}], ")"}]}], ",", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "5"}], ")"}]}], ",", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}]}], ",", 
               RowBox[{"10", "^", 
                RowBox[{"(", "0", ")"}]}], ",", 
               RowBox[{"10", "^", 
                RowBox[{"(", "1", ")"}]}], ",", 
               RowBox[{"10", "^", 
                RowBox[{"(", "2", ")"}]}], ",", 
               RowBox[{"10", "^", 
                RowBox[{"(", "3", ")"}]}]}], "}"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"etae0list", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "15"}], ")"}]}], ",", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "5"}], ")"}]}], ",", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "2"}], ")"}]}], ",", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}]}], ",", 
              RowBox[{"10", "^", 
               RowBox[{"(", "1", ")"}]}], ",", 
              RowBox[{"10", "^", 
               RowBox[{"(", "3", ")"}]}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"etae0list", "=", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{"etae0list", ",", "lowestprec"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"numetae", "=", 
            RowBox[{
             RowBox[{"Dimensions", "[", "etae0list", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"etae0list", "=", 
          RowBox[{"{", "etaguess", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<etaguess=\>\"", ",", "etaguess"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"numetae", "=", "1"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"ii", "=", "1"}], ",", 
           RowBox[{"ii", "<=", "numetae"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"etae0", "=", 
             RowBox[{"etae0list", "[", 
              RowBox[{"[", "ii", "]"}], "]"}]}], ";", " ", 
            RowBox[{"(*", " ", "pick", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "compute", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"CAREFUL", ":", " ", 
              RowBox[{
              "Using", " ", "high", " ", "WorkingPrecision", " ", "can", " ", 
               "lead", " ", "to", " ", "FindRoot", " ", "offsetting", " ", 
               RowBox[{"indep", "'"}], "s", " ", "by", " ", "too", " ", 
               "small", " ", "a", " ", "value", " ", "to", " ", "show", " ", 
               "up", " ", "as", " ", "new", " ", "function", " ", "value"}]}],
              " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"solsetae0", "=", 
             RowBox[{"FindRoot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"eqdiff", "[", 
                 RowBox[{"etaevar", ",", "rhob", ",", "T"}], "]"}], 
                "\[Equal]", "0"}], ",", 
               RowBox[{"{", 
                RowBox[{"etaevar", ",", "etae0"}], "}"}], ",", 
               RowBox[{"WorkingPrecision", "\[Rule]", "myprec"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"myetae0", "=", 
             RowBox[{"solsetae0", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"error0", "=", 
             RowBox[{"Abs", "[", 
              RowBox[{"eqdiff", "[", 
               RowBox[{"myetae0", ",", "rhob", ",", "T"}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"myetae0", ">", "0"}], "&&", 
               RowBox[{"error0", "<", "error"}]}], ",", 
              RowBox[{
               RowBox[{"solsetae", "=", "solsetae0"}], ";", 
               RowBox[{"error", "=", "error0"}], ";"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<etae0=\>\"", ",", 
                 RowBox[{"solsetae0", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ";", 
               RowBox[{"Print", "[", "error0", "]"}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "iterate", " ", "to", " ", "next", " ", "or", " ", "stop", " ", 
              "if", " ", "error", " ", "small", " ", "enough", " ", "that", 
              " ", "believe", " ", "the", " ", "result"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"RELTOL", "=", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "6"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"error", "<", "RELTOL"}], ",", 
              RowBox[{
               RowBox[{"ii", "=", 
                RowBox[{"numetae", "+", "1"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"ii", "++"}], ";"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Finalsoletae\>\"", "]"}], ";", 
            RowBox[{"Print", "[", 
             RowBox[{"solsetae", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ";", 
            RowBox[{"Print", "[", "\"\<Finalerror\>\"", "]"}], ";", 
            RowBox[{"Print", "[", "error", "]"}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"return", " ", "value", " ", "itself"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"solsetae", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "lowestprec"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.491613260631256*^9, 3.49161339993156*^9}, {
   3.49161349707124*^9, 3.491613498423184*^9}, 3.491614085867888*^9, {
   3.4916141228710957`*^9, 3.4916141284891744`*^9}, {3.4916150128608384`*^9, 
   3.4916154097815824`*^9}, {3.4916154457132497`*^9, 
   3.4916154753859167`*^9}, {3.4916155263291693`*^9, 3.491615565845992*^9}, {
   3.491615649215872*^9, 3.4916156660500784`*^9}, {3.4916156980661154`*^9, 
   3.491615770760645*^9}, {3.4916158036980066`*^9, 3.4916158039583807`*^9}, {
   3.491618553261685*^9, 3.4916185846668434`*^9}, {3.491618788810387*^9, 
   3.491618819674768*^9}, {3.4916189512739983`*^9, 3.4916191339066114`*^9}, {
   3.4916200525175085`*^9, 3.4916201460319757`*^9}, {3.4916202054574256`*^9, 
   3.4916202100640497`*^9}, {3.491620241489237*^9, 3.49162024527468*^9}, {
   3.491620276469536*^9, 3.49162033915968*^9}, {3.491620378686517*^9, 
   3.4916203835935726`*^9}, {3.491620425734168*^9, 3.4916208500442963`*^9}, {
   3.4916209630668144`*^9, 3.4916209744331584`*^9}, {3.491621068087827*^9, 
   3.491621069910448*^9}, {3.4916211229266815`*^9, 3.4916211400312767`*^9}, {
   3.4916211711159744`*^9, 3.4916211833836145`*^9}, {3.4916212550366464`*^9, 
   3.4916212631282816`*^9}, {3.491621295164347*^9, 3.4916213415210047`*^9}, {
   3.491621439041232*^9, 3.49162149582288*^9}, {3.491621575988152*^9, 
   3.4916216787258816`*^9}, 3.4916217186032224`*^9, 3.4916217916482563`*^9, {
   3.491621855520099*^9, 3.4916219964727793`*^9}, {3.4916224798678675`*^9, 
   3.4916224820309772`*^9}, {3.49162253857228*^9, 3.4916225431588755`*^9}, {
   3.4916225977673984`*^9, 3.491622827207317*^9}, {3.4916229988240895`*^9, 
   3.4916230029099646`*^9}, 3.4916230557459393`*^9, {3.4916231455550785`*^9, 
   3.49162314569528*^9}, {3.4916232246087523`*^9, 3.491623227182453*^9}, {
   3.491623302490741*^9, 3.491623340875936*^9}, {3.491623378550109*^9, 
   3.491623399840723*^9}, {3.4916236754169827`*^9, 3.4916236944243135`*^9}, {
   3.4916238339449344`*^9, 3.4916238481153107`*^9}, {3.4916239203191347`*^9, 
   3.491623923714016*^9}, {3.491623976650134*^9, 3.4916240038792877`*^9}, 
   3.4917491684971695`*^9, {3.4917561132031665`*^9, 3.491756117970021*^9}, {
   3.491756546896787*^9, 3.4917565566808558`*^9}, {3.491756627082088*^9, 
   3.491756633090728*^9}, {3.4917570745855665`*^9, 3.4917570957459936`*^9}, {
   3.491757128633283*^9, 3.4917571428437166`*^9}, {3.491757221627002*^9, 
   3.491757382398179*^9}, {3.491758857308997*^9, 3.491758937223909*^9}, {
   3.491758986324512*^9, 3.4917589946665072`*^9}, {3.4917600183585043`*^9, 
   3.491760053579149*^9}, {3.491760186330035*^9, 3.491760188823621*^9}, {
   3.4917602303232946`*^9, 3.4917602616683664`*^9}, {3.4917602946457853`*^9, 
   3.4917603267219086`*^9}, {3.491762248745643*^9, 3.4917622647186112`*^9}, {
   3.4917623091625185`*^9, 3.4917623093127346`*^9}, {3.4917623559397807`*^9, 
   3.4917623640414305`*^9}, {3.4917625274163523`*^9, 3.491762530921392*^9}, {
   3.4917640301071153`*^9, 3.491764030557763*^9}, {3.4917674864871454`*^9, 
   3.491767490202488*^9}, {3.4917675295490656`*^9, 3.4917675335147676`*^9}, {
   3.491767577928632*^9, 3.4917676189576287`*^9}, {3.491767914392443*^9, 
   3.491767918418232*^9}, {3.4917679780139265`*^9, 3.4917679964704657`*^9}, {
   3.49176829666212*^9, 3.4917683792008047`*^9}, {3.4917684277205725`*^9, 
   3.4917685485042515`*^9}, {3.4917685920468626`*^9, 
   3.4917686716112704`*^9}, {3.491768750705002*^9, 3.491768762431864*^9}, {
   3.491768799715475*^9, 3.491768799845662*^9}, {3.491768841245192*^9, 
   3.4917688433882737`*^9}, {3.49176896737656*^9, 3.49176899015932*^9}, {
   3.4917692223632126`*^9, 3.4917692348711987`*^9}, {3.4917692668471775`*^9, 
   3.491769296870349*^9}, {3.4917693691943455`*^9, 3.4917693762244544`*^9}, {
   3.4917694398259087`*^9, 3.4917694608661633`*^9}, {3.4917695108981056`*^9, 
   3.4917695413518963`*^9}, {3.4917695772935777`*^9, 
   3.4917696451511517`*^9}, {3.4917701817126894`*^9, 3.491770202472541*^9}, {
   3.4917738281359887`*^9, 3.4917738809118767`*^9}, {3.491773947988328*^9, 
   3.4917739481085005`*^9}, {3.491773994034539*^9, 3.4917740062621217`*^9}, {
   3.49177408273208*^9, 3.491774107657922*^9}, {3.4917742279508944`*^9, 
   3.491774256001229*^9}, {3.4917744800433855`*^9, 3.491774496156555*^9}, {
   3.4917745271811666`*^9, 3.491774533670498*^9}, {3.491827903722864*^9, 
   3.491827942558707*^9}, {3.4918279732228003`*^9, 3.4918281290068064`*^9}, {
   3.49182822959144*^9, 3.491828233697344*^9}, {3.4918282687377295`*^9, 
   3.491828323356267*^9}, {3.491839219834634*^9, 3.491839319688216*^9}, {
   3.4918418533614593`*^9, 3.491841862815053*^9}, {3.491841963790248*^9, 
   3.49184196509212*^9}, {3.4918420261899743`*^9, 3.4918420663276896`*^9}, {
   3.491842172750718*^9, 3.4918421757049665`*^9}, {3.491842350245944*^9, 
   3.4918423621530657`*^9}, {3.4918445914987073`*^9, 
   3.4918446374748173`*^9}, {3.4918447736406145`*^9, 3.491844775853797*^9}, {
   3.4918455147362576`*^9, 3.4918455785079565`*^9}, {3.491930613542331*^9, 
   3.4919306783154707`*^9}, {3.4919309323106976`*^9, 
   3.4919309355353346`*^9}, {3.4919476822859793`*^9, 3.491947682806728*^9}, {
   3.492207840400357*^9, 3.492207842863899*^9}, {3.4922104505235295`*^9, 
   3.492210450663731*^9}, {3.4923742679514227`*^9, 3.4923742829029217`*^9}, {
   3.492374692802328*^9, 3.492374696577757*^9}, {3.4923754378736877`*^9, 
   3.492375477130136*^9}, {3.4923786535375853`*^9, 3.4923786558108544`*^9}, {
   3.4923801224898353`*^9, 3.4923801752857523`*^9}, {3.493425382434264*^9, 
   3.4934254430213842`*^9}, {3.49345299663153*^9, 3.493453007587283*^9}, {
   3.4938391883213296`*^9, 3.493839396570778*^9}, {3.4938394546442833`*^9, 
   3.493839524765112*^9}, {3.49383996609972*^9, 3.493839995862517*^9}, {
   3.493840034317813*^9, 3.4938400439216223`*^9}, {3.4938400968777695`*^9, 
   3.493840104018037*^9}, {3.49384278023625*^9, 3.4938428897937856`*^9}, {
   3.493842939134734*^9, 3.4938429630791645`*^9}, {3.4938434457131586`*^9, 
   3.493843456188221*^9}, {3.493843506120019*^9, 3.493843506210149*^9}, {
   3.493843539938648*^9, 3.4938435399987345`*^9}, {3.493843593425558*^9, 
   3.493843600645941*^9}, {3.4938436348851748`*^9, 3.4938436353157935`*^9}, {
   3.493843695412208*^9, 3.4938436959630003`*^9}, {3.4938438911336412`*^9, 
   3.493843897562886*^9}, {3.4938440061390114`*^9, 3.493844040007712*^9}, {
   3.493844170475315*^9, 3.493844268856781*^9}, {3.4938445196574144`*^9, 
   3.493844682952221*^9}, {3.493844815703107*^9, 3.4938448757594643`*^9}, {
   3.493844919502363*^9, 3.4938449244594913`*^9}, {3.4938449845559053`*^9, 
   3.493845006948104*^9}, {3.493845049258944*^9, 3.493845050450658*^9}, {
   3.493845215347768*^9, 3.4938452181518*^9}, {3.49384525520508*^9, 
   3.493845260833173*^9}, {3.4938454179991665`*^9, 3.493845443025152*^9}, {
   3.4938457026284432`*^9, 3.49384577294956*^9}, {3.49384584714625*^9, 
   3.4938458763882976`*^9}, {3.493924338721592*^9, 3.49392437263035*^9}, {
   3.4939255812182145`*^9, 3.4939256008664675`*^9}, {3.4939257342482605`*^9, 
   3.4939257527047997`*^9}, {3.4939259216877856`*^9, 
   3.4939261815614653`*^9}, {3.4939264247311263`*^9, 3.493926431200429*^9}, {
   3.49392668288233*^9, 3.4939267376410685`*^9}, {3.4939267888547106`*^9, 
   3.4939267970264606`*^9}, {3.4939270154605536`*^9, 3.49392701936617*^9}, {
   3.4939270841493235`*^9, 3.493927118678974*^9}, {3.4939272277558193`*^9, 
   3.4939272700165873`*^9}, {3.4939274511270113`*^9, 
   3.4939274532300353`*^9}, {3.493927503051675*^9, 3.49392751373704*^9}, {
   3.493927547926202*^9, 3.4939278738148065`*^9}, {3.4939280308105555`*^9, 
   3.4939280937510595`*^9}, {3.4939281348802*^9, 3.493928269623952*^9}, {
   3.4939283154298177`*^9, 3.4939283160006385`*^9}, {3.4939284130702176`*^9, 
   3.4939284213621407`*^9}, {3.4939285276049104`*^9, 3.49392853019864*^9}, {
   3.493928713832693*^9, 3.493928747661336*^9}, {3.493928870287664*^9, 
   3.4939288910074577`*^9}, {3.4939289493813953`*^9, 
   3.4939289523356433`*^9}, {3.49392902566108*^9, 3.4939290607214947`*^9}, {
   3.493929191319285*^9, 3.493929245947837*^9}, {3.4939294426206384`*^9, 
   3.493929444863864*^9}, {3.493929545859088*^9, 3.493929547491435*^9}, {
   3.493929698548645*^9, 3.4939296996302*^9}, {3.49392984183468*^9, 
   3.49392989015416*^9}, {3.493929920848296*^9, 3.493929939985814*^9}, {
   3.4939299992109756`*^9, 3.493930004718896*^9}, {3.4939300800872707`*^9, 
   3.493930083151677*^9}, {3.4939301273251953`*^9, 3.4939301427974434`*^9}, {
   3.4939302373634224`*^9, 3.493930237503624*^9}, {3.493930466783312*^9, 
   3.4939305152429934`*^9}, {3.493930601597165*^9, 3.4939306018675537`*^9}, {
   3.4939306639067616`*^9, 3.493930674161507*^9}, {3.493931016674016*^9, 
   3.4939310227827997`*^9}, {3.4939312690368958`*^9, 
   3.4939312851100082`*^9}, {3.4939314709872866`*^9, 3.493931477626834*^9}, {
   3.493931547867835*^9, 3.4939315702299905`*^9}, {3.4939316307169666`*^9, 
   3.493931635513864*^9}, {3.4939317063857727`*^9, 3.4939317065059457`*^9}, 
   3.4939319736500797`*^9, {3.4939320255046434`*^9, 3.4939320321341763`*^9}, {
   3.4939320991905985`*^9, 3.493932116074877*^9}, {3.493932162721952*^9, 
   3.4939321780640125`*^9}, {3.4939323631000814`*^9, 
   3.4939323652932353`*^9}, {3.493932510982726*^9, 3.4939325126951885`*^9}, {
   3.49393285100165*^9, 3.493932866033264*^9}, {3.493932971064291*^9, 
   3.4939329715549965`*^9}, {3.4939330238401794`*^9, 3.493933192422589*^9}, {
   3.493936811786979*^9, 3.4939368325268016`*^9}, {3.493936875728923*^9, 
   3.4939368843012495`*^9}, {3.4939375167106094`*^9, 
   3.4939375532130976`*^9}, {3.4939386396052527`*^9, 
   3.4939386415780897`*^9}, {3.4939393919470673`*^9, 
   3.4939396705777187`*^9}, {3.4939400105966415`*^9, 
   3.4939400133906593`*^9}, {3.4939415038438253`*^9, 3.493941521529256*^9}, {
   3.4939419546620703`*^9, 3.4939419678410206`*^9}, {3.493942479196314*^9, 
   3.4939424966413984`*^9}, {3.4939496365580945`*^9, 
   3.4939496615440226`*^9}, {3.4939496986974463`*^9, 3.493949857215384*^9}, {
   3.4939498885604563`*^9, 3.493949990887595*^9}, {3.493950443127108*^9, 
   3.4939504535020266`*^9}, {3.4939537407688837`*^9, 
   3.4939538360358715`*^9}, {3.493969018761964*^9, 3.4939690948575907`*^9}, {
   3.493969125730444*^9, 3.4939692023868484`*^9}, {3.493971551326721*^9, 
   3.4939715516571865`*^9}, {3.49397819383486*^9, 3.4939782402215605`*^9}, {
   3.4940394571464047`*^9, 3.4940394793483295`*^9}, {3.4940395173329487`*^9, 
   3.4940395273874063`*^9}, {3.494111716490238*^9, 3.4941117310211325`*^9}, {
   3.4941122841865454`*^9, 3.494112303043661*^9}, {3.4941123395161057`*^9, 
   3.494112343231448*^9}, {3.4941123735350227`*^9, 3.494112400573902*^9}, 
   3.494112463193946*^9, {3.494112517632224*^9, 3.494112518894038*^9}, {
   3.4941168446842194`*^9, 3.494116863951925*^9}, {3.4941170512913055`*^9, 
   3.4941172424061155`*^9}, {3.494117679174157*^9, 3.4941176861441793`*^9}, 
   3.4941499041513987`*^9, {3.4941536643683248`*^9, 3.494153695723411*^9}, {
   3.4941540745481343`*^9, 3.4941540754294014`*^9}, {3.4941541212552958`*^9, 
   3.4941541390508847`*^9}, {3.4941544567376957`*^9, 3.49415447636592*^9}, {
   3.4941550958867474`*^9, 3.494155113922682*^9}, {3.4941555274072433`*^9, 
   3.494155554235821*^9}, 3.494155669261219*^9, {3.494156636802475*^9, 
   3.4941566656239185`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseFunction", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used. Values may be lost for multivalued inverses.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InverseFunction/ifun\\\", ButtonNote -> \\\
\"InverseFunction::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.4938398660057917`*^9, 3.4938399668508*^9, 3.493839998526347*^9, 
   3.493840044392299*^9, 3.4938401054200525`*^9, 3.4938435414808655`*^9, 
   3.493843601407035*^9, 3.4938436373987885`*^9, 3.4938437080503807`*^9, 
   3.4938439029005613`*^9, 3.4938440466973314`*^9, 3.493844300502285*^9, 
   3.4938450161513376`*^9, 3.49384505191276*^9, 3.493845095104867*^9, 
   3.4938452190831394`*^9, 3.493845270527112*^9, 3.4938454201021905`*^9, 
   3.4938457761942253`*^9, 3.493845849579749*^9, 3.493924422061429*^9, {
   3.493925583161008*^9, 3.493925601637576*^9}, {3.49392618466593*^9, 
   3.4939262097319727`*^9}, 3.4939264323220415`*^9, {3.4939266913244686`*^9, 
   3.4939267117538447`*^9}, 3.4939267978776846`*^9, 3.4939271273514447`*^9, 
   3.4939272716789775`*^9, 3.493927455002584*^9, 3.4939275148286095`*^9, 
   3.493928320977795*^9, 3.493928388114333*^9, 3.4939284421420207`*^9, 
   3.493928550447757*^9, 3.493928748592675*^9, 3.49392889171848*^9, 
   3.493928953226925*^9, 3.4939290289958754`*^9, 3.4939290628044896`*^9, 
   3.4939294219409027`*^9, 3.4939299551876736`*^9, 3.493930039468864*^9, 
   3.493930084353405*^9, 3.49393014668303*^9, 3.493930545636698*^9, 
   3.4939306083468704`*^9, 3.4939307098728576`*^9, 3.4939310468273745`*^9, 
   3.493931286992715*^9, 3.493931352677165*^9, 3.493931478367899*^9, 
   3.4939315713616176`*^9, 3.493931638898731*^9, 3.493931975923349*^9, 
   3.4939320327350397`*^9, 3.49393211794757*^9, 3.493932366294675*^9, 
   3.4939325132459807`*^9, 3.4939328663737535`*^9, 3.4939332020263987`*^9, 
   3.4939341138575473`*^9, 3.493934747068059*^9, 3.4939369677512445`*^9, 
   3.493937560002861*^9, 3.4939380578387136`*^9, 3.4939384634319277`*^9, 
   3.4939389899390078`*^9, 3.493939771062208*^9, 3.493940203784432*^9, 
   3.4939415267267294`*^9, 3.493942075055187*^9, 3.493942668728848*^9, 
   3.493943640376008*^9, 3.493944036645816*^9, 3.493945586444317*^9, 
   3.493945816455056*^9, 3.493950203903121*^9, 3.493950454823927*^9, 
   3.493950498306452*^9, 3.4939509604609976`*^9, 3.4939543645558453`*^9, 
   3.493954561398892*^9, 3.493969848288819*^9, 3.4939700210921288`*^9, 
   3.4939705244308367`*^9, 3.4939707857888327`*^9, 3.4939715614710045`*^9, 
   3.4939716017577286`*^9, 3.4939736538673553`*^9, 3.493976268926978*^9, 
   3.4939782466307764`*^9, 3.49404393182067*^9, 3.4940444067035184`*^9, 
   3.4940449947490864`*^9, 3.494045063487928*^9, 3.494046741691066*^9, 
   3.494047386958915*^9, 3.4940482194059153`*^9, 3.494052747907581*^9, 
   3.494053162423626*^9, 3.49405473694768*^9, 3.4941119699547024`*^9, 
   3.4941123050164976`*^9, 3.494112344683536*^9, 3.4941124110890226`*^9, 
   3.494112504863864*^9, 3.4941125419471874`*^9, 3.494113605847*^9, 
   3.4941179666074657`*^9, 3.4941183597027087`*^9, 3.4941185137842674`*^9, 
   3.49412167561075*^9, 3.4941217783885374`*^9, 3.494122387073784*^9, 
   3.4941229707030015`*^9, 3.494128460927557*^9, 3.494129785712504*^9, 
   3.494140647871522*^9, 3.494140774012904*^9, 3.4941421701604657`*^9, 
   3.494142336830125*^9, 3.494147769191477*^9, 3.494148897063277*^9, 
   3.494149148735163*^9, 3.494149477147397*^9, 3.4941495723342686`*^9, 
   3.4941499458613744`*^9, 3.4941509144541426`*^9, 3.4941511241556787`*^9, 
   3.494151274141347*^9, 3.4941519135207295`*^9, 3.494152682907053*^9, 
   3.494153744603698*^9, 3.4941545725542316`*^9, 3.4941546785967135`*^9, 
   3.4941548864556*^9, 3.494155018675723*^9, 3.4941551222346334`*^9, 
   3.49415581144567*^9, 3.4941568429889565`*^9, 3.4941573802615166`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseFunction", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used. Values may be lost for multivalued inverses.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InverseFunction/ifun\\\", ButtonNote -> \\\
\"InverseFunction::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.4938398660057917`*^9, 3.4938399668508*^9, 3.493839998526347*^9, 
   3.493840044392299*^9, 3.4938401054200525`*^9, 3.4938435414808655`*^9, 
   3.493843601407035*^9, 3.4938436373987885`*^9, 3.4938437080503807`*^9, 
   3.4938439029005613`*^9, 3.4938440466973314`*^9, 3.493844300502285*^9, 
   3.4938450161513376`*^9, 3.49384505191276*^9, 3.493845095104867*^9, 
   3.4938452190831394`*^9, 3.493845270527112*^9, 3.4938454201021905`*^9, 
   3.4938457761942253`*^9, 3.493845849579749*^9, 3.493924422061429*^9, {
   3.493925583161008*^9, 3.493925601637576*^9}, {3.49392618466593*^9, 
   3.4939262097319727`*^9}, 3.4939264323220415`*^9, {3.4939266913244686`*^9, 
   3.4939267117538447`*^9}, 3.4939267978776846`*^9, 3.4939271273514447`*^9, 
   3.4939272716789775`*^9, 3.493927455002584*^9, 3.4939275148286095`*^9, 
   3.493928320977795*^9, 3.493928388114333*^9, 3.4939284421420207`*^9, 
   3.493928550447757*^9, 3.493928748592675*^9, 3.49392889171848*^9, 
   3.493928953226925*^9, 3.4939290289958754`*^9, 3.4939290628044896`*^9, 
   3.4939294219409027`*^9, 3.4939299551876736`*^9, 3.493930039468864*^9, 
   3.493930084353405*^9, 3.49393014668303*^9, 3.493930545636698*^9, 
   3.4939306083468704`*^9, 3.4939307098728576`*^9, 3.4939310468273745`*^9, 
   3.493931286992715*^9, 3.493931352677165*^9, 3.493931478367899*^9, 
   3.4939315713616176`*^9, 3.493931638898731*^9, 3.493931975923349*^9, 
   3.4939320327350397`*^9, 3.49393211794757*^9, 3.493932366294675*^9, 
   3.4939325132459807`*^9, 3.4939328663737535`*^9, 3.4939332020263987`*^9, 
   3.4939341138575473`*^9, 3.493934747068059*^9, 3.4939369677512445`*^9, 
   3.493937560002861*^9, 3.4939380578387136`*^9, 3.4939384634319277`*^9, 
   3.4939389899390078`*^9, 3.493939771062208*^9, 3.493940203784432*^9, 
   3.4939415267267294`*^9, 3.493942075055187*^9, 3.493942668728848*^9, 
   3.493943640376008*^9, 3.493944036645816*^9, 3.493945586444317*^9, 
   3.493945816455056*^9, 3.493950203903121*^9, 3.493950454823927*^9, 
   3.493950498306452*^9, 3.4939509604609976`*^9, 3.4939543645558453`*^9, 
   3.493954561398892*^9, 3.493969848288819*^9, 3.4939700210921288`*^9, 
   3.4939705244308367`*^9, 3.4939707857888327`*^9, 3.4939715614710045`*^9, 
   3.4939716017577286`*^9, 3.4939736538673553`*^9, 3.493976268926978*^9, 
   3.4939782466307764`*^9, 3.49404393182067*^9, 3.4940444067035184`*^9, 
   3.4940449947490864`*^9, 3.494045063487928*^9, 3.494046741691066*^9, 
   3.494047386958915*^9, 3.4940482194059153`*^9, 3.494052747907581*^9, 
   3.494053162423626*^9, 3.49405473694768*^9, 3.4941119699547024`*^9, 
   3.4941123050164976`*^9, 3.494112344683536*^9, 3.4941124110890226`*^9, 
   3.494112504863864*^9, 3.4941125419471874`*^9, 3.494113605847*^9, 
   3.4941179666074657`*^9, 3.4941183597027087`*^9, 3.4941185137842674`*^9, 
   3.49412167561075*^9, 3.4941217783885374`*^9, 3.494122387073784*^9, 
   3.4941229707030015`*^9, 3.494128460927557*^9, 3.494129785712504*^9, 
   3.494140647871522*^9, 3.494140774012904*^9, 3.4941421701604657`*^9, 
   3.494142336830125*^9, 3.494147769191477*^9, 3.494148897063277*^9, 
   3.494149148735163*^9, 3.494149477147397*^9, 3.4941495723342686`*^9, 
   3.4941499458613744`*^9, 3.4941509144541426`*^9, 3.4941511241556787`*^9, 
   3.494151274141347*^9, 3.4941519135207295`*^9, 3.494152682907053*^9, 
   3.494153744603698*^9, 3.4941545725542316`*^9, 3.4941546785967135`*^9, 
   3.4941548864556*^9, 3.494155018675723*^9, 3.4941551222346334`*^9, 
   3.49415581144567*^9, 3.4941568429889565`*^9, 3.4941573803216033`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseFunction", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used. Values may be lost for multivalued inverses.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InverseFunction/ifun\\\", ButtonNote -> \\\
\"InverseFunction::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.4938398660057917`*^9, 3.4938399668508*^9, 3.493839998526347*^9, 
   3.493840044392299*^9, 3.4938401054200525`*^9, 3.4938435414808655`*^9, 
   3.493843601407035*^9, 3.4938436373987885`*^9, 3.4938437080503807`*^9, 
   3.4938439029005613`*^9, 3.4938440466973314`*^9, 3.493844300502285*^9, 
   3.4938450161513376`*^9, 3.49384505191276*^9, 3.493845095104867*^9, 
   3.4938452190831394`*^9, 3.493845270527112*^9, 3.4938454201021905`*^9, 
   3.4938457761942253`*^9, 3.493845849579749*^9, 3.493924422061429*^9, {
   3.493925583161008*^9, 3.493925601637576*^9}, {3.49392618466593*^9, 
   3.4939262097319727`*^9}, 3.4939264323220415`*^9, {3.4939266913244686`*^9, 
   3.4939267117538447`*^9}, 3.4939267978776846`*^9, 3.4939271273514447`*^9, 
   3.4939272716789775`*^9, 3.493927455002584*^9, 3.4939275148286095`*^9, 
   3.493928320977795*^9, 3.493928388114333*^9, 3.4939284421420207`*^9, 
   3.493928550447757*^9, 3.493928748592675*^9, 3.49392889171848*^9, 
   3.493928953226925*^9, 3.4939290289958754`*^9, 3.4939290628044896`*^9, 
   3.4939294219409027`*^9, 3.4939299551876736`*^9, 3.493930039468864*^9, 
   3.493930084353405*^9, 3.49393014668303*^9, 3.493930545636698*^9, 
   3.4939306083468704`*^9, 3.4939307098728576`*^9, 3.4939310468273745`*^9, 
   3.493931286992715*^9, 3.493931352677165*^9, 3.493931478367899*^9, 
   3.4939315713616176`*^9, 3.493931638898731*^9, 3.493931975923349*^9, 
   3.4939320327350397`*^9, 3.49393211794757*^9, 3.493932366294675*^9, 
   3.4939325132459807`*^9, 3.4939328663737535`*^9, 3.4939332020263987`*^9, 
   3.4939341138575473`*^9, 3.493934747068059*^9, 3.4939369677512445`*^9, 
   3.493937560002861*^9, 3.4939380578387136`*^9, 3.4939384634319277`*^9, 
   3.4939389899390078`*^9, 3.493939771062208*^9, 3.493940203784432*^9, 
   3.4939415267267294`*^9, 3.493942075055187*^9, 3.493942668728848*^9, 
   3.493943640376008*^9, 3.493944036645816*^9, 3.493945586444317*^9, 
   3.493945816455056*^9, 3.493950203903121*^9, 3.493950454823927*^9, 
   3.493950498306452*^9, 3.4939509604609976`*^9, 3.4939543645558453`*^9, 
   3.493954561398892*^9, 3.493969848288819*^9, 3.4939700210921288`*^9, 
   3.4939705244308367`*^9, 3.4939707857888327`*^9, 3.4939715614710045`*^9, 
   3.4939716017577286`*^9, 3.4939736538673553`*^9, 3.493976268926978*^9, 
   3.4939782466307764`*^9, 3.49404393182067*^9, 3.4940444067035184`*^9, 
   3.4940449947490864`*^9, 3.494045063487928*^9, 3.494046741691066*^9, 
   3.494047386958915*^9, 3.4940482194059153`*^9, 3.494052747907581*^9, 
   3.494053162423626*^9, 3.49405473694768*^9, 3.4941119699547024`*^9, 
   3.4941123050164976`*^9, 3.494112344683536*^9, 3.4941124110890226`*^9, 
   3.494112504863864*^9, 3.4941125419471874`*^9, 3.494113605847*^9, 
   3.4941179666074657`*^9, 3.4941183597027087`*^9, 3.4941185137842674`*^9, 
   3.49412167561075*^9, 3.4941217783885374`*^9, 3.494122387073784*^9, 
   3.4941229707030015`*^9, 3.494128460927557*^9, 3.494129785712504*^9, 
   3.494140647871522*^9, 3.494140774012904*^9, 3.4941421701604657`*^9, 
   3.494142336830125*^9, 3.494147769191477*^9, 3.494148897063277*^9, 
   3.494149148735163*^9, 3.494149477147397*^9, 3.4941495723342686`*^9, 
   3.4941499458613744`*^9, 3.4941509144541426`*^9, 3.4941511241556787`*^9, 
   3.494151274141347*^9, 3.4941519135207295`*^9, 3.494152682907053*^9, 
   3.494153744603698*^9, 3.4941545725542316`*^9, 3.4941546785967135`*^9, 
   3.4941548864556*^9, 3.494155018675723*^9, 3.4941551222346334`*^9, 
   3.49415581144567*^9, 3.4941568429889565`*^9, 3.4941573803716755`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Further output of \\\\\\\"\\\
\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(InverseFunction :: \
\\\"ifun\\\"\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" will \
be suppressed during this calculation.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.4938398660057917`*^9, 3.4938399668508*^9, 3.493839998526347*^9, 
   3.493840044392299*^9, 3.4938401054200525`*^9, 3.4938435414808655`*^9, 
   3.493843601407035*^9, 3.4938436373987885`*^9, 3.4938437080503807`*^9, 
   3.4938439029005613`*^9, 3.4938440466973314`*^9, 3.493844300502285*^9, 
   3.4938450161513376`*^9, 3.49384505191276*^9, 3.493845095104867*^9, 
   3.4938452190831394`*^9, 3.493845270527112*^9, 3.4938454201021905`*^9, 
   3.4938457761942253`*^9, 3.493845849579749*^9, 3.493924422061429*^9, {
   3.493925583161008*^9, 3.493925601637576*^9}, {3.49392618466593*^9, 
   3.4939262097319727`*^9}, 3.4939264323220415`*^9, {3.4939266913244686`*^9, 
   3.4939267117538447`*^9}, 3.4939267978776846`*^9, 3.4939271273514447`*^9, 
   3.4939272716789775`*^9, 3.493927455002584*^9, 3.4939275148286095`*^9, 
   3.493928320977795*^9, 3.493928388114333*^9, 3.4939284421420207`*^9, 
   3.493928550447757*^9, 3.493928748592675*^9, 3.49392889171848*^9, 
   3.493928953226925*^9, 3.4939290289958754`*^9, 3.4939290628044896`*^9, 
   3.4939294219409027`*^9, 3.4939299551876736`*^9, 3.493930039468864*^9, 
   3.493930084353405*^9, 3.49393014668303*^9, 3.493930545636698*^9, 
   3.4939306083468704`*^9, 3.4939307098728576`*^9, 3.4939310468273745`*^9, 
   3.493931286992715*^9, 3.493931352677165*^9, 3.493931478367899*^9, 
   3.4939315713616176`*^9, 3.493931638898731*^9, 3.493931975923349*^9, 
   3.4939320327350397`*^9, 3.49393211794757*^9, 3.493932366294675*^9, 
   3.4939325132459807`*^9, 3.4939328663737535`*^9, 3.4939332020263987`*^9, 
   3.4939341138575473`*^9, 3.493934747068059*^9, 3.4939369677512445`*^9, 
   3.493937560002861*^9, 3.4939380578387136`*^9, 3.4939384634319277`*^9, 
   3.4939389899390078`*^9, 3.493939771062208*^9, 3.493940203784432*^9, 
   3.4939415267267294`*^9, 3.493942075055187*^9, 3.493942668728848*^9, 
   3.493943640376008*^9, 3.493944036645816*^9, 3.493945586444317*^9, 
   3.493945816455056*^9, 3.493950203903121*^9, 3.493950454823927*^9, 
   3.493950498306452*^9, 3.4939509604609976`*^9, 3.4939543645558453`*^9, 
   3.493954561398892*^9, 3.493969848288819*^9, 3.4939700210921288`*^9, 
   3.4939705244308367`*^9, 3.4939707857888327`*^9, 3.4939715614710045`*^9, 
   3.4939716017577286`*^9, 3.4939736538673553`*^9, 3.493976268926978*^9, 
   3.4939782466307764`*^9, 3.49404393182067*^9, 3.4940444067035184`*^9, 
   3.4940449947490864`*^9, 3.494045063487928*^9, 3.494046741691066*^9, 
   3.494047386958915*^9, 3.4940482194059153`*^9, 3.494052747907581*^9, 
   3.494053162423626*^9, 3.49405473694768*^9, 3.4941119699547024`*^9, 
   3.4941123050164976`*^9, 3.494112344683536*^9, 3.4941124110890226`*^9, 
   3.494112504863864*^9, 3.4941125419471874`*^9, 3.494113605847*^9, 
   3.4941179666074657`*^9, 3.4941183597027087`*^9, 3.4941185137842674`*^9, 
   3.49412167561075*^9, 3.4941217783885374`*^9, 3.494122387073784*^9, 
   3.4941229707030015`*^9, 3.494128460927557*^9, 3.494129785712504*^9, 
   3.494140647871522*^9, 3.494140774012904*^9, 3.4941421701604657`*^9, 
   3.494142336830125*^9, 3.494147769191477*^9, 3.494148897063277*^9, 
   3.494149148735163*^9, 3.494149477147397*^9, 3.4941495723342686`*^9, 
   3.4941499458613744`*^9, 3.4941509144541426`*^9, 3.4941511241556787`*^9, 
   3.494151274141347*^9, 3.4941519135207295`*^9, 3.494152682907053*^9, 
   3.494153744603698*^9, 3.4941545725542316`*^9, 3.4941546785967135`*^9, 
   3.4941548864556*^9, 3.494155018675723*^9, 3.4941551222346334`*^9, 
   3.49415581144567*^9, 3.4941568429889565`*^9, 3.494157380391704*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used by \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Solve\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\", so some solutions may not be found; \
use Reduce for complete solution information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", \
ButtonNote -> \\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.4938398660057917`*^9, 3.4938399668508*^9, 3.493839998526347*^9, 
   3.493840044392299*^9, 3.4938401054200525`*^9, 3.4938435414808655`*^9, 
   3.493843601407035*^9, 3.4938436373987885`*^9, 3.4938437080503807`*^9, 
   3.4938439029005613`*^9, 3.4938440466973314`*^9, 3.493844300502285*^9, 
   3.4938450161513376`*^9, 3.49384505191276*^9, 3.493845095104867*^9, 
   3.4938452190831394`*^9, 3.493845270527112*^9, 3.4938454201021905`*^9, 
   3.4938457761942253`*^9, 3.493845849579749*^9, 3.493924422061429*^9, {
   3.493925583161008*^9, 3.493925601637576*^9}, {3.49392618466593*^9, 
   3.4939262097319727`*^9}, 3.4939264323220415`*^9, {3.4939266913244686`*^9, 
   3.4939267117538447`*^9}, 3.4939267978776846`*^9, 3.4939271273514447`*^9, 
   3.4939272716789775`*^9, 3.493927455002584*^9, 3.4939275148286095`*^9, 
   3.493928320977795*^9, 3.493928388114333*^9, 3.4939284421420207`*^9, 
   3.493928550447757*^9, 3.493928748592675*^9, 3.49392889171848*^9, 
   3.493928953226925*^9, 3.4939290289958754`*^9, 3.4939290628044896`*^9, 
   3.4939294219409027`*^9, 3.4939299551876736`*^9, 3.493930039468864*^9, 
   3.493930084353405*^9, 3.49393014668303*^9, 3.493930545636698*^9, 
   3.4939306083468704`*^9, 3.4939307098728576`*^9, 3.4939310468273745`*^9, 
   3.493931286992715*^9, 3.493931352677165*^9, 3.493931478367899*^9, 
   3.4939315713616176`*^9, 3.493931638898731*^9, 3.493931975923349*^9, 
   3.4939320327350397`*^9, 3.49393211794757*^9, 3.493932366294675*^9, 
   3.4939325132459807`*^9, 3.4939328663737535`*^9, 3.4939332020263987`*^9, 
   3.4939341138575473`*^9, 3.493934747068059*^9, 3.4939369677512445`*^9, 
   3.493937560002861*^9, 3.4939380578387136`*^9, 3.4939384634319277`*^9, 
   3.4939389899390078`*^9, 3.493939771062208*^9, 3.493940203784432*^9, 
   3.4939415267267294`*^9, 3.493942075055187*^9, 3.493942668728848*^9, 
   3.493943640376008*^9, 3.493944036645816*^9, 3.493945586444317*^9, 
   3.493945816455056*^9, 3.493950203903121*^9, 3.493950454823927*^9, 
   3.493950498306452*^9, 3.4939509604609976`*^9, 3.4939543645558453`*^9, 
   3.493954561398892*^9, 3.493969848288819*^9, 3.4939700210921288`*^9, 
   3.4939705244308367`*^9, 3.4939707857888327`*^9, 3.4939715614710045`*^9, 
   3.4939716017577286`*^9, 3.4939736538673553`*^9, 3.493976268926978*^9, 
   3.4939782466307764`*^9, 3.49404393182067*^9, 3.4940444067035184`*^9, 
   3.4940449947490864`*^9, 3.494045063487928*^9, 3.494046741691066*^9, 
   3.494047386958915*^9, 3.4940482194059153`*^9, 3.494052747907581*^9, 
   3.494053162423626*^9, 3.49405473694768*^9, 3.4941119699547024`*^9, 
   3.4941123050164976`*^9, 3.494112344683536*^9, 3.4941124110890226`*^9, 
   3.494112504863864*^9, 3.4941125419471874`*^9, 3.494113605847*^9, 
   3.4941179666074657`*^9, 3.4941183597027087`*^9, 3.4941185137842674`*^9, 
   3.49412167561075*^9, 3.4941217783885374`*^9, 3.494122387073784*^9, 
   3.4941229707030015`*^9, 3.494128460927557*^9, 3.494129785712504*^9, 
   3.494140647871522*^9, 3.494140774012904*^9, 3.4941421701604657`*^9, 
   3.494142336830125*^9, 3.494147769191477*^9, 3.494148897063277*^9, 
   3.494149148735163*^9, 3.494149477147397*^9, 3.4941495723342686`*^9, 
   3.4941499458613744`*^9, 3.4941509144541426`*^9, 3.4941511241556787`*^9, 
   3.494151274141347*^9, 3.4941519135207295`*^9, 3.494152682907053*^9, 
   3.494153744603698*^9, 3.4941545725542316`*^9, 3.4941546785967135`*^9, 
   3.4941548864556*^9, 3.494155018675723*^9, 3.4941551222346334`*^9, 
   3.49415581144567*^9, 3.4941568429889565`*^9, 3.4941573804517903`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getQneutrino", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unprotect", "[", 
       RowBox[{
       "Qnucapnondeg", ",", "Qnucapdeg", ",", "Qnucap", ",", "Qnupair", ",", 
        "Qnubrem", ",", "Qnuplasmon", ",", "Qnu0", ",", "Qnucapnondegfactor", 
        ",", "Qnucapdegfactor", ",", "Qnupairfactor", ",", "Qnubremfactor", 
        ",", "Qnuplasmonfactor", ",", "gammaplasmon"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{
       "Qnucapnondeg", ",", "Qnucapdeg", ",", "Qnucap", ",", "Qnupair", ",", 
        "Qnubrem", ",", "Qnuplasmon", ",", "Qnu0", ",", "Qnupairfactor", ",", 
        "Qnubremfactor", ",", "Qnuplasmonfactor", ",", "gammaplasmon"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Unprotect", "[", 
       RowBox[{
       "Ypp", ",", "Ynn", ",", "alphaa", ",", "sinTwsq", ",", "CVe", ",", 
        "Csp", ",", "Csn", ",", "sigmanuN", ",", "sigma0nu", ",", 
        "sigma0prime", ",", "sigmanueCA", ",", "sigmanue", ",", "taunusca", 
        ",", "dtaunuscads", ",", "Hnusca", ",", "unu0", ",", "nnu0", ",", 
        "Fnu0", ",", "nnu", ",", "sigmacap", ",", "sigmabrem", ",", 
        "sigmapair", ",", "sigmaplasmon", ",", "taunuabs", ",", "dtaunuabsds",
         ",", "Hnuabs", ",", "taunutot", ",", "damptaunu", ",", "Unu", ",", 
        "nnutrue", ",", "Pnu", ",", "damptaunu2", ",", "Fnu", ",", "Qnu", ",",
         "Unue", ",", "nnuetrue", ",", "Pnue", ",", "Fnue", ",", "Qnue"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{
       "Ypp", ",", "Ynn", ",", "alphaa", ",", "sinTwsq", ",", "CVe", ",", 
        "Csp", ",", "Csn", ",", "sigmanuN", ",", "sigma0nu", ",", 
        "sigma0prime", ",", "sigmanueCA", ",", "sigmanue", ",", "taunusca", 
        ",", "dtaunuscads", ",", "Hnusca", ",", "unu0", ",", "nnu0", ",", 
        "Fnu0", ",", "nnu", ",", "sigmacap", ",", "sigmabrem", ",", 
        "sigmapair", ",", "sigmaplasmon", ",", "taunuabs", ",", "dtaunuabsds",
         ",", "Hnuabs", ",", "taunutot", ",", "damptaunu", ",", "Unu", ",", 
        "nnutrue", ",", "Pnu", ",", "damptaunu2", ",", "Fnu", ",", "Qnu", ",",
         "Unue", ",", "nnuetrue", ",", "Pnue", ",", "Fnue", ",", "Qnue"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Qnucapnondegfactor", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"92", "/", "10"}], ")"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", "33", ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnucapnondeg", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"Qnucapnondegfactor", "*", 
        RowBox[{
         RowBox[{"T11", "[", "T", "]"}], "^", "6"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rho10", "[", "rhob", "]"}], "*", 
          RowBox[{"Xnuc", "[", 
           RowBox[{"rhob", ",", "T"}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"damptaurad", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Qnucapdegfactor", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"11", "/", "10"}], ")"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", "31", ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnucapdeg", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"Qnucapdegfactor", "*", 
        RowBox[{
         RowBox[{"myetae", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "^", "9"}], "*", 
        RowBox[{
         RowBox[{"T11", "[", "T", "]"}], "^", "9"}], "*", 
        RowBox[{"(", 
         RowBox[{"damptaurad", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "interpolate", " ", "using", " ", "etae", " ", "up", " ", "to", " ", 
        "1"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnudegenfactor", "[", 
        RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"myetae", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnucap", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Qnudegenfactor", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "*", 
         RowBox[{"Qnucapdeg", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Qnudegenfactor", "[", 
            RowBox[{"rhob", ",", "T"}], "]"}]}], ")"}], "*", 
         RowBox[{"Qnucapnondeg", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Qnupairfactor", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"48", "/", "10"}], ")"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", "33", ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnupair", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"Qnupairfactor", "*", 
        RowBox[{
         RowBox[{"T11", "[", "T", "]"}], "^", "9"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"damptaurad", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          ")"}], "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Qnubremfactor", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "/", "2"}], ")"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", "33", ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnubrem", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"Qnubremfactor", "*", 
        RowBox[{
         RowBox[{"T11", "[", "T", "]"}], "^", 
         RowBox[{"(", 
          RowBox[{"55", "/", "10"}], ")"}]}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Xnuc", "[", 
            RowBox[{"rhob", ",", "T"}], "]"}], "*", 
           RowBox[{"rho13", "[", "rhob", "]"}]}], ")"}], "^", "2"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Qnuplasmonfactor", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "/", "2"}], ")"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", "32", ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"limit", " ", "gammap", " ", "so", " ", 
        RowBox[{"don", "'"}], "t", " ", "get", " ", "underflow"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gammaplasmon", "[", 
        RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"5565", "/", "1000"}], ")"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "2"}], ")"}]}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Pi", "^", "2"}], "+", 
               RowBox[{"3", "*", 
                RowBox[{
                 RowBox[{"myetae", "[", 
                  RowBox[{"rhob", ",", "T"}], "]"}], "^", "2"}]}]}], ")"}], 
             "/", "3"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}]}], ",", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "5"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnuplasmon", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"Qnuplasmonfactor", "*", 
        RowBox[{
         RowBox[{"T11", "[", "T", "]"}], "^", "9"}], "*", 
        RowBox[{
         RowBox[{"gammaplasmon", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "^", "6"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"gammaplasmon", "[", 
           RowBox[{"rhob", ",", "T"}], "]"}]}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"gammaplasmon", "[", 
           RowBox[{"rhob", ",", "T"}], "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{
           RowBox[{
            RowBox[{"gammaplasmon", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}], "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"gammaplasmon", "[", 
              RowBox[{"rhob", ",", "T"}], "]"}]}], ")"}]}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"damptaurad", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          ")"}], "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "total", " ", "optically", " ", "thin", " ", "energy", " ", "density", 
        " ", "rate"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnu0", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Qnucap", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "+", 
        RowBox[{"Qnupair", "[", 
         RowBox[{"T", ",", "bgauss", ",", "npairs"}], "]"}], "+", 
        RowBox[{"Qnubrem", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "+", 
        RowBox[{"Qnuplasmon", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"optical", " ", "depth", " ", "effects"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "scattering", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Ypp", "=", "Ye"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ynn", "=", 
       RowBox[{"1", "-", "Ypp"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alphaa", "=", 
       RowBox[{"125", "/", "100"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sinTwsq", "=", 
       RowBox[{"23", "/", "100"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CVe", "=", 
       RowBox[{
        RowBox[{"1", "/", "2"}], "+", 
        RowBox[{"2", "*", "sinTwsq"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Csp", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"CVe", "-", "1"}], ")"}], "^", "2"}]}], "+", 
          RowBox[{"5", "*", 
           RowBox[{"alphaa", "^", "2"}]}]}], ")"}], "/", "24"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Csn", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"5", "*", 
           RowBox[{"alphaa", "^", "2"}]}]}], ")"}], "/", "24"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmanuN", "[", 
        RowBox[{"rhob_", ",", "T_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"nb", "[", "rhob", "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"77", "/", "10"}], ")"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "7"}], ")"}]}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Csp", "*", "Ypp"}], "+", 
            RowBox[{"Csn", "*", "Ynn"}]}], ")"}], "*", 
          RowBox[{
           RowBox[{"T11", "[", "T", "]"}], "^", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Xnuc", "[", 
             RowBox[{"rhob", ",", "T"}], "]"}], "*", 
            RowBox[{"rho10", "[", "rhob", "]"}]}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigma0nu", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"17", "/", "10"}], ")"}], "*", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "44"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigma0prime", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "/", "2"}], ")"}], "*", "sigma0nu"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmanueCA", "[", 
        RowBox[{
        "CA_", ",", "rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], 
        "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"nb", "[", "rhob", "]"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ne", "[", "rhob", "]"}], "+", "npairs"}], ")"}], "*", 
          "sigma0prime", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"myetae", "[", 
              RowBox[{"rhob", ",", "T"}], "]"}], "/", "4"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"CVe", "+", "CA"}], ")"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "3"}], ")"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"CVe", "-", "CA"}], ")"}], "^", "2"}]}]}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"kb", "*", 
             RowBox[{"T", "/", 
              RowBox[{"(", 
               RowBox[{"me", "*", 
                RowBox[{"c", "^", "2"}]}], ")"}]}]}], ")"}], "^", "2"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "only", " ", "take", " ", "scattering", " ", "for", " ", "normal", " ",
         "electron", " ", "neutrinos"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmanue", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"sigmanueCA", "[", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", "rhob", ",", "T", ",", "bgauss", ",", 
         "npairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"taunusca", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"sigmanuN", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Xnuc", "[", 
            RowBox[{"rhob", ",", "T"}], "]"}], "*", 
           RowBox[{"nbint", "[", "rhob", "]"}]}], ")"}], "*", "Rjet"}], "+", 
        RowBox[{
         RowBox[{"sigmanue", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"npairs", "*", "Nscalayers", "*", "Lpnum"}], "+", 
           RowBox[{
            RowBox[{"neint", "[", "rhob", "]"}], "*", "Rjet"}]}], ")"}]}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"below", " ", "is", " ", "just", " ", "an", " ", 
        RowBox[{"approximation", " ", "--"}], " ", "I", " ", 
        RowBox[{"don", "'"}], "t", " ", "know", " ", "how", " ", "it", " ", 
        "should", " ", "be", " ", "constrained", " ", "unlike", " ", 
        "absorption"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dtaunuscads", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"sigmanuN", "[", 
          RowBox[{"rhob", ",", "T"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Xnuc", "[", 
            RowBox[{"rhob", ",", "T"}], "]"}], "*", 
           RowBox[{"nbint", "[", "rhob", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"sigmanue", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"npairs", "*", "Nscalayers"}], "+", 
           RowBox[{"neint", "[", "rhob", "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Hnusca", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"taunusca", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "/", 
          RowBox[{"dtaunuscads", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}], 
         ")"}], "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "absorption", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"unu0", "[", "T_", "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"7", "/", "8"}], ")"}], "*", "arad", "*", 
        RowBox[{"T", "^", "4"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nnu0", "[", "T_", "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "3"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"arad", "/", "kb"}], ")"}], "*", 
        RowBox[{"T", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Fnu0", "[", "T_", "]"}], ":=", 
       RowBox[{"c", "*", 
        RowBox[{"unu0", "[", "T", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"APPROXIMATION", ":", " ", 
        RowBox[{
        "below", " ", "is", " ", "rough", " ", "approximation", " ", "only", 
         " ", "roughly", " ", "valid", " ", "when", " ", "neurtrinos", " ", 
         "are", " ", "optically", " ", 
         RowBox[{"thick", ".", "  ", "Only"}], " ", "makes", " ", "opacity", 
         " ", "larger", " ", "than", " ", "would", " ", "be"}]}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "This", " ", "is", " ", "done", " ", "to", " ", "avoid", " ", "having",
         " ", "to", " ", "solve", " ", "the", " ", "nnu", " ", "equation", 
        " ", "with", " ", "T", " ", "and", " ", "npairs"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"nnu", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", 
         RowBox[{"nrad", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nnu", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=",
        "npairs"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmacap", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"nb", "[", "rhob", "]"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Qnucap", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{"c", "*", 
           RowBox[{"unu0", "[", "T", "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmabrem", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"nb", "[", "rhob", "]"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Qnubrem", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{"c", "*", 
           RowBox[{"unu0", "[", "T", "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmapair", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"nb", "[", "rhob", "]"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Qnupair", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{"c", "*", 
           RowBox[{"unu0", "[", "T", "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmaplasmon", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"nb", "[", "rhob", "]"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Qnuplasmon", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{"c", "*", 
           RowBox[{"unu0", "[", "T", "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"taunuabs", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sigmacap", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "+", 
           RowBox[{"sigmabrem", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Xnuc", "[", 
            RowBox[{"rhob", ",", "T"}], "]"}], "*", 
           RowBox[{"nbint", "[", "rhob", "]"}]}], ")"}], "*", "Rjet"}], " ", 
        "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sigmapair", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "+", 
           RowBox[{"sigmaplasmon", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           ")"}], "*", 
         RowBox[{"nnu", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "*", "Nabslayers", "*", "Lpnum"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"below", " ", "is", " ", "equivalent", " ", 
        RowBox[{"to", " ", "\\", "Sum"}], " ", 
        RowBox[{"Q0", " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{"c", " ", "u0nu"}], ")"}]}], "  ", "as", " ", "is", " ", 
        "must", " ", "be", " ", "to", " ", "work", " ", "in", " ", "the", " ",
         "optically", " ", "thin", " ", "limit"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dtaunuabsds", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sigmacap", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "+", 
          RowBox[{"sigmabrem", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "+", 
          RowBox[{"sigmapair", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "+", 
          RowBox[{"sigmaplasmon", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}], 
         ")"}], "*", 
        RowBox[{"nb", "[", "rhob", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Hnuabs", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"taunuabs", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "/", 
          RowBox[{"dtaunuabsds", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}], 
         ")"}], "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "total", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"taunutot", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"taunuabs", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "+", 
         RowBox[{"taunusca", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "densities", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"damptaunu", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{"taunutot", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           "+", 
          RowBox[{"2", "*", 
           RowBox[{"Sqrt", "[", "3", "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{"taunutot", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           "+", 
          RowBox[{"2", "*", 
           RowBox[{"Sqrt", "[", "3", "]"}]}], "+", 
          RowBox[{"2", "/", 
           RowBox[{"taunuabs", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
            "]"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unue", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"unu0", "[", "T", "]"}], "*", 
        RowBox[{"damptaunu", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nnuetrue", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nnu0", "[", "T", "]"}], "*", 
        RowBox[{"damptaunu", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pnue", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Unu", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "/",
         "3"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "fluxes", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"damptaunu2", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "3"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"taunutot", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "/", "2"}], "+", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", "3", "]"}]}], "+", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"3", "*", 
             RowBox[{"taunuabs", "[", 
              RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
              "]"}]}], ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Fnue", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Fnu0", "[", "T", "]"}], "*", 
        RowBox[{"damptaunu2", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnue", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Fnu", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "/", 
        RowBox[{"Hnuabs", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "hack", " ", "for", " ", "mu", " ", "and", " ", "tau", " ", 
        "neutrinos"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unu", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Unue", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"damptaunu", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "*", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nnutrue", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nnuetrue", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"damptaunu", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "*", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pnu", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Pnue", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"damptaunu", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "*", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Fnu", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Fnue", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"damptaunu2", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "*", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qnu", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"qnue", ",", "damp", ",", "result"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"qnue", "=", 
           RowBox[{"Qnue", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"damp", "=", 
           RowBox[{"damptaunu2", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"qnue", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"damp", "*", "2"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Qnu: \>\"", ",", "qnue", ",", "\"\< \>\"", ",", "damp", 
               ",", "\"\< \>\"", ",", "result"}], "]"}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
          "result"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "SUPERDEBUG", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Unu", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nnutrue", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Pnu", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Qnu", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", "0"}], ";"}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", 
       RowBox[{
       "Qnucapnondeg", ",", "Qnucapdeg", ",", "Qnucap", ",", "Qnupair", ",", 
        "Qnubrem", ",", "Qnuplasmon", ",", "Qnu0", ",", "Qnucapnondegfactor", 
        ",", "Qnucapdegfactor", ",", "Qnupairfactor", ",", "Qnubremfactor", 
        ",", "Qnuplasmonfactor", ",", "gammaplasmon"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", 
       RowBox[{
       "Ypp", ",", "Ynn", ",", "alphaa", ",", "sinTwsq", ",", "CVe", ",", 
        "Csp", ",", "Csn", ",", "sigmanuN", ",", "sigma0nu", ",", 
        "sigma0prime", ",", "sigmanueCA", ",", "sigmanue", ",", "taunusca", 
        ",", "dtaunuscads", ",", "Hnusca", ",", "unu0", ",", "nnu0", ",", 
        "Fnu0", ",", "nnu", ",", "sigmacap", ",", "sigmabrem", ",", 
        "sigmapair", ",", "sigmaplasmon", ",", "taunuabs", ",", "dtaunuabsds",
         ",", "Hnuabs", ",", "taunutot", ",", "damptaunu", ",", "Unu", ",", 
        "nnutrue", ",", "Pnu", ",", "damptaunu2", ",", "Fnu", ",", "Qnu", ",",
         "Unue", ",", "nnuetrue", ",", "Pnue", ",", "Fnue", ",", "Qnue"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.465148298467224*^9, 3.465148298667512*^9}, {
   3.4651483596151505`*^9, 3.4651483791131873`*^9}, {3.4651484379878445`*^9, 
   3.465148457145392*^9}, {3.4770742202813473`*^9, 3.47707447126224*^9}, 
   3.477095279462963*^9, {3.477096019276763*^9, 3.477096020718837*^9}, {
   3.4770972220863185`*^9, 3.4770972229675856`*^9}, {3.477167044930453*^9, 
   3.4771670880424447`*^9}, {3.477171607130574*^9, 3.4771717870092273`*^9}, 
   3.477172016349002*^9, {3.477172062595501*^9, 3.477172077526971*^9}, {
   3.4771721125373135`*^9, 3.4771722561438093`*^9}, {3.4771722889409695`*^9, 
   3.477172289932395*^9}, {3.491749168757544*^9, 3.4917491689678464`*^9}, {
   3.491828409119589*^9, 3.491828497396525*^9}, {3.491828542511397*^9, 
   3.491828781955701*^9}, {3.4918393306439695`*^9, 3.4918393633209567`*^9}, {
   3.491842525447872*^9, 3.491842530334899*^9}, {3.491842683575248*^9, 
   3.491842692067459*^9}, {3.491842800563469*^9, 3.4918428654167233`*^9}, {
   3.4918429539440193`*^9, 3.4918429571185837`*^9}, 3.491843088136979*^9, {
   3.4923742964123473`*^9, 3.4923743362496305`*^9}, {3.492374380723581*^9, 
   3.492374508667555*^9}, {3.4939677738194227`*^9, 3.4939678357942114`*^9}, {
   3.4939682742640934`*^9, 3.4939683448206234`*^9}, {3.4939683782864094`*^9, 
   3.4939684144558935`*^9}, {3.493968446890268*^9, 3.4939686133792644`*^9}, {
   3.49396866112554*^9, 3.493968781762993*^9}, {3.4939688309712973`*^9, 
   3.4939688684132695`*^9}, {3.493970116466417*^9, 3.4939701506245117`*^9}, {
   3.4939707739621806`*^9, 3.4939707791294565`*^9}, {3.4939780693758965`*^9, 
   3.4939780817436805`*^9}, {3.494040336170379*^9, 3.494040445417469*^9}, {
   3.494040527625678*^9, 3.4940407692230787`*^9}, {3.494040816911651*^9, 
   3.494041707071638*^9}, {3.49404175903636*^9, 3.4940417870866947`*^9}, {
   3.494041838170149*^9, 3.4940418383103504`*^9}, {3.4940420345425186`*^9, 
   3.494042039069027*^9}, {3.4940421024301357`*^9, 3.4940421127549825`*^9}, {
   3.4940422621698303`*^9, 3.4940422740869665`*^9}, {3.494042492420915*^9, 
   3.494042520981984*^9}, {3.494043334451696*^9, 3.4940434355070066`*^9}, {
   3.4940443516743903`*^9, 3.4940443970997086`*^9}, 3.4940447925082784`*^9, {
   3.494044831574453*^9, 3.494044845774872*^9}, {3.4940448923518467`*^9, 
   3.4940449479618096`*^9}, {3.494045054605155*^9, 3.494045057359115*^9}, {
   3.494045817672392*^9, 3.494045836869997*^9}, {3.494046054532981*^9, 
   3.4940462167963037`*^9}, {3.49404736509748*^9, 3.4940473730188704`*^9}, {
   3.4940602405915313`*^9, 3.494060373923253*^9}, {3.494129658399437*^9, 
   3.4941297475476255`*^9}, {3.4941416938856163`*^9, 3.4941417331020064`*^9}, 
   3.494149905593472*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getsigmaphoton", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "getsigmaff", ";", "\[IndentingNewLine]", "getsigmasynch", ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getsigmaff", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unprotect", "[", 
       RowBox[{
       "Z", ",", "netot", ",", "Q1ff", ",", "nbsigmaff0", ",", "sigmaff0", 
        ",", "factorsigmaff", ",", "sigmaff", ",", "nbsigmaff", ",", "Q0ff"}],
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Z", "=", "1"}], ";", " ", 
      RowBox[{"(*", " ", "protons", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"netot", "[", 
        RowBox[{"rhob_", ",", "npairs_"}], "]"}], ":=", " ", 
       RowBox[{
        RowBox[{"ne", "[", "rhob", "]"}], " ", "+", " ", "npairs"}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "unsure", " ", "if", " ", "total", " ", "or", " ", "just", " ", "ne", 
        " ", "or", " ", "something", " ", "more", " ", "complicated"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Q1fffactor1", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"1.4", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "27"}], ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Q1fffactor2", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"4.4", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "10"}], ")"}]}]}], ",", "lowestprec"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Q1ff", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{"Q1fffactor1", "*", 
        RowBox[{"T", "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], "*", 
        RowBox[{"Z", "^", "2"}], "*", 
        RowBox[{"netot", "[", 
         RowBox[{"rhob", ",", "npairs"}], "]"}], "*", 
        RowBox[{"np", "[", "rhob", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Q1fffactor2", "*", "T"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nbsigmaff0", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Q1ff", "[", 
         RowBox[{"rhob", ",", "T", ",", "npairs"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"c", "*", 
          RowBox[{"urad0", "[", "T", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmaff0", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nbsigmaff0", "[", 
         RowBox[{"rhob", ",", "T", ",", "npairs"}], "]"}], "/", 
        RowBox[{"nb", "[", "rhob", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"factorsigmaff", "[", 
        RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "30"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sqrt", "[", "5", "]"}], "*", "Pi", "*", "me", "*", 
           RowBox[{"c", "^", "2"}], "*", "kb", "*", "T"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"hbar", "*", "c", "*", "q", "*", "bgauss"}], ")"}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sigmaff", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"sigmaff0", "[", 
         RowBox[{"rhob", ",", "T", ",", "npairs"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"factorsigmaff", "[", 
             RowBox[{"T", ",", "bgauss"}], "]"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"-", "2"}], ")"}]}]}], " ", ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "force", " ", "not", " ", "to", " ", "be", " ", "direct", " ", 
        "function", " ", "of", " ", "T", " ", "so", " ", "can", " ", "easily",
         " ", "solve", " ", "for", " ", "T", " ", "per", " ", "iteration"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"localTrad", "=", 
         RowBox[{"T", "//.", "solsTrad"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"don", "'"}], "t", " ", "allow", " ", "to", " ", "go", " ", 
         "below", " ", 
         RowBox[{"10", "^", "4"}], " ", "K", " ", "for", " ", "this", " ", 
         "term", " ", "since", " ", "makes", " ", "no", " ", "sense", " ", 
         "for", " ", "free"}], "-", "free"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"localsolsTrad", "=", 
         RowBox[{"{", 
          RowBox[{"T", "\[Rule]", 
           RowBox[{
            RowBox[{"10", "^", "4"}], "+", "localTrad"}]}], "}"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"nbsigmaff", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"nb", "*", "sigmaff"}], ")"}], "//.", "localsolsTrad"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"try", " ", "including", " ", "Temperature", " ", 
        RowBox[{"(", "T", ")"}], " ", "dependence"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nbsigmaff", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nb", "[", "rhob", "]"}], "*", 
        RowBox[{"sigmaff", "[", 
         RowBox[{"rhob", ",", 
          RowBox[{"T", "+", 
           RowBox[{"10", "^", "4"}]}], ",", "bgauss", ",", "npairs"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"so", " ", 
          RowBox[{"Kirchhoff", "'"}], "s", " ", "law", " ", "defines", " ", 
          "Q0ff", " ", "through", " ", "nb", "*", "sigmaff"}], " ", "=", " ", 
         RowBox[{"Q0ff", "/", 
          RowBox[{"(", 
           RowBox[{"c", "*", "urad0"}], ")"}]}]}], " ", ",", " ", 
        RowBox[{"but", " ", "not", " ", "used"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Q0ff", " ", "not", " ", "used", " ", "except", " ", "perhaps", " ", 
        "as", " ", "diagnostic"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Q0ff", "[", 
        RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"nbsigmaff", "[", 
         RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"c", "*", 
          RowBox[{"urad0", "[", "T", "]"}]}], ")"}]}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", 
       RowBox[{
       "Z", ",", "netot", ",", "Q1ff", ",", "nbsigmaff0", ",", "sigmaff0", 
        ",", "factorsigmaff", ",", "sigmaff", ",", "nbsigmaff", ",", "Q0ff"}],
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4770869128723965`*^9, 3.4770869165677104`*^9}, {
   3.4770974098863616`*^9, 3.477097466657995*^9}, 3.477097507316459*^9, {
   3.477161889347088*^9, 3.477161903617608*^9}, {3.477174350675598*^9, 
   3.4771743683309855`*^9}, 3.477174416209832*^9, {3.477174655103344*^9, 
   3.47717465566415*^9}, {3.4771747215388737`*^9, 3.4771747285789967`*^9}, {
   3.4771765491168013`*^9, 3.477176634950224*^9}, {3.477176673856168*^9, 
   3.4771766947361917`*^9}, {3.4912579315815616`*^9, 
   3.4912579349063425`*^9}, {3.491258036191984*^9, 3.49125807289476*^9}, {
   3.491344351408784*^9, 3.4913443747122927`*^9}, {3.491344415761318*^9, 
   3.4913444809150047`*^9}, {3.491600224516243*^9, 3.4916002298639326`*^9}, {
   3.4916002664365215`*^9, 3.491600290931744*^9}, {3.491607850071253*^9, 
   3.491607852504752*^9}, {3.4917491691981773`*^9, 3.491749169758984*^9}, {
   3.491828862401376*^9, 3.4918290440425634`*^9}, {3.4918290826781187`*^9, 
   3.491829161281144*^9}, {3.49182923103144*^9, 3.4918292317124195`*^9}, {
   3.491839366385363*^9, 3.4918393877460785`*^9}, {3.4923745469325776`*^9, 
   3.4923745828542304`*^9}, {3.494149906845272*^9, 3.4941499072057905`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"see", " ", 
    RowBox[{"plancklaw", ".", "nb"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", 
     RowBox[{
     "betax", ",", "sinpart", ",", "tempresultclass", ",", "Thetadep", ",", 
      "resultclass"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "betax", ",", "sinpart", ",", "tempresultclass", ",", "resultclass"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"betax", "[", "gamma_", "]"}], ":=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{"1", "/", 
        RowBox[{"gamma", "^", "2"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Sinth", " ", "is", " ", "to", " ", "mock", " ", "what", " ", "happens", 
      " ", "after", " ", "correct", " ", "integration"}], ",", " ", 
     RowBox[{"but", " ", "still", " ", "this", " ", 
      RowBox[{"doesn", "'"}], "t", " ", "account", " ", "for", " ", "pitch", 
      " ", "angles", " ", 
      RowBox[{"correctly", ".", "  ", 
       RowBox[{"Right", "?"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sinpart", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"sinpart", "=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Sin", "[", "th", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"th", ",", "0", ",", "Pi"}], "}"}]}], "]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tempresultclass", "[", "Thetax_", "]"}], "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "gammax", "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"sinpart", "*", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"gammax", "^", "2"}], "*", 
            RowBox[{"betax", "[", "gammax", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gammax", "^", "2"}], "-", "1"}], ")"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "gammax"}], "/", "Thetax"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"gammax", ",", "1", ",", "Infinity"}], "}"}], ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{
             RowBox[{"Re", "[", "Thetax", "]"}], ">", "0"}]}]}], "]"}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "Thetadep", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Thetadep", "[", "T_", "]"}], ":=", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "6"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"kb", "*", "T"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"me", "*", 
         RowBox[{"c", "^", "2"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"resultclass", "[", "T_", "]"}], ":=", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"tempresultclass", "[", 
       RowBox[{"Thetadep", "[", "T", "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Protect", "[", 
     RowBox[{
     "betax", ",", "sinpart", ",", "tempresultclass", ",", "Thetadep", ",", 
      "resultclass"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getsigmasynch", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Unprotect", "[", 
         RowBox[{
         "Bc", ",", "Brat", ",", "beta", ",", "fgamfullfree", ",", 
          "fgamfullfixedT", ",", "Q0synch", ",", "nbsigmasynch", ",", 
          "Q1synch", ",", "nbsigmasynch0", ",", "sigmasynch0", ",", 
          "factorsigmasynch", ",", "sigmasynch", ",", "nbsigmasynch", ",", 
          "Q0synch"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Bc", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"me", "^", "2"}], "*", 
            RowBox[{"c", "^", "3"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"q", "*", "hbar"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Brat", "[", "bgauss_", "]"}], ":=", 
         RowBox[{"bgauss", "/", "Bc"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"gamma", "^", "2"}], " ", "=", " ", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"beta", "^", "2"}]}], ")"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"beta", "^", "2"}]}], " ", "=", " ", 
          RowBox[{"1", "/", 
           RowBox[{"gamma", "^", "2"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"beta", "^", "2"}], " ", "=", " ", 
          RowBox[{"1", "-", 
           RowBox[{"1", "/", 
            RowBox[{"gamma", "^", "2"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"classical", " ", "=", " ", 
          RowBox[{"Brat", 
           RowBox[{"<<", "1"}], " ", "and", " ", "omega", 
           RowBox[{"<<", "gamma"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"beta", "[", "gamma_", "]"}], ":=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"1", "/", 
            RowBox[{"gamma", "^", "2"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "below", " ", "Exp", " ", "is", " ", "only", " ", "part", " ", 
          "that", " ", "mixes", " ", "gamma", " ", "and", " ", "temperature", 
          " ", "and", " ", "needs", " ", "to", " ", "be", " ", "integrated", 
          " ", "to", " ", "constant", " ", "for", " ", "simplicity", " ", 
          "of", " ", "integration", " ", "so", " ", "root", " ", "finding", 
          " ", "for", " ", "temperature", " ", "is", " ", "simple"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fgamfullfree", "[", "T_", "]"}], ":=", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Thetadep", "[", "T", "]"}], "*", 
            RowBox[{"BesselK", "[", 
             RowBox[{"2", ",", 
              RowBox[{"1", "/", 
               RowBox[{"Thetadep", "[", "T", "]"}]}]}], "]"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fgamfullfixedT", "[", 
          RowBox[{"gamma_", ",", "T_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"gamma", "^", "2"}], "*", 
          RowBox[{"beta", "[", "gamma", "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "gamma"}], "/", 
            RowBox[{"Thetadep", "[", "T", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"stupid", " ", "to", " ", "go", " ", "below", " ", 
          RowBox[{"10", "^", "4"}], " ", "K"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fgamfullfreeforint", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", "fgamfullfree", ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"fgamfullfree", "//.", "solsTrad"}], ")"}]}], "*", 
            RowBox[{"(", "Thetadep", ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fgamfullfixedTforint", "=", 
           RowBox[{
            RowBox[{"(", "fgamfullfixedT", ")"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fgamfullfree", "//.", "solsTrad"}], ")"}], "/", 
             RowBox[{"(", "Thetavalue", ")"}]}]}]}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"get", " ", "Q0synch"}], " ", "*)"}], "\[IndentingNewLine]", 
        "getclassSynch", ";", "\[IndentingNewLine]", "getclassSynchnew", ";", 
        " ", 
        RowBox[{"(*", " ", 
         RowBox[{"alternate", " ", "version"}], " ", "*)"}], 
        "\[IndentingNewLine]", "getQEDSynch", ";", "\[IndentingNewLine]", 
        "getqedSynchultrarel", " ", ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ultra", " ", "rel", " ", "QED", " ", "version", " ", "from", " ", 
           "Baring", " ", "1998"}], ",", " ", 
          RowBox[{"eq", " ", "6"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "getqedSynchultrarelnew", ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ultra", " ", "rel", " ", "QED", " ", "version", " ", "from", " ", 
           "Baring", " ", "1998"}], ",", " ", 
          RowBox[{
          "eq", " ", "6", " ", "but", " ", "using", " ", "eq", " ", "8", 
           "a"}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"use", " ", "supression", " ", 
          RowBox[{"technique", ".", " ", "Q0synchnoqednew"}], " ", "has", " ",
           "correct", " ", "integrals", " ", "and", " ", "all", " ", 
          "terms"}], "  ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Q1synch", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", 
         RowBox[{"Q0synchnoqednew", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nbsigmasynch0", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"Q1synch", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "/", 
          RowBox[{"(", 
           RowBox[{"c", "*", 
            RowBox[{"urad0", "[", "T", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sigmasynch0", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"nbsigmasynch0", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "/", 
          RowBox[{"nb", "[", "rhob", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Use", " ", "supression", " ", "factor", " ", "for", " ", "QED", " ",
           "effects", " ", "since", " ", "QED", " ", "calculations", " ", 
          "themselves", " ", "are", " ", "too", " ", "slow", " ", "or", " ", 
          "erroneous", " ", "since", " ", "far", " ", "too", " ", "wrong", 
          " ", "for", " ", "given", " ", "computer", " ", "resources"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"see", " ", 
          RowBox[{"trying_qedscaling", ".", "nb"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"factorsigmasynch", "[", 
          RowBox[{"T_", ",", "bgauss_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "30"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"me", "*", 
              RowBox[{"c", "^", "2"}]}], ")"}], "^", "3"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], "*", "Pi", "*", "kb", "*", "T", 
             "*", "hbar", "*", "c", "*", "q", "*", "bgauss"}], ")"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sigmasynch", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"sigmasynch0", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"factorsigmasynch", "[", 
                RowBox[{"T", ",", "bgauss"}], "]"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ")"}]}]}], " ", ")"}], "^", 
           RowBox[{"(", "2", ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nbsigmasynch", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"nb", "[", "rhob", "]"}], "*", 
          RowBox[{"sigmasynch", "[", 
           RowBox[{"rhob", ",", 
            RowBox[{"T", "+", 
             RowBox[{"10", "^", "4"}]}], ",", "bgauss", ",", "npairs"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"so", " ", 
            RowBox[{"Kirchhoff", "'"}], "s", " ", "law", " ", "defines", " ", 
            "Q0synch", " ", "through", " ", "nb", "*", "sigmasynch"}], " ", 
           "=", " ", 
           RowBox[{"Q0synch", "/", 
            RowBox[{"(", 
             RowBox[{"c", "*", "urad0"}], ")"}]}]}], " ", ",", " ", 
          RowBox[{"but", " ", "not", " ", "used"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Q0synch", " ", "not", " ", "used", " ", "except", " ", "perhaps", 
          " ", "as", " ", "diagnostic"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Q0synch", "[", 
          RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"nbsigmasynch", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "*", 
          RowBox[{"(", 
           RowBox[{"c", "*", 
            RowBox[{"urad0", "[", "T", "]"}]}], ")"}]}]}], ";", " ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Full", " ", "QED", " ", "fails", " ", "to", " ", "integrate", " ", 
           "properly", " ", "most", " ", "of", " ", "the", " ", "time"}], ",",
           " ", 
          RowBox[{
           RowBox[{"it", "'"}], "s", " ", "too", " ", "slow"}], ",", " ", 
          RowBox[{
          "and", " ", "not", " ", "really", " ", "dealing", " ", "with", " ", 
           "pitch", " ", "properly"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Q0synch", "[", 
            RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], 
            "]"}], ":=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"Brat", "[", "bgauss", "]"}], "]"}], "<", 
              RowBox[{"1", "/", "100"}]}], ",", 
             RowBox[{"Q0synchnoqed", "[", 
              RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}],
              ",", 
             RowBox[{"Q0synchqed", "[", 
              RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
              "]"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"nbsigmasynch", "[", 
            RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], 
            "]"}], ":=", 
           RowBox[{
            RowBox[{"Q0synch", "[", 
             RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
            "/", 
            RowBox[{"(", 
             RowBox[{"c", "*", 
              RowBox[{"urad0", "[", "T", "]"}]}], ")"}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Protect", "[", 
         RowBox[{
         "Bc", ",", "Brat", ",", "beta", ",", "fgamfullfree", ",", 
          "fgamfullfixedT", ",", "Q0synch", ",", "nbsigmasynch", ",", 
          "Q1synch", ",", "nbsigmasynch0", ",", "sigmasynch0", ",", 
          "factorsigmasynch", ",", "sigmasynch", ",", "nbsigmasynch", ",", 
          "Q0synch"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.4770869062929363`*^9, 3.477086977915925*^9}, {
   3.4770870598737745`*^9, 3.4770870612657757`*^9}, {3.477087101623808*^9, 
   3.477087218722187*^9}, {3.477097389787461*^9, 3.4770973954055395`*^9}, 
   3.4770974523374033`*^9, 3.4770975087785616`*^9, {3.477174804848667*^9, 
   3.4771748064709997`*^9}, {3.4771748427331424`*^9, 
   3.4771748567332735`*^9}, {3.477175207768037*^9, 3.477175260043205*^9}, {
   3.4771753580040655`*^9, 3.477175408466627*^9}, {3.47717544798345*^9, 
   3.477175466049427*^9}, {3.4771755006591935`*^9, 3.4771755052357745`*^9}, {
   3.4771755901578865`*^9, 3.47717561488344*^9}, {3.4915146690335007`*^9, 
   3.491514801273653*^9}, {3.4915148788552094`*^9, 3.4915148792057133`*^9}, {
   3.491515141002158*^9, 3.4915152351275043`*^9}, {3.4915168175328913`*^9, 
   3.491516863739333*^9}, {3.4915178778675776`*^9, 3.4915178780878944`*^9}, {
   3.491517971181757*^9, 3.491517972533701*^9}, {3.4915180363354435`*^9, 
   3.491518093407509*^9}, {3.491518250032725*^9, 3.4915182526264544`*^9}, {
   3.491522864147496*^9, 3.4915229230722256`*^9}, {3.491523202754389*^9, 
   3.491523226318272*^9}, {3.4915232855634623`*^9, 3.49152335729661*^9}, {
   3.4915233895830355`*^9, 3.491523390955008*^9}, {3.491523634755576*^9, 
   3.4915236361876354`*^9}, {3.4915262453193827`*^9, 3.491526260571314*^9}, {
   3.491526622732075*^9, 3.491526647547758*^9}, {3.491526703488197*^9, 
   3.4915267052307024`*^9}, {3.4915267509764814`*^9, 
   3.4915267513269854`*^9}, {3.491526783853757*^9, 3.4915267906234913`*^9}, {
   3.491526852332224*^9, 3.491526870067726*^9}, {3.491528607275709*^9, 
   3.4915286084473934`*^9}, {3.4915291059026995`*^9, 
   3.4915291169285536`*^9}, {3.4917491700694304`*^9, 
   3.4917491706502657`*^9}, {3.4918292795411935`*^9, 3.491829336062467*^9}, {
   3.491829415316429*^9, 3.4918295515423117`*^9}, {3.491829967330186*^9, 
   3.491830081444274*^9}, {3.491830118076949*^9, 3.4918302368477325`*^9}, {
   3.4918303349888525`*^9, 3.4918304291342273`*^9}, {3.4918306380846834`*^9, 
   3.4918306494610415`*^9}, {3.4918306841809664`*^9, 
   3.4918307063628626`*^9}, {3.491830836920595*^9, 3.4918308650911026`*^9}, {
   3.4918309506541357`*^9, 3.491830970562763*^9}, {3.491833395199219*^9, 
   3.4918334217974653`*^9}, {3.4918393928233795`*^9, 3.491839440191491*^9}, {
   3.491845444465213*^9, 3.4918454470889854`*^9}, {3.4923746415886865`*^9, 
   3.492374642630184*^9}, {3.4930758610745325`*^9, 3.4930758777284803`*^9}, {
   3.4930855064438925`*^9, 3.4930855213353057`*^9}, {3.4931541183429585`*^9, 
   3.4931541457323427`*^9}, {3.4931565238819537`*^9, 
   3.4931565833775043`*^9}, {3.4931665841479053`*^9, 3.493166877730056*^9}, {
   3.4931669153842*^9, 3.49316693441156*^9}, {3.493172306936872*^9, 
   3.493172308439032*^9}, {3.4931733343041534`*^9, 3.493173334374254*^9}, {
   3.493173546849779*^9, 3.493173570433691*^9}, {3.4931745587648416`*^9, 
   3.493174559706195*^9}, {3.494149908267317*^9, 3.4941499097093906`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"see", " ", 
    RowBox[{"plancklaw", ".", 
     RowBox[{"nb", " ", "--"}]}], " ", "but", " ", "not", " ", "dealing", " ",
     "with", " ", "pitch", " ", "angle", " ", "properly"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getclassSynch", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Not", " ", "protected", " ", "since", " ", "want", " ", "to", " ", 
        "store", " ", 
        RowBox[{"results", ":", " ", "Q0synchnoqed"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "myprecsynch", ",", "jgeo", ",", "rawcoef", ",", "jclass0raw", ",", 
         "jclass0", ",", "jclassnew", ",", "grand", ",", "grandit", ",", 
         "jclassthermalneworig", ",", "netot2", ",", "jclassthermalnew"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Stored", ":", " ", "Q0synchnoqed"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", "Q0synchnoqed", "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "purge", " ", "any", " ", "remembered", " ", "versions", " ", "in", 
         " ", "case", " ", "change", " ", "\"\<Choice\>\"", " ", "below"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Classical", " ", "Relativistic", " ", "Synchrotron"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"myprecsynch", "=", "lowestprec"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "20", " ", "makes", " ", "this", " ", "too", " ", "slow", " ", "for",
           " ", "iteration", " ", "to", " ", "get", " ", "T"}], ",", 
         "npairs"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"jgeo", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"2", "*", "Pi", "*", "1"}], ")"}]}], ")"}], ",", 
          "myprecsynch"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rawcoef", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "/", "3"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"hbar", "*", "c"}], ")"}]}], ")"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"me", "*", 
               RowBox[{"c", "^", "2"}]}], ")"}], "^", "2"}], "/", "hbar"}]}], 
          ",", "myprecsynch"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jclass0raw", "[", "bgauss_", "]"}], ":=", 
        RowBox[{"rawcoef", "*", 
         RowBox[{
          RowBox[{"Brat", "[", "bgauss", "]"}], "^", "2"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jclass0", "[", 
         RowBox[{"gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"jclass0raw", "[", "bgauss", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gamma", "^", "2"}], "-", "1"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jclassnew", "[", 
         RowBox[{"th_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{"jgeo", "*", 
         RowBox[{
          RowBox[{"jclass0", "[", 
           RowBox[{"gamma", ",", "bgauss"}], "]"}], "/", 
          RowBox[{"Sin", "[", "th", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grand", "[", 
         RowBox[{"th_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{"jclassnew", "[", 
         RowBox[{"th", ",", 
          RowBox[{"gamma", "*", 
           RowBox[{"Sin", "[", "th", "]"}]}], ",", "bgauss"}], "]"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"\\", "gamma"}], " ", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"\\", "gamma", " ", "\\", "sin", "\\", "theta"}], " ", "is",
           " ", "for", " ", "Lornetz", " ", "boost"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grandit", "[", 
         RowBox[{"th_", ",", "gamma_", ",", "T_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"grand", "[", 
          RowBox[{"th", ",", "gamma", ",", "bgauss"}], "]"}], "*", 
         RowBox[{"fgamfullfree", "[", "T", "]"}], "*", 
         RowBox[{"fgamfullfixedT", "[", 
          RowBox[{"gamma", ",", "T"}], "]"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "no", " ", "Lorentz", " ", "boost", " ", "for", " ", "distribution", 
         " ", "function", " ", "itself"}], " ", "*)"}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"netot2", "[", 
         RowBox[{"rhob_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"ne", "[", "rhob", "]"}], " ", "+", " ", "npairs"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"jclassthermalneworig", "[", 
           RowBox[{
            RowBox[{"rhob_", "?", "NumericQ"}], ",", 
            RowBox[{"T_", "?", "NumericQ"}], ",", 
            RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
            RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"thetap", ",", "gammap"}], "}"}], ",", 
            RowBox[{
             RowBox[{"netot2", "[", 
              RowBox[{"rhob", ",", "npairs"}], "]"}], "*", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"grandit", "[", 
                RowBox[{"thetap", ",", "gammap", ",", "T", ",", "bgauss"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"thetap", ",", "0", ",", "Pi"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"gammap", ",", 
                 RowBox[{"1", "/", 
                  RowBox[{"Sin", "[", "thetap", "]"}]}], ",", "Infinity"}], 
                "}"}], ",", 
               RowBox[{"WorkingPrecision", "\[Rule]", "myprecsynch"}], ",", 
               " ", "\n", "  ", 
               RowBox[{
               "Method", " ", "->", " ", "\"\<AdaptiveMonteCarlo\>\""}], ",", 
               " ", 
               RowBox[{"MaxPoints", " ", "->", " ", "10000"}]}], "]"}]}]}], 
           "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Use", " ", "WorkingPrecision"}], "\[Rule]", 
         RowBox[{"15", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", ".", "e", ".", " ", "slowprec"}], "=", "15"}], ")"}],
           " ", "below", " ", "seems", " ", "to", " ", "be", " ", "good", " ",
           "enough", " ", "for", " ", "external", " ", "FindRoot", " ", "to", 
          " ", "work", " ", "with", " ", "WorkingPrecision", " ", "of", " ", 
          "30"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "too", " ", "small", " ", "WorkingPrecision", " ", "here", " ", "and",
          " ", "complains", " ", "about", " ", "convergence", " ", "and", " ",
          "takes", " ", "long", " ", "time", " ", "as", " ", "well"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jclassthermalneworig", "[", 
         RowBox[{
          RowBox[{"rhob_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}], ",", 
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"thetap", ",", "gammap", ",", "result"}], "}"}], ",", 
          RowBox[{
           RowBox[{"result", "=", 
            RowBox[{
             RowBox[{"netot2", "[", 
              RowBox[{"rhob", ",", "npairs"}], "]"}], "*", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"grandit", "[", 
                RowBox[{"thetap", ",", "gammap", ",", "T", ",", "bgauss"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"thetap", ",", "0", ",", "Pi"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"gammap", ",", 
                 RowBox[{"1", "/", 
                  RowBox[{"Sin", "[", "thetap", "]"}]}], ",", "Infinity"}], 
                "}"}], ",", 
               RowBox[{"WorkingPrecision", "\[Rule]", "slowprec"}]}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{"result", ",", "lowestprec"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "had", " ", "to", " ", "use", " ", "montecarlo", " ", "to", " ", 
          "get", " ", "faster", " ", "and", " ", "accurate", " ", "and", " ", 
          "more", " ", "generally", " ", "convergent", " ", "answer"}], ",", 
         " ", 
         RowBox[{"but", " ", "requires", " ", "more", " ", "points"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"AccuracyGoal", "\[Rule]", "myprecsynch"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"WorkingPrecision", "\[Rule]", "myprecsynch"}], "]"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"below", " ", "is", " ", "approximation"}], ",", " ", 
         RowBox[{
          RowBox[{
          "to", " ", "test", " ", "if", " ", "can", " ", "converge", " ", 
           "with", " ", 
           RowBox[{"FindRoot", "[", "T", "]"}], " ", "with", " ", "T"}], "-", 
          RowBox[{"dependent", " ", "Q0synch"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "unsure", " ", "if", " ", "total", " ", "or", " ", "just", " ", 
           "ne", " ", "or", " ", "something", " ", "more", " ", 
           RowBox[{"complicatd", " ", "--"}], " ", "already", " ", "defined", 
           " ", "above"}], " ", ".."}], " ", "so", " ", "used", " ", "netot2",
          " ", "even", " ", "though", " ", "same", " ", "definition"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jclassthermalnew", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"netot2", "[", 
          RowBox[{"rhob", ",", "npairs"}], "]"}], "*", 
         RowBox[{"fgamfullfree", "[", "T", "]"}], "*", 
         RowBox[{"resultclass", "[", "T", "]"}], "*", 
         RowBox[{"jclass0raw", "[", "bgauss", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"SUPERDEBUG", " ", "choose"}], ",", " ", 
         RowBox[{
         "but", " ", "should", " ", "choose", " ", "jclassthermalneworig"}]}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Choice", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"debug", " ", "version"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Q0synchnoqed", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], 
           "]"}], ":=", 
          RowBox[{
           RowBox[{"Q0synchnoqed", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "foo", "}"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<nonqed=\>\"", ",", "T", ",", "\"\< \>\"", ",", "npairs"}],
                "]"}], ";", 
              RowBox[{"jclassthermalnew", "[", 
               RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
               "]"}]}]}], "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"normal", " ", "version"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Q0synchnoqed", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], 
           "]"}], ":=", 
          RowBox[{
           RowBox[{"Q0synchnoqed", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "=", 
           RowBox[{"jclassthermalnew", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
            "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Choice", " ", "2"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "debug", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Q0synchnoqed", "[", 
           RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], 
           "]"}], ":=", 
          RowBox[{
           RowBox[{"Q0synchnoqed", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
           "=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "foo", "}"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<nonqedorig=\>\"", ",", "T", ",", "\"\< \>\"", ",", 
                "npairs"}], "]"}], ";", 
              RowBox[{"jclassthermalneworig", "[", 
               RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
               "]"}]}]}], "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"normal", " ", "version"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Q0synchnoqed", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"Q0synchnoqed", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "=", 
         RowBox[{"jclassthermalneworig", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "myprecsynch", ",", "jgeo", ",", "rawcoef", ",", "jclass0raw", ",", 
         "jclass0", ",", "jclassnew", ",", "grand", ",", "grandit", ",", 
         "jclassthermalneworig", ",", "netot2", ",", "jclassthermalnew"}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4770870517921534`*^9, 3.477087096476406*^9}, {
   3.4770871834815135`*^9, 3.4770871836717873`*^9}, {3.4771749154477005`*^9, 
   3.4771749205450306`*^9}, {3.47717504982092*^9, 3.4771750520140734`*^9}, {
   3.4771757439590416`*^9, 3.477175744139301*^9}, {3.491515268525528*^9, 
   3.491515315993784*^9}, {3.491517869485525*^9, 3.4915178818533087`*^9}, {
   3.491518110452018*^9, 3.491518126334856*^9}, {3.4915233082861357`*^9, 
   3.4915233160973682`*^9}, {3.4915233976546416`*^9, 3.491523401450099*^9}, {
   3.491523438473336*^9, 3.491523448347534*^9}, {3.4915262949407344`*^9, 
   3.491526378681147*^9}, {3.491526589404152*^9, 3.4915265943813086`*^9}, {
   3.4915267090662174`*^9, 3.4915267329705906`*^9}, {3.4915278145057616`*^9, 
   3.4915278148262224`*^9}, {3.4915290786635313`*^9, 3.491529090961214*^9}, {
   3.4915291280445375`*^9, 3.491529134493811*^9}, {3.4916052063397536`*^9, 
   3.491605214451418*^9}, {3.4916078090122128`*^9, 3.4916078298121214`*^9}, {
   3.491829565933005*^9, 3.4918296630826993`*^9}, {3.491829718602533*^9, 
   3.491829783295557*^9}, {3.491829820759427*^9, 3.491829948162624*^9}, {
   3.491830721104059*^9, 3.4918308181936674`*^9}, {3.491831446947771*^9, 
   3.491831547382189*^9}, {3.4918317429333773`*^9, 3.4918317616102333`*^9}, {
   3.49183335455077*^9, 3.491833377323515*^9}, {3.491839444137165*^9, 
   3.4918394976841617`*^9}, {3.4918538639117823`*^9, 3.491853871833173*^9}, {
   3.49185391702816*^9, 3.491853922956685*^9}, {3.4918539792376127`*^9, 
   3.491853980930046*^9}, {3.491854146007416*^9, 3.491854147749922*^9}, {
   3.491854332605731*^9, 3.4918543347087555`*^9}, {3.491854375907997*^9, 
   3.491854383428811*^9}, {3.491856877234728*^9, 3.491856881590992*^9}, {
   3.4918605647070527`*^9, 3.4918605859776382`*^9}, {3.491860621268384*^9, 
   3.491860701083152*^9}, {3.4918608578685985`*^9, 3.491860858058872*^9}, {
   3.4918609798940625`*^9, 3.4918609950057917`*^9}, {3.4918611816141214`*^9, 
   3.491861212939165*^9}, {3.4918613018470078`*^9, 3.4918613196626253`*^9}, {
   3.491861567108435*^9, 3.4918615778839293`*^9}, {3.491925656404317*^9, 
   3.49192566018976*^9}, {3.4919262851984787`*^9, 3.491926305667912*^9}, {
   3.491926364903088*^9, 3.4919263784826145`*^9}, {3.4919301334820385`*^9, 
   3.4919301627541294`*^9}, {3.4919301975741987`*^9, 
   3.4919302130464463`*^9}, {3.4919302529838734`*^9, 
   3.4919302735734797`*^9}, {3.491930697252701*^9, 3.4919307123844595`*^9}, {
   3.4919308705218496`*^9, 3.491930895267432*^9}, {3.491947241502163*^9, 
   3.49194724572824*^9}, {3.491947401902808*^9, 3.491947405477949*^9}, {
   3.491949333039646*^9, 3.4919493732474623`*^9}, {3.492095975343645*^9, 
   3.4920959856384478`*^9}, {3.492097769022829*^9, 3.4920977925065966`*^9}, {
   3.492181337050411*^9, 3.4921813426284323`*^9}, {3.49218250850488*^9, 
   3.4921825138725986`*^9}, {3.492197112804832*^9, 3.492197115909296*^9}, {
   3.4921975844129715`*^9, 3.492197654754117*^9}, {3.49219780950664*^9, 
   3.4921978137327166`*^9}, {3.492198736018899*^9, 3.4921987501692467`*^9}, {
   3.492198890781437*^9, 3.492198917299568*^9}, {3.492199009752509*^9, 
   3.4921990383336067`*^9}, {3.492199682980563*^9, 3.492199690481349*^9}, {
   3.4923686188884687`*^9, 3.4923686217525873`*^9}, {3.492374661036651*^9, 
   3.4923746652627277`*^9}, {3.492375497239051*^9, 3.4923755051804705`*^9}, {
   3.4923773495625615`*^9, 3.4923773497828784`*^9}, {3.4923774373187485`*^9, 
   3.4923774800602083`*^9}, {3.4923778010818143`*^9, 
   3.4923778120475826`*^9}, {3.4923786231038237`*^9, 3.4923786264686623`*^9}, 
   3.492463989074061*^9, {3.493156475902963*^9, 3.4931564829531007`*^9}, {
   3.493941979688056*^9, 3.4939419923863153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"see", " ", "trying_nonqed", 
     RowBox[{"_synch", ".", 
      RowBox[{"nb", "  ", "--"}]}], " ", "direct", " ", "integration", " ", 
     "over", " ", "omega"}], "-", "pre", "-", 
    RowBox[{
    "integrated", " ", "form", " ", "to", " ", "avoid", " ", "having", " ", 
     "to", " ", "repeat", " ", "known", " ", "result", " ", "of", " ", 
     "integration", " ", "over", " ", "omega"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "also", " ", "deals", " ", "with", " ", "pitch", " ", "angle", " ", 
    "properly"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "all", " ", "azimuthal", " ", "angle", " ", "stuff", " ", "already", " ", 
    "integrated", " ", "over"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getclassSynchnew", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Not", " ", "protected", " ", "since", " ", "want", " ", "to", " ", 
        "store", " ", 
        RowBox[{"results", ":", " ", "Q0synchnoqednew"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "netot4", ",", "Thetadep2", ",", "beta2", ",", "fgamfullfree2", ",", 
         "fgamfullfixedT2", ",", "jclassgen2"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Stored", ":", " ", "Q0synchnoqednew"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", "Q0synchnoqednew", "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "purge", " ", "any", " ", "remembered", " ", "versions", " ", "in", 
         " ", "case", " ", "change", " ", "\"\<Choice\>\"", " ", "below"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"netot4", "[", 
         RowBox[{"rhob_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"ne", "[", "rhob", "]"}], "+", "npairs"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thetadep2", "[", "T_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"me", "*", 
           RowBox[{"c", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"beta2", "[", "gamma_", "]"}], ":=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"1", "/", 
           RowBox[{"gamma", "^", "2"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fgamfullfree2", "[", "T_", "]"}], ":=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Thetadep2", "[", "T", "]"}], "*", 
           RowBox[{"BesselK", "[", 
            RowBox[{"2", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Thetadep2", "[", "T", "]"}]}]}], "]"}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fgamfullfixedT2", "[", 
         RowBox[{"gamma_", ",", "T_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"gamma", "^", "2"}], "*", 
         RowBox[{"beta2", "[", "gamma", "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "gamma"}], "/", 
           RowBox[{"Thetadep2", "[", "T", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jclassgen2", "[", 
         RowBox[{"gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{"2", "*", 
         RowBox[{"q", "^", "4"}], "*", 
         RowBox[{"bgauss", "^", "2"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gamma", "^", "2"}], "-", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"me", "^", "2"}], "*", 
            RowBox[{"c", "^", "3"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pitchpart", "=", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "th", "]"}], "^", "3"}], ",", 
          RowBox[{"{", 
           RowBox[{"th", ",", "0", ",", "Pi"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"emissivity", " ", "has", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "thetap", "]"}], "^", "2"}], " ", "and", " ", 
          "then", " ", "assume", " ", "isotropic"}], ",", " ", 
         RowBox[{"so", " ", "density", " ", "weight", " ", "is", " ", 
          RowBox[{"Sin", "[", "thetap", "]"}], 
          RowBox[{"d", "\\", "thetap"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pclassgen2", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"omegap", ",", "gammap"}], "}"}], ",", 
          RowBox[{
           RowBox[{"netot4", "[", 
            RowBox[{"rhob", ",", "npairs"}], "]"}], "*", 
           RowBox[{"fgamfullfree2", "[", "T", "]"}], "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{"pitchpart", "*", 
              RowBox[{"fgamfullfixedT2", "[", 
               RowBox[{"gammap", ",", "T"}], "]"}], "*", 
              RowBox[{"jclassgen2", "[", 
               RowBox[{"gammap", ",", "bgauss"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"gammap", ",", "1", ",", "Infinity"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"synchintprec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "set", " ", "precision", " ", "to", " ", "lowestprec", " ", "so", 
          " ", "other", " ", "processes", " ", 
          RowBox[{"don", "'"}], "t", " ", "use", " ", "low", " ", "precision",
           " ", "to", " ", "compute"}], ",", " ", 
         RowBox[{
         "which", " ", "would", " ", "sour", " ", "their", " ", 
          "robustness"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Q0synchnoqednew", "[", 
         RowBox[{
          RowBox[{"rhob_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}], ",", 
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Q0synchnoqednew", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "=", 
         RowBox[{"Module", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"Pclassgen2", "[", 
              RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}],
              ",", "lowestprec"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "netot4", ",", "Thetadep2", ",", "beta2", ",", "fgamfullfree2", ",", 
         "fgamfullfixedT2", ",", "jclassgen2"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4925312888670835`*^9, 3.4925312890473423`*^9}, {
   3.4930755735010223`*^9, 3.4930756264271264`*^9}, {3.4930756722029486`*^9, 
   3.493075744206485*^9}, 3.493075782100974*^9, {3.4930758268453135`*^9, 
   3.493075841756755*^9}, {3.4930760143549395`*^9, 3.493076014495141*^9}, {
   3.4930761917199774`*^9, 3.4930761939231453`*^9}, {3.4931543250702176`*^9, 
   3.493154374130763*^9}, {3.4931546165193005`*^9, 3.4931546314908285`*^9}, {
   3.4931547363616257`*^9, 3.493154743612051*^9}, {3.4931559784676867`*^9, 
   3.493156046745866*^9}, {3.49315649481015*^9, 3.493156498976141*^9}, {
   3.4931569856659665`*^9, 3.4931569935873566`*^9}, {3.4931579406892223`*^9, 
   3.4931579508538384`*^9}, {3.4941415015891075`*^9, 
   3.4941415062257743`*^9}, {3.494141580041917*^9, 3.494141613970704*^9}, {
   3.494149704183859*^9, 3.494149737221365*^9}, {3.494152659172925*^9, 
   3.494152677419162*^9}, {3.494153703975277*^9, 3.494153710915256*^9}, 
   3.4941541521797633`*^9, 3.4941542003990993`*^9, {3.494154495092848*^9, 
   3.4941545155322385`*^9}, {3.4941546742604785`*^9, 
   3.4941546743906655`*^9}, {3.494154873506981*^9, 3.494154880547104*^9}, {
   3.4941550067686014`*^9, 3.4941550111749372`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"too", " ", "slow"}], ",", " ", 
    RowBox[{"use", " ", "\"\<new\>\"", " ", "version"}], ",", " ", 
    RowBox[{"given", " ", "below"}], ",", " ", 
    RowBox[{"of", " ", "this"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"see", " ", 
    RowBox[{"trying_qedscaling", ".", "nb"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getqedSynchultrarel", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Not", " ", "protected", " ", "since", " ", "want", " ", "to", " ", 
        "store", " ", 
        RowBox[{"results", ":", " ", "Q0synchnoqednew"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "netot5", ",", "Thetadep3", ",", "beta3", ",", "fgamfullfree3", ",", 
         "fgamfullfixedT3", ",", "jw", ",", "Pqedultrarel"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Stored", ":", " ", "Q0synchqedultrarel"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", "Q0synchqedultrarel", "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "purge", " ", "any", " ", "remembered", " ", "versions", " ", "in", 
         " ", "case", " ", "change", " ", "\"\<Choice\>\"", " ", "below"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"netot5", "[", 
         RowBox[{"rhob_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"ne", "[", "rhob", "]"}], "+", "npairs"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"part1", "[", 
         RowBox[{"y_", "?", "NumericQ"}], "]"}], ":=", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"BesselK", "[", 
           RowBox[{
            RowBox[{"5", "/", "3"}], ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "Infinity"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"me", "^", "2"}], "*", 
           RowBox[{"c", "^", "3"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"q", "*", "hbar"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Brat", "[", "bgauss_", "]"}], ":=", 
        RowBox[{"bgauss", "/", "Bc"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ygen", "[", 
         RowBox[{
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"omega_", "?", "NumericQ"}], ",", 
          RowBox[{"gamma_", "?", "NumericQ"}], ",", 
          RowBox[{"al_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"Brat", "[", "bgauss", "]"}], "*", 
            RowBox[{"Sin", "[", "al", "]"}]}], ")"}]}], "*", 
         RowBox[{"omega", "/", 
          RowBox[{"(", 
           RowBox[{"gamma", "*", 
            RowBox[{"(", 
             RowBox[{"gamma", "-", "omega"}], ")"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"part2", "[", 
         RowBox[{"bgauss_", ",", "omega_", ",", "gamma_", ",", "al_"}], "]"}],
         ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"omega", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"gamma", "*", 
            RowBox[{"(", 
             RowBox[{"gamma", "-", "omega"}], ")"}]}], ")"}]}], "*", 
         RowBox[{"BesselK", "[", 
          RowBox[{
           RowBox[{"2", "/", "3"}], ",", 
           RowBox[{"ygen", "[", 
            RowBox[{"bgauss", ",", "omega", ",", "gamma", ",", "al"}], 
            "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jw", "[", 
         RowBox[{
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"omega_", "?", "NumericQ"}], ",", 
          RowBox[{"gamma_", "?", "NumericQ"}], ",", 
          RowBox[{"al_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"Pi", "*", 
             RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"q", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"hbar", "*", "c"}], ")"}]}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"me", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}], "^", "2"}], "/", "hbar"}], "*", 
         RowBox[{"omega", "/", 
          RowBox[{"gamma", "^", "2"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"part1", "[", 
            RowBox[{"ygen", "[", 
             RowBox[{"bgauss", ",", "omega", ",", "gamma", ",", "al"}], "]"}],
             "]"}], "+", 
           RowBox[{"part2", "[", 
            RowBox[{"bgauss", ",", "omega", ",", "gamma", ",", "al"}], 
            "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thetadep3", "[", "T_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"me", "*", 
           RowBox[{"c", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"beta3", "[", "gamma_", "]"}], ":=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"1", "/", 
           RowBox[{"gamma", "^", "2"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fgamfullfree3", "[", "T_", "]"}], ":=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Thetadep3", "[", "T", "]"}], "*", 
           RowBox[{"BesselK", "[", 
            RowBox[{"2", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Thetadep3", "[", "T", "]"}]}]}], "]"}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fgamfullfixedT3", "[", 
         RowBox[{
          RowBox[{"gamma_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"gamma", "^", "2"}], "*", 
         RowBox[{"beta3", "[", "gamma", "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "gamma"}], "/", 
           RowBox[{"Thetadep3", "[", "T", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pqedultrarel", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"netot5", "[", 
          RowBox[{"rhob", ",", "npairs"}], "]"}], "*", 
         RowBox[{"fgamfullfree3", "[", "T", "]"}], "*", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fgamfullfixedT3", "[", 
             RowBox[{"gamma", ",", "T"}], "]"}], "*", 
            RowBox[{"jw", "[", 
             RowBox[{"bgauss", ",", "omega", ",", "gamma", ",", "al"}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"al", ",", "0", ",", "Pi"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"omega", ",", "0", ",", "Infinity"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"gamma", ",", 
             RowBox[{"1", "+", "omega"}], ",", "Infinity"}], "}"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Q0synchqedultrarel", "[", 
         RowBox[{
          RowBox[{"rhob_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}], ",", 
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Q0synchqedultrarel", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "=", 
         RowBox[{"Pqedultrarel", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "netot5", ",", "Thetadep3", ",", "beta3", ",", "fgamfullfree3", ",", 
         "fgamfullfixedT3", ",", "jw", ",", "Pqedultrarel"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4930853241217265`*^9, 3.4930854808771296`*^9}, {
  3.49308558502689*^9, 3.4930856290201488`*^9}, {3.493088027088402*^9, 
  3.4930880333273726`*^9}, {3.4930896475485086`*^9, 3.493089655189496*^9}, {
  3.4931540420132017`*^9, 3.4931540434152174`*^9}, {3.493156998804859*^9, 
  3.493157004933672*^9}, {3.4931720025792274`*^9, 3.493172038230491*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.493166507016997*^9, 3.4931665095906973`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"see", " ", 
     RowBox[{"trying_qedscaling", ".", 
      RowBox[{"nb", " ", "--"}]}], " ", "this", " ", "version", " ", "is", 
     " ", "efficient", " ", "enough", " ", "to", " ", "get", " ", "right", 
     " ", "answer", " ", "with", " ", "NIntegrate"}], ",", " ", 
    RowBox[{
    "unlike", " ", "full", " ", "integral", " ", "over", " ", "pitch", " ", 
     "angle"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"still", " ", "quite", " ", "slow"}], ",", " ", 
    RowBox[{
    "so", " ", "only", " ", "used", " ", "this", " ", "to", " ", "extract", 
     " ", "suppression", " ", "factor"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getqedSynchultrarelnew", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Not", " ", "protected", " ", "since", " ", "want", " ", "to", " ", 
        "store", " ", 
        RowBox[{"results", ":", " ", "Q0synchnoqednew"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "netot6", ",", "Thetadep4", ",", "beta4", ",", "fgamfullfree4", ",", 
         "fgamfullfixedT4", ",", "jgaom", ",", "Pqedultrarelother"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Stored", ":", " ", "Q0synchqedultrarelother"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", "Q0synchqedultrarelother", "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "purge", " ", "any", " ", "remembered", " ", "versions", " ", "in", 
         " ", "case", " ", "change", " ", "\"\<Choice\>\"", " ", "below"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", 
        RowBox[{
        "ys", ",", "Wstuff1", ",", "Wstuff2", ",", "Wstuff", ",", "jgaom"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"netot6", "[", 
         RowBox[{"rhob_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"ne", "[", "rhob", "]"}], "+", "npairs"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bc2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"me", "^", "2"}], "*", 
           RowBox[{"c", "^", "3"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"q", "*", "hbar"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Brat2", "[", "bgauss_", "]"}], ":=", 
        RowBox[{"bgauss", "/", "Bc2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ys", "[", 
         RowBox[{"bgauss_", ",", "omega_", ",", "gamma_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"3", "*", 
            RowBox[{"Brat2", "[", "bgauss", "]"}]}], ")"}]}], "*", 
         RowBox[{"omega", "/", 
          RowBox[{"(", 
           RowBox[{"gamma", "*", 
            RowBox[{"(", 
             RowBox[{"gamma", "-", "omega"}], ")"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Wstuff1", "[", 
         RowBox[{"bg_", ",", "w_", ",", "ga_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"WhittakerW", "[", 
           RowBox[{"0", ",", 
            RowBox[{"4", "/", "3"}], ",", 
            RowBox[{"ys", "[", 
             RowBox[{"bg", ",", "w", ",", "ga"}], "]"}]}], "]"}], "*", 
          RowBox[{"WhittakerW", "[", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"ys", "[", 
             RowBox[{"bg", ",", "w", ",", "ga"}], "]"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"WhittakerW", "[", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"5", "/", "6"}], ",", 
            RowBox[{"ys", "[", 
             RowBox[{"bg", ",", "w", ",", "ga"}], "]"}]}], "]"}], "*", 
          RowBox[{"WhittakerW", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ",", 
            RowBox[{"5", "/", "6"}], ",", 
            RowBox[{"ys", "[", 
             RowBox[{"bg", ",", "w", ",", "ga"}], "]"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Wstuff2", "[", 
         RowBox[{"bg_", ",", "w_", ",", "ga_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"WhittakerW", "[", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"ys", "[", 
             RowBox[{"bg", ",", "w", ",", "ga"}], "]"}]}], "]"}], "^", "2"}], 
         "+", 
         RowBox[{
          RowBox[{"WhittakerW", "[", 
           RowBox[{"1", ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"ys", "[", 
             RowBox[{"bg", ",", "w", ",", "ga"}], "]"}]}], "]"}], "*", 
          RowBox[{"WhittakerW", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"ys", "[", 
             RowBox[{"bg", ",", "w", ",", "ga"}], "]"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Wstuff", "[", 
         RowBox[{"bg_", ",", "w_", ",", "ga_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Wstuff1", "[", 
          RowBox[{"bg", ",", "w", ",", "ga"}], "]"}], "+", 
         RowBox[{"3", "*", "w", "*", 
          RowBox[{
           RowBox[{"Brat2", "[", "bg", "]"}], "/", "4"}], "*", 
          RowBox[{"Wstuff2", "[", 
           RowBox[{"bg", ",", "w", ",", "ga"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jgaom", "[", 
         RowBox[{"bgauss_", ",", "omega_", ",", "gamma_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"q", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"hbar", "*", "c"}], ")"}]}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"me", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}], "^", "2"}], "/", "hbar"}], "*", 
         RowBox[{"(", 
          RowBox[{"omega", "/", 
           RowBox[{"gamma", "^", "2"}]}], ")"}], "*", 
         RowBox[{"Wstuff", "[", 
          RowBox[{"bgauss", ",", "omega", ",", "gamma"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Thetadep4", "[", "T_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"me", "*", 
           RowBox[{"c", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"beta4", "[", "gamma_", "]"}], ":=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"1", "/", 
           RowBox[{"gamma", "^", "2"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fgamfullfree4", "[", "T_", "]"}], ":=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Thetadep4", "[", "T", "]"}], "*", 
           RowBox[{"BesselK", "[", 
            RowBox[{"2", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Thetadep4", "[", "T", "]"}]}]}], "]"}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fgamfullfixedT4", "[", 
         RowBox[{
          RowBox[{"gamma_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"gamma", "^", "2"}], "*", 
         RowBox[{"beta4", "[", "gamma", "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "gamma"}], "/", 
           RowBox[{"Thetadep4", "[", "T", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pqedultrarelother", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"netot6", "[", 
          RowBox[{"rhob", ",", "npairs"}], "]"}], "*", 
         RowBox[{"fgamfullfree4", "[", "T", "]"}], "*", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fgamfullfixedT4", "[", 
             RowBox[{"gamma", ",", "T"}], "]"}], "*", 
            RowBox[{"jgaom", "[", 
             RowBox[{"bgauss", ",", "omega", ",", "gamma"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"omega", ",", "0", ",", "Infinity"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"gamma", ",", 
             RowBox[{"1", "+", "omega"}], ",", "Infinity"}], "}"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Q0synchqedultrarelother", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"Q0synchqedultrarelother", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "=", 
         RowBox[{"Pqedultrarelother", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "netot6", ",", "Thetadep4", ",", "beta4", ",", "fgamfullfree4", ",", 
         "fgamfullfixedT4", ",", "jgaom", ",", "Pqedultrarelother"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.493153956680499*^9, 3.493154072517064*^9}, {
  3.4931720519402046`*^9, 3.49317207355128*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.4931512845982337`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"see", " ", 
    RowBox[{"plancklaw", ".", "nb"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "go", " ", "ahead", " ", "and", " ", "compute", " ", "this", " ", "since", 
    " ", "expensive", " ", "and", " ", "can", " ", "be", " ", "done", " ", 
    "analytically"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tempib1", "[", "x0_", "]"}], "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"BesselK", "[", 
            RowBox[{
             RowBox[{"5", "/", "3"}], ",", "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "x0", ",", "Infinity"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x0", ">", "0"}], "}"}]}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ib1", "[", "x0_", "]"}], ":=", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"tempib1", "[", "x0", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"actually", ",", " ", 
    RowBox[{
    "go", " ", "ahead", " ", "and", " ", "do", " ", "integral", " ", 
     "outside", " ", "and", " ", 
     RowBox[{"copy", "/", "paste"}], " ", "here", " ", "so", " ", "not", " ", 
     "slow", " ", "each", " ", "run", " ", "of", " ", "the", " ", "gamma_jet", 
     RowBox[{"_reconnection", ".", "nb"}], " ", "file"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"too", " ", "slow", " ", "even", " ", "for", " ", "analytical"}], 
   "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ib1", "[", "x0_", "]"}], ":=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"2", "/", "3"}]], " ", 
        RowBox[{"Gamma", "[", 
         FractionBox["2", "3"], "]"}], " ", 
        RowBox[{"HypergeometricPFQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"-", 
            FractionBox["1", "3"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["2", "3"]}], ",", 
            FractionBox["2", "3"]}], "}"}], ",", 
          FractionBox[
           SuperscriptBox["x0", "2"], "4"]}], "]"}]}], 
       SuperscriptBox["x0", 
        RowBox[{"2", "/", "3"}]]], "+", 
      FractionBox[
       RowBox[{"\[Pi]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "320"}], "+", 
          FractionBox[
           RowBox[{"81", " ", 
            SuperscriptBox["2", 
             RowBox[{"1", "/", "3"}]], " ", 
            SuperscriptBox["x0", 
             RowBox[{"8", "/", "3"}]], " ", 
            RowBox[{"HypergeometricPFQ", "[", 
             RowBox[{
              RowBox[{"{", 
               FractionBox["4", "3"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                FractionBox["7", "3"], ",", 
                FractionBox["8", "3"]}], "}"}], ",", 
              FractionBox[
               SuperscriptBox["x0", "2"], "4"]}], "]"}]}], 
           RowBox[{"Gamma", "[", 
            RowBox[{"-", 
             FractionBox["1", "3"]}], "]"}]]}], ")"}]}], 
       RowBox[{"320", " ", 
        SqrtBox["3"]}]]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"analytical", " ", "stuff", " ", "above", " ", "too", " ", 
    RowBox[{"slow", " ", "--"}], " ", "just", " ", "use", " ", "NIntegrate"}],
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"NOTE", ":", " ", 
     RowBox[{"Due", " ", "to", " ", "catastrophic", " ", "cancellation", " ", 
      RowBox[{"(", 
       RowBox[{"not", " ", "tried", " ", "to", " ", "avoid", " ", "yet"}], 
       ")"}]}]}], ",", " ", 
    RowBox[{
    "the", " ", "QED", " ", "Synch", " ", "calculation", " ", "cannot", " ", 
     "be", " ", "used", " ", "for", " ", "small", " ", "Brat", " ", "smaller",
      " ", "than", " ", "about", " ", 
     RowBox[{"Brat", "\\", "sim"}], " ", 
     RowBox[{"0.01", ".", "  ", "Calculation"}], " ", "is", " ", "also", " ", 
     "kinda", " ", "slow", " ", 
     RowBox[{"(", 
      RowBox[{
      "faster", " ", "than", " ", "before", " ", "with", " ", "analytical", 
       " ", "IB1"}], ")"}]}], ",", " ", 
    RowBox[{
    "so", " ", "also", " ", "reason", " ", "to", " ", "avoid", " ", "unless", 
     " ", "QED", " ", "effects", " ", "matter"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getQEDSynch", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "ib1", ",", "xi", ",", "IB1", ",", "sigma", ",", "chi", ",", "Dmu", 
         ",", "B2", ",", "B3", ",", "Kstuff", ",", "jgen", ",", "fgamset", 
         ",", "grandgennew0", ",", "fgamset", ",", "omegalow", ",", 
         "omegahigh", ",", "gammalow", ",", "gammahigh", ",", "netot3", ",", 
         "jgenthermalnew"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Stored", ":", " ", "Q0synchqed"}], ",", "grandgennew"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", 
        RowBox[{"Q0synchqed", ",", "grandgennew"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"QED", " ", "Relativistic", " ", "Synchrotron"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ib1", "[", 
         RowBox[{"x0_", "?", "NumericQ"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"BesselK", "[", 
             RowBox[{
              RowBox[{"5", "/", "3"}], ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "x0", ",", "Infinity"}], "}"}], ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "lowestprec"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xi", "[", 
         RowBox[{"omega_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "omega"}], "/", 
          RowBox[{"Brat", "[", "bgauss", "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gamma", "^", "2"}], "-", "1"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"Brat", "[", "bgauss", "]"}]}], ")"}]}], "*", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "+", "1"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"gamma", "-", "1"}], ")"}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"gamma", "-", "omega"}], ")"}], "^", "2"}], "-", "1"}],
             ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"Brat", "[", "bgauss", "]"}]}], ")"}]}], "*", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "omega", "+", "1"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"gamma", "-", "omega", "-", "1"}], ")"}]}], "]"}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IB1", "[", 
         RowBox[{"omega_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{"ib1", "[", 
         RowBox[{"xi", "[", 
          RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sigma", "[", 
         RowBox[{"omega_", ",", "gamma_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"omega", "^", "2"}], "*", "gamma", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gamma", "-", "omega"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gamma", "^", "2"}], "-", "1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"gamma", "-", "omega"}], ")"}], "^", "2"}], "-", 
              "1"}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chi", "[", 
         RowBox[{"omega_", ",", "gamma_"}], "]"}], ":=", 
        RowBox[{"omega", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gamma", "*", 
             RowBox[{"(", 
              RowBox[{"gamma", "-", "omega"}], ")"}]}], "-", "1", "+", 
            RowBox[{"omega", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gamma", "^", "2"}], "-", "1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"gamma", "-", "omega"}], ")"}], "^", "2"}], "-", 
              "1"}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Dmu", "[", 
         RowBox[{"omega_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"2", "*", "Pi", "*", 
           RowBox[{
            RowBox[{"Brat", "[", "bgauss", "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gamma", "^", "2"}], "-", "1"}], ")"}]}]}], "]"}], "*", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gamma", "-", "omega", "+", "1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"gamma", "-", "1"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"gamma", "-", "omega", "-", "1"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"gamma", "+", "1"}], ")"}]}], ")"}]}]}], "]"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"B2", "[", 
         RowBox[{"omega_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"sigma", "[", 
          RowBox[{"omega", ",", "gamma"}], "]"}], "*", 
         RowBox[{"BesselK", "[", 
          RowBox[{
           RowBox[{"2", "/", "3"}], ",", 
           RowBox[{"xi", "[", 
            RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"B3", "[", 
         RowBox[{"omega_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"chi", "[", 
          RowBox[{"omega", ",", "gamma"}], "]"}], "*", 
         RowBox[{"BesselK", "[", 
          RowBox[{
           RowBox[{"1", "/", "3"}], ",", 
           RowBox[{"xi", "[", 
            RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Kstuff", "[", 
         RowBox[{"omega_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"IB1", "[", 
          RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}], "+", 
         RowBox[{"B2", "[", 
          RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}], "-", 
         RowBox[{"B3", "[", 
          RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Barring", " ", "Equation", " ", "31"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jgen", "[", 
         RowBox[{"omega_", ",", "gamma_", ",", "bgauss_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{"hbar", "*", "c"}], ")"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"me", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}], "^", "2"}], "/", "hbar"}], "*", 
         RowBox[{"(", 
          RowBox[{"omega", "/", 
           RowBox[{"(", 
            RowBox[{"Pi", "*", "gamma"}], ")"}]}], ")"}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"xi", "[", 
            RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi"}], ")"}]}], "]"}], "*", 
         RowBox[{"Dmu", "[", 
          RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}], "*", 
         RowBox[{"Kstuff", "[", 
          RowBox[{"omega", ",", "gamma", ",", "bgauss"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"dw", " ", "\[Rule]", " ", 
          RowBox[{"dw", " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ",", " ", 
         RowBox[{"w", "\[Rule]", " ", 
          RowBox[{"w", " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"g", "\[Rule]", " ", 
           RowBox[{"g", " ", 
            RowBox[{"Sin", "[", "th", "]"}], " ", "and", " ", "Integrating", 
            " ", "over", " ", 
            RowBox[{"d", "\\", "Omega"}]}]}], " ", "=", " ", 
          RowBox[{"dth", " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gamma", "\[Rule]", 
           RowBox[{"gammareal", "*", 
            RowBox[{"Sin", "[", "th", "]"}]}]}], ",", 
          RowBox[{"omega", "\[Rule]", 
           RowBox[{"omegareal", "*", 
            RowBox[{"Sin", "[", "th", "]"}]}]}]}], "}"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grandgennew0", "[", 
         RowBox[{"th_", ",", "omega_", ",", "gamma_", ",", "bgauss_"}], "]"}],
         ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"2", "*", "Pi", "*", 
           RowBox[{"Sin", "[", "th", "]"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"Sin", "[", "th", "]"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"jgen", "[", 
           RowBox[{
            RowBox[{"omega", "*", 
             RowBox[{"Sin", "[", "th", "]"}]}], ",", 
            RowBox[{"gamma", "*", 
             RowBox[{"Sin", "[", "th", "]"}]}], ",", "bgauss"}], "]"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fgamset", "[", 
         RowBox[{"th_", ",", "gamma_", ",", "T_"}], "]"}], ":=", 
        RowBox[{"fgamfullfixedT", "[", 
         RowBox[{
          RowBox[{"gamma", "*", 
           RowBox[{"Sin", "[", "th", "]"}]}], ",", "T"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grandgennew", "[", 
         RowBox[{
         "th_", ",", "omega_", ",", "gamma_", ",", "T_", ",", "bgauss_"}], 
         "]"}], ":=", 
        RowBox[{
         RowBox[{"grandgennew", "[", 
          RowBox[{"th", ",", "omega", ",", "gamma", ",", "T", ",", "bgauss"}],
           "]"}], "=", 
         RowBox[{
          RowBox[{"grandgennew0", "[", 
           RowBox[{"th", ",", "omega", ",", "gamma", ",", "bgauss"}], "]"}], 
          "*", 
          RowBox[{"fgamset", "[", 
           RowBox[{"th", ",", "gamma", ",", "T"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"omegalow", "[", 
         RowBox[{"th_", ",", "gamma_"}], "]"}], ":=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "10"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"omegahigh", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "10"}], ")"}]}]}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"gammareal", "/", 
              RowBox[{"Sin", "[", "th", "]"}]}], "-", "1"}], ")"}]}]}], ";"}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"omegahigh", "[", 
         RowBox[{"th_", ",", "gamma_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "10"}], ")"}]}]}], "+", 
         RowBox[{"(", 
          RowBox[{"gamma", "-", 
           RowBox[{"1", "/", 
            RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gammalow", "[", "th_", "]"}], ":=", 
        RowBox[{"1", "/", 
         RowBox[{"Sin", "[", "th", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gammahigh", "[", "th_", "]"}], ":=", "Infinity"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"netot3", "[", 
         RowBox[{"rhob_", ",", "npairs_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"ne", "[", "rhob", "]"}], " ", "+", " ", "npairs"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "unsure", " ", "if", " ", "total", " ", "or", " ", "just", " ", "ne", 
         " ", "or", " ", "something", " ", "more", " ", "complicatd"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Use", " ", "WorkingPrecision"}], "\[Rule]", 
         RowBox[{
         "15", " ", "below", " ", "seems", " ", "to", " ", "be", " ", "good", 
          " ", "enough", " ", "for", " ", "external", " ", "FindRoot", " ", 
          "to", " ", "work", " ", "with", " ", "WorkingPrecision", " ", "of", 
          " ", "30"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "too", " ", "small", " ", "WorkingPrecision", " ", "here", " ", "and",
          " ", "complains", " ", "about", " ", "convergence", " ", "and", " ",
          "takes", " ", "long", " ", "time", " ", "as", " ", "well"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{",", 
         RowBox[{"WorkingPrecision", "\[Rule]", "slowprec"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"PrecisionGoal", "\[Rule]", "7"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "7"}], ","}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jgenthermalnew", "[", 
         RowBox[{
          RowBox[{"rhob_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}], ",", 
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"thp", ",", "omegap", ",", "gammap"}], "}"}], ",", 
          RowBox[{
           RowBox[{"netot3", "[", 
            RowBox[{"rhob", ",", "npairs"}], "]"}], "*", 
           RowBox[{"fgamfullfree", "[", "T", "]"}], "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{"grandgennew", "[", 
              RowBox[{
              "thp", ",", "omegap", ",", "gammap", ",", "T", ",", "bgauss"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"thp", ",", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "10"}], ")"}]}], ",", 
               RowBox[{"Pi", "-", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "10"}], ")"}]}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"gammap", ",", 
               RowBox[{"gammalow", "[", "thp", "]"}], ",", 
               RowBox[{"gammahigh", "[", "thp", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"omegap", ",", 
               RowBox[{"omegalow", "[", 
                RowBox[{"thp", ",", "gammap"}], "]"}], ",", 
               RowBox[{"omegahigh", "[", 
                RowBox[{"thp", ",", "gammap"}], "]"}]}], "}"}], ",", 
             RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
             RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", " ", "\n", 
             "  ", 
             RowBox[{"Method", " ", "->", " ", "\"\<AdaptiveMonteCarlo\>\""}],
              ",", " ", 
             RowBox[{"MaxPoints", " ", "->", " ", "2000"}]}], "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Q0synchqed", "[", 
         RowBox[{"rhob_", ",", "T_", ",", "bgauss_", ",", "npairs_"}], "]"}], 
        ":=", 
        RowBox[{
         RowBox[{"Q0synchqed", "[", 
          RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
         "=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "foo", "}"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<QED\>\"", "]"}], ";", 
            RowBox[{"jgenthermalnew", "[", 
             RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], 
             "]"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "removed", " ", "AccuracyGoal", " ", "since", " ", "based", " ", 
          "upon", " ", "number", " ", "of", " ", "digits"}], ",", " ", 
         RowBox[{"not", " ", "number", " ", "of", " ", "significant", " ", 
          RowBox[{"digits", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"AccuracyGoal", "\[Rule]", "4"}], ","}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "ib1", ",", "xi", ",", "IB1", ",", "sigma", ",", "chi", ",", "Dmu", 
         ",", "B2", ",", "B3", ",", "Kstuff", ",", "jgen", ",", "fgamset", 
         ",", "grandgennew0", ",", "fgamset", ",", "omegalow", ",", 
         "omegahigh", ",", "gammalow", ",", "gammahigh", ",", "netot3", ",", 
         "jgenthermalnew"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.4770840418540754`*^9, 3.4770841774590654`*^9}, {
   3.477084379489571*^9, 3.4770844142695827`*^9}, 3.4770844594545555`*^9, {
   3.4770859547847347`*^9, 3.477085969075283*^9}, {3.4770861507364993`*^9, 
   3.4770862610050573`*^9}, {3.477086304327352*^9, 3.4770863124390163`*^9}, {
   3.47708648763093*^9, 3.4770865108142653`*^9}, 3.477086929796733*^9, {
   3.4770870573201027`*^9, 3.477087085981315*^9}, {3.477087178504357*^9, 
   3.4770871787447023`*^9}, {3.477174928726795*^9, 3.4771749345651903`*^9}, {
   3.491515351594976*^9, 3.491515364483509*^9}, {3.491518137120365*^9, 
   3.491518152362282*^9}, {3.4916078351698256`*^9, 3.4916078368722734`*^9}, {
   3.4918318055233774`*^9, 3.4918318300386286`*^9}, {3.491831863666984*^9, 
   3.4918321761563215`*^9}, {3.491832216314066*^9, 3.49183238365469*^9}, {
   3.491832414509056*^9, 3.491832559116992*^9}, {3.491832602409243*^9, 
   3.491832603450741*^9}, {3.49183312212656*^9, 3.491833191376136*^9}, {
   3.491839500748568*^9, 3.491839569046776*^9}, {3.49184036679388*^9, 
   3.491840410286419*^9}, {3.491840645574747*^9, 3.4918406869642625`*^9}, {
   3.4918469547569056`*^9, 3.4918469550673523`*^9}, {3.4918474107626095`*^9, 
   3.4918474186439424`*^9}, {3.4918474619962797`*^9, 
   3.4918475185375824`*^9}, {3.491847869702533*^9, 3.491847916009118*^9}, {
   3.491849008870576*^9, 3.4918490219393682`*^9}, {3.491849083728216*^9, 
   3.491849083858403*^9}, {3.491852627393757*^9, 3.4918526965331745`*^9}, {
   3.491860716174853*^9, 3.4918607371249776`*^9}, {3.4918614563091135`*^9, 
   3.4918614675552845`*^9}, {3.4918615012437267`*^9, 3.4918615343513327`*^9}, 
   3.491925920994779*^9, {3.4919262438690495`*^9, 3.4919262695559855`*^9}, {
   3.491930725122776*^9, 3.491930748856904*^9}, {3.4921994477022495`*^9, 
   3.4921995259647856`*^9}, {3.492199664323736*^9, 3.4921996711635714`*^9}, {
   3.492375519050414*^9, 3.4923755310977373`*^9}, {3.492377495872946*^9, 
   3.4923775020518303`*^9}, {3.4923778172550707`*^9, 3.492377820619909*^9}, {
   3.49246484323228*^9, 3.492464846286672*^9}, 3.4925274120725265`*^9, {
   3.4925275853416753`*^9, 3.492527587234397*^9}, {3.4925283067790513`*^9, 
   3.492528312607432*^9}, 3.493086525759597*^9, 3.49308803971656*^9, {
   3.4930909285004272`*^9, 3.493090928600571*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"normmatrix", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"SquaredEuclideanDistance", "[", 
        RowBox[{
         RowBox[{"p1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "ii"}], "]"}], "]"}], ",", 
         RowBox[{"p2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "jj"}], "]"}], "]"}]}], "]"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"p1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"p2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.4937434280748577`*^9, 3.493743428936096*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4939449520220623`*^9, 3.4939449949037232`*^9}, 
   3.4939450280614014`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"minelement", "[", 
     RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ii", ",", "jj", ",", "dist", ",", "dist0", ",", "whichii", ",", 
        "whichjj", ",", "avgpoint", ",", "totalii", ",", "totaljj"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dist0", "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", "30", ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"totalii", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"p1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"totaljj", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"p2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "\[LessEqual]", "totalii"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "\[LessEqual]", "totaljj"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dist", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"SquaredEuclideanDistance", "[", 
                RowBox[{
                 RowBox[{"p1", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1", ",", "ii"}], "]"}], "]"}], ",", 
                 RowBox[{"p2", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1", ",", "jj"}], "]"}], "]"}]}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dist", "<", "dist0"}], ",", 
               RowBox[{
                RowBox[{"dist0", "=", "dist"}], ";", 
                RowBox[{"whichii", "=", "ii"}], ";", 
                RowBox[{"whichjj", "=", "jj"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<dist=\>\"", ",", "dist", ",", "\"\< jj=\>\"", ",", "jj", 
                 ",", "\"\< ii=\>\"", ",", "ii"}], "]"}], ";"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"jj", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"ii", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"avgpoint", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.5", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"p1", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1", ",", "whichii"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"p2", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1", ",", "whichjj"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"0.5", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"p1", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1", ",", "whichii"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"p2", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1", ",", "whichjj"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "avgpoint", ",", "dist0", ",", "whichii", ",", "whichjj", ",", 
         "totalii", ",", "totaljj", ",", 
         RowBox[{"p1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "whichii"}], "]"}], "]"}], ",", 
         RowBox[{"p2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "whichjj"}], "]"}], "]"}]}], "}"}]}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Makeeq1difflist", "[", 
    RowBox[{
    "eq1diff_", ",", "lT0_", ",", "lT1_", ",", "num_", ",", "npairs_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", ",", "lT", ",", "ii", ",", "eq1difftable"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lT", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"lT0", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"lT1", "-", "lT0"}], ")"}], "*", 
           RowBox[{"ii", "/", 
            RowBox[{"(", 
             RowBox[{"num", "-", "1"}], ")"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "0", ",", 
           RowBox[{"num", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"eq1diff", "[", 
        RowBox[{"T", ",", "npairs"}], "]"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"eq1difftable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lT", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", 
           RowBox[{"eq1diff", "[", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"lT", "[", 
               RowBox[{"[", "ii", "]"}], "]"}]}], ",", "npairs"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
      "eq1difftable"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "gensolseq1diff", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gensolseq1diff", "[", 
    RowBox[{"eq1diff_", ",", "npairs_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"gensolseq1diff", "[", 
     RowBox[{"eq1diff", ",", "npairs"}], "]"}], "=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "leta", ",", "list", ",", "lowestprec0", ",", "root", ",", 
        "numele"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"root", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"lowestprec0", "=", "lowestprec"}], ";", "\[IndentingNewLine]", 
       RowBox[{"lowestprec", "=", "30"}], ";", "\[IndentingNewLine]", 
       RowBox[{"list", "=", 
        RowBox[{"Makeeq1difflist", "[", 
         RowBox[{"eq1diff", ",", "6", ",", "15", ",", "200", ",", "npairs"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numele", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "list", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"assume", " ", 
         RowBox[{"monotonic", " ", "--"}], " ", "else", " ", "need", " ", 
         "to", " ", "check", " ", "all", " ", "points", " ", "if", " ", 
         "root", " ", "near"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", "0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"numele", ",", "2"}], "]"}], "]"}], ">", "0"}]}], "||", 
          RowBox[{
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", "0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"numele", ",", "2"}], "]"}], "]"}], "<", "0"}]}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<eq1diffbad(at prec=30, trying again at prec=50=\>\"", ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "\"\< \>\"", ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"numele", ",", "2"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lowestprec", "=", "50"}], ";", "\[IndentingNewLine]", 
          RowBox[{"list", "=", 
           RowBox[{"Makeeq1difflist", "[", 
            RowBox[{
            "eq1diff", ",", "5", ",", "20", ",", "200", ",", "npairs"}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "if", " ", "still", " ", "bad"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", "0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"numele", ",", "2"}], "]"}], "]"}], ">", "0"}]}], "||", 
          RowBox[{
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", "0"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"numele", ",", "2"}], "]"}], "]"}], "<", "0"}]}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"then", " ", "report"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Did not span root: \>\"", ",", "list"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "report", " ", "back", " ", "large", " ", "error", " ", "at", " ",
              "T"}], "=", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"list", "=", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"10", "^", "100"}]}], "}"}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"lowestprec", "=", "lowestprec0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
       "list"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bisecteq1diff", "[", 
    RowBox[{"ftol_", ",", "Ttol_", ",", "eq1diff_", ",", "npairs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "foo", ",", "lowT", ",", "highT", ",", "fmin", ",", "fmax", ",", 
       "error", ",", "myT", ",", "spanroot", ",", "MAXITER", ",", "ferr", ",",
        "ii", ",", "epsf", ",", "epsT"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spanroot", "=", "1"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"assume", " ", "will", " ", "span", " ", "root"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "fmin", " ", "and", " ", "fmax"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"lowT", "=", 
       RowBox[{"10", "^", "5"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"highT", "=", 
       RowBox[{"10", "^", "20"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fmin", "=", 
       RowBox[{"eq1diff", "[", 
        RowBox[{"lowT", ",", "npairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fmax", "=", 
       RowBox[{"eq1diff", "[", 
        RowBox[{"highT", ",", "npairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"fmin", ">", "0"}], "&&", 
          RowBox[{"fmax", ">", "0"}]}], " ", "||", " ", 
         RowBox[{
          RowBox[{"fmin", "<", "0"}], "&&", 
          RowBox[{"fmax", "<", "0"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "need", " ", "to", " ", "expand", " ", "starting", " ", "points"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lowT", "=", 
          RowBox[{"10", "^", "4"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"highT", "=", 
          RowBox[{"10", "^", "25"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fmin", "=", 
          RowBox[{"eq1diff", "[", 
           RowBox[{"lowT", ",", "npairs"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fmax", "=", 
          RowBox[{"eq1diff", "[", 
           RowBox[{"highT", ",", "npairs"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"fmin", ">", "0"}], "&&", 
             RowBox[{"fmax", ">", "0"}]}], " ", "||", " ", 
            RowBox[{
             RowBox[{"fmin", "<", "0"}], "&&", 
             RowBox[{"fmax", "<", "0"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Bisection failure: \>\"", ",", "\"\<fmin=\>\"", ",", "fmin",
               ",", "\"\< fmax=\>\"", ",", "fmax"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"myT", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"epsf", "=", 
             RowBox[{"10", "^", 
              RowBox[{"(", "30", ")"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"epsT", "=", "epsf"}], ";", "\[IndentingNewLine]", 
            RowBox[{"spanroot", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"spanroot", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        " ", 
        RowBox[{"(*", " ", 
         RowBox[{"eq1diff", "[", 
          RowBox[{"T", ",", "npairs"}], "]"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MAXITER", "=", "200"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"ii", "=", "1"}], ",", 
           RowBox[{"ii", "\[LessEqual]", "MAXITER"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"myT", "=", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"lowT", "*", "highT"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ferr", "=", 
             RowBox[{"eq1diff", "[", 
              RowBox[{"myT", ",", "npairs"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<myT=\>\"", ",", "myT", ",", "\"\< ferr=\>\"", ",", "ferr",
                 ",", "\"\< fmin=\>\"", ",", "fmin", ",", "\"\< fmax=\>\"", 
                ",", "fmax"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ferr", ">", "0"}], ",", 
              RowBox[{
               RowBox[{"highT", "=", "myT"}], ";", 
               RowBox[{"fmax", "=", "ferr"}], ";"}], ",", 
              RowBox[{
               RowBox[{"lowT", "=", "myT"}], ";", 
               RowBox[{"fmin", "=", "ferr"}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"epsf", "=", 
             RowBox[{"Abs", "[", "ferr", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"epsT", "=", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"Log", "[", 
                RowBox[{"10", ",", 
                 RowBox[{"highT", "/", "lowT"}]}], "]"}], "]"}], "/", 
              RowBox[{"Abs", "[", 
               RowBox[{"Log", "[", 
                RowBox[{"10", ",", "lowT"}], "]"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "break", " ", "out", " ", "of", " ", "loop", " ", "if", " ", 
              "tolerance", " ", "met"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"epsf", "<", "ftol"}], " ", "||", " ", 
               RowBox[{"epsT", "<", "Ttol"}]}], ",", 
              RowBox[{
               RowBox[{"ii", "=", 
                RowBox[{"MAXITER", "+", "1"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"ii", "++"}], ";"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "loop"}], " ", "*)"}], "\[IndentingNewLine]", 
       "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"end", " ", "if", " ", "spanned", " ", "root"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"myT", ",", "epsf", ",", "epsT"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Gets", " ", "Aum", " ", 
     RowBox[{"(", 
      RowBox[{"rhobcenter", "/", "rhobvalue"}], ")"}], " ", "and", " ", "T", 
     " ", "assuming", " ", "npairs"}], "=", "0"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "assumes", " ", "rhobrad", " ", "and", " ", "rhobnorm", " ", "same", " ", 
    "and", " ", "that", " ", "bgaussnorm", " ", "and", " ", "bgaussrad", " ", 
    "same"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getTA", "[", 
     RowBox[{
     "rhobnorm0_", ",", "rhobrad0_", ",", "bgaussnorm0_", ",", 
      "bgaussrad0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "npairs0", ",", "lrhoblow", ",", "lrhobhigh", ",", "lTlow",
         ",", "lThigh", ",", "RELTOL", ",", "useminmethod", ",", "ntrials", 
        ",", "goodpoint", ",", "triali", ",", "errorTA", ",", "pTA1", ",", 
        "pTA2", ",", "errorlrhob", ",", "errorlT", ",", "pickpoint", ",", 
        "doprintdebug0", ",", "minresult", ",", "errorpoint", ",", "MAXERROR",
         ",", "methodCPTAFR", ",", "okerrorlT", ",", "okerrorlrhob", ",", 
        "myT", ",", "myrhob", ",", "solstrial", ",", "solsTAtrial"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"npairs0", "=", "0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "initial", " ", "error", " ", "as", " ", "large", " ", 
         "so", " ", "triggers", " ", "to", " ", "find", " ", "solution"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RELTOL", "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "10"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"errorTA", "=", 
        RowBox[{
         RowBox[{"10", "^", "30"}], "*", "RELTOL"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "bad", " ", "sol", " ", "so", " ", "easily", " ", "seen", " ", "when",
          " ", "debugging", " ", "if", " ", "this", " ", "is", " ", "not", 
         " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"solsTAtrial", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "\[Rule]", "0"}], ",", 
          RowBox[{"rhobforA", "\[Rule]", "0"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "setup", " ", "equations", " ", "to", " ", "root", " ", "find", " ", 
         "on"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "[", 
        RowBox[{
        "eqTA1diff", ",", "eqTA2diff", ",", "Qum0func", ",", "rhobcenterfunc",
          ",", "eqTAtotdiff"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Qum0func", "[", 
         RowBox[{"bgauss_", "?", "NumericQ"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"bgauss", "^", "2"}], "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "Pi", "*", 
           RowBox[{"Lpnum", "/", "vaout"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rhobcenterfunc", "[", 
         RowBox[{
          RowBox[{"rhob_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}], ",", 
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Qtot", "[", 
          RowBox[{
          "rhob", ",", "rhob", ",", "T", ",", "bgauss", ",", "bgauss", ",", 
           "npairs"}], "]"}], "/", 
         RowBox[{"Qum0func", "[", "bgauss", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqTA1diff", "[", 
         RowBox[{
          RowBox[{"rhob_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}], ",", 
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Pm", "-", 
           RowBox[{"Pg", "[", 
            RowBox[{
            "rhob", ",", "rhob", ",", "T", ",", "bgauss", ",", "bgauss", ",", 
             "npairs"}], "]"}]}], ")"}], "/", "Pm"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqTA2diff", "[", 
         RowBox[{
          RowBox[{"rhob_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}], ",", 
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rhob", "-", 
           RowBox[{"rhobcenterfunc", "[", 
            RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}]}],
           ")"}], "/", "rhobingoing"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqTAtotdiff", "[", 
         RowBox[{
          RowBox[{"rhob_", "?", "NumericQ"}], ",", 
          RowBox[{"T_", "?", "NumericQ"}], ",", 
          RowBox[{"bgauss_", "?", "NumericQ"}], ",", 
          RowBox[{"npairs_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"eqTA1diff", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "^", "2"}], "+", 
         RowBox[{
          RowBox[{"eqTA2diff", "[", 
           RowBox[{"rhob", ",", "T", ",", "bgauss", ",", "npairs"}], "]"}], 
          "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{
        "eqTA1diff", ",", "eqTA2diff", ",", "Qum0func", ",", "rhobcenterfunc",
          ",", "eqTAtotdiff"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Use", " ", "ContourPlot", " ", "to", " ", "seek", " ", "out", " ", 
         "shared", " ", "root"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ntrials", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"goodpoint", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"triali", "=", "1"}], ",", 
         RowBox[{"triali", "\[LessEqual]", "ntrials"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"errorTA", ">", "RELTOL"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"assume", " ", "only", " ", "can", " ", "compress"}], 
              ",", " ", 
              RowBox[{"not", " ", "decompress"}], ",", " ", 
              RowBox[{
              "so", " ", "lower", " ", "rho", " ", "limit", " ", "is", " ", 
               RowBox[{"rhobingoing", ".", "  ", "Note"}], " ", "that", " ", 
               "solution", 
               RowBox[{"(", "s", ")"}], " ", "are", " ", "present", " ", 
               "for", " ", "decompression"}], ",", " ", 
              RowBox[{
              "so", " ", "have", " ", "to", " ", "avoid", " ", "them"}]}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"triali", "\[Equal]", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "any", " ", "higher", " ", "lT", " ", "than", " ", "9", " ", 
                 "and", " ", "pairs", " ", "important", " ", "and", " ", 
                 "then", " ", "full", " ", "3", "D", " ", "root", " ", 
                 "finding", " ", "would", " ", "be", " ", "needed"}], " ", 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"lTlow", "=", "4"}], ";", 
                RowBox[{"lThigh", "=", "9"}], ";", "\[IndentingNewLine]", 
                RowBox[{"lrhoblow", "=", 
                 RowBox[{"Log", "[", 
                  RowBox[{"10", ",", "rhobingoing"}], "]"}]}], ";", 
                RowBox[{"lrhobhigh", "=", 
                 RowBox[{"Log", "[", 
                  RowBox[{"10", ",", 
                   RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"(", "15", ")"}]}], "*", "rhobingoing"}]}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "sometimes", " ", "pairs", " ", "are", " ", "very", " ", 
               "negligible", " ", "and", " ", "then", " ", "temperature", " ",
                "can", " ", "be", " ", "quite", " ", "high"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"triali", "\[Equal]", "2"}], "&&", 
                RowBox[{"goodpoint", "\[Equal]", "0"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<Trying Expanded\>\"", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"lTlow", "=", "4"}], ";", 
                RowBox[{"lThigh", "=", "11"}], ";", "\[IndentingNewLine]", 
                RowBox[{"lrhoblow", "=", 
                 RowBox[{"Log", "[", 
                  RowBox[{"10", ",", "rhobingoing"}], "]"}]}], ";", 
                RowBox[{"lrhobhigh", "=", 
                 RowBox[{"Log", "[", 
                  RowBox[{"10", ",", 
                   RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"(", "25", ")"}]}], "*", "rhobingoing"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"pTA1old", "=", "pTA1"}], ";", 
                RowBox[{"pTA2old", "=", "pTA2"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "sometimes", " ", "good", " ", "point", " ", "found", " ", 
               "but", " ", "FindRoot", " ", "not", " ", "given", " ", "good", 
               " ", "enough", " ", "initial", " ", "value"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"In", " ", "that", " ", "case"}], ",", " ", 
               RowBox[{"zoom", "-", 
                RowBox[{
                "in", " ", "around", " ", "good", " ", "point", " ", "within",
                  " ", "error", " ", "found", " ", "already"}]}]}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"triali", "\[Equal]", "2"}], "&&", 
                RowBox[{"goodpoint", "\[Equal]", "1"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<Trying goodpoint zoom\>\"", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"lTlow", "=", 
                 RowBox[{
                  RowBox[{"pickpoint", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"errorlT", "*", "2"}], ",", "1"}], "]"}]}]}], ";", 
                RowBox[{"lThigh", "=", 
                 RowBox[{
                  RowBox[{"pickpoint", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"errorlT", "*", "2"}], ",", "1"}], "]"}]}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"lrhoblow", "=", 
                 RowBox[{
                  RowBox[{"pickpoint", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"errorlrhob", "*", "2"}], ",", "1"}], "]"}]}]}], 
                ";", 
                RowBox[{"lrhobhigh", "=", 
                 RowBox[{
                  RowBox[{"pickpoint", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"errorlrhob", "*", "2"}], ",", "1"}], "]"}]}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Get", " ", "contour", " ", "plots"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<CPTA1\>\"", "]"}], ";"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"doprintdebug0", "=", "doprintdebug"}], ";", 
             RowBox[{"doprintdebug", "=", "0"}], ";", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "avoids", " ", "excessive", " ", "debug", " ", "while", " ", 
               "getting", " ", "plots"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"pTA1", "=", 
              RowBox[{"ContourPlot", "[", 
               RowBox[{
                RowBox[{"0", "\[Equal]", 
                 RowBox[{"eqTA1diff", "[", 
                  RowBox[{
                   RowBox[{"10", "^", "lrhob"}], ",", 
                   RowBox[{"10", "^", "lT"}], ",", "bgaussnorm", ",", 
                   "npairs0"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"lT", ",", "lTlow", ",", "lThigh"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lrhob", ",", "lrhoblow", ",", "lrhobhigh"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"doprintdebug", "=", "doprintdebug0"}], ";", " ", 
             RowBox[{"(*", " ", 
              RowBox[{"recover", " ", "value"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<CPTA2\>\"", "]"}], ";"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"doprintdebug0", "=", "doprintdebug"}], ";", 
             RowBox[{"doprintdebug", "=", "0"}], ";", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "avoids", " ", "excessive", " ", "debug", " ", "while", " ", 
               "getting", " ", "plots"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"pTA2", "=", 
              RowBox[{"ContourPlot", "[", 
               RowBox[{
                RowBox[{"0", "\[Equal]", 
                 RowBox[{"eqTA2diff", "[", 
                  RowBox[{
                   RowBox[{"10", "^", "lrhob"}], ",", 
                   RowBox[{"10", "^", "lT"}], ",", "bgaussnorm", ",", 
                   "npairs0"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"lT", ",", "lTlow", ",", "lThigh"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"lrhob", ",", "lrhoblow", ",", "lrhobhigh"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"doprintdebug", "=", "doprintdebug0"}], ";", " ", 
             RowBox[{"(*", " ", 
              RowBox[{"recover", " ", "value"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<CPATdone\>\"", "]"}], ";", 
                RowBox[{"pTA1global", "=", "pTA1"}], ";", 
                RowBox[{"pTA2global", "=", "pTA2"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "only", " ", "pick", " ", "point", " ", "if", " ", "Contour", 
               " ", "plots", " ", "worked"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"pTA1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], " ", "&&", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"pTA2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", 
                    RowBox[{"pTA1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], " ", "&&", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", 
                    RowBox[{"pTA2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"minresult", "=", 
                    RowBox[{"minelement", "[", 
                    RowBox[{"pTA1", ",", "pTA2"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"errorpoint", "=", 
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"MAXERROR", "=", "1"}], ";", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "max", " ", "overall", " ", "log", " ", "error", " ", 
                    "which", " ", "we", " ", "call", " ", "a", " ", "good", 
                    " ", "point", " ", "that", " ", "we", " ", "can", " ", 
                    "zoom", " ", "in", " ", "on"}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"goodpoint", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"errorpoint", ">", "MAXERROR"}], ",", "0", ",", 
                    "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"goodpoint", "\[Equal]", "0"}], ",", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<No good CPTA point to pick: minresult\>\"", ",", 
                    "minresult"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"pickpoint", "=", 
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"errorlT", "=", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", 
                    RowBox[{"7", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"errorlrhob", "=", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", 
                    RowBox[{"7", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"methodCPTAFR", "=", "2"}], ";", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"2", " ", "gets", " ", "job", " ", "done"}], ",", 
                    " ", 
                    RowBox[{
                    RowBox[{
                    "1", " ", "can", " ", "be", " ", "problem", " ", "when", 
                    " ", "one", " ", "of", " ", "solutions", " ", "zig"}], 
                    "-", 
                    RowBox[{
                    "zags", " ", "on", " ", "small", " ", "scales"}]}]}], " ",
                     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Only", " ", "FindRoot", " ", "if", " ", "still", " ", 
                    "kinda", " ", "bad", " ", 
                    RowBox[{"error", " ", "--"}], " ", "dont", " ", "need", 
                    " ", "these", " ", "to", " ", "be", " ", "super", " ", 
                    "accurate"}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"okerrorlT", "=", "0.1"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"okerrorlrhob", "=", "0.1"}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"methodCPTAFR", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"if", " ", "good", " ", "enough", " ", "error"}], 
                    ",", " ", 
                    RowBox[{
                    "then", " ", "avoid", " ", "Findroot", " ", "and", " ", 
                    "just", " ", "assign"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"errorlT", "<", "okerrorlT"}], " ", "&&", " ", 
                    RowBox[{"errorlrhob", "<", "okerrorlrhob"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myT", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"pickpoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "lowestprec"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"myrhob", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"pickpoint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "lowestprec"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"solstrial", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"T", "\[Rule]", "myT"}], ",", 
                    RowBox[{"rhob", "\[Rule]", "myrhob"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"errorTA", "=", "0"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"end", " ", "if", " ", "methodCPTAFR"}], 
                    "\[Equal]", "2"}], " ", "*)"}], "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"methodCPTAFR", "\[Equal]", "1"}], " ", "||", " ", 
                    RowBox[{"errorlT", ">", "okerrorlT"}], " ", "||", " ", 
                    RowBox[{"errorlrhob", ">", "okerrorlrhob"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<TAFR\>\"", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"solstrial", "=", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"eqTA1diff", "[", 
                    RowBox[{
                    RowBox[{"10", "^", "x"}], ",", 
                    RowBox[{"10", "^", "y"}]}], "]"}], "==", "0"}], ",", 
                    RowBox[{
                    RowBox[{"eqTA2diff", "[", 
                    RowBox[{
                    RowBox[{"10", "^", "x"}], ",", 
                    RowBox[{"10", "^", "y"}]}], "]"}], "\[Equal]", "0"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"pickpoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"pickpoint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"myT", "=", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"solstrial", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myrhob", "=", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"solstrial", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myT", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"myT", ",", "lowestprec"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myrhob", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"myrhob", ",", "lowestprec"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"errorTA", "=", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"eqTAtotdiff", "[", 
                    RowBox[{"myT", ",", "myrhob"}], "]"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{"end", " ", "if", " ", "methodCPTAFR"}], 
                   "\[Equal]", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"end", " ", "Dimension", " ", "inner", " ", "check"}], 
               " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
             RowBox[{"(*", " ", 
              RowBox[{"end", " ", "Dimension", " ", "outer", " ", "check"}], 
              " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"errorTA", ">", "RELTOL"}], " ", "&&", " ", 
                RowBox[{"myT", ">", 
                 RowBox[{"10", "^", "8"}]}]}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<ContourPlot+FindRoot failed\>\"", ",", "\"\< min=\>\"", 
                  ",", "errorTA"}], "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "less", " ", "strict", " ", "on", " ", "error", " ", "at", " ", 
               "low", " ", "temperatures", " ", "if", " ", "FR", " ", "got", 
               " ", "a", " ", "solution"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "reset", " ", "errorTnpairs", " ", "if", " ", "want", " ", "to",
                " ", "pass", " ", "solution", " ", "through"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"errorTA", ">", "0.5"}], " ", "&&", 
                RowBox[{"myT", "<", 
                 RowBox[{"10", "^", "8"}]}]}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<ContourPlot+FindRoot failed\>\"", ",", "\"\< min=\>\"", 
                  ",", "errorTA"}], "]"}], ";"}], ",", 
               RowBox[{
                RowBox[{"errorTA", "=", "0"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"don", "'"}], "t", " ", "set", " ", "or", " ", 
                "print"}], "-", 
               RowBox[{
               "out", " ", "solution", " ", "if", " ", "failed", " ", "to", 
                " ", "get", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"errorTA", "<", "RELTOL"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "jump", " ", "out", " ", "of", " ", "loop", " ", "if", " ", 
                 "got", " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"triali", "=", 
                 RowBox[{"ntrials", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"and", " ", "set", " ", "solution"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"solsTAtrial", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"T", "\[Rule]", "myT"}], ",", 
                   RowBox[{"rhobforA", "\[Rule]", "myrhob"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<solsTAtrial=\>\"", ",", "solsTAtrial"}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<errorTA=\>\"", ",", "errorTA"}], "]"}]}], 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"end", " ", "if"}], " ", "<", "RELTOL"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"end", " ", "bit", " ", "outer", " ", "if"}], " ", "<", 
            "RELTOL"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"triali", "=", 
           RowBox[{"triali", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "loop"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"return", " ", "solution", " ", "and", " ", "error"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"solsTAtrial", ",", "errorTA"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.4941492794230833`*^9, 3.4941499113517523`*^9, {3.4941512338133583`*^9, 
   3.4941512607420797`*^9}, 3.4941518025611773`*^9, {3.4941518377918367`*^9, 
   3.494151872591877*^9}, {3.4941525701549234`*^9, 3.494152622430091*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "First", " ", "check", " ", "trivial", " ", "case", " ", "where", " ", 
     "npairs"}], "=", 
    RowBox[{"0", " ", "is", " ", "best", " ", "solution"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getTnpairs0", "[", 
     RowBox[{
     "eq1diff_", ",", "eq2diff_", ",", "rhobnorm0_", ",", "rhobrad0_", ",", 
      "bgaussnorm0_", ",", "bgaussrad0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "npairsguess", ",", "RELTOL", ",", "errorTnpairs", ",", 
        "bisectreturn", ",", "Ttol", ",", "myT", ",", "epsf", ",", "epsT", 
        ",", "solsTtrial", ",", "eq2diffnum", ",", "mynpairssol"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"npairsguess", "=", "0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "initial", " ", "error", " ", "as", " ", "large", " ", 
         "so", " ", "triggers", " ", "to", " ", "find", " ", "solution"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RELTOL", "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "10"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"errorTnpairs", "=", 
        RowBox[{
         RowBox[{"10", "^", "30"}], "*", "RELTOL"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "bad", " ", "sol", " ", "so", " ", "easily", " ", "seen", " ", "when",
          " ", "debugging", " ", "if", " ", "this", " ", "is", " ", "not", 
         " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"solsTtrial", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "\[Rule]", "0"}], ",", 
          RowBox[{"npairs", "\[Rule]", "0"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"find", " ", "good", " ", "guess"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Before gensolseq1diff\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"solslist", "=", 
          RowBox[{"gensolseq1diff", "[", 
           RowBox[{"eq1diff", ",", "npairsguess"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", "\"\<Before findelement for eq1diff\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"root", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"lTguess", "=", 
          RowBox[{
           RowBox[{"findelement", "[", 
            RowBox[{"root", ",", "solslist"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Tguess", "=", 
          RowBox[{"10", "^", "lTguess"}]}], ";"}], "\[IndentingNewLine]", 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "bisect", " ", "good", " ", "because", " ", "eq1diff", " ", "can", 
          " ", "jump", " ", "in", " ", "value", " ", "near", " ", "root"}], 
         ",", " ", 
         RowBox[{
         "never", " ", "really", " ", "getting", " ", "close", " ", "to", " ",
           "zero", " ", "but", " ", "still", " ", "\"\<crossing\>\"", " ", 
          "through", " ", 
          RowBox[{"it", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Ttol", "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Trying Bisection for npairs=0\>\"", "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"bisectreturn", "=", 
        RowBox[{"bisecteq1diff", "[", 
         RowBox[{"RELTOL", ",", "Ttol", ",", "eq1diff", ",", "npairsguess"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"myT", ",", "epsf", ",", "epsT"}], "}"}], "=", 
        "bisectreturn"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"now", " ", "find", " ", "root"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sols", "=", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"eq1diff", "[", 
             RowBox[{"T", ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", "Tguess"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myT", "=", 
          RowBox[{"sols", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "now", " ", "check", " ", "eq2diff", " ", "to", " ", "see", " ", 
          "if", " ", "npairs"}], "=", 
         RowBox[{
         "0", " ", "works", " ", "at", " ", "this", " ", "temperature"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "only", " ", "do", " ", "this", " ", "check", " ", "if", " ", 
         "bisect", " ", "worked", " ", "to", " ", "either", " ", "get", " ", 
         "eq1diff", " ", "small", " ", "or", " ", "at", " ", "least", " ", 
         "T", " ", "near", " ", "root"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eq2diffnum", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{"eq2diff", "[", 
          RowBox[{"myT", ",", "npairsguess"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"eq2diffnum", "<", "RELTOL"}], " ", "&&", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "epsf", "]"}], "<", "RELTOL"}], "||", 
            RowBox[{
             RowBox[{"Abs", "[", "epsT", "]"}], "<", "Ttol"}]}], ")"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Got npairs=0 solution!\>\"", ",", "\"\< eq2diffnum=\>\"", 
               ",", "eq2diffnum"}], "]"}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<bisectreturn=\>\"", ",", "bisectreturn"}], "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<eq1diffparms:\>\"", ",", "rhobnorm0", ",", "\"\< \>\"", 
               ",", "rhobrad0", ",", "\"\< \>\"", ",", "bgaussnorm0", ",", 
               "\"\< \>\"", ",", "bgaussrad0"}], "]"}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<eq1diffparms:\>\"", ",", 
               RowBox[{"Precision", "[", "rhobnorm0", "]"}], ",", "\"\< \>\"",
                ",", 
               RowBox[{"Precision", "[", "rhobrad0", "]"}], ",", "\"\< \>\"", 
               ",", 
               RowBox[{"Precision", "[", "bgaussnorm0", "]"}], ",", 
               "\"\< \>\"", ",", 
               RowBox[{"Precision", "[", "bgaussrad0", "]"}]}], "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"set", " ", "solution"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"mynpairssol", "=", "0"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"myT", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{"myT", ",", "lowestprec"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mynpairssol", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{"mynpairssol", ",", "lowestprec"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"solsTtrial", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "\[Rule]", "myT"}], ",", 
             RowBox[{"npairs", "\[Rule]", "mynpairssol"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"errorTnpairs", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Then", " ", 
          RowBox[{"done", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", "]"}], 
       ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"if", " ", "eq2diff", " ", "check"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"solsTtrial", ",", "errorTnpairs"}], "}"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"trynpairs0case", "\[Equal]", "1"}], ","}], " "}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.4941492945448275`*^9, 3.4941492947351007`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "method"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"minmethod0func", "[", 
     RowBox[{
     "eq1diff_", ",", "eq2diff_", ",", "rhobnorm0_", ",", "rhobrad0_", ",", 
      "bgaussnorm0_", ",", "bgaussrad0_", ",", "errorother_", ",", 
      "useminmethod_", ",", "myT_", ",", "mynpairssol_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "GUESSRELTOL", ",", "Tguess", ",", "npairsguess", ",", 
        "Tgoodguess", ",", "level1", ",", "level2", ",", "nlevel1", ",", 
        "nlevel2", ",", "var10", ",", "var20", ",", "solsguess", ",", 
        "solstrial", ",", "solsTtrial"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "most", " ", "basic", " ", "guess"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GUESSRELTOL", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"errorother", "<", "GUESSRELTOL"}], " ", "&&", " ", 
          RowBox[{"useminmethod", "\[Equal]", "2"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "then", " ", "use", " ", "previous", " ", "\"\<failed\>\"", " ", 
           "result", " ", "as", " ", "a", " ", "guess"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Tguess", "=", "myT"}], ";", "\[IndentingNewLine]", 
          RowBox[{"npairsguess", "=", "mynpairssol"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"else", " ", "use", " ", "typical", " ", "guess"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Tgoodguess", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Pm", "/", "arad"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "4"}], ")"}]}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"assumes", " ", "radiation", " ", "dominated"}], ",", " ", 
            RowBox[{"which", " ", "typically", " ", "is"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Tguess", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{"Tgoodguess", ",", "lowestprec"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"npairsguess", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"ne", "[", "rhobrad", "]"}], ",", "lowestprec"}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"get", " ", "better", " ", 
          RowBox[{"guess", ":", " ", 
           RowBox[{"cast", " ", "wide", " ", "net"}]}]}], ",", " ", 
         RowBox[{
         "then", " ", "bit", " ", "more", " ", "shallow", " ", "net"}], ",", 
         " ", 
         RowBox[{"before", " ", "using", " ", 
          RowBox[{"Newton", "'"}], "s", " ", "method"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"lowestprec", "=", "MachinePrecision"}], ";", 
       RowBox[{"slowprec", "=", "MachinePrecision"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "level1"}], "=", 
         RowBox[{
          RowBox[{"0.5", " ", "and", " ", "nevels1"}], "=", 
          RowBox[{
           RowBox[{"10", " ", "with", " ", "Tguess"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"10", "^", "9"}], " ", "goes", " ", 
             RowBox[{"like", ":", " ", 
              RowBox[{
               RowBox[{"10", "^", "4"}], " ", "-", " ", 
               RowBox[{
                RowBox[{"10", "^", "14"}], " ", "and", " ", "nevel2"}]}]}]}], 
            "=", 
            RowBox[{
             RowBox[{"2", " ", "nevel2"}], "=", 
             RowBox[{
              RowBox[{"10", " ", 
               RowBox[{"w", "/", " ", "npairsguess"}]}], "=", 
              RowBox[{
               RowBox[{"10", "^", "13"}], " ", "goes", " ", 
               RowBox[{"like", ":", " ", 
                RowBox[{
                 RowBox[{"10", "^", 
                  RowBox[{"-", "7"}]}], " ", "-", " ", 
                 RowBox[{"10", "^", "23"}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"level1", "=", "0.25"}], ";", " ", 
       RowBox[{"level2", "=", "1"}], ";", 
       RowBox[{"nlevel1", "=", "20"}], ";", 
       RowBox[{"nlevel2", "=", "20"}], ";", " ", 
       RowBox[{"var10", "=", "Tguess"}], ";", 
       RowBox[{"var20", "=", "npairsguess"}], ";", "\[IndentingNewLine]", 
       RowBox[{"solsguess", "=", 
        RowBox[{"gettemperaturegetguess", "[", 
         RowBox[{
         "level1", ",", "level2", ",", "nlevel1", ",", "nlevel2", ",", 
          "eq1diff", ",", "eq2diff", ",", "var10", ",", "var20"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"level1", "=", 
          RowBox[{"level1", "/", "2"}]}], ";", " ", 
         RowBox[{"level2", "=", 
          RowBox[{"level2", "/", "2"}]}], ";", 
         RowBox[{"nlevel1", "=", "10"}], ";", 
         RowBox[{"nlevel2", "=", "10"}], ";", 
         RowBox[{"var10", "=", 
          RowBox[{"solsguess", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"var20", "=", 
          RowBox[{"solsguess", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", 
         RowBox[{"solsguess", "=", 
          RowBox[{"gettemperaturegetguess", "[", 
           RowBox[{
           "level1", ",", "level2", ",", "nlevel1", ",", "nlevel2", ",", 
            "eq1diff", ",", "eq2diff", ",", "var10", ",", "var20"}], "]"}]}], 
         ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"level1", "=", 
        RowBox[{"level2", "/", "8"}]}], ";", " ", 
       RowBox[{"level2", "=", 
        RowBox[{"level2", "/", "8"}]}], ";", 
       RowBox[{"nlevel1", "=", "10"}], ";", 
       RowBox[{"nlevel2", "=", "10"}], ";", 
       RowBox[{"var10", "=", 
        RowBox[{"solsguess", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"var20", "=", 
        RowBox[{"solsguess", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"solsguess", "=", 
        RowBox[{"gettemperaturegetguess", "[", 
         RowBox[{
         "level1", ",", "level2", ",", "nlevel1", ",", "nlevel2", ",", 
          "eq1diff", ",", "eq2diff", ",", "var10", ",", "var20"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "get", " ", "solution", " ", "for", " ", "T", " ", "and", " ", 
         "npairs"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"CAREFUL", ":", " ", 
         RowBox[{
         "Using", " ", "high", " ", "WorkingPrecision", " ", "can", " ", 
          "lead", " ", "to", " ", "FindRoot", " ", "offsetting", " ", 
          RowBox[{"indep", "'"}], "s", " ", "by", " ", "too", " ", "small", 
          " ", "a", " ", "value", " ", "to", " ", "show", " ", "up", " ", 
          "as", " ", "new", " ", "function", " ", "value"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"lowestprec", "=", "30"}], ";", 
       RowBox[{"slowprec", "=", "15"}], ";", 
       RowBox[{"myprecfindroot", "=", "MachinePrecision"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"re", "-", 
         RowBox[{
         "get", " ", "general", " ", "functions", " ", "with", " ", "new", 
          " ", "precision"}]}], " ", "*)"}], "\[IndentingNewLine]", "getPUNQ",
        ";", "\[IndentingNewLine]", 
       RowBox[{"level1", "=", ".5"}], ";", " ", 
       RowBox[{"level2", "=", "2"}], ";", 
       RowBox[{"nlevel1", "=", "5"}], ";", 
       RowBox[{"nlevel2", "=", "5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"solstrial", "=", 
        RowBox[{"gettemperature", "[", 
         RowBox[{
         "level1", ",", "level2", ",", "nlevel1", ",", "nlevel2", ",", 
          "eq1diff", ",", "eq2diff", ",", 
          RowBox[{"solsguess", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solsguess", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myT", "=", 
        RowBox[{"solstrial", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mynpairssol", "=", 
        RowBox[{"solstrial", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myT", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"myT", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mynpairssol", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"mynpairssol", ",", "lowestprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"solsTtrial", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "\[Rule]", "myT"}], ",", 
          RowBox[{"npairs", "\[Rule]", "mynpairssol"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"return", " ", "-", " ", 
          RowBox[{
          "0", " ", "error", " ", "assumes", " ", "found", " ", 
           "solution"}]}], ",", " ", 
         RowBox[{"but", " ", "may", " ", "not", " ", "have"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"solsTtrial", ",", "0"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"end", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"useminmethod", "\[Equal]", "0"}], " ", "||", " ", 
        RowBox[{"errorTnpairs", ">", "RELTOL"}]}], ","}], " "}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{3.4941493100871763`*^9, 3.494149912343178*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Try", " ", "using", " ", "NMinimize", " ", "on", " ", "combined", " ", 
    "equation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"minmethod1func", "[", 
     RowBox[{
     "eqtotdiff_", ",", "rhobnorm0_", ",", "rhobrad0_", ",", "bgaussnorm0_", 
      ",", "bgaussrad0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "min", ",", "solstrial", ",", "myT", ",", "mynpairssol", 
        ",", "errorTnpairs", ",", "truemynpairs", ",", "solsTtrial", ",", 
        "RELTOL"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "initial", " ", "error", " ", "as", " ", "large", " ", 
        "so", " ", "triggers", " ", "to", " ", "find", " ", "solution"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RELTOL", "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "10"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"errorTnpairs", "=", 
        RowBox[{
         RowBox[{"10", "^", "30"}], "*", "RELTOL"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "bad", " ", "sol", " ", "so", " ", "easily", " ", "seen", " ", "when",
          " ", "debugging", " ", "if", " ", "this", " ", "is", " ", "not", 
         " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"solsTtrial", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "\[Rule]", "0"}], ",", 
          RowBox[{"npairs", "\[Rule]", "0"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "now", " ", "comes", " ", "methods", " ", "that", " ", "work", " ", 
           "for", " ", "non"}], "-", 
          RowBox[{
          "zero", " ", "npairs", " ", "and", " ", "can", " ", "sometimes", 
           " ", "work", " ", "even", " ", "if", " ", "npairs"}]}], "\[Rule]", 
         "0"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"lowestprec", "=", "MachinePrecision"}], ";", 
       RowBox[{"slowprec", "=", "MachinePrecision"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"min", ",", "solstrial"}], "}"}], "=", 
          RowBox[{"NMinimize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"eqtotdiff", "[", 
               RowBox[{"x", ",", "y"}], "]"}], ",", 
              RowBox[{"x", ">", "0"}], ",", 
              RowBox[{"y", ">", "0"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"min", ",", "solstrial"}], "}"}], "=", 
        RowBox[{"NMinimize", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eqtotdiff", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myT", "=", 
        RowBox[{"solstrial", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mynpairssol", "=", 
        RowBox[{"solstrial", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "errorTnpairs", " ", "should", " ", "be", " ", "kept", " ", "as", " ",
          "global", " ", "variable"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"errorTnpairs", "=", 
        RowBox[{"Abs", "[", "min", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"solsTtrial", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"T", "->", 
             RowBox[{"solstrial", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
            RowBox[{"npairs", "->", 
             RowBox[{"solstrial", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"when", " ", "npairs", " ", "negligible"}], ",", " ", 
         RowBox[{
         "need", " ", "to", " ", "compute", " ", "directly", " ", "since", 
          " ", "eq2diff", " ", "always", " ", "small"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "essentially", " ", "this", " ", "is", " ", "limit", " ", "when", " ",
          "2", 
         RowBox[{"eqs", "/", "2"}], "unkns", " ", "becomes", " ", "1", 
         RowBox[{"eq", "/", "1"}], "unkn"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"truemynpairs", "=", 
        RowBox[{"npairsfunc", "[", 
         RowBox[{
         "rhobrad0", ",", "myT", ",", "bgaussrad0", ",", "mynpairssol"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solsTtrial", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "\[Rule]", "myT"}], ",", 
          RowBox[{"npairs", "->", "truemynpairs"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"errorTnpairs", ">", "RELTOL"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<NMinimize failed\>\"", ",", "\"\< min=\>\"", ",", 
            "errorTnpairs"}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"solsTtrial", ",", "errorTnpairs"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{3.4941493220944414`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Use", " ", "ContourPlot", " ", "to", " ", "seek", " ", "out", " ", 
    "shared", " ", "root"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"minmethod2func", "[", 
     RowBox[{
     "eq1diff_", ",", "eq2diff_", ",", "rhobnorm0_", ",", "rhobrad0_", ",", 
      "bgaussnorm0_", ",", "bgaussrad0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "ntrials", ",", "goodpoint", ",", "triali", ",", 
        "errorTnpairs", ",", "RELTOL", ",", "solsTtrial", ",", "Tmid", ",", 
        "Tbaryon", ",", "npairstest", ",", "npairsavg", ",", "yavg", ",", 
        "ylow", ",", "yhigh", ",", "lTlow", ",", "lThigh", ",", "lnpairslow", 
        ",", "lnpairshigh", ",", "p1old", ",", "p2old", ",", "p1", ",", "p2", 
        ",", "pickpoint", ",", "errorlT", ",", "errorlnpairs", ",", 
        "minresult", ",", "errorpoint", ",", "MAXERROR", ",", "methodCPFR", 
        ",", "okerrorlT", ",", "okerrorlnpairs", ",", "mynpairssol", ",", 
        "myT", ",", "solstrial", ",", "truemynpairs"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "initial", " ", "error", " ", "as", " ", "large", " ", 
        "so", " ", "triggers", " ", "to", " ", "find", " ", "solution"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RELTOL", "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "10"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"errorTnpairs", "=", 
        RowBox[{
         RowBox[{"10", "^", "30"}], "*", "RELTOL"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "bad", " ", "sol", " ", "so", " ", "easily", " ", "seen", " ", "when",
          " ", "debugging", " ", "if", " ", "this", " ", "is", " ", "not", 
         " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"solsTtrial", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "\[Rule]", "0"}], ",", 
          RowBox[{"npairs", "\[Rule]", "0"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ntrials", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"goodpoint", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"triali", "=", "1"}], ",", 
         RowBox[{"triali", "\[LessEqual]", "ntrials"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"errorTnpairs", ">", "RELTOL"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Tmid", "=", 
              RowBox[{"me", "*", 
               RowBox[{
                RowBox[{"c", "^", "2"}], "/", "kb"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Tbaryon", "=", 
              RowBox[{"Pm", "*", 
               RowBox[{"mb", "/", 
                RowBox[{"(", 
                 RowBox[{"kb", "*", "rhobvalue"}], ")"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"npairstest", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Tbaryon", ">", "Tmid"}], ",", 
                RowBox[{"npairsfunc", "[", 
                 RowBox[{"rhobvalue", ",", "Tmid", ",", "bgaussrad", ",", 
                  RowBox[{"ne", "[", "rhobvalue", "]"}]}], "]"}], ",", 
                RowBox[{"ne", "[", "rhobvalue", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"can", "'"}], "t", " ", "find", " ", "good", " ", 
                "bootstrap", " ", "besides", " ", "ne"}], ",", " ", 
               RowBox[{"but", " ", "that", " ", "eventually", " ", 
                RowBox[{"can", "'"}], "t", " ", "work", " ", "for", " ", 
                "very", " ", "optically", " ", "thick", " ", "regions"}], ",",
                " ", 
               RowBox[{
               "so", " ", "have", " ", "to", " ", "use", " ", "very", " ", 
                "broad", " ", "ylow", " ", "to", " ", "yhigh", " ", 
                "range"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"npairsavg", "=", 
              RowBox[{"ne", "[", "rhobvalue", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"yavg", "=", 
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", "npairsavg"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ylow", "=", 
              RowBox[{"yavg", "-", "15"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"yhigh", "=", 
              RowBox[{"yavg", "+", "15"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"ylow", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ylow", "<", "0"}], ",", "0", ",", "ylow"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"triali", "\[Equal]", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"lTlow", "=", "6"}], ";", 
                RowBox[{"lThigh", "=", "15"}], ";", 
                RowBox[{"lnpairslow", "=", "ylow"}], ";", 
                RowBox[{"lnpairshigh", "=", "yhigh"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "sometimes", " ", "pairs", " ", "are", " ", "very", " ", 
               "negligible", " ", "and", " ", "then", " ", "temperature", " ",
                "can", " ", "be", " ", "quite", " ", "high"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"triali", "\[Equal]", "2"}], "&&", 
                RowBox[{"goodpoint", "\[Equal]", "0"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<Trying Expanded\>\"", "]"}], ";", 
                RowBox[{"lTlow", "=", "5"}], ";", 
                RowBox[{"lThigh", "=", "20"}], ";", 
                RowBox[{"lnpairslow", "=", 
                 RowBox[{"-", "40"}]}], ";", 
                RowBox[{"lnpairshigh", "=", "yhigh"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"p1old", "=", "p1"}], ";", 
                RowBox[{"p2old", "=", "p2"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "sometimes", " ", "good", " ", "point", " ", "found", " ", 
               "but", " ", "FindRoot", " ", "not", " ", "given", " ", "good", 
               " ", "enough", " ", "initial", " ", "value"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"In", " ", "that", " ", "case"}], ",", " ", 
               RowBox[{"zoom", "-", 
                RowBox[{
                "in", " ", "around", " ", "good", " ", "point", " ", "within",
                  " ", "error", " ", "found", " ", "already"}]}]}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"triali", "\[Equal]", "2"}], "&&", 
                RowBox[{"goodpoint", "\[Equal]", "1"}]}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<Trying goodpoint zoom\>\"", "]"}], 
                ";", 
                RowBox[{"lTlow", "=", 
                 RowBox[{
                  RowBox[{"pickpoint", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"errorlT", "*", "2"}], ",", "1"}], "]"}]}]}], ";", 
                RowBox[{"lThigh", "=", 
                 RowBox[{
                  RowBox[{"pickpoint", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"errorlT", "*", "2"}], ",", "1"}], "]"}]}]}], ";", 
                RowBox[{"lnpairslow", "=", 
                 RowBox[{
                  RowBox[{"pickpoint", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"errorlnpairs", "*", "2"}], ",", "1"}], "]"}]}]}],
                 ";", 
                RowBox[{"lnpairshigh", "=", 
                 RowBox[{
                  RowBox[{"pickpoint", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"errorlnpairs", "*", "2"}], ",", "1"}], "]"}]}]}],
                 ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<CP1\>\"", "]"}], ";"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"p1", "=", 
              RowBox[{"ContourPlot", "[", 
               RowBox[{
                RowBox[{"0", "\[Equal]", 
                 RowBox[{"eq1diff", "[", 
                  RowBox[{
                   RowBox[{"10", "^", "x"}], ",", 
                   RowBox[{"10", "^", "y"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "lTlow", ",", "lThigh"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "lnpairslow", ",", "lnpairshigh"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<CP2\>\"", "]"}], ";"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"p2", "=", 
              RowBox[{"ContourPlot", "[", 
               RowBox[{
                RowBox[{"0", "\[Equal]", 
                 RowBox[{"eq2diff", "[", 
                  RowBox[{
                   RowBox[{"10", "^", "x"}], ",", 
                   RowBox[{"10", "^", "y"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "lTlow", ",", "lThigh"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "lnpairslow", ",", "lnpairshigh"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<CPdone\>\"", "]"}], ";", 
                RowBox[{"p1global", "=", "p1"}], ";", 
                RowBox[{"p2global", "=", "p2"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "only", " ", "pick", " ", "point", " ", "if", " ", "Contour", 
               " ", "plots", " ", "worked"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], " ", "&&", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"p2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ">", "0"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], " ", "&&", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", 
                    RowBox[{"p2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", "0"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"minresult", "=", 
                    RowBox[{"minelement", "[", 
                    RowBox[{"p1", ",", "p2"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"errorpoint", "=", 
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"MAXERROR", "=", "1"}], ";", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "max", " ", "overall", " ", "log", " ", "error", " ", 
                    "which", " ", "we", " ", "call", " ", "a", " ", "good", 
                    " ", "point", " ", "that", " ", "we", " ", "can", " ", 
                    "zoom", " ", "in", " ", "on"}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"goodpoint", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"errorpoint", ">", "MAXERROR"}], ",", "0", ",", 
                    "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"goodpoint", "\[Equal]", "0"}], ",", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<No good CP point to pick: minresult\>\"", ",", 
                    "minresult"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"pickpoint", "=", 
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"errorlT", "=", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", 
                    RowBox[{"7", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"errorlnpairs", "=", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", 
                    RowBox[{"7", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"minresult", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"methodCPFR", "=", "2"}], ";", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"2", " ", "gets", " ", "job", " ", "done"}], ",", 
                    " ", 
                    RowBox[{
                    RowBox[{
                    "1", " ", "can", " ", "be", " ", "problem", " ", "when", 
                    " ", "one", " ", "of", " ", "solutions", " ", "zig"}], 
                    "-", 
                    RowBox[{
                    "zags", " ", "on", " ", "small", " ", "scales"}]}]}], " ",
                     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Only", " ", "FindRoot", " ", "if", " ", "still", " ", 
                    "kinda", " ", "bad", " ", 
                    RowBox[{"error", " ", "--"}], " ", "dont", " ", "need", 
                    " ", "these", " ", "to", " ", "be", " ", "super", " ", 
                    "accurate"}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"okerrorlT", "=", "0.1"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"okerrorlnpairs", "=", "0.1"}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"methodCPFR", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"if", " ", "good", " ", "enough", " ", "error"}], 
                    ",", " ", 
                    RowBox[{
                    "then", " ", "avoid", " ", "Findroot", " ", "and", " ", 
                    "just", " ", "assign"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"errorlT", "<", "okerrorlT"}], " ", "&&", " ", 
                    RowBox[{"errorlnpairs", "<", "okerrorlnpairs"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myT", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"pickpoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "lowestprec"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"mynpairssol", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"pickpoint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "lowestprec"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"solstrial", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"T", "\[Rule]", "myT"}], ",", 
                    RowBox[{"npairs", "\[Rule]", "mynpairssol"}]}], "}"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"errorTnpairs", "=", "0"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"end", " ", "if", " ", "methodCPFR"}], "\[Equal]",
                     "2"}], " ", "*)"}], "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"methodCPFR", "\[Equal]", "1"}], " ", "||", " ", 
                    RowBox[{"errorlT", ">", "okerrorlT"}], " ", "||", " ", 
                    RowBox[{"errorlnpairs", ">", "okerrorlnpairs"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<FR\>\"", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"solstrial", "=", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"eq1diff", "[", 
                    RowBox[{
                    RowBox[{"10", "^", "x"}], ",", 
                    RowBox[{"10", "^", "y"}]}], "]"}], "==", "0"}], ",", 
                    RowBox[{
                    RowBox[{"eq2diff", "[", 
                    RowBox[{
                    RowBox[{"10", "^", "x"}], ",", 
                    RowBox[{"10", "^", "y"}]}], "]"}], "\[Equal]", "0"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"pickpoint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", 
                    RowBox[{"pickpoint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"myT", "=", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"solstrial", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"mynpairssol", "=", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"solstrial", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myT", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"myT", ",", "lowestprec"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"mynpairssol", "=", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"mynpairssol", ",", "lowestprec"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"errorTnpairs", "=", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"eqtotdiff", "[", 
                    RowBox[{"myT", ",", "mynpairssol"}], "]"}], "]"}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{"end", " ", "if", " ", "methodCPFR"}], "\[Equal]", 
                   "1"}], " ", "*)"}], "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", "]"}], ";"}]}], 
              RowBox[{"(*", " ", 
               RowBox[{"end", " ", "Dimension", " ", "inner", " ", "check"}], 
               " ", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
             RowBox[{"(*", " ", 
              RowBox[{"end", " ", "Dimension", " ", "outer", " ", "check"}], 
              " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"errorTnpairs", ">", "RELTOL"}], " ", "&&", " ", 
                RowBox[{"myT", ">", 
                 RowBox[{"10", "^", "8"}]}]}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<ContourPlot+FindRoot failed\>\"", ",", "\"\< min=\>\"", 
                  ",", "errorTnpairs"}], "]"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "less", " ", "strict", " ", "on", " ", "error", " ", "at", " ", 
               "low", " ", "temperatures", " ", "if", " ", "FR", " ", "got", 
               " ", "a", " ", "solution"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "reset", " ", "errorTnpairs", " ", "if", " ", "want", " ", "to",
                " ", "pass", " ", "solution", " ", "through"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"errorTnpairs", ">", "0.5"}], " ", "&&", 
                RowBox[{"myT", "<", 
                 RowBox[{"10", "^", "8"}]}]}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<ContourPlot+FindRoot failed\>\"", ",", "\"\< min=\>\"", 
                  ",", "errorTnpairs"}], "]"}], ";"}], ",", 
               RowBox[{
                RowBox[{"errorTnpairs", "=", "0"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"don", "'"}], "t", " ", "set", " ", "or", " ", 
                "print"}], "-", 
               RowBox[{
               "out", " ", "solution", " ", "if", " ", "failed", " ", "to", 
                " ", "get", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"errorTnpairs", "<", "RELTOL"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "jump", " ", "out", " ", "of", " ", "loop", " ", "if", " ", 
                 "got", " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"triali", "=", 
                 RowBox[{"ntrials", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"and", " ", "set", " ", "solution"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"truemynpairs", "=", 
                 RowBox[{"npairsfunc", "[", 
                  RowBox[{
                  "rhobrad", ",", "myT", ",", "bgaussrad", ",", 
                   "mynpairssol"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"solsTtrial", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"T", "\[Rule]", "myT"}], ",", 
                   RowBox[{"npairs", "->", "truemynpairs"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<solsTtrial=\>\"", ",", "solsTtrial"}], 
                   "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<errorTnpairs=\>\"", ",", "errorTnpairs"}], 
                   "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
             ";"}]}], 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"end", " ", "if"}], " ", "<", "RELTOL"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"end", " ", "bit", " ", "outer", " ", "if"}], " ", "<", 
            "RELTOL"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"triali", "=", 
           RowBox[{"triali", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "loop"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"solsTtrial", ",", "errorTnpairs"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"end", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"useminmethod", "\[Equal]", "2"}], ","}], " "}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.494149336675408*^9, {3.4941499131743727`*^9, 3.4941499144962735`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "major", " ", "function", " ", "to", " ", "get", " ", "temperature"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gettemperaturewrapper", "[", 
      RowBox[{
      "rhobnorm0_", ",", "rhobrad0_", ",", "bgaussnorm0_", ",", 
       "bgaussrad0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", 
         RowBox[{"rhobnorm", "=", "rhobnorm0"}], ",", 
         RowBox[{"rhobrad", "=", "rhobrad0"}], ",", 
         RowBox[{"bgaussnorm", "=", "bgaussnorm0"}], ",", 
         RowBox[{"bgaussrad", "=", "bgaussrad0"}], ",", "myT", ",", 
         "mynpairssol", ",", "truemynpairs", ",", "Pbnum", ",", "Tmid", ",", 
         "Tbaryon", ",", "npairstest", ",", "npairsavg", ",", "triali", ",", 
         "lTlow", ",", "lThigh", ",", "lnpairslow", ",", "lnpairshigh", ",", 
         "ntrials", ",", "minresult", ",", "goodpoint", ",", "errorpoint", 
         ",", "okerrorlT", ",", "okerrorlnpairs", ",", "methodCPFR", ",", 
         "MAXERROR", ",", "failed", ",", "root", ",", "npairsguess", ",", 
         "lTguess", ",", "Tguess", ",", "sols", ",", "trynpairs0case", ",", 
         "RELTOL", ",", "Ttol", ",", "epsf", ",", "epsT", ",", "eq2diffnum", 
         ",", "Aumlocal"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"0", "=", 
          RowBox[{
          "try", " ", "to", " ", "find", " ", "MIN", " ", "itself"}]}], ",", 
         " ", 
         RowBox[{"then", " ", "feed", " ", "to", " ", "FindRoot"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"1", "==", 
         RowBox[{
         "much", " ", "more", " ", "robust", " ", "for", " ", "this", " ", 
          "particular", " ", "simple", " ", "2", " ", "equations", " ", "and",
           " ", "2", " ", "unknowns", " ", "since", " ", "visually", " ", 
          "can", " ", "tell", " ", "a", " ", "kinda", " ", "of", " ", "2", 
          "D", " ", "bisection", " ", "would", " ", "be", " ", "good", " ", 
          "enough"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "1", " ", "can", " ", "take", " ", "long", " ", "time", " ", "for", 
          " ", "no", " ", "good", " ", 
          RowBox[{"reason", ".", "  ", "Sometimes"}], " ", "fast"}], ",", " ", 
         RowBox[{"but", " ", "sometimes", " ", "very", " ", 
          RowBox[{"slow", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"2", "\[Equal]", 
         RowBox[{"ContourPlot", "+", 
          RowBox[{"FindRoot", " ", ":", " ", 
           RowBox[{
           "seems", " ", "to", " ", "be", " ", "fastest", " ", "and", " ", 
            "safest", " ", "and", " ", 
            RowBox[{"doesn", "'"}], "t", " ", "get", " ", "stuck", " ", 
            "like", " ", "1"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"useminmethod", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"trynpairs0case", "=", "1"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "whether", " ", "to", " ", "check", " ", "if", " ", "npairs"}], "=", 
          RowBox[{
          "0", " ", "is", " ", "a", " ", "solution", " ", "so", " ", "just", 
           " ", "1", "D", " ", "problem"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "setup", " ", "equations", " ", "to", " ", "find", " ", "root", " ", 
          "of"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Unprotect", "[", "Pgfunc", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Pgfunc", "[", 
          RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Pg", "[", 
           RowBox[{
           "rhobnorm", ",", "rhobrad", ",", "T", ",", "bgaussnorm", ",", 
            "bgaussrad", ",", "npairs"}], "]"}], "//.", "consts"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Protect", "[", "Pgfunc", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Pbnum", "=", "Pm"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"force", " ", "balance", " ", "condition"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Unprotect", "[", 
         RowBox[{"eq1diff", ",", "eq2diff", ",", "eqtotdiff"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{"eq1diff", ",", "eq2diff"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "both", " ", "are", " ", "relative", " ", "differences", " ", "and",
            " ", "reasonably", " ", "normalized"}], ",", " ", 
          RowBox[{"but", " ", "when", " ", "lots", " ", "of", " ", "pairs"}], 
          ",", " ", 
          RowBox[{
          "using", " ", "$n_e$", " ", "to", " ", "normalize", " ", "might", 
           " ", "be", " ", "too", " ", "much", " ", "of", " ", "a", " ", 
           "constraint", " ", "to", " ", "have", " ", "a", " ", "relative", 
           " ", "error", " ", "much", " ", "less", " ", "than", " ", 
           "unity"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eq1diff", "[", 
          RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pgfunc", "[", 
              RowBox[{"T", ",", "npairs"}], "]"}], "-", "Pbnum"}], ")"}], "/",
            "Pbnum"}], "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "problem", " ", "with", " ", "below", " ", "eq2diff", " ", "is", 
           " ", "that", " ", "if", " ", "npairs", 
           RowBox[{"<<", "ne"}]}], ",", " ", 
          RowBox[{
          "then", " ", "npairs", " ", "can", " ", "be", " ", "set", " ", "to",
            " ", "any", " ", "smaller", " ", "value", " ", "and", " ", 
           RowBox[{"Abs", "[", "eq2diff", "]"}], " ", "becomes", " ", 
           RowBox[{"<<", "1"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eq2diff", "[", 
          RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"npairs", "-", 
             RowBox[{"npairsfunc", "[", 
              RowBox[{"rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
              "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"ne", "[", "rhobrad", "]"}], ")"}]}], "//.", "consts"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "try", " ", "normalizing", " ", "pairs", " ", "with", " ", "pre"}], 
          "-", 
          RowBox[{"suppressed", " ", "pair", " ", 
           RowBox[{"density", ".", " ", 
            RowBox[{
             RowBox[{"--", " ", "doesn"}], "'"}]}], "t", " ", "work"}]}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"eq2diff", "[", 
            RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"npairs", "-", 
               RowBox[{"npairsfunc", "[", 
                RowBox[{
                "rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
                "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"npairs0", "[", 
               RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad"}], "]"}], 
              ")"}]}], "//.", "consts"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"try", " ", "normalizing", " ", "directly", " ", "by", " ", 
          RowBox[{"npairsfunc", " ", "--"}], " ", 
          RowBox[{"doesn", "'"}], "t", " ", "work"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"eq2diff", "[", 
            RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"npairs", "-", 
               RowBox[{"npairsfunc", "[", 
                RowBox[{
                "rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
                "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"npairsfunc", "[", 
               RowBox[{"rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}],
                "]"}], ")"}]}], "//.", "consts"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Protect", "[", 
         RowBox[{"eq1diff", ",", "eq2diff"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eqtotdiff", "[", 
          RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"eq1diff", "[", 
            RowBox[{"T", ",", "npairs"}], "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"eq2diff", "[", 
            RowBox[{"T", ",", "npairs"}], "]"}], "^", "2"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Protect", "[", "eqtotdiff", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "set", " ", "initial", " ", "error", " ", "as", " ", "large", " ", 
          "so", " ", "triggers", " ", "to", " ", "find", " ", "solution"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"RELTOL", "=", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "10"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"errorTnpairs", "=", 
         RowBox[{
          RowBox[{"10", "^", "30"}], "*", "RELTOL"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "bad", " ", "sol", " ", "so", " ", "easily", " ", "seen", " ", 
          "when", " ", "debugging", " ", "if", " ", "this", " ", "is", " ", 
          "not", " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"solsTtrial", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"T", "\[Rule]", "0"}], ",", 
           RowBox[{"npairs", "\[Rule]", "0"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"trynpairs0case", "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"resultTnpairs0", "=", 
            RowBox[{"getTnpairs0", "[", 
             RowBox[{
             "eq1diff", ",", "eq2diff", ",", "rhobnorm", ",", "rhobrad", ",", 
              "bgaussnorm", ",", "bgaussrad"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"solsTtrial", "=", 
            RowBox[{"resultTnpairs0", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"errorTnpairs", "=", 
            RowBox[{"resultTnpairs0", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"if", " ", "npairs"}], "=", "0"}], ",", " ", 
             RowBox[{
             "can", " ", "find", " ", "Aum", " ", "kinda", " ", "easily"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"errorTnpairs", "<", "RELTOL"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Aumlocal", "=", "getAumitself"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"RELTOLAum", "=", "0.2"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"Aumlocal", "-", "1"}], "]"}], ">", "RELTOLAum"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"resultTA", "=", 
                  RowBox[{"getTA", "[", 
                   RowBox[{
                   "rhobnorm", ",", "rhobrad", ",", "bgaussnorm", ",", 
                    "bgaussrad"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"solsTA", "=", 
                  RowBox[{"resultTA", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"errorTA", "=", 
                  RowBox[{"resultTA", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"errorTA", "<", "RELTOL"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{"ITERATED", ":", " ", "rhobcenter"}], " ", "*)"}],
                    "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"rhobcenter", "=", 
                    RowBox[{"solsTA", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"errorTnpairs", "=", "0"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               RowBox[{"(*", " ", 
                RowBox[{
                "end", " ", "if", " ", "good", " ", "TA", " ", "error"}], " ",
                 "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"end", " ", "if", " ", "Aumlocal"}], ">", "1"}], "*)"}],
             "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "end", " ", "if", " ", "good", " ", "Tnpairs", " ", "error"}], " ", 
          "*)"}], "\[IndentingNewLine]", "]"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"end", " ", "if", " ", "getting", " ", "npairs"}], "=", 
          RowBox[{"0", " ", "solution"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"errorTnpairs", ">", "RELTOL"}], ",", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"useminmethod", "==", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"resultmin1", "=", 
               RowBox[{"minmethod1func", "[", 
                RowBox[{
                "eqtotdiff", ",", "rhobnorm", ",", "rhobrad", ",", 
                 "bgaussnorm", ",", "bgaussrad"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"solsTtrial", "=", 
               RowBox[{"resultmin1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"errorTnpairs", "=", 
               RowBox[{"resultmin1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"useminmethod", "\[Equal]", "2"}], "||", " ", 
              RowBox[{"errorTnpairs", ">", "RELTOL"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"resultmin2", "=", 
               RowBox[{"minmethod2func", "[", 
                RowBox[{
                "eq1diff", ",", "eq2diff", ",", "rhobnorm", ",", "rhobrad", 
                 ",", "bgaussnorm", ",", "bgaussrad"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"solsTtrial", "=", 
               RowBox[{"resultmin2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"errorTnpairs", "=", 
               RowBox[{"resultmin2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"useminmethod", "\[Equal]", "0"}], " ", "||", " ", 
              RowBox[{"errorTnpairs", ">", "RELTOL"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"resultmin0", "=", 
               RowBox[{"minmethod0func", "[", 
                RowBox[{
                "eq1diff", ",", "eq2diff", ",", "rhobnorm", ",", "rhobrad", 
                 ",", "bgaussnorm", ",", "bgaussrad", ",", "errorTnpairs", 
                 ",", "useminmethod", ",", 
                 RowBox[{"solsTtrial", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"solsTtrial", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"solsTtrial", "=", 
               RowBox[{"resultmin0", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"errorTnpairs", "=", 
               RowBox[{"resultmin0", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "end", " ", "overall", " ", "RELTOL", " ", "check", " ", "before", 
          " ", "doing", " ", "various", " ", "methods"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"myTmev", "=", 
         RowBox[{
          RowBox[{"kb", "*", 
           RowBox[{"T", "/", "ergPmev"}]}], "//.", 
          RowBox[{"{", 
           RowBox[{"T", "->", 
            RowBox[{"solsTtrial", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<myTmev=\>\"", ",", "myTmev", ",", "\"\< npairs/ne=\>\"", ",", 
             RowBox[{
              RowBox[{"solsTtrial", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", 
              RowBox[{"ne", "[", "rhobrad", "]"}]}], ",", "\"\< error=\>\"", 
             ",", "errorTnpairs"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
        "solsTtrial"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.494149367890293*^9, 3.4941493767530365`*^9}, {
   3.4941494424675293`*^9, 3.4941494672531695`*^9}, {3.494149560246888*^9, 
   3.4941495681282206`*^9}, {3.494149915367526*^9, 3.4941499192531137`*^9}, {
   3.4941510017596817`*^9, 3.4941510045036273`*^9}, {3.4941510353980513`*^9, 
   3.4941510941925936`*^9}, 3.4941536355969534`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gettemperaturetestguess", "[", 
    RowBox[{
    "rhobnorm0_", ",", "rhobrad0_", ",", "Tnorm0_", ",", "Trad0_", ",", 
     "bgaussnorm0_", ",", "bgaussrad0_", ",", "npairsnorm0_", ",", 
     "npairsrad0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", ",", 
       RowBox[{"rhobnorm", "=", "rhobnorm0"}], ",", 
       RowBox[{"rhobrad", "=", "rhobrad0"}], ",", 
       RowBox[{"Tnorm", "=", "Tnorm0"}], ",", 
       RowBox[{"Trad", "=", "Trad0"}], ",", 
       RowBox[{"bgaussnorm", "=", "bgaussnorm0"}], ",", 
       RowBox[{"bgaussrad", "=", "bgaussrad0"}], ",", 
       RowBox[{"npairsnorm", "=", "npairsnorm0"}], ",", 
       RowBox[{"npairsrad", "=", "npairsrad0"}], ",", "Pbnum"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Unprotect", "[", "Pgfunc", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pgfunc", "[", 
        RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Pg", "[", 
         RowBox[{
         "rhobnorm", ",", "rhobrad", ",", "T", ",", "bgaussnorm", ",", 
          "bgaussrad", ",", "npairs"}], "]"}], "//.", "consts"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", "Pgfunc", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pbnum", "=", "Pm"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"force", " ", "balance", " ", "condition"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Unprotect", "[", 
       RowBox[{"eq1diff", ",", "eq2diff"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{"eq1diff", ",", "eq2diff"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "both", " ", "are", " ", "relative", " ", "differences", " ", "and", 
         " ", "reasonably", " ", "normalized"}], ",", " ", 
        RowBox[{"but", " ", "when", " ", "lots", " ", "of", " ", "pairs"}], 
        ",", " ", 
        RowBox[{
        "using", " ", "$n_e$", " ", "to", " ", "normalize", " ", "might", " ",
          "be", " ", "too", " ", "much", " ", "of", " ", "a", " ", 
         "constraint", " ", "to", " ", "have", " ", "a", " ", "relative", " ",
          "error", " ", "much", " ", "less", " ", "than", " ", "unity"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eq1diff", "[", 
        RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pgfunc", "[", 
            RowBox[{"T", ",", "npairs"}], "]"}], "-", "Pbnum"}], ")"}], "/", 
         "Pbnum"}], "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eq2diff", "[", 
        RowBox[{"T_", ",", "npairs_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"npairs", "-", 
           RowBox[{"npairsfunc", "[", 
            RowBox[{"rhobrad", ",", "T", ",", "bgaussrad", ",", "npairs"}], 
            "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"ne", "[", "rhobrad", "]"}], ")"}]}], "//.", "consts"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", 
       RowBox[{"eq1diff", ",", "eq2diff"}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "most", " ", "basic", " ", "guess"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Tguess", "=", "Tnorm"}], ";", "\[IndentingNewLine]", 
      RowBox[{"npairsguess", "=", "npairsnorm"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "get", " ", "solution", " ", "for", " ", "T", " ", "and", " ", 
        "npairs"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"level1", "=", "0"}], ";", " ", 
      RowBox[{"level2", "=", "0"}], ";", 
      RowBox[{"nlevel1", "=", "1"}], ";", 
      RowBox[{"nlevel2", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"solstrial", "=", 
       RowBox[{"gettemperature", "[", 
        RowBox[{
        "level1", ",", "level2", ",", "nlevel1", ",", "nlevel2", ",", 
         "eq1diff", ",", "eq2diff", ",", "Tguess", ",", "npairsguess"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solsTtrial", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T", "\[Rule]", 
          RowBox[{"solstrial", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"npairs", "\[Rule]", 
          RowBox[{"solstrial", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"myTmev", "=", 
       RowBox[{
        RowBox[{"kb", "*", 
         RowBox[{"T", "/", "ergPmev"}]}], "//.", 
        RowBox[{"{", 
         RowBox[{"T", "->", 
          RowBox[{"solsTtrial", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<myTmev=\>\"", ",", "myTmev", ",", "\"\< npairs/ne=\>\"", ",", 
           RowBox[{
            RowBox[{"solsTtrial", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", 
            RowBox[{"ne", "[", "rhobrad", "]"}]}]}], "]"}], ";"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
      "solsTtrial"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"get", " ", "both", " ", "T", " ", "and", " ", "npairs"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gettemperature", "[", 
      RowBox[{
      "level10_", ",", "level20_", ",", "nlevel10_", ",", "nlevel20_", ",", 
       "eq1diff_", ",", "eq2diff_", ",", "var100_", ",", "var200_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", 
         RowBox[{"level1", "=", "level10"}], ",", 
         RowBox[{"level2", "=", "level20"}], ",", 
         RowBox[{"nlevel1", "=", "nlevel10"}], ",", 
         RowBox[{"nlevel2", "=", "nlevel20"}], ",", "ii", ",", "jj", ",", 
         "var1", ",", 
         RowBox[{"var10", "=", "var100"}], ",", "myvar1", ",", "var10list", 
         ",", "numvar10", ",", "var2", ",", 
         RowBox[{"var20", "=", "var200"}], ",", "myvar2", ",", "var20list", 
         ",", "numvar20", ",", "erroreq1", ",", "erroreq2", ",", "error0eq1", 
         ",", "error0eq2", ",", "myprec", ",", "sols0", ",", "sols", ",", 
         "fulleq1", ",", "fulleq2", ",", "errorroot", ",", "debugformat", ",",
          "RELTOL", ",", "nn", ",", "var1orig", ",", "var2orig"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"solsT", "=", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"Pg", "\[Equal]", "Pm"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{"10", "^", 
               RowBox[{"(", "10", ")"}]}]}], "}"}], ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "20"}]}], "]"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"solsT", "=", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"Ug", "\[Equal]", "Um"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{"10", "^", 
               RowBox[{"(", "10", ")"}]}]}], "}"}], ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "20"}]}], "]"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Problems", " ", "getting", " ", "root", " ", "with", " ", "bad", 
          " ", "guess"}], ",", " ", 
         RowBox[{"so", " ", "do", " ", "below"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Also", ",", " ", 
         RowBox[{
         "problem", " ", "with", " ", "FindRoot", " ", "not", " ", 
          "returning", " ", "correct", " ", "answer", " ", "if", " ", 
          "anything", " ", "odd", " ", "happens", " ", "like", " ", 
          "Overflow"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myprec", "=", "lowestprec"}], ";", "\[IndentingNewLine]", 
        RowBox[{"debugformat", "=", "0"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"0", " ", "=", " ", 
          RowBox[{
           RowBox[{"normal", " ", ":", " ", "1"}], " ", "=", " ", 
           RowBox[{
           "show", " ", "error", " ", "per", " ", "initial", " ", 
            "point"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fulleq1", "[", 
          RowBox[{
           RowBox[{"var1_", "?", "NumericQ"}], ",", 
           RowBox[{"var2_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"eq1diff", "[", 
             RowBox[{"var1", ",", "var2"}], "]"}], "]"}], ",", "myprec"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fulleq2", "[", 
          RowBox[{
           RowBox[{"var1_", "?", "NumericQ"}], ",", 
           RowBox[{"var2_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"eq2diff", "[", 
             RowBox[{"var1", ",", "var2"}], "]"}], "]"}], ",", "myprec"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"fulleq1", "[", 
            RowBox[{"var1_", ",", "var2_"}], "]"}], ":=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"eq1diff", "[", 
               RowBox[{"var1", ",", "var2"}], "]"}], "]"}], ",", "myprec"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fulleq2", "[", 
            RowBox[{"var1_", ",", "var2_"}], "]"}], ":=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"eq2diff", "[", 
               RowBox[{"var2", ",", "var2"}], "]"}], "]"}], ",", "myprec"}], 
            "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"random", " ", "error"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"var1orig", "=", "var10"}], ";", "\[IndentingNewLine]", 
        RowBox[{"var2orig", "=", "var20"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "default", " ", "solution", " ", "in", " ", "case", " ", "nothing", 
          " ", "good", " ", "found"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sols", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"T", "\[Rule]", "var1orig"}], ",", 
           RowBox[{"npairs", "\[Rule]", "var2orig"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"erroreq1", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"fulleq1", "[", 
           RowBox[{"var1orig", ",", "var2orig"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"erroreq2", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"fulleq2", "[", 
           RowBox[{"var1orig", ",", "var2orig"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "probe", " ", "various", " ", "starting", " ", "points", " ", 
          "rather", " ", "than", " ", "a", " ", "single", " ", "starting", 
          " ", "point", " ", "with", " ", "many", " ", "iterations"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "start", " ", "with", " ", "most", " ", "plausible", " ", "and", 
           " ", "move", " ", "to", " ", "least", " ", "plausible"}], ",", " ", 
          RowBox[{
          "so", " ", "quicker", " ", "to", " ", "get", " ", "solution"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"level1array", "=", 
         RowBox[{"var10", "*", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "nn"}], "*", " ", "level1", 
               "*", 
               RowBox[{"IntegerPart", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"nn", "+", "1"}], ")"}], "/", "2"}], "]"}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"nn", ",", "0", ",", 
              RowBox[{"nlevel1", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"level2array", "=", 
         RowBox[{"var20", "*", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "nn"}], "*", " ", "level2", 
               "*", 
               RowBox[{"IntegerPart", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"nn", "+", "1"}], ")"}], "/", "2"}], "]"}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"nn", ",", "0", ",", 
              RowBox[{"nlevel2", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"var10list", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"level1array", ",", "myprec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numvar10", "=", 
         RowBox[{
          RowBox[{"Dimensions", "[", "var10list", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"var20list", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"level2array", ",", "myprec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numvar20", "=", 
         RowBox[{
          RowBox[{"Dimensions", "[", "var20list", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ii", "=", "1"}], ",", 
          RowBox[{"ii", "<=", "numvar10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "pick", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"var10", "=", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              RowBox[{"var10list", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], ",", "myprec"}], "]"}]}], ";",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"jj", "=", "1"}], ",", 
             RowBox[{"jj", "<=", "numvar20"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", "pick", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"var20", "=", 
               RowBox[{"SetPrecision", "[", 
                RowBox[{
                 RowBox[{"var20list", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}], ",", "myprec"}], "]"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Evaluated", "\[Rule]", 
                 RowBox[{
                 "False", " ", "required", " ", "because", " ", "equations", 
                  " ", "have", " ", "NIntegrate"}]}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "which", " ", "requires", " ", "numerical", " ", "values", 
                  " ", "be", " ", 
                  RowBox[{"inputed", ".", "  ", "Evaluated"}]}], "\[Rule]", 
                 RowBox[{"True", " ", 
                  RowBox[{"(", "default", ")"}], " ", "means", " ", 
                  "functions", " ", "are", " ", "evaluated", " ", "before", 
                  " ", "numerical", " ", "values", " ", "are", " ", "put", 
                  " ", "in"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"errorroot", "=", "0"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"DO", " ", "Type", " ", "1"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", "Newton", " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{",", 
                RowBox[{"AccuracyGoal", "\[Rule]", "Infinity"}], ",", 
                RowBox[{"PrecisionGoal", "\[Rule]", "4"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                 "Print", "[", "\"\<gettemperature: FindRoot\>\"", "]"}], 
                 ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"CAREFUL", ":", " ", 
                RowBox[{
                "Using", " ", "high", " ", "WorkingPrecision", " ", "can", 
                 " ", "lead", " ", "to", " ", "FindRoot", " ", "offsetting", 
                 " ", 
                 RowBox[{"indep", "'"}], "s", " ", "by", " ", "too", " ", 
                 "small", " ", "a", " ", "value", " ", "to", " ", "show", " ",
                  "up", " ", "as", " ", "new", " ", "function", " ", 
                 "value"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Check", "[", 
               RowBox[{
                RowBox[{"sols0", "=", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fulleq1", "[", 
                    RowBox[{"var1", ",", "var2"}], "]"}], "\[Equal]", "0"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"fulleq2", "[", 
                    RowBox[{"var1", ",", "var2"}], "]"}], "\[Equal]", "0"}]}],
                     "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"var1", ",", "var10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"var2", ",", "var20"}], "}"}]}], "}"}], ",", 
                   RowBox[{
                   "WorkingPrecision", "\[Rule]", "myprecfindroot"}]}], 
                  "]"}]}], ",", 
                RowBox[{"errorroot", "=", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"FindRoot", "::", "\"\<cvmit\>\""}], ",", 
                  RowBox[{"FindRoot", "::", "\"\<lstol\>\""}], ",", 
                  RowBox[{"FindRoot", "::", "\"\<jsing\>\""}], ",", 
                  RowBox[{"FindRoot", "::", "\"\<nlnum\>\""}]}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"DO", " ", "Type", " ", "1.5"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Newton", " ", "with", " ", "Reap", " ", "and", " ", "Sow"}], 
               " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", "\"\<FindRoot reap/sow\>\"", "]"}], 
                   ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Clear", "[", "stxy", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Check", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"sols0", ",", "stxy"}], "}"}], "=", 
                   RowBox[{"Reap", "[", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fulleq1", "[", 
                    RowBox[{"var1", ",", "var2"}], "]"}], "\[Equal]", "0"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"fulleq2", "[", 
                    RowBox[{"var1", ",", "var2"}], "]"}], "\[Equal]", "0"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"var1", ",", "var10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"var2", ",", "var20"}], "}"}]}], "}"}], ",", 
                    RowBox[{"WorkingPrecision", "\[Rule]", "myprecfindroot"}],
                     ",", 
                    RowBox[{"EvaluationMonitor", "\[RuleDelayed]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"var1", ",", "var2"}], "}"}], "]"}]}]}], "]"}], 
                    "]"}]}], ",", 
                  RowBox[{"errorroot", "=", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"FindRoot", "::", "\"\<cvmit\>\""}], ",", 
                    RowBox[{"FindRoot", "::", "\"\<lstol\>\""}], ",", 
                    RowBox[{"FindRoot", "::", "\"\<jsing\>\""}], ",", 
                    RowBox[{"FindRoot", "::", "\"\<nlnum\>\""}]}], "}"}]}], 
                 "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"DO", " ", "Type", " ", "2"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Secant", " ", "--"}], " ", 
                RowBox[{"doesn", "'"}], "t", " ", "work"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Check", "[", 
                 RowBox[{
                  RowBox[{"sols0", "=", 
                   RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fulleq1", "[", 
                    RowBox[{"var1", ",", "var2"}], "]"}], "\[Equal]", "0"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"fulleq2", "[", 
                    RowBox[{"var1", ",", "var2"}], "]"}], "\[Equal]", "0"}]}],
                     "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"var1", ",", 
                    RowBox[{"var10", "/", "10"}], ",", 
                    RowBox[{"var10", "*", "10"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"var2", ",", 
                    RowBox[{"var20", "/", 
                    RowBox[{"10", "^", "3"}]}], ",", 
                    RowBox[{"var20", "*", 
                    RowBox[{"10", "^", "3"}]}]}], "}"}]}], "}"}], ",", 
                    RowBox[{
                    "WorkingPrecision", "\[Rule]", "myprecfindroot"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"errorroot", "=", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"FindRoot", "::", "\"\<cvmit\>\""}], ",", 
                    RowBox[{"FindRoot", "::", "\"\<lstol\>\""}]}], "}"}]}], 
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"DO", " ", "Type", " ", "3"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "just", " ", "report", " ", "error", " ", "at", " ", "this", 
                " ", "\"\<initial\>\"", " ", "position"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"sols0", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"var1", "\[Rule]", "var10"}], ",", 
                   RowBox[{"var2", "\[Rule]", "var20"}]}], "}"}]}], ";"}], 
               "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"myvar1", "=", 
               RowBox[{"sols0", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myvar2", "=", 
               RowBox[{"sols0", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"error0eq1", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"fulleq1", "[", 
                 RowBox[{"myvar1", ",", "myvar2"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"error0eq2", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"fulleq2", "[", 
                 RowBox[{"myvar1", ",", "myvar2"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"doprintdebug", "\[Equal]", "1"}], "&&", 
                 RowBox[{"debugformat", "\[Equal]", "0"}]}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<gettemperature: sols0=\>\"", ",", "sols0"}], 
                  "]"}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<gettemperature: error0eq1=\>\"", ",", "error0eq1"}], 
                  "]"}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<gettemperature: error0eq2=\>\"", ",", "error0eq2"}], 
                  "]"}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<gettemperature: errorroot=\>\"", ",", "errorroot"}], 
                  "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "also", " ", "checks", " ", "that", " ", "relative", " ", 
                "error", " ", "for", " ", "equation", " ", "1", " ", 
                "relative", " ", "difference", " ", "is", " ", "smallish", 
                " ", "and", " ", "not", " ", "abnormally", " ", "large"}], 
               " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"errorroot", "=", 
               RowBox[{"errorroot", "+", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"sols0", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                    "var10"}], " ", "&&", " ", 
                   RowBox[{
                    RowBox[{"sols0", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", "0"}], "&&", 
                   RowBox[{
                    RowBox[{"sols0", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[NotEqual]", 
                    "var20"}], " ", "&&", " ", 
                   RowBox[{
                    RowBox[{"sols0", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ">", "0"}], "&&", 
                   RowBox[{"error0eq1", "<", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "2"}], ")"}]}]}], "&&", 
                   RowBox[{"error0eq1", "<", "erroreq1"}], "&&", 
                   RowBox[{"error0eq2", "<", "erroreq2"}]}], ",", "0", ",", 
                  "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"doprintdebug", "\[Equal]", "1"}], "&&", 
                 RowBox[{"debugformat", "\[Equal]", "0"}]}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<gettemperature: post check: errorroot=\>\"", ",", 
                   "errorroot"}], "]"}], ";"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"doprintdebug", "\[Equal]", "1"}], "&&", 
                 RowBox[{"debugformat", "\[Equal]", "1"}]}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<gettemperature: specialFindRoot: =\>\"", ",", 
                   RowBox[{"SetPrecision", "[", 
                    RowBox[{"var10", ",", "5"}], "]"}], ",", "\"\< \>\"", ",", 
                   RowBox[{"SetPrecision", "[", 
                    RowBox[{"var20", ",", "5"}], "]"}], ",", "\"\< \>\"", ",", 
                   RowBox[{"SetPrecision", "[", 
                    RowBox[{"error0eq1", ",", "5"}], "]"}], ",", "\"\< \>\"", 
                   ",", 
                   RowBox[{"SetPrecision", "[", 
                    RowBox[{"error0eq2", ",", "5"}], "]"}]}], "]"}], ";"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"if", " ", "all", " ", "good"}], ",", " ", 
                RowBox[{
                "then", " ", "no", " ", "longer", " ", "need", " ", "to", " ",
                  "iterate"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "override", " ", "any", " ", "FindRoot", " ", "lstol", " ", 
                "issues", " ", "if", " ", "error", " ", "is", " ", "actually",
                 " ", "small", " ", 
                RowBox[{"enough", ".", "  ", "Assume"}], " ", "just", " ", 
                "problem", " ", "getting", " ", "down", " ", "to", " ", 
                "very", " ", "small", " ", "errors"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"RELTOL", "=", 
               RowBox[{"SetPrecision", "[", 
                RowBox[{
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"-", "4"}], ")"}]}], ",", "myprec"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"errorroot", "\[Equal]", "0"}], " ", "||", " ", 
                 RowBox[{
                  RowBox[{"error0eq1", "<", "RELTOL"}], "&&", 
                  RowBox[{"error0eq2", "<", "RELTOL"}]}]}], ",", 
                RowBox[{
                 RowBox[{"sols", "=", "sols0"}], ";", 
                 RowBox[{"erroreq1", "=", "error0eq1"}], ";", 
                 RowBox[{"erroreq2", "=", "error0eq2"}], ";", 
                 RowBox[{"ii", "=", "numvar10"}], ";", 
                 RowBox[{"jj", "=", "numvar20"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", "iterate", " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"jj", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "iterate", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ii", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"doprintdebug", "\[Equal]", "1"}], "&&", 
           RowBox[{"debugformat", "\[Equal]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<gettemperature: FinalsolT\>\"", "]"}], 
           ";", 
           RowBox[{"Print", "[", "sols", "]"}], ";", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<gettemperature: Finalerror1&2=\>\"", ",", "erroreq1", ",", 
             "\"\< \>\"", ",", "erroreq2"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"death", " ", 
          RowBox[{"check", " ", "--"}], " ", "just", " ", "return", " ", 
          "inputted", " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorroot", "\[Equal]", "0"}], " ", "||", " ", 
           RowBox[{
            RowBox[{"error0eq1", "<", "RELTOL"}], "&&", 
            RowBox[{"error0eq2", "<", "RELTOL"}]}]}], ",", "0", ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<gettemperature: NO GOOD SOLUTION FOUND!\>\"", 
            "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "actual", " ", "values"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sols", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"sols", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.491747466539875*^9, 3.4917475370612803`*^9}, {
   3.491747573904258*^9, 3.4917477827044973`*^9}, {3.491747826126936*^9, 
   3.491747982471749*^9}, {3.491748057129101*^9, 3.4917480577199507`*^9}, 
   3.4917491115753202`*^9, {3.491749657480293*^9, 3.4917496609052176`*^9}, {
   3.491750987803203*^9, 3.4917511097285233`*^9}, {3.49175301985515*^9, 
   3.4917530241913853`*^9}, {3.491754376475875*^9, 3.49175438465764*^9}, {
   3.491754529135389*^9, 3.491754576082896*^9}, {3.4917547556210594`*^9, 
   3.4917548580683713`*^9}, {3.4917549103635683`*^9, 3.491754969148096*^9}, {
   3.491755021142861*^9, 3.4917550727070065`*^9}, {3.4917551309707856`*^9, 
   3.4917551312912464`*^9}, {3.4917551884334126`*^9, 3.491755295397219*^9}, {
   3.4917553583176947`*^9, 3.491755429990755*^9}, {3.491834648461322*^9, 
   3.491834835299982*^9}, {3.4918350491975517`*^9, 3.4918352307686386`*^9}, {
   3.4918352634856834`*^9, 3.4918355049829392`*^9}, {3.4918355564068832`*^9, 
   3.4918355929294*^9}, {3.4918452105088*^9, 3.4918452463002653`*^9}, {
   3.4918453169118*^9, 3.4918453494586*^9}, {3.49192989552988*^9, 
   3.4919299765163326`*^9}, 3.4919303358430195`*^9, {3.491930959259448*^9, 
   3.49193096390613*^9}, {3.4919477009327917`*^9, 3.4919477199801807`*^9}, {
   3.49194869965889*^9, 3.491948714289928*^9}, {3.492095732183998*^9, 
   3.4920957856108227`*^9}, {3.492095848591384*^9, 3.492095863562912*^9}, {
   3.492181923383517*^9, 3.492181928030198*^9}, {3.492182246648349*^9, 
   3.492182325621907*^9}, {3.492189949524541*^9, 3.4921900757460384`*^9}, {
   3.492190169991557*^9, 3.492190198132021*^9}, {3.492190645905888*^9, 
   3.4921906982611713`*^9}, {3.4921907287049475`*^9, 
   3.4921908620166397`*^9}, {3.492190924776885*^9, 3.492190985313933*^9}, 
   3.4921913411956654`*^9, {3.492192363645877*^9, 3.492192418554832*^9}, {
   3.492193657926962*^9, 3.4921936879701614`*^9}, {3.4921939542130003`*^9, 
   3.492193958539221*^9}, {3.492195987306445*^9, 3.4921960069546976`*^9}, {
   3.4921975510950623`*^9, 3.492197551165163*^9}, {3.492197846700122*^9, 
   3.4921978468503375`*^9}, {3.492198104921426*^9, 3.492198155624333*^9}, {
   3.4921983035370207`*^9, 3.492198387938384*^9}, {3.4921996344207373`*^9, 
   3.492199652666974*^9}, {3.4921997748326397`*^9, 3.4921997873506403`*^9}, {
   3.492200086961459*^9, 3.4922000900759373`*^9}, {3.492201205630026*^9, 
   3.492201206571379*^9}, {3.4922013011573873`*^9, 3.492201302569418*^9}, {
   3.4922015210035105`*^9, 3.492201569553322*^9}, {3.4922042645785775`*^9, 
   3.492204411169365*^9}, 3.492204703139197*^9, {3.4922053722012606`*^9, 
   3.492205382976755*^9}, {3.492274237975381*^9, 3.4922743637562447`*^9}, {
   3.4923685823859806`*^9, 3.492368582466096*^9}, {3.492369971783837*^9, 
   3.4923699727752624`*^9}, {3.492370075733309*^9, 3.492370146014368*^9}, {
   3.492370177479613*^9, 3.4923702082939215`*^9}, {3.4923702773632383`*^9, 
   3.492370291303283*^9}, {3.4923704550687666`*^9, 3.4923704578127117`*^9}, {
   3.4923705410223618`*^9, 3.4923705424844637`*^9}, {3.4923706934815874`*^9, 
   3.4923707371343565`*^9}, {3.492374773548435*^9, 3.4923748619555583`*^9}, {
   3.492377571191248*^9, 3.492377603077098*^9}, {3.4923783500211506`*^9, 
   3.4923783942847986`*^9}, {3.4923786346804705`*^9, 
   3.4923786476190753`*^9}, {3.492378912439869*^9, 3.4923789181180334`*^9}, {
   3.4923792066028547`*^9, 3.492379210167981*^9}, {3.492380200592141*^9, 
   3.4923802055793123`*^9}, {3.492380260247922*^9, 3.4923802695613136`*^9}, {
   3.492380304751915*^9, 3.4923803447293997`*^9}, {3.4923806970159636`*^9, 
   3.49238071726508*^9}, {3.4923850485731955`*^9, 3.492385180412771*^9}, {
   3.4923852842520847`*^9, 3.492385315827488*^9}, {3.4935992998586607`*^9, 
   3.493599458446699*^9}, {3.4935995637481155`*^9, 3.49359957518456*^9}, {
   3.4935996259876113`*^9, 3.49359980451432*^9}, {3.493599903837139*^9, 
   3.4935999046683345`*^9}, {3.493600083365288*^9, 3.4936000843767424`*^9}, {
   3.4936078260506*^9, 3.4936078429298*^9}, {3.493607920106*^9, 
   3.4936079357060003`*^9}, {3.4936088308964*^9, 3.4936088630324*^9}, {
   3.4936090702628*^9, 3.493609078328*^9}, {3.4936093009868*^9, 
   3.4936093381303997`*^9}, {3.4936094428532*^9, 3.493609452104*^9}, {
   3.4936095284504004`*^9, 3.4936095335516*^9}, {3.4936097264888*^9, 
   3.4936097356616*^9}, {3.4936098663594*^9, 3.4936099055622*^9}, {
   3.4936124309602575`*^9, 3.493612440213563*^9}, 3.4936125570615826`*^9, {
   3.493739074134198*^9, 3.4937390748852787`*^9}, {3.4937391231847296`*^9, 
   3.493739293139112*^9}, {3.4937393276587486`*^9, 3.493739343181069*^9}, {
   3.493739499736184*^9, 3.4937395055345216`*^9}, {3.4937434012062225`*^9, 
   3.4937434112506657`*^9}, {3.4937434578076115`*^9, 
   3.4937436969514832`*^9}, {3.493743785969485*^9, 3.493743786870781*^9}, {
   3.49374388152689*^9, 3.493743881617019*^9}, {3.493744016300685*^9, 
   3.4937440518518047`*^9}, {3.4937446763097315`*^9, 
   3.4937446915216045`*^9}, {3.4937450397923937`*^9, 
   3.4937451467662144`*^9}, {3.493745381013045*^9, 3.4937453973565454`*^9}, {
   3.493745649439022*^9, 3.4937457008930097`*^9}, {3.4937457821097937`*^9, 
   3.4937458053932734`*^9}, {3.4937468183097763`*^9, 
   3.4937470745682573`*^9}, {3.493747163756504*^9, 3.493747212556675*^9}, {
   3.4937488926925917`*^9, 3.4937490850992594`*^9}, {3.493749396046379*^9, 
   3.493749406331168*^9}, {3.4937610358135424`*^9, 3.4937612173946433`*^9}, 
   3.4937612794638944`*^9, {3.493761322525814*^9, 3.4937613226259584`*^9}, {
   3.493761634013712*^9, 3.4937616384500914`*^9}, {3.493924273728136*^9, 
   3.493924303170472*^9}, {3.493924482728664*^9, 3.4939245093970113`*^9}, {
   3.4939353630538034`*^9, 3.49393537788513*^9}, {3.493935435097397*^9, 
   3.4939354799118366`*^9}, {3.4939355312756944`*^9, 3.493935596589611*^9}, {
   3.493935710673656*^9, 3.4939357279084387`*^9}, {3.49394133586228*^9, 
   3.493941362851088*^9}, {3.4939420180331936`*^9, 3.493942059322565*^9}, {
   3.4939447128882046`*^9, 3.493944831198326*^9}, {3.493944999710635*^9, 
   3.493945030074296*^9}, {3.4939451576477375`*^9, 3.4939452450734496`*^9}, {
   3.493945283168227*^9, 3.4939453465693936`*^9}, {3.4939454042523375`*^9, 
   3.4939455829693203`*^9}, {3.493945753063904*^9, 3.493945812779771*^9}, {
   3.493945900195469*^9, 3.4939460818166275`*^9}, {3.4939461949292755`*^9, 
   3.493946381687821*^9}, {3.493946533886672*^9, 3.4939465883449793`*^9}, {
   3.493946655691819*^9, 3.4939466635030513`*^9}, {3.4939467049226093`*^9, 
   3.493946708657981*^9}, {3.493946743988784*^9, 3.493946755425229*^9}, {
   3.493946791036435*^9, 3.4939468236933937`*^9}, {3.4939468667452993`*^9, 
   3.4939470071772304`*^9}, {3.493947077989053*^9, 3.493947107191043*^9}, {
   3.4939472561652575`*^9, 3.493947291806507*^9}, {3.4939756790692587`*^9, 
   3.493975813952757*^9}, {3.4939760412095366`*^9, 3.4939760986421204`*^9}, {
   3.4939761313090935`*^9, 3.4939762108835154`*^9}, {3.4941130606530495`*^9, 
   3.494113065389861*^9}, {3.4941133476657534`*^9, 3.4941133477859263`*^9}, {
   3.4941134956886*^9, 3.494113558819378*^9}, {3.4941145114592066`*^9, 
   3.494114626744979*^9}, {3.49411469131783*^9, 3.49411483320185*^9}, {
   3.494114890714549*^9, 3.4941149999916816`*^9}, {3.4941150547704496`*^9, 
   3.494115061219723*^9}, {3.4941152755278835`*^9, 3.4941152878455954`*^9}, {
   3.494116530322189*^9, 3.4941167709782352`*^9}, {3.494116891671784*^9, 
   3.4941170410265455`*^9}, {3.4941172941905775`*^9, 3.494117394394664*^9}, {
   3.4941174349229407`*^9, 3.4941176695302896`*^9}, {3.4941177280945005`*^9, 
   3.4941178721816883`*^9}, {3.4941179230147824`*^9, 3.494117949142352*^9}, {
   3.494118250595821*^9, 3.494118348696883*^9}, {3.494118429933696*^9, 
   3.4941185002648273`*^9}, {3.4941187382870865`*^9, 
   3.4941187410110035`*^9}, {3.4941193347447505`*^9, 3.494120091242541*^9}, {
   3.4941201770659485`*^9, 3.4941202809853773`*^9}, {3.4941203940779967`*^9, 
   3.4941203965615683`*^9}, {3.494120429779333*^9, 3.494120438892437*^9}, {
   3.4941204751846223`*^9, 3.4941204790101233`*^9}, {3.4941205275599346`*^9, 
   3.4941205739065776`*^9}, {3.494120604190123*^9, 3.494120605812456*^9}, {
   3.494120641313504*^9, 3.4941207465047617`*^9}, {3.494120820921768*^9, 
   3.4941212038824387`*^9}, {3.4941212445809603`*^9, 
   3.4941212482262015`*^9}, {3.49412129765728*^9, 3.494121351945342*^9}, {
   3.4941213904507103`*^9, 3.4941216342612925`*^9}, {3.4941217457415934`*^9, 
   3.4941217734213953`*^9}, {3.494122870789333*^9, 3.49412287107975*^9}, {
   3.4941229273706927`*^9, 3.494122955140624*^9}, {3.4941288900846543`*^9, 
   3.494128954016584*^9}, {3.4941290578759265`*^9, 3.4941290771336174`*^9}, {
   3.4941292640423794`*^9, 3.494129291952512*^9}, {3.494140614533584*^9, 
   3.494140635944371*^9}, {3.4941407525220013`*^9, 3.49414076640196*^9}, {
   3.494144513409893*^9, 3.494144770759944*^9}, {3.4941448620912724`*^9, 
   3.4941448941774096`*^9}, {3.494144981593107*^9, 3.4941450339784336`*^9}, {
   3.4941451667493486`*^9, 3.494145990704138*^9}, {3.494146033776072*^9, 
   3.494146618717176*^9}, {3.494146650633069*^9, 3.4941468023812723`*^9}, {
   3.4941468454632206`*^9, 3.4941474332784576`*^9}, {3.494147500955773*^9, 
   3.4941476548370433`*^9}, {3.494148172321149*^9, 3.4941484461048307`*^9}, {
   3.4941485984238544`*^9, 3.4941486134454546`*^9}, {3.494148694812454*^9, 
   3.4941488728985295`*^9}, 3.4941489933917904`*^9, {3.494149046007448*^9, 
   3.4941491032497587`*^9}, {3.494149226757354*^9, 3.4941493648759584`*^9}, 
   3.494149920645115*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "find", " ", "good", " ", "guess", " ", "by", " ", "going", " ", "over", 
    " ", "2", "D", " ", "grid", " ", "of", " ", "reasonable", " ", 
    RowBox[{"guesses", ".", "  ", "Better"}], " ", "to", " ", "do", " ", 
    "this", " ", "than", " ", "let", " ", 
    RowBox[{"Newton", "'"}], "s", " ", "method", " ", "work", " ", "from", 
    " ", "each", " ", "point", " ", "since", " ", "that", " ", "would", " ", 
    "use", " ", "many", " ", "many", " ", "more", " ", "function", " ", 
    "evaluations"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gettemperaturegetguess", "[", 
     RowBox[{
     "level10_", ",", "level20_", ",", "nlevel10_", ",", "nlevel20_", ",", 
      "eq1diff_", ",", "eq2diff_", ",", "var100_", ",", "var200_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", 
        RowBox[{"level1", "=", "level10"}], ",", 
        RowBox[{"level2", "=", "level20"}], ",", 
        RowBox[{"nlevel1", "=", "nlevel10"}], ",", 
        RowBox[{"nlevel2", "=", "nlevel20"}], ",", "ii", ",", "jj", ",", 
        "var1", ",", 
        RowBox[{"var10", "=", "var100"}], ",", "myvar1", ",", "var10list", 
        ",", "numvar10", ",", "var2", ",", 
        RowBox[{"var20", "=", "var200"}], ",", "myvar2", ",", "var20list", 
        ",", "numvar20", ",", "erroreq1", ",", "erroreq2", ",", "error0eq1", 
        ",", "error0eq2", ",", "myprec", ",", "sols0", ",", "sols", ",", 
        "fulleq1", ",", "fulleq2", ",", "errorroot", ",", "debugformat", ",", 
        "level1array", ",", "level2array", ",", "nn", ",", "errorrat", ",", 
        "gooderror", ",", "gooderrorold", ",", "betterguess"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"solsT", "=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{"Pg", "\[Equal]", "Pm"}], ",", 
           RowBox[{"{", 
            RowBox[{"T", ",", 
             RowBox[{"10", "^", 
              RowBox[{"(", "10", ")"}]}]}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "myprecfindroot"}]}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"solsT", "=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{"Ug", "\[Equal]", "Um"}], ",", 
           RowBox[{"{", 
            RowBox[{"T", ",", 
             RowBox[{"10", "^", 
              RowBox[{"(", "10", ")"}]}]}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "myprecfindroot"}]}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Problems", " ", "getting", " ", "root", " ", "with", " ", "bad", " ",
          "guess"}], ",", " ", 
        RowBox[{"so", " ", "do", " ", "below"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Also", ",", " ", 
        RowBox[{
        "problem", " ", "with", " ", "FindRoot", " ", "not", " ", "returning",
          " ", "correct", " ", "answer", " ", "if", " ", "anything", " ", 
         "odd", " ", "happens", " ", "like", " ", "Overflow"}]}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myprec", "=", "lowestprec"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fulleq1", "[", 
         RowBox[{
          RowBox[{"var1_", "?", "NumericQ"}], ",", 
          RowBox[{"var2_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{"eq1diff", "[", 
            RowBox[{"var1", ",", "var2"}], "]"}], "]"}], ",", "myprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fulleq2", "[", 
         RowBox[{
          RowBox[{"var1_", "?", "NumericQ"}], ",", 
          RowBox[{"var2_", "?", "NumericQ"}]}], "]"}], ":=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{"eq2diff", "[", 
            RowBox[{"var1", ",", "var2"}], "]"}], "]"}], ",", "myprec"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"fulleq1", "[", 
           RowBox[{"var1_", ",", "var2_"}], "]"}], ":=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"eq1diff", "[", 
              RowBox[{"var1", ",", "var2"}], "]"}], "]"}], ",", "myprec"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fulleq2", "[", 
           RowBox[{"var1_", ",", "var2_"}], "]"}], ":=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"eq2diff", "[", 
              RowBox[{"var2", ",", "var2"}], "]"}], "]"}], ",", "myprec"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"random", " ", "error"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"erroreq1", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{"fulleq1", "[", 
          RowBox[{"var10", ",", "var20"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"erroreq2", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{"fulleq2", "[", 
          RowBox[{"var10", ",", "var20"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "initial", " ", "guess", " ", "is", " ", "supposed", " ", 
         "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"sols", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"var1", "->", "var10"}], ",", 
          RowBox[{"var2", "\[Rule]", "var20"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Initial\>\"", "]"}], ";", 
          RowBox[{"Print", "[", "sols", "]"}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Initialerror1&2=\>\"", ",", "erroreq1", ",", "\"\< \>\"", ",",
             "erroreq2"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "probe", " ", "various", " ", "starting", " ", "points", " ", 
         "rather", " ", "than", " ", "a", " ", "single", " ", "starting", " ",
          "point", " ", "with", " ", "many", " ", "iterations"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "start", " ", "with", " ", "most", " ", "plausible", " ", "and", " ",
           "move", " ", "to", " ", "least", " ", "plausible"}], ",", " ", 
         RowBox[{
         "so", " ", "quicker", " ", "to", " ", "get", " ", "solution"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"level1array", "=", 
        RowBox[{"var10", "*", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], "^", "nn"}], "*", " ", "level1", 
              "*", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nn", "+", "1"}], ")"}], "/", "2"}], "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"nn", ",", "0", ",", 
             RowBox[{"nlevel1", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"level2array", "=", 
        RowBox[{"var20", "*", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], "^", "nn"}], "*", " ", "level2", 
              "*", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nn", "+", "1"}], ")"}], "/", "2"}], "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"nn", ",", "0", ",", 
             RowBox[{"nlevel2", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"var10list", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"level1array", ",", "myprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numvar10", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "var10list", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"var20list", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"level2array", ",", "myprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numvar20", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "var20list", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<=", "numvar10"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "pick", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"var10", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"var10list", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "myprec"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<=", "numvar20"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "pick", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"var20", "=", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{"var20list", "[", 
                 RowBox[{"[", "jj", "]"}], "]"}], ",", "myprec"}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"sols0", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"var1", "\[Rule]", "var10"}], ",", 
                RowBox[{"var2", "\[Rule]", "var20"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"myvar1", "=", 
              RowBox[{"sols0", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"myvar2", "=", 
              RowBox[{"sols0", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"error0eq1", "=", 
              RowBox[{"Abs", "[", 
               RowBox[{"fulleq1", "[", 
                RowBox[{"myvar1", ",", "myvar2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"error0eq2", "=", 
              RowBox[{"Abs", "[", 
               RowBox[{"fulleq2", "[", 
                RowBox[{"myvar1", ",", "myvar2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"if", " ", "low", " ", "errors"}], ",", " ", 
               RowBox[{
               "then", " ", "choose", " ", "it", " ", "as", " ", "best", " ", 
                "guess"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"don", "'"}], "t", " ", "rely", " ", "strictly", " ", 
                "on", " ", "error", " ", "in", " ", "var2", " ", 
                RowBox[{"(", 
                 RowBox[{"i", ".", "e", ".", " ", "npairs"}], ")"}], " ", 
                "since", " ", "error", " ", "can", " ", "vary", " ", "by", 
                " ", "alot"}], ",", " ", 
               RowBox[{
               "while", " ", "error", " ", "in", " ", "eq1", " ", "is", " ", 
                "more", " ", "true", " ", "to", " ", "the", " ", "real", " ", 
                "error"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"errorrat", "=", 
                RowBox[{"10", "^", "4"}]}], ";"}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{
               "should", " ", "be", " ", "much", " ", "bigger", " ", "than", 
                " ", "1", " ", "so", " ", "less", " ", "strict", " ", "with", 
                " ", 
                RowBox[{"eq2", "'"}], "s", " ", "error"}], " ", "*)"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"betterguess", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"error0eq1", "<", "erroreq1"}], " ", "&&", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"error0eq2", "<", "erroreq2"}], "||", 
                    RowBox[{"error0eq2", "<", 
                    RowBox[{"errorrat", "*", "erroreq2"}]}]}], ")"}]}], ",", 
                  "1", ",", "0"}], "]"}]}], ";"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"gooderrorold", "=", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"erroreq1", "^", "2"}], "+", 
                  RowBox[{"erroreq2", "^", "2"}]}], ")"}], "]"}], "/", 
               "2"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"gooderror", "=", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"error0eq1", "^", "2"}], "+", 
                  RowBox[{"error0eq2", "^", "2"}]}], ")"}], "]"}], "/", 
               "2"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"gooderrorold", "=", 
                RowBox[{"(", "erroreq1", ")"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"gooderror", "=", 
                RowBox[{"(", "error0eq1", ")"}]}], ";"}], 
              "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"betterguess", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"gooderror", "<", "gooderrorold"}], ",", "1", ",", 
                "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"betterguess", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
                  RowBox[{"Print", "[", "\"\<Better guess found\>\"", "]"}]}],
                  "]"}], ";", 
                RowBox[{"erroreq1", "=", "error0eq1"}], ";", 
                RowBox[{"erroreq2", "=", "error0eq2"}], ";", 
                RowBox[{"sols", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"var1", "->", "var10"}], ",", 
                   RowBox[{"var2", "\[Rule]", "var20"}]}], "}"}]}], ";"}]}], 
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<special:\>\"", ",", "\"\<ii=\>\"", ",", "ii", ",", 
                  "\"\< jj=\>\"", ",", "jj", ",", "\"\< \>\"", ",", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{"var10", ",", "5"}], "]"}], ",", "\"\< \>\"", ",", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{"var20", ",", "5"}], "]"}], ",", "\"\< \>\"", ",", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{"error0eq1", ",", "5"}], "]"}], ",", "\"\< \>\"", 
                  ",", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{"error0eq2", ",", "5"}], "]"}], ",", "\"\< \>\"", 
                  ",", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{"gooderror", ",", "5"}], "]"}]}], "]"}], ";"}]}], 
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", "iterate", " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"jj", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "iterate", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"ii", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Finalstart\>\"", "]"}], ";", 
          RowBox[{"Print", "[", "sols", "]"}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Finalerror1&2=\>\"", ",", "erroreq1", ",", "\"\< \>\"", ",", 
            "erroreq2"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"return", " ", "actual", " ", "values"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sols", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"sols", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4921914793643427`*^9, 3.4921914852127523`*^9}, 
   3.4921915672507167`*^9, {3.4921920230060606`*^9, 3.4921920372164946`*^9}, {
   3.4921920747905235`*^9, 3.492192209163742*^9}, {3.4921927161928144`*^9, 
   3.492192730803824*^9}, {3.4921935125679455`*^9, 3.4921935797645693`*^9}, {
   3.492193967432008*^9, 3.4921939708168755`*^9}, {3.49219466874044*^9, 
   3.492194679185459*^9}, {3.4921953631489506`*^9, 3.4921953739444733`*^9}, {
   3.492195786447624*^9, 3.4921958464238653`*^9}, {3.4921961858018675`*^9, 
   3.492196185952083*^9}, {3.4921974650513377`*^9, 3.4921974814949827`*^9}, {
   3.4921975358731747`*^9, 3.4921975359432755`*^9}, {3.492200276874541*^9, 
   3.4922004926848607`*^9}, {3.492200555054544*^9, 3.492200555334947*^9}, {
   3.492200588602784*^9, 3.492200615761837*^9}, {3.4922012120893135`*^9, 
   3.492201287878293*^9}, 3.492201514454093*^9, {3.492202811368965*^9, 
   3.492202844446528*^9}, {3.4922110212942576`*^9, 3.4922112255880175`*^9}, {
   3.4922115284735456`*^9, 3.492211681002872*^9}, {3.492263562725125*^9, 
   3.492263585457813*^9}, {3.492368762705267*^9, 3.492368762795397*^9}, {
   3.4923748718297567`*^9, 3.4923748748240623`*^9}, {3.4923786407692256`*^9, 
   3.492378642712019*^9}, {3.492378918909171*^9, 3.492378922394182*^9}, {
   3.4923802803067646`*^9, 3.4923802823096447`*^9}, {3.4923806113627996`*^9, 
   3.492380657729472*^9}, {3.4923807904503155`*^9, 3.4923808164877553`*^9}, {
   3.4924497646303153`*^9, 3.49244976621259*^9}, {3.49244987270572*^9, 
   3.4924499101095037`*^9}, {3.492449941905224*^9, 3.492449965188704*^9}, {
   3.492450040476963*^9, 3.492450089597595*^9}, {3.493975850224914*^9, 
   3.4939758557428484`*^9}, {3.493975913545965*^9, 3.4939759137362385`*^9}, 
   3.494149921346123*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.4917475077791743`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"once", " ", "have", " ", "T", " ", "and", " ", "npairs"}], ",", 
    " ", 
    RowBox[{
    "can", " ", "get", " ", "numerical", " ", "values", " ", "before", " ", 
     "compute", " ", "plasma", " ", "things"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getradnums", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "other", " ", "things", " ", "needed", " ", "by", " ", "plasma", " ", 
        "part", " ", "of", " ", "calculation", " ", "that", " ", "turn", " ", 
        "into", " ", "numbers"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "also", " ", "some", " ", "things", " ", "that", " ", "are", " ", 
        "related", " ", "and", " ", "inexpensive", " ", "to", " ", 
        "compute"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qtotnum", "=", 
        RowBox[{"Qtot", "[", 
         RowBox[{
         "rhobnorm", ",", "rhobrad", ",", "Trad", ",", "bgaussnorm", ",", 
          "bgaussrad", ",", "npairsrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Qradnum", "=", 
        RowBox[{"Qrad", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Qnunum", "=", 
        RowBox[{"Qnu", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Qnurat", "=", 
        RowBox[{"Qnunum", "/", "Qtotnum"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Habsnum", "=", 
        RowBox[{"Habs", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Hscanum", "=", 
        RowBox[{"Hsca", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dtrad", "=", 
        RowBox[{"Uradnum", "/", "Qradnum"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tauradabsnum", "=", 
        RowBox[{"tauradabs", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"dtauradscadsnum", "=", 
        RowBox[{"dtauradscads", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dtauradabsdsnum", "=", 
        RowBox[{"dtauradabsds", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lambdascanum", "=", 
        RowBox[{"1", "/", "dtauradscadsnum"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lambdaabsnum", "=", 
        RowBox[{"1", "/", "dtauradabsdsnum"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Pgnum", "=", 
        RowBox[{"Pg", "[", 
         RowBox[{
         "rhobnorm", ",", "rhobrad", ",", "Trad", ",", "bgaussnorm", ",", 
          "bgaussrad", ",", "npairsrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pradnum", "=", 
        RowBox[{"Prad", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ppairsnum", "=", 
        RowBox[{"Ppairs", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ppairs0num", "=", 
        RowBox[{"Ppairs0", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pbaryonnum", "=", 
        RowBox[{"Pbaryon", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Penum", "=", 
        RowBox[{"Pe", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pnunum", "=", 
        RowBox[{"Pnu", "[", 
         RowBox[{
         "rhobnorm", ",", "Tnorm", ",", "bgaussrad", ",", "npairsrad"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Ugnum", "=", 
        RowBox[{"Ug", "[", 
         RowBox[{
         "rhobnorm", ",", "rhobrad", ",", "Trad", ",", "bgaussnorm", ",", 
          "bgaussrad", ",", "npairsrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Uradnum", "=", 
        RowBox[{"Urad", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Upairsnum", "=", 
        RowBox[{"Upairs", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Upairs0num", "=", 
        RowBox[{"Upairs0", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ubaryonnum", "=", 
        RowBox[{"Ubaryon", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Uenum", "=", 
        RowBox[{"Ue", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ununum", "=", 
        RowBox[{"Unu", "[", 
         RowBox[{
         "rhobnorm", ",", "Tnorm", ",", "bgaussrad", ",", "npairsrad"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nbsigmaffnum", "=", 
        RowBox[{"nbsigmaff", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nbsigmasynchnum", "=", 
        RowBox[{"nbsigmasynch", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"damptauradnum", "=", 
        RowBox[{"damptaurad", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"damptaurad2num", "=", 
        RowBox[{"damptaurad2", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nradnum", "=", 
        RowBox[{"nrad", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"npairs0num", "=", 
        RowBox[{"npairs0", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"npairs0qednum", "=", 
        RowBox[{"npairs0qed", "[", 
         RowBox[{"Trad", ",", "bgaussrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Upairs0qednum", "=", 
        RowBox[{"Upairs0qed", "[", 
         RowBox[{"Trad", ",", "bgaussrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ppairs0qednum", "=", 
        RowBox[{"Ppairs0qed", "[", 
         RowBox[{"Trad", ",", "bgaussrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"taunuscanum", "=", 
        RowBox[{"taunusca", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Hnuscanum", "=", 
        RowBox[{"Hnusca", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"taunuabsnum", "=", 
        RowBox[{"taunuabs", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Hnuabsnum", "=", 
        RowBox[{"Hnuabs", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"damptaununum", "=", 
        RowBox[{"damptaunu", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"damptaunu2num", "=", 
        RowBox[{"damptaunu2", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ununum", "=", 
        RowBox[{"Unu", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nnutruenum", "=", 
        RowBox[{"nnutrue", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nnunum", "=", 
        RowBox[{"nnu", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pnunum", "=", 
        RowBox[{"Pnu", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Qnunum", "=", 
        RowBox[{"Qnu", "[", 
         RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}],
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.493588708829509*^9, {3.493588857633478*^9, 3.493588863181456*^9}, {
   3.4935933988434176`*^9, 3.4935934211755295`*^9}, {3.493593578381581*^9, 
   3.493593602576371*^9}, {3.4935937106017036`*^9, 3.4935937310010366`*^9}, {
   3.4935937661615953`*^9, 3.493593773231762*^9}, {3.49393778191195*^9, 
   3.493937784135147*^9}, {3.493937935993509*^9, 3.4939379586661105`*^9}, {
   3.4939379919439616`*^9, 3.4939379968410034`*^9}, {3.4939382335613904`*^9, 
   3.4939382339018803`*^9}, {3.4939383601133633`*^9, 3.49393839779755*^9}, {
   3.4939384296433425`*^9, 3.4939384540784783`*^9}, {3.4939387284730387`*^9, 
   3.4939387353629456`*^9}, {3.493938885759205*^9, 3.4939388996491776`*^9}, {
   3.4939389446939487`*^9, 3.493938984350973*^9}, {3.493939695884107*^9, 
   3.493939715662547*^9}, {3.4939403552922897`*^9, 3.4939403565140467`*^9}, {
   3.4939438898747697`*^9, 3.4939439332771792`*^9}, {3.494047116640216*^9, 
   3.494047153463165*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"resolves", " ", "problems", " ", 
    RowBox[{"(", 
     RowBox[{
     "computing", " ", "right", " ", "answer", " ", "and", " ", "getting", 
      " ", "done", " ", "at", " ", "all", " ", "with", " ", "even", " ", 
      "wrong", " ", "answer"}], ")"}], " ", "with", " ", "Mathematica", " ", 
    "and", " ", "large", " ", "mu"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "omegaprelfactor", "]"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "purge", " ", "any", " ", "stored", " ", "values", " ", "before", " ", 
     "defining", " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"omegaprelfactor", "[", "muth_", "]"}], ":=", 
    RowBox[{
     RowBox[{"omegaprelfactor", "[", "muth", "]"}], "=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "mu", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"top0", "=", 
         RowBox[{"MeijerG", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "2", "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ",", "1", ",", 
               RowBox[{"3", "/", "2"}]}], "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"mu", "^", "2"}], "/", "4"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bottom0", "=", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{"BesselK", "[", 
            RowBox[{"2", ",", "mu"}], "]"}]}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"top", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"top0", ",", 
              RowBox[{"{", 
               RowBox[{"mu", ",", "Infinity", ",", "2"}], "}"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"mu", ">", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bottom", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"bottom0", ",", 
              RowBox[{"{", 
               RowBox[{"mu", ",", "Infinity", ",", "2"}], "}"}]}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"mu", ">", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"omegaprelfactorreturn", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"muth", "<", "10"}], ",", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"top0", "/", "bottom0"}], "]"}], "//.", 
            RowBox[{"{", 
             RowBox[{"mu", "\[Rule]", "muth"}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"top", "/", "bottom"}], "]"}], "//.", 
            RowBox[{"{", 
             RowBox[{"mu", "\[Rule]", "muth"}], "}"}]}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"compute", " ", "some", " ", "plasma", " ", "stuff"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeplasmastuff", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "See", " ", "if", " ", "pairs", " ", "should", " ", "be", " ", 
         "included", " ", "as", " ", "charge", " ", "carriers"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Compare", " ", "annihilation", " ", "time", " ", "to", " ", "plasma",
          " ", "time", " ", "to", " ", "see", " ", "if", " ", "pairs", " ", 
         "included", " ", "as", " ", "charge", " ", "carriers", " ", "for", 
         " ", "plasma", " ", "frequency"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "even", " ", "a", " ", "couple", " ", "of", " ", "positron", " ", 
          "pairs", " ", "can", " ", "annihilate", " ", "with", " ", "the", 
          " ", "many", " ", "electrons"}], ",", " ", 
         RowBox[{
          RowBox[{"so", " ", "should", " ", "be", " ", "ne"}], "+", 
          "npairs"}], ",", " ", 
         RowBox[{"not", " ", "npairs"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"netotpl", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ne", "[", "rhobnorm", "]"}], "+", "npairs"}], "//.", 
          "solsT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sigmaesnum", "=", 
         RowBox[{"sigmaes", "[", 
          RowBox[{"Trad", ",", "bgaussrad"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sigmaBnum", "=", 
         RowBox[{"sigmaB", "[", 
          RowBox[{"Trad", ",", "bgaussrad"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sigmaknnum", "=", 
         RowBox[{"sigmakn", "[", "Trad", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"ITERATED", " ", 
          RowBox[{"within", ":", " ", "Tann"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Tann", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"netotpl", "*", "sigmaesnum", "*", "c"}], ")"}]}], "//.",
            "consts"}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"muth", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"me", "*", 
              RowBox[{"c", "^", "2"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"kb", "*", "T"}], ")"}]}], "//.", "consts"}], "//.", 
          "solsT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"omegape", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"4", "*", "Pi", "*", "netotforomegape", "*", 
            RowBox[{
             RowBox[{"q", "^", "2"}], "/", "me"}]}], "]"}], "*", 
          RowBox[{"omegaprelfactor", "[", "muth", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tpl", "=", 
         RowBox[{"2", "*", 
          RowBox[{"Pi", "/", "omegape"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"ITERATED", ":", " ", "netotforomegape"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"netotforomegape", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ne", "[", "rhobnorm", "]"}], " ", "+", " ", 
           RowBox[{"npairs", "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "Tpl"}], "/", "Tann"}], "]"}]}]}], "//.", 
          "solsT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"muth", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"me", "*", 
              RowBox[{"c", "^", "2"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"kb", "*", "T"}], ")"}]}], "//.", "consts"}], "//.", 
          "solsT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"omegape", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"4", "*", "Pi", "*", "netotforomegape", "*", 
              RowBox[{
               RowBox[{"q", "^", "2"}], "/", "me"}]}], "]"}], "*", 
            RowBox[{"omegaprelfactor", "[", "muth", "]"}]}], "//.", 
           "consts"}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Gyration", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"omegag", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q", "*", "bgaussnorm"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"gammae", "*", "me", "*", "c"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tg", "=", 
         RowBox[{"2", "*", 
          RowBox[{"Pi", "/", "omegag"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"QED", " ", "gyration"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"omegabe1", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "hbar"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"me", "*", 
                  RowBox[{"c", "^", "2"}]}], ")"}], "^", "2"}], "+", 
               RowBox[{
               "2", "*", "hbar", "*", "c", "*", "q", "*", "bgaussnorm"}]}], 
              ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}]}], " ", "-", " ", 
            RowBox[{"me", "*", 
             RowBox[{"c", "^", "2"}]}]}], ")"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.4771628557667313`*^9, 3.477162855987048*^9}, {
  3.4771637056688304`*^9, 3.477163706359824*^9}, {3.4771638248101473`*^9, 
  3.477163844438371*^9}, {3.4771675684532413`*^9, 3.477167576194373*^9}, {
  3.477174143687965*^9, 3.477174146101435*^9}, {3.4912610304675407`*^9, 
  3.491261030597728*^9}, {3.491749112126112*^9, 3.4917491135281277`*^9}, {
  3.491853420093603*^9, 3.491853458769216*^9}, {3.4922033764214706`*^9, 
  3.49220342733468*^9}, {3.492203859375925*^9, 3.492203920273491*^9}, {
  3.492203980119546*^9, 3.4922039870795536`*^9}, {3.492205406210163*^9, 
  3.4922054407698574`*^9}, {3.4922079714788384`*^9, 3.492207984427458*^9}, {
  3.4922093814262433`*^9, 3.492209427392339*^9}, {3.493520986699869*^9, 
  3.493520987751381*^9}, {3.493521027368347*^9, 3.493521029531458*^9}, {
  3.493593572823589*^9, 3.4935935756276207`*^9}, {3.493597823535813*^9, 
  3.4935978276917887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gettaualongjet", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"below", " ", "uses", " ", "all", " ", "electrons"}], "+", 
       RowBox[{
        RowBox[{"positrons", " ", "--"}], " ", "assuming", " ", "layer", " ", 
        "heated", " ", 
        RowBox[{"up", ".", "  ", "Only"}], " ", "integrate", " ", "up", " ", 
        "through", " ", "layers", " ", "in", " ", "comoving", " ", 
        "frame"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"taualongjet1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"netot", "//.", "solsT"}], ")"}], "*", "sigmat", "*", 
          RowBox[{"(", 
           RowBox[{"fcover", "*", "Lpnum"}], ")"}]}], "//.", "consts"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tauradscanum", "=", 
       RowBox[{"tauradsca", "[", 
        RowBox[{
        "rhobrad", ",", "Trad", ",", "bgaussnorm", ",", "npairsnorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"taualongjet1", "=", "tauradscanum"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "now", " ", "integrate", " ", "up", " ", "rest", " ", "of", " ", 
        RowBox[{"jet", "'"}], "s", " ", "electrons", " ", "associated", " ", 
        "with", " ", "baryons"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rhobfake", "=", 
       RowBox[{"rhobrad", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rc", "/", "Ljet"}], ")"}], "^", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nbfake", "=", 
       RowBox[{"nb", "[", "rhobfake", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nefake2", "=", 
       RowBox[{"ne", "[", "rhobfake", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"taualongjet2", "=", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"nefake2", "*", 
          RowBox[{"sigmaesnum", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "gammavalue"}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"rc", ",", "Ljet", ",", "Infinity"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"below", " ", "is", " ", "final", " ", 
        RowBox[{"opacity", " ", "--"}], " ", "no", " ", "pair", " ", 
        "production", " ", "due", " ", "to", " ", "escaping", " ", "photons", 
        " ", "for", " ", "a", " ", "given", " ", "emax", " ", "yet", " ", 
        "included"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"taualongjet", "=", 
       RowBox[{"taualongjet1", "+", "taualongjet2"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4651555128109407`*^9, 3.465155624501544*^9}, {
   3.4651855417769375`*^9, 3.4651855437197313`*^9}, {3.4652415653515377`*^9, 
   3.4652415655317965`*^9}, {3.466531532143261*^9, 3.4665315473651485`*^9}, {
   3.4689764805432205`*^9, 3.4689764856205215`*^9}, 3.46897651636473*^9, {
   3.4689765469687357`*^9, 3.4689766836552815`*^9}, {3.46897676312956*^9, 
   3.4689768130413294`*^9}, {3.472019785195696*^9, 3.4720198169313297`*^9}, 
   3.4770972375685806`*^9, 3.491749113978776*^9, {3.4922040668642783`*^9, 
   3.4922040994110785`*^9}, {3.492205488678747*^9, 3.492205604565384*^9}, {
   3.492207975724944*^9, 3.4922079760253763`*^9}, {3.4934267990913167`*^9, 
   3.4934268348927965`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "because", " ", "Solve", " ", "got", " ", "WRONG", " ", 
    RowBox[{"answer", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"reportpressure", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pg", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pm", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<P components\>\"", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Pbaryon", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Prad", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ppairs", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Tann\>\"", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Tann", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Tpl", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"taurad", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "taurad"}], "]"}], "//.", "solsT"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.464908280124674*^9, 3.464908294485323*^9}, {
  3.4649084649904976`*^9, 3.464908465170757*^9}, {3.464909135564736*^9, 
  3.4649091533302813`*^9}, {3.4651484596990643`*^9, 3.4651484707249184`*^9}, {
  3.4651486326577663`*^9, 3.4651486362929935`*^9}, {3.465187756271224*^9, 
  3.4651877717334576`*^9}, {3.4665315611750064`*^9, 3.4665315914685664`*^9}, {
  3.4667867669927998`*^9, 3.4667867766024*^9}, {3.4912612252476206`*^9, 
  3.4912612296439424`*^9}, {3.4917491143993807`*^9, 3.4917491167527647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getDelta", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "below", " ", "assumes", " ", "bsqvalue", " ", "in", " ", "HL", " ", 
       "units"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Below", " ", "is", " ", "va", " ", "mixed", " ", "between", " ", 
       "within", " ", "and", " ", "outside", " ", "layer"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vamix", "=", 
       RowBox[{
        RowBox[{"c", "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"bsqvalue", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rhobrad", "*", 
              RowBox[{"c", "^", "2"}]}], "+", "bsqvalue", "+", "Ugin", "+", 
             "Pgin"}], ")"}]}], "]"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Below", " ", "is", " ", 
         RowBox[{"va", " ", "**", "outside", "**", " ", "layer"}], " ", 
         "assuming", " ", "cold", " ", "there"}], ",", " ", 
        RowBox[{"which", " ", "is", " ", "true", " ", "so", " ", "far"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vaout", "=", 
       RowBox[{
        RowBox[{"c", "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"bsqvalue", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rhobingoing", "*", 
              RowBox[{"c", "^", "2"}]}], "+", "bsqvalue"}], ")"}]}], "]"}]}], 
        "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Below", " ", "is", " ", "va", " ", "inside", " ", "layer"}], 
        ",", " ", 
        RowBox[{"which", " ", "is", " ", "just", " ", 
         RowBox[{"0", " ", "--"}], " ", "never", " ", "should", " ", "be", 
         " ", "used"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vain", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"REDUNDANT", ":", " ", 
         RowBox[{
         "below", " ", "is", " ", "redundant", " ", "so", " ", "far"}]}], ",",
         " ", 
        RowBox[{
        "but", " ", "conveniant", " ", "place", " ", "to", " ", "have", " ", 
         "computed", " ", "for", " ", "clarity"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"muth", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"me", "*", 
            RowBox[{"c", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"kb", "*", "T"}], ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"omegape", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"4", "*", "Pi", "*", "netotforomegape", "*", 
           RowBox[{
            RowBox[{"q", "^", "2"}], "/", "me"}]}], "]"}], "*", 
         RowBox[{"omegaprelfactor", "[", "muth", "]"}]}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"muthp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"mp", "*", 
            RowBox[{"c", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"kb", "*", "T"}], ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"omegapp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"4", "*", "Pi", "*", 
           RowBox[{"np", "[", "rhobnorm", "]"}], "*", 
           RowBox[{
            RowBox[{"q", "^", "2"}], "/", "mp"}]}], "]"}], "*", 
         RowBox[{"omegaprelfactor", "[", "muthp", "]"}]}], "//.", "solsT"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Tpe", "=", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"Pi", "/", "omegape"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tpp", "=", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"Pi", "/", "omegapp"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Deltapete", "=", 
       RowBox[{
        RowBox[{"c", "/", "omegape"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Deltapetp", "=", 
       RowBox[{
        RowBox[{"c", "/", "omegapp"}], "//.", "solsT"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.464909890380107*^9, 3.464909914634984*^9}, {
   3.4649133269716835`*^9, 3.464913327181986*^9}, {3.464914734205186*^9, 
   3.464914746953517*^9}, {3.4650782895797744`*^9, 3.465078319392643*^9}, {
   3.4650783773559904`*^9, 3.465078378257286*^9}, {3.4650789516818304`*^9, 
   3.4650789582713056`*^9}, 3.465144281811557*^9, {3.4651443256546*^9, 
   3.4651443273971057`*^9}, 3.4651482079871197`*^9, {3.46515079270376*^9, 
   3.465150832210568*^9}, {3.4651536590453568`*^9, 3.4651538004086275`*^9}, {
   3.46518360260855*^9, 3.4651836090878673`*^9}, {3.4651875892510605`*^9, 
   3.4651875953598447`*^9}, {3.4652460910291424`*^9, 3.465246105890512*^9}, {
   3.4652463556095905`*^9, 3.4652463628199587`*^9}, {3.4652483001356816`*^9, 
   3.4652483078367553`*^9}, {3.465249150868976*^9, 3.4652491583196898`*^9}, {
   3.465249195903733*^9, 3.465249230112923*^9}, {3.46524928049537*^9, 
   3.465249315695986*^9}, {3.465249348453088*^9, 3.465249350425925*^9}, {
   3.465249384284611*^9, 3.465249389181653*^9}, {3.465249472461403*^9, 
   3.465249475425666*^9}, {3.4665316108364162`*^9, 3.4665316345405006`*^9}, {
   3.4670842162268*^9, 3.4670842168196*^9}, {3.4681002279635096`*^9, 
   3.468100242664649*^9}, {3.468100323861404*^9, 3.468100379271079*^9}, {
   3.4685759239931374`*^9, 3.468575929681317*^9}, {3.4685759889164925`*^9, 
   3.4685759982699423`*^9}, {3.468576693629821*^9, 3.4685766972550335`*^9}, {
   3.468576763890851*^9, 3.46857676416124*^9}, {3.4685768346526017`*^9, 
   3.468576835814272*^9}, {3.4686587129530416`*^9, 3.4686587134237185`*^9}, {
   3.4686591838601727`*^9, 3.4686591846212673`*^9}, {3.468661734978501*^9, 
   3.468661736360488*^9}, {3.4689773957091646`*^9, 3.4689774215863743`*^9}, {
   3.472005686280715*^9, 3.4720057326073294`*^9}, {3.472077000354915*^9, 
   3.4720770811510944`*^9}, {3.472077202966256*^9, 3.472077207673024*^9}, {
   3.472077839491534*^9, 3.4720778532813635`*^9}, 3.4770972469220304`*^9, {
   3.4771642521446238`*^9, 3.4771642552591023`*^9}, {3.477600880155134*^9, 
   3.4776008899091597`*^9}, {3.491261290972128*^9, 3.491261299053749*^9}, {
   3.4917491174537725`*^9, 3.491749121109029*^9}, {3.492208219545541*^9, 
   3.4922082214082193`*^9}, {3.4924493615006433`*^9, 3.492449363002803*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4686587153765264`*^9, 3.468658719973136*^9}, {
  3.4686588101828513`*^9, 3.4686588355493264`*^9}, {3.468659563255717*^9, 
  3.468659569013997*^9}, {3.4686596126367235`*^9, 3.4686596171732464`*^9}, {
  3.4686653147259245`*^9, 3.468665340603134*^9}, {3.4686655461186514`*^9, 
  3.468665551165909*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getlarmor", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "ELECTRONS", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Ee", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"3", "/", "2"}], "*", "kb", "*", "T"}], "//.", "solsT"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"thetae", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"me", "*", 
           RowBox[{"c", "^", "2"}]}], ")"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thetaevth", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "/", "2"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kb", "*", "T"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"me", "*", 
            RowBox[{"c", "^", "2"}]}], ")"}]}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vth", "=", 
       RowBox[{
        RowBox[{"c", "*", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"thetaevth", "*", 
            RowBox[{"(", 
             RowBox[{"2", "+", "thetaevth"}], ")"}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "thetaevth"}], ")"}]}]}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"ITERATED", ":", " ", "gammae"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gammae", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"vth", "/", "c"}], ")"}], "^", "2"}]}], "]"}]}], "//.", 
         "consts"}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pe", "=", 
       RowBox[{
        RowBox[{"gammae", "*", "me", "*", "vth"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Eele", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pe", "^", "2"}], "*", 
             RowBox[{"c", "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"me", "^", "2"}], "*", 
             RowBox[{"c", "^", "4"}]}]}], "]"}], "-", 
          RowBox[{"me", "*", 
           RowBox[{"c", "^", "2"}]}]}], ")"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ve", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"Eele", "*", 
            RowBox[{"2", "/", "me"}]}], "]"}], "//.", "solsT"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"wge", "=", 
       RowBox[{
        RowBox[{"q", "*", 
         RowBox[{
          RowBox[{"(", "bgaussrad", ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"gammae", "*", "me", "*", "c"}], ")"}]}]}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Check", " ", "Larmor", " ", "radius", " ", "in", " ", "comoving", " ",
         "frame"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Rl", "=", 
       RowBox[{
        RowBox[{"vth", "/", "wge"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rl", "/", "Lpnum"}], "//.", "solsT"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Deltapete", "/", "Lpnum"}], "//.", "solsT"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Deltapetp", "/", "Lpnum"}], "//.", "solsT"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "PROTONS", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"thetap", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"mp", "*", 
           RowBox[{"c", "^", "2"}]}], ")"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"thetapvthp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "/", "2"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"kb", "*", "T"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"mp", "*", 
            RowBox[{"c", "^", "2"}]}], ")"}]}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vthp", "=", 
       RowBox[{
        RowBox[{"c", "*", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"thetapvthp", "*", 
            RowBox[{"(", 
             RowBox[{"2", "+", "thetapvthp"}], ")"}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "thetapvthp"}], ")"}]}]}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gammap", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"vthp", "/", "c"}], ")"}], "^", "2"}]}], "]"}]}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pp", "=", 
       RowBox[{
        RowBox[{"gammap", "*", "mp", "*", "vthp"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ep", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pp", "^", "2"}], "*", 
             RowBox[{"c", "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"mp", "^", "2"}], "*", 
             RowBox[{"c", "^", "4"}]}]}], "]"}], "-", 
          RowBox[{"mp", "*", 
           RowBox[{"c", "^", "2"}]}]}], ")"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wgp", "=", 
       RowBox[{
        RowBox[{"q", "*", 
         RowBox[{"bgaussrad", "/", 
          RowBox[{"(", 
           RowBox[{"gammap", "*", "mp", "*", "c"}], ")"}]}]}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rlp", "=", 
       RowBox[{
        RowBox[{"vthp", "/", "wgp"}], "//.", "solsT"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.46507897831012*^9, 3.4650789966965585`*^9}, 
   3.465144328208272*^9, {3.465144446278048*^9, 3.4651444464583073`*^9}, {
   3.465150724926301*^9, 3.4651507426117315`*^9}, {3.4651507781428223`*^9, 
   3.465150785743752*^9}, {3.4651508371176243`*^9, 3.4651508545326653`*^9}, {
   3.465187601118125*^9, 3.4651876043928337`*^9}, {3.466531649892576*^9, 
   3.4665316637424912`*^9}, {3.4670842214528*^9, 3.4670842226071997`*^9}, {
   3.4686594033257484`*^9, 3.4686594847928925`*^9}, {3.468659827896251*^9, 
   3.4686598280765104`*^9}, {3.468660909942157*^9, 3.4686609107332945`*^9}, {
   3.4686639561323633`*^9, 3.4686639574442496`*^9}, {3.4686642309875855`*^9, 
   3.4686642311778593`*^9}, {3.4686643073874435`*^9, 3.468664316240173*^9}, {
   3.468666905663581*^9, 3.4686669872909555`*^9}, {3.4686698675325394`*^9, 
   3.4686698681434174`*^9}, {3.4686702333986287`*^9, 
   3.4686702794648685`*^9}, {3.468976877313749*^9, 3.468976886406824*^9}, {
   3.4689774604722896`*^9, 3.4689774770260925`*^9}, {3.4770902021721773`*^9, 
   3.477090210944792*^9}, {3.4770975096297855`*^9, 3.477097516529707*^9}, 
   3.4771780466701775`*^9, 3.491262048010696*^9, {3.4917491214695473`*^9, 
   3.4917491270175247`*^9}, {3.4922082594929824`*^9, 3.4922083061901293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getDeltasp", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"etac", "[", "units", "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"L", "^", "2"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"M", "*", 
            RowBox[{
             RowBox[{
              RowBox[{"L", "^", "2"}], "/", 
              RowBox[{"S", "^", "2"}]}], "/", 
             RowBox[{"L", "^", "3"}]}], "*", 
            RowBox[{"L", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"M", "*", 
            RowBox[{"L", "/", "S"}]}], ")"}]}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"L", "^", "2"}], "/", "S"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Uradnum", "=", 
       RowBox[{"Urad", "[", 
        RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nucg", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "/", "3"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Uradnum", "*", "sigmaesnum"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"me", "*", "c"}], ")"}]}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lambdamfpg", "=", 
       RowBox[{"vth", "/", "nucg"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dpe", "=", 
       RowBox[{
        RowBox[{"c", "/", "omegape"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"etac", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dpe", "^", "2"}], "*", "nucg"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ununum", "=", 
       RowBox[{"Unu", "[", 
        RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigmanuenum", "=", 
       RowBox[{"sigmanue", "[", 
        RowBox[{"rhobrad", ",", "Trad", ",", "bgaussrad", ",", "npairsrad"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nucnu", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "/", "3"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Ununum", "*", "sigmanuenum"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"me", "*", "c"}], ")"}]}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"etanu", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dpe", "^", "2"}], "*", "nucnu"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"LogL", "=", "20"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"vthermal", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "/", "2"}], "*", "kb", "*", "T"}], ")"}], "/", 
            "me"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vthermal", "=", 
       RowBox[{"vth", "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lambdaD", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vthermal", "/", "omegape"}], ")"}], "//.", "solsT"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "protons", " ", "witin", " ", "Debye", " ", 
        "sphere"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LambdaC1", "=", 
       RowBox[{"24", "*", "Pi", "*", 
        RowBox[{"np", "[", "rhobnorm", "]"}], "*", 
        RowBox[{"lambdaD", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"number", " ", "of", " ", "charge"}], "-", 
        RowBox[{
        "carrying", " ", "particles", " ", "within", " ", "Debye", " ", 
         "sphere"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LambdaC2", "=", 
       RowBox[{"24", "*", "Pi", "*", "netotforomegape", "*", 
        RowBox[{"lambdaD", "^", "3"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"old", ",", " ", 
        RowBox[{"just", " ", "checks"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LogLother1", "=", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"3", "/", "2"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sqrt", "[", "Pi", "]"}], "*", "1", "*", 
            RowBox[{"q", "^", "3"}], "*", 
            RowBox[{"nb", "[", "rhobnorm", "]"}]}], ")"}]}], "]"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lambdaC", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "1", ")"}], "*", 
         RowBox[{
          RowBox[{"q", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"kb", "*", "T"}], ")"}]}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"LogLother2", "=", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"lambdaD", "/", "lambdaC"}], "]"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"etas", "[", "units", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "/", "S"}], ")"}], "*", "L"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"etas", "=", 
         RowBox[{
          RowBox[{"c", "*", "radiuse", "*", 
           RowBox[{
            RowBox[{"(", "thetae", ")"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "/", "2"}], ")"}]}], "*", "LogLother2"}], "//.",
           "solsT"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"lambdac", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"q", "^", "2"}], "/", 
         RowBox[{"(", "Eele", ")"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigma0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"5", "/", "16"}], ")"}], "*", 
         RowBox[{"lambdac", "^", "2"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"logL", "=", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"lambdaD", "/", "lambdac"}], "]"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigmac", "=", 
       RowBox[{
        RowBox[{"sigma0", "*", "logL"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"below", " ", "uses", " ", "np"}], ",", " ", 
        RowBox[{
         RowBox[{
         "but", " ", "want", " ", "to", " ", "estimate", " ", "for", " ", 
          "ion"}], "+", "electron", "+", "positron"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"lambdamfps", "=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"sigmac", "*", "np"}], ")"}]}], "//.", "solsT"}]}], ";"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"netot", "=", 
         RowBox[{"ne", "+", "npairs"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "only", " ", "protons", " ", "and", " ", "pairs", " ", "make", " ", 
         "change", " ", "in", " ", "average", " ", "velocity", " ", "of", " ",
          "electron"}], "-", 
        RowBox[{"positron", " ", "pairs"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"nall", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"np", "[", "rhobnorm", "]"}], "+", "npairs"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lambdamfps", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"sigmac", "*", "nall"}], ")"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nucs", "=", 
       RowBox[{
        RowBox[{"vth", "/", "lambdamfps"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"etas", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dpe", "^", "2"}], "*", "nucs"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"etas", "<", "0.0"}], ",", 
        RowBox[{
         RowBox[{"etas", "=", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "500"}], ")"}]}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"OLD", ":", " ", 
        RowBox[{
        "Below", " ", "must", " ", "be", " ", "iterated", " ", "upon", " ", 
         "at", " ", "least", " ", "a", " ", "few", " ", "times"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"final", " ", "Spitzer", " ", 
        RowBox[{"result", " ", "--"}], " ", "now", " ", "same", " ", "as", 
        " ", "original", " ", "one"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"etab", "=", "etas"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tev", "=", 
       RowBox[{
        RowBox[{"kb", "*", 
         RowBox[{"T", "/", "ergPmev"}], "*", 
         RowBox[{"10", "^", "6"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"etaprimebook", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "14"}], ")"}]}], "*", "LogLother2", "*", 
         RowBox[{
          RowBox[{"(", "Tev", ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "/", "2"}], ")"}]}]}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"etaprimebook", "<", "0.0"}], ",", 
        RowBox[{
         RowBox[{"etaprimebook", "=", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "500"}], ")"}]}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"etabook", "=", 
       RowBox[{
        RowBox[{"etaprimebook", "*", 
         RowBox[{
          RowBox[{"c", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", "*", "Pi"}], ")"}]}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "total", " ", "resistivity", " ", "from", " ", "radiation", " ", 
        "drag", " ", "and", " ", "from", " ", 
        RowBox[{"Coulomb", "/", "annihilation"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"etatotal", "=", 
       RowBox[{"etac", "+", "etanu", "+", "etab"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Lundquistc", "=", 
       RowBox[{
        RowBox[{"Lpnum", "*", 
         RowBox[{"vaout", "/", "etac"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Lundquistnu", "=", 
       RowBox[{
        RowBox[{"Lpnum", "*", 
         RowBox[{"vaout", "/", "etanu"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Lundquists", "=", 
       RowBox[{
        RowBox[{"Lpnum", "*", 
         RowBox[{"vaout", "/", "etas"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Lundquistb", "=", 
       RowBox[{
        RowBox[{"Lpnum", "*", 
         RowBox[{"vaout", "/", "etabook"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Lundquistt", "=", 
       RowBox[{
        RowBox[{"Lpnum", "*", 
         RowBox[{"vaout", "/", "etatotal"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "UM10", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Deltaspc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ")"}]}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Lpnum", "*", 
           RowBox[{"etac", "/", "vaout"}]}], "]"}]}], "//.", "solsT"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Deltaspnu", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ")"}]}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Lpnum", "*", 
           RowBox[{"etanu", "/", "vaout"}]}], "]"}]}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Deltasps", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ")"}]}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Lpnum", "*", 
           RowBox[{"etas", "/", "vaout"}]}], "]"}]}], "//.", "solsT"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Deltaspb", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ")"}]}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Lpnum", "*", 
           RowBox[{"etabook", "/", "vaout"}]}], "]"}]}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Deltaspt", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ")"}]}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Lpnum", "*", 
           RowBox[{"etatotal", "/", "vaout"}]}], "]"}]}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "UM10", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vrecc0", "=", 
       RowBox[{"etac", "/", "Deltaspc"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vrecnu0", "=", 
       RowBox[{"etanu", "/", "Deltaspnu"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vrecs0", "=", 
       RowBox[{"etas", "/", "Deltasps"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vrecb0", "=", 
       RowBox[{"etab", "/", "Deltaspb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vrect0", "=", 
       RowBox[{"etatotal", "/", "Deltaspt"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vrecc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], "*", "vrecc0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vrecnu", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], "*", "vrecnu0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vrecs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], "*", "vrecs0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vrecb", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], "*", "vrecb0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vrect", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rhobcenter", "/", "rhobingoing"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], "*", "vrect0"}]}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.46490808080807*^9, 3.4649080900213184`*^9}, 
   3.4649133224652033`*^9, {3.4649133666587505`*^9, 3.46491337885629*^9}, {
   3.46491475900084*^9, 3.4649147628663983`*^9}, {3.4649148601863375`*^9, 
   3.4649148845513725`*^9}, {3.465079001233082*^9, 3.465079001884018*^9}, {
   3.4651823771764655`*^9, 3.465182378488352*^9}, {3.4651860376099105`*^9, 
   3.465186062435608*^9}, {3.4651876094701347`*^9, 3.4651876159895086`*^9}, {
   3.466531673296229*^9, 3.466531699133381*^9}, {3.4670842234652*^9, 
   3.4670842260236*^9}, {3.4672750682958174`*^9, 3.4672750696878195`*^9}, {
   3.4672750999613504`*^9, 3.467275142081917*^9}, {3.467327161612328*^9, 
   3.4673272395544033`*^9}, {3.467327685645851*^9, 3.467327687148011*^9}, {
   3.467327730109787*^9, 3.4673277742833056`*^9}, {3.467327817094866*^9, 
   3.4673278840411296`*^9}, {3.46732796081152*^9, 3.467327980529874*^9}, {
   3.467328035619088*^9, 3.4673280386834946`*^9}, {3.467328393423586*^9, 
   3.467328396407877*^9}, {3.467329950142037*^9, 3.4673299700606785`*^9}, {
   3.467330053961322*^9, 3.4673300545621853`*^9}, {3.4673320895383377`*^9, 
   3.467332169433221*^9}, {3.467332205975766*^9, 3.467332234787195*^9}, {
   3.4673323850031953`*^9, 3.4673323865754557`*^9}, {3.4673325176439233`*^9, 
   3.467332517714024*^9}, {3.467343387594144*^9, 3.4673434014741025`*^9}, {
   3.4673434970915937`*^9, 3.4673435090387726`*^9}, {3.4673534550404205`*^9, 
   3.467353467688608*^9}, {3.4673537003832064`*^9, 3.4673537068525085`*^9}, {
   3.4681003959350405`*^9, 3.468100404096777*^9}, {3.4686595852473392`*^9, 
   3.4686595947510047`*^9}, {3.4686596289702096`*^9, 
   3.4686598233296847`*^9}, {3.468659858610416*^9, 3.4686598860899296`*^9}, {
   3.468660051998494*^9, 3.468660100338003*^9}, {3.468660243283549*^9, 
   3.468660294046542*^9}, {3.468660375734003*^9, 3.468660397555381*^9}, {
   3.4686642285540867`*^9, 3.4686642288845615`*^9}, {3.4686660278613634`*^9, 
   3.46866603033492*^9}, {3.4686660626714177`*^9, 3.4686660696514544`*^9}, {
   3.4686661015773616`*^9, 3.4686661231784225`*^9}, {3.4686698689846272`*^9, 
   3.4686698703265567`*^9}, {3.468977683883539*^9, 3.4689776893914595`*^9}, {
   3.468977741586512*^9, 3.468977742738168*^9}, {3.4689792721273212`*^9, 
   3.4689793357688336`*^9}, {3.4689906291979876`*^9, 
   3.4689906357674336`*^9}, {3.4720018546611166`*^9, 
   3.4720018597784753`*^9}, {3.472005156559013*^9, 3.472005184328944*^9}, {
   3.472005217045989*^9, 3.4720052534883904`*^9}, {3.4721669008723907`*^9, 
   3.472166905018352*^9}, {3.4721669498928785`*^9, 3.4721669899004064`*^9}, {
   3.472168438753755*^9, 3.4721684388639135`*^9}, {3.4771507301209087`*^9, 
   3.4771507360594482`*^9}, {3.4771512682246637`*^9, 
   3.4771512683448367`*^9}, {3.47715140140617*^9, 3.4771514016164722`*^9}, {
   3.477158952353899*^9, 3.477158997008109*^9}, {3.477159307204149*^9, 
   3.477159346610813*^9}, 3.47716287647651*^9, {3.4771630207840147`*^9, 
   3.4771631034328575`*^9}, {3.4771635526988707`*^9, 3.47716357006384*^9}, {
   3.477163857967826*^9, 3.477163858198157*^9}, {3.4771653462578816`*^9, 
   3.477165381268224*^9}, {3.4771676079900928`*^9, 3.4771676200774736`*^9}, 
   3.477167658903302*^9, {3.4771678328133726`*^9, 3.477167839302704*^9}, 
   3.4771741467323427`*^9, 3.4771770880717807`*^9, {3.477177987855606*^9, 
   3.4771779886567583`*^9}, {3.4771780379276066`*^9, 3.477178058577299*^9}, {
   3.4771780910039263`*^9, 3.4771780932671804`*^9}, {3.477178296459357*^9, 
   3.477178297230466*^9}, {3.477178704506099*^9, 3.477178707500405*^9}, {
   3.4912621604423647`*^9, 3.491262160622624*^9}, {3.491262267165826*^9, 
   3.4912622735249696`*^9}, {3.4913369284851437`*^9, 3.49133694866416*^9}, {
   3.49174912750823*^9, 3.49174913510916*^9}, {3.4922065327099905`*^9, 
   3.4922065330905375`*^9}, {3.4922065799779587`*^9, 3.492206615869568*^9}, 
   3.4922082727420335`*^9, {3.4922083819490657`*^9, 3.4922083931952367`*^9}, {
   3.4924397973380527`*^9, 3.4924399387614098`*^9}, {3.492440070641043*^9, 
   3.492440073645363*^9}, {3.4924401114096656`*^9, 3.4924401217345123`*^9}, {
   3.4924414040684175`*^9, 3.4924414320386367`*^9}, {3.4924512205838737`*^9, 
   3.4924512219558463`*^9}, {3.4924514254484544`*^9, 3.4924514259591885`*^9}, 
   3.492451713432555*^9, {3.492452098045602*^9, 3.4924521184449344`*^9}, {
   3.4939246877835183`*^9, 3.493924689576096*^9}, {3.4939247286723137`*^9, 
   3.493924787436813*^9}, {3.4939248187217984`*^9, 3.493924846451672*^9}, {
   3.494054416947542*^9, 3.494054475692013*^9}, {3.4940545183934145`*^9, 
   3.494054537781293*^9}, {3.4940545728617363`*^9, 3.494054620700525*^9}, {
   3.494054710830125*^9, 3.4940547111906433`*^9}, {3.4941484890065203`*^9, 
   3.494148489487211*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"New", " ", "radiation", " ", "element"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getAumitself", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "foo", ",", "Aum", ",", "vaout", ",", "Qum0", ",", "Qtotnum"}], "}"}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vaout", "=", 
         RowBox[{
          RowBox[{"c", "*", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"bsqvalue", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rhobingoing", "*", 
                RowBox[{"c", "^", "2"}]}], "+", "bsqvalue"}], ")"}]}], 
            "]"}]}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Qum0", "=", 
         RowBox[{"bsqgaussvalue", "/", 
          RowBox[{"(", 
           RowBox[{"4", "*", "Pi", "*", 
            RowBox[{"Lpnum", "/", "vaout"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Qtotnum", "=", 
         RowBox[{"Qtot", "[", 
          RowBox[{
          "rhobnorm", ",", "rhobrad", ",", "Trad", ",", "bgaussnorm", ",", 
           "bgaussrad", ",", "npairsrad"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Qtotnum=\>\"", ",", "Qtotnum", ",", "\"\< Qum0=\>\"", ",", 
             "Qum0"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Aumitselfstuff: \>\"", ",", "Qum0", ",", "\"\< \>\"", ",", 
             "Qtotnum", ",", "\"\< \>\"", ",", "rhobnorm", ",", "\"\< \>\"", 
             ",", "rhobrad", ",", "\"\< \>\"", ",", "Trad", ",", "\"\< \>\"", 
             ",", "bgaussnorm", ",", "\"\< \>\"", ",", "bgaussrad", ",", 
             "\"\< \>\"", ",", "npairsrad"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Uzdensky", " ", "&"}], " ", "McKinney", " ", "2010"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Aum", "=", 
         RowBox[{"Qtotnum", "/", "Qum0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Aum", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Aum", "<", "1"}], ",", "1", ",", "Aum"}], "]"}]}], ";", 
        " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"If", " ", "Aum"}], "<", "1"}], ",", " ", 
          RowBox[{
          "then", " ", "reset", " ", "to", " ", "1", " ", "since", " ", 
           "back", " ", "to", " ", "SP", " ", "regime"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Aum", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"Aum", ",", "lowestprec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
        "Aum"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"for", " ", "iterating", " ", 
     RowBox[{"over", " ", "--"}], " ", "old", " ", "method"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getAum", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", "Aum", ",", "vaout"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"whichsplevel", "\[Equal]", "0"}], ",", 
          RowBox[{"rhobcenter", "=", "rhobingoing"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"whichsplevel", ">", "0"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Aum", "=", "getAumitself"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Aum=\>\"", ",", "Aum"}], "]"}], ";"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"ITEREATED", ":", " ", "rhobcenter"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"rhobcenter", "=", 
            RowBox[{"Aum", "*", "rhobingoing"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "set", " ", "precision", " ", "or", " ", "else", " ", "tiny", 
              " ", "loss", " ", "of", " ", "accuracy", " ", "in", " ", "Aum", 
              " ", "calculation", " ", "accumulates", " ", "after", " ", 
              RowBox[{"iterations", " ", "--"}], " ", "equivalent", " ", "to",
               " ", "WorkingPrecision"}], "\[Rule]", 
             RowBox[{
             "lowestprec", " ", "for", " ", "this", " ", "iteration", " ", 
              "process"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rhobcenter", "=", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{"rhobcenter", ",", "lowestprec"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.4924514476804223`*^9, 3.4924514634831457`*^9}, {
  3.4924516569613533`*^9, 3.492451703938904*^9}, {3.4924521303320274`*^9, 
  3.4924521602350254`*^9}, {3.4924528305188465`*^9, 3.4924528510483665`*^9}, {
  3.493176304805525*^9, 3.4931763128771315`*^9}, {3.493178682434387*^9, 
  3.4931786984073553`*^9}, {3.4931793865368366`*^9, 3.493179392605563*^9}, {
  3.4931820570768847`*^9, 3.4931820756636114`*^9}, {3.494052675583584*^9, 
  3.4940526959729023`*^9}, {3.4941283383613153`*^9, 3.494128412017227*^9}, {
  3.494129537285283*^9, 3.494129543584341*^9}, {3.494142285696598*^9, 
  3.4941423315625505`*^9}, {3.4941484777102766`*^9, 3.4941485580057364`*^9}, {
  3.494148629168062*^9, 3.494148672961034*^9}, {3.4941498603884706`*^9, 
  3.494149860929248*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "needs", " ", "to", " ", "be", " ", "updated", " ", "for", " ", "new", 
     " ", "full", " ", "SP", " ", "rel", " ", 
     RowBox[{"method", " ", "--"}], " ", "kinda", " ", "updated"}], ",", " ", 
    RowBox[{"but", " ", "reverted", " ", "partially"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getDeltasprelnew", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "relativistic", " ", "radiative", " ", "version", " ", "of", " ", 
        RowBox[{"SP", " ", "--"}], " ", "replace", " ", "Deltaspt", " ", 
        "with", " ", "its", " ", "output"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"have", " ", "etatotal"}], ",", " ", 
        RowBox[{"now", " ", "get", " ", "solution"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "ignore", " ", "relativistic", " ", "SP", " ", "stuff", " ", "for", 
        " ", "now"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"solvespfullall", ";", "\[IndentingNewLine]", 
       RowBox[{"Deltaspt", "=", "deltaspfinal"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4771782989829855`*^9, 3.4771783107699347`*^9}, {
  3.4771784415680127`*^9, 3.4771784465752125`*^9}, {3.47717862421064*^9, 
  3.4771786242807407`*^9}, {3.477600947091384*^9, 3.4776010093909664`*^9}, {
  3.4776011430731916`*^9, 3.477601174137861*^9}, {3.4850607514774623`*^9, 
  3.4850607616120353`*^9}, {3.4913375386224785`*^9, 3.491337538782709*^9}, {
  3.4913375959849615`*^9, 3.4913376132497873`*^9}, {3.491625075249843*^9, 
  3.4916250978924017`*^9}, {3.491747998995509*^9, 3.4917480300401487`*^9}, {
  3.4917492014245167`*^9, 3.491749201975309*^9}, {3.492206742731987*^9, 
  3.4922067500525136`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"limitT", "[", 
     RowBox[{"Ttrial0_", ",", "Tc0_", ",", "limitfactor0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", 
        RowBox[{"Ttrial", "=", "Ttrial0"}], ",", 
        RowBox[{"Tc", "=", "Tc0"}], ",", 
        RowBox[{"limitfactor", "=", "limitfactor0"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Ttrial", ">", 
          RowBox[{"limitfactor", "*", "Tc"}]}], ",", 
         RowBox[{
          RowBox[{"Ttrial", "=", 
           RowBox[{"limitfactor", "*", "Tc"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Ttrial", "<", 
          RowBox[{"Tc", "/", "limitfactor"}]}], ",", 
         RowBox[{
          RowBox[{"Ttrial", "=", 
           RowBox[{"Tc", "/", "limitfactor"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "return", "*)"}], "\[IndentingNewLine]", 
       "Ttrial"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4916260658041906`*^9, 3.4916261588880386`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "super", " ", "simplified", " ", "SP", " ", "case", " ", "of", " ", "only",
     " ", "using", " ", "pressure", " ", "equilibrium"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getDeltasprelorig", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", "limitfactor"}], "}"}], ",", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"solsT", "=", "solsTtrial"}], ";", "\[IndentingNewLine]", 
       RowBox[{"solsTrad", "=", "solsT"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\"\<iterate\>\"", " ", "fsolssp", " ", "as", " ", "if", " ", 
         "returned", " ", "like", " ", "in", " ", "solvespfullall", " ", 
         "for", " ", "full", " ", "SP", " ", "solution"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"myu4vel", "=", "0.01"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"just", " ", "keep", " ", "non"}], "-", "rel"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"myb", "=", "bgaussnorm"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ugnum", "=", 
        RowBox[{"Ug", "[", 
         RowBox[{
         "rhobnorm", ",", "rhobrad", ",", "Tnorm", ",", "bgaussnorm", ",", 
          "bgaussrad", ",", "npairsrad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myie", "=", "Ugnum"}], ";", "\[IndentingNewLine]", 
       RowBox[{"fsolssp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "\[Rule]", "Lpnum"}], ",", 
          RowBox[{"ux", "->", "myu4vel"}], ",", 
          RowBox[{"rhoc", "\[Rule]", "rhobvalue"}], ",", 
          RowBox[{"iec", "\[Rule]", "myie"}], ",", 
          RowBox[{"rhoout", "\[Rule]", "rhobvalue"}], ",", 
          RowBox[{"ieout", "\[Rule]", "myie"}], ",", 
          RowBox[{"Bx", "\[Rule]", "myb"}], ",", 
          RowBox[{"uy", "\[Rule]", "myu4vel"}]}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4913375453821983`*^9, 3.4913375462834945`*^9}, {
   3.491337637604808*^9, 3.4913376807869005`*^9}, {3.4913377166284385`*^9, 
   3.4913377526602497`*^9}, {3.4913377850067616`*^9, 
   3.4913378367010946`*^9}, {3.4913388721600113`*^9, 
   3.4913389147812977`*^9}, {3.491342221716437*^9, 3.4913423381638803`*^9}, {
   3.491342620389701*^9, 3.49134262082032*^9}, {3.4915311402279153`*^9, 
   3.4915311425212126`*^9}, {3.4915311966991167`*^9, 
   3.4915312035790095`*^9}, {3.4915991416491566`*^9, 3.491599182067275*^9}, {
   3.4916004726129885`*^9, 3.49160053534319*^9}, {3.491603174528152*^9, 
   3.491603180556821*^9}, {3.491608526804347*^9, 3.4916085665715294`*^9}, {
   3.4916178183449264`*^9, 3.4916178646815553`*^9}, {3.4916250206112766`*^9, 
   3.4916250376257424`*^9}, {3.49162510291963*^9, 3.4916252445032177`*^9}, {
   3.491625557222886*^9, 3.491625566325976*^9}, {3.491626027368923*^9, 
   3.4916260589142833`*^9}, {3.4916261662586365`*^9, 3.491626213907152*^9}, {
   3.4917480919191265`*^9, 3.4917482364870048`*^9}, 3.4917492084446115`*^9, {
   3.491755695742888*^9, 3.4917557148804064`*^9}, {3.491833654992784*^9, 
   3.4918336990561438`*^9}, {3.4918339211454926`*^9, 
   3.4918339215660973`*^9}, {3.4918340094024*^9, 3.491834009602688*^9}, {
   3.491839668469739*^9, 3.4918396731564784`*^9}, {3.49220400166052*^9, 
   3.4922040031226225`*^9}, {3.4922085112449837`*^9, 3.4922085888165264`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "simplified", " ", "SP", " ", "case", " ", "using", " ", "pressure", " ",
       "equilibrium", " ", "AND", " ", "radiative", " ", "equilibrium", " ", 
      "from", " ", "Uzdensky"}], " ", "&"}], " ", "McKinney", " ", "2010"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getDeltasprelum10", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"have", " ", "etatotal"}], ",", " ", 
        RowBox[{"now", " ", "get", " ", "solution"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "TODO", " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Now", " ", "need", " ", "to", " ", "set", " ", "Afactor", " ", "and", 
        " ", "use", " ", "Afactor", " ", "in", " ", "enhancing", " ", 
        "baryon", " ", "and", " ", "electron", " ", "density", " ", "in", " ",
         "layer"}], " ", "*)"}], "\[IndentingNewLine]", "1"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4913393130940433`*^9, 3.4913393887227917`*^9}, {
   3.4916252537064514`*^9, 3.4916252584933343`*^9}, 3.4934268425638275`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getconditione", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"electron", "/", "positrons"}], " ", "dominate", " ", 
       "resistivity", " ", "in", " ", "Petschek", " ", "regime"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"conditionec", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Deltapete", "/", 
            RowBox[{"(", 
             RowBox[{"Deltaspc", "+", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "500"}], ")"}]}]}], ")"}]}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conditionenu", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Deltapete", "/", 
            RowBox[{"(", 
             RowBox[{"Deltaspnu", "+", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "500"}], ")"}]}]}], ")"}]}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conditiones", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Deltapete", "/", 
            RowBox[{"(", 
             RowBox[{"Deltasps", "+", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "500"}], ")"}]}]}], ")"}]}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conditioneb", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Deltapete", "/", 
            RowBox[{"(", 
             RowBox[{"Deltaspb", "+", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "500"}], ")"}]}]}], ")"}]}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conditionet", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Deltapete", "/", 
             RowBox[{"(", "Deltaspt", ")"}]}], "+", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "500"}], ")"}]}]}], ")"}], "//.", "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4649084913584127`*^9, 3.4649085056189184`*^9}, {
  3.465144284765805*^9, 3.465144285226467*^9}, {3.4651443292197266`*^9, 
  3.465144329690403*^9}, {3.465170283196176*^9, 3.46517029055676*^9}, {
  3.465170320970493*^9, 3.465170321300968*^9}, {3.4651860723598785`*^9, 
  3.4651860771167183`*^9}, {3.465187700801462*^9, 3.4651877065096703`*^9}, {
  3.466531710730056*^9, 3.4665317217659245`*^9}, {3.4672751512250643`*^9, 
  3.467275158685792*^9}, {3.467353621189331*^9, 3.467353642590104*^9}, {
  3.491749136210744*^9, 3.4917491370319247`*^9}, {3.4931760159301424`*^9, 
  3.493176016320704*^9}, {3.4940546373945293`*^9, 3.494054647559146*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getconditionp", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "protons", " ", "dominate", " ", "resistivity", " ", "in", " ", 
       "Petschek", " ", 
       RowBox[{"regime", " ", "--"}], " ", 
       RowBox[{"normal", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"conditionpc", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Deltapetp", "/", "Deltaspc"}], "+", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "500"}], ")"}]}]}], ")"}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conditionpnu", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Deltapetp", "/", "Deltaspnu"}], "+", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "500"}], ")"}]}]}], ")"}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conditionps", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Deltapetp", "/", "Deltasps"}], "+", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "500"}], ")"}]}]}], ")"}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conditionpb", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Deltapetp", "/", "Deltaspb"}], "+", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "500"}], ")"}]}]}], ")"}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conditionpt", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Deltapetp", "/", "Deltaspt"}], "+", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "500"}], ")"}]}]}], ")"}], ")"}], "//.", 
          "solsT"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bsqvalue", ">", "0"}], ",", 
           RowBox[{"rhobvalue", ">", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Size", " ", "of", " ", "Pet", " ", "layer", " ", "compared", " ", 
        "to", " ", "Lpnum"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "so", " ", "perhaps", " ", "every", " ", "GRB", " ", "fred", " ", "is",
         " ", "a", " ", "reconnection", " ", "event", " ", "and", " ", 
        "number", " ", "of", " ", "freds", " ", "related", " ", "to", " ", 
        "number", " ", "of", " ", "polarity", " ", "flips"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Deltapetp", "/", "Lpnum"}], "//.", "solsT"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.465170274734008*^9, 3.465170317475467*^9}, {
  3.4651860837262225`*^9, 3.4651860882827744`*^9}, {3.4651877133995776`*^9, 
  3.4651877159232063`*^9}, {3.466531736467064*^9, 3.466531752960781*^9}, {
  3.4670842272248*^9, 3.4670842280671997`*^9}, {3.4672751711837635`*^9, 
  3.467275176100834*^9}, {3.4673536444127245`*^9, 3.4673536577519054`*^9}, {
  3.4917491375727024`*^9, 3.4917491388345165`*^9}, {3.493176019515298*^9, 
  3.4931760198758163`*^9}, {3.4940546520155535`*^9, 3.494054656562091*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getTobs", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"observed", " ", "energy", " ", "in", " ", "MeV"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "//.", "solsT"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Eco", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "ergPmev"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", "gammavalue", ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Observed value in MeV\>\"", "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Eobs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "ergPmev"}], ")"}], "*", "gammavalue", "*", 
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"ITERATED", ":", " ", "gammae"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gammae", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"me", "*", 
           RowBox[{"c", "^", "2"}]}], ")"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Esynobs", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1.7", "*", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "8"}], ")"}]}], "/", 
           RowBox[{"10", "^", "6"}]}], "*", "ergPmev", "*", "gammavalue", "*",
           "bgaussrad", "*", 
          RowBox[{"gammae", "^", "2"}]}], "//.", "solsT"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Esynobskev", "=", 
       RowBox[{
        RowBox[{"Esynobs", "/", "ergPmev"}], "*", "1000"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Eobsickev", "=", 
       RowBox[{"Esynobskev", "*", 
        RowBox[{"gammae", "^", "2"}]}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4651861893781424`*^9, 3.4651862242282543`*^9}, {
   3.465187636448928*^9, 3.465187641245826*^9}, {3.465229439275096*^9, 
   3.465229449189352*^9}, {3.4652316707738333`*^9, 3.4652316720957346`*^9}, {
   3.465240056521947*^9, 3.465240159890584*^9}, {3.4652402417182465`*^9, 
   3.4652402640303297`*^9}, {3.465240485278469*^9, 3.4652405312746077`*^9}, {
   3.4664618379866047`*^9, 3.466461844536022*^9}, {3.466531761072445*^9, 
   3.4665317622140865`*^9}, {3.4665318831079235`*^9, 3.46653189475467*^9}, {
   3.4667867831232*^9, 3.466786784418*^9}, {3.477090225976406*^9, 
   3.477090232776184*^9}, 3.477097518272213*^9, {3.4917491393953233`*^9, 
   3.491749141037685*^9}, {3.492206796188854*^9, 3.4922068102090144`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gettimeann", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Get", " ", "pair", " ", "density", " ", "for", " ", "critical", " ", 
         "field"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tannother", "=", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"ndentottemp2", "*", "sigmat", "*", "c"}], ")"}]}]}], ";", 
        " ", 
        RowBox[{"(*", " ", 
         RowBox[{"ndentottemp2", " ", "is", " ", "a", " ", "variable"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"muth", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"me", "*", 
            RowBox[{"c", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"kb", "*", "T"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"omegap", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"4", "*", "Pi", "*", "ndentottemp2", "*", 
            RowBox[{
             RowBox[{"q", "^", "2"}], "/", "me"}]}], "]"}], "*", 
          RowBox[{"omegaprelfactor", "[", "muth", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tplother", "=", 
         RowBox[{"2", "*", 
          RowBox[{"Pi", "/", "omegap"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<myn\>\"", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myn", "=", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{"Tannother", "\[Equal]", "Tplother"}], ",", 
            "ndentottemp2"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myn", "*", "me", "*", 
         RowBox[{"mp", "/", "me"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"paireden", "=", 
         RowBox[{"myn", "*", "me", "*", 
          RowBox[{"c", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Obtain", " ", "classical", " ", "critical", " ", "field", " ", 
          "strength"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"paireden", "\[Equal]", 
           RowBox[{
            RowBox[{"Bit", "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"8", "*", "Pi"}], ")"}]}]}], ",", "Bit"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"estimate", " ", "quantum", " ", "correction"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{"10", "^", "15"}], "/", "137."}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Compare", " ", "number", " ", "density", " ", "with", " ", 
          "classical", " ", "electron", " ", "density"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", 
           RowBox[{"Pi", "/", "3"}], "*", 
           RowBox[{"radiuse", "^", "3"}]}], ")"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.464914778989582*^9, 3.464914779169842*^9}, {
   3.4650781701580544`*^9, 3.465078174003584*^9}, 3.465078589030363*^9, {
   3.4650786455115795`*^9, 3.465078694972701*^9}, {3.4650787364022737`*^9, 
   3.4650788128321743`*^9}, {3.4651445131341825`*^9, 3.465144516318762*^9}, {
   3.4665319123499713`*^9, 3.4665319391485057`*^9}, {3.46665492081719*^9, 
   3.466654933595565*^9}, {3.4667867894568*^9, 3.4667867906736*^9}, {
   3.472005771693533*^9, 3.4720058052718163`*^9}, {3.47207786342595*^9, 
   3.4720778664402847`*^9}, {3.49220687203792*^9, 3.4922068757833056`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gettaus", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"netotnum", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ne", "[", "rhobnorm", "]"}], "+", "npairs"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"taupairL", "=", 
       RowBox[{
        RowBox[{"netotnum", "*", "sigmaesnum", "*", "Lpnum"}], "//.", 
        "consts"}]}], ";", " ", 
      RowBox[{"(*", " ", "diag", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"taugammaL", "=", 
       RowBox[{
        RowBox[{"netotnum", "*", "sigmaesnum", "*", "Lpnum"}], "//.", 
        "consts"}]}], ";", " ", 
      RowBox[{"(*", " ", "diag", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Sweet", " ", "Parker", " ", "optical", " ", "depth", " ", "across", 
        " ", "layer", " ", "and", " ", "along", " ", "layer"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"tauspc", "=", 
       RowBox[{
        RowBox[{"sigmaesnum", "*", "netotnum", "*", "Deltaspc"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tausps", "=", 
       RowBox[{
        RowBox[{"sigmaesnum", "*", "netotnum", "*", "Deltasps"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tauspt", "=", 
       RowBox[{
        RowBox[{"sigmaesnum", "*", "netotnum", "*", "Deltaspt"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tauL", "=", 
       RowBox[{
        RowBox[{"sigmaesnum", "*", "netotnum", "*", 
         RowBox[{"(", "1", ")"}], "*", "Lpnum"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "compute", " ", "optical", " ", "depth", " ", "to", " ", "electron", 
        " ", "scattering", " ", "within", " ", "Petschek", " ", "layer"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"taupete", "=", 
       RowBox[{
        RowBox[{"sigmaesnum", "*", "netotnum", "*", "Deltapete"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"taupetp", "=", 
       RowBox[{
        RowBox[{"sigmaesnum", "*", "netotnum", "*", "Deltapetp"}], "/.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Compute", " ", "optical", " ", "depth", " ", "to", " ", "baryon"}], 
        "-", 
        RowBox[{"electron", " ", "scattering"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sigmac", "=", 
         RowBox[{
          RowBox[{"sigmat", "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"kb", "*", 
              RowBox[{"T", "/", 
               RowBox[{"(", 
                RowBox[{"me", "*", 
                 RowBox[{"c", "^", "2"}]}], ")"}]}]}], ")"}], "^", "2"}]}], "//.",
           "solsT"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"taubet", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"np", "[", "rhobrad", "]"}], "*", 
         RowBox[{"(", "Deltaspt", ")"}], "*", "sigmac"}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"taubef", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"np", "*", 
            RowBox[{"(", 
             RowBox[{"Lpnum", "*", "fcover"}], ")"}], "*", "sigmac"}], "//.", 
           "consts"}], "//.", "solsT"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "baryons", " ", "exist", " ", "across", " ", "entire", " ", "jet"}], 
        ",", " ", 
        RowBox[{"not", " ", "just", " ", "in", " ", "layers"}]}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"taubef", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"sigmaesnum", "*", 
          RowBox[{"np", "[", "rhobrad", "]"}], "*", "Rjet"}], "//.", 
         "consts"}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"taubeR", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"np", "[", "rhobrad", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"Lpnum", "*", "1"}], ")"}], "*", "sigmac"}], "//.", 
        "solsT"}]}], ";"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "So", " ", "for", " ", "any", " ", "reasonable", " ", "temperature", " ",
       "baryons", " ", "and", " ", "electrons", " ", "are", " ", 
      "significantly", " ", "coupled", " ", "due", " ", "to", " ", "high", 
      " ", "density", " ", "still"}], " ", "*)"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4649148268884573`*^9, 3.4649148270587025`*^9}, {
   3.4651445410042577`*^9, 3.4651445920977263`*^9}, {3.465185847646757*^9, 
   3.4651858584022226`*^9}, {3.465185906801818*^9, 3.4651859307562623`*^9}, {
   3.4665319561729856`*^9, 3.466531971785435*^9}, {3.466532005123373*^9, 
   3.4665320123237267`*^9}, {3.4670842287692003`*^9, 3.4670842295336*^9}, {
   3.4672011973045487`*^9, 3.467201231393566*^9}, {3.4672015446840563`*^9, 
   3.4672015518543663`*^9}, {3.4673255221949615`*^9, 3.467325574299885*^9}, {
   3.467330139013621*^9, 3.4673301394943123`*^9}, {3.467330188735117*^9, 
   3.4673302049183874`*^9}, {3.4673407952865887`*^9, 3.467340796127798*^9}, {
   3.468979738858448*^9, 3.468979740110248*^9}, {3.472020001957384*^9, 
   3.472020021705781*^9}, {3.472020219089605*^9, 3.4720202361341133`*^9}, {
   3.4771638656488705`*^9, 3.477163865809101*^9}, 3.47717414727312*^9, {
   3.491749141348131*^9, 3.491749143861746*^9}, {3.491775459061144*^9, 
   3.4917754751743135`*^9}, {3.4922068875201826`*^9, 
   3.4922069462546387`*^9}, {3.4922089334721165`*^9, 3.4922089439571934`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getTdiffs", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Compare", " ", "photon", " ", "diffusion", " ", "time", " ", "across", 
       " ", "layer", " ", "and", " ", "transit", " ", "time", " ", "along", 
       " ", "layer"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TdiffacrossSPc", " ", "=", " ", 
       RowBox[{
        RowBox[{"tauspc", "*", 
         RowBox[{"Deltaspc", "/", "c"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TdiffacrossSPs", " ", "=", " ", 
       RowBox[{
        RowBox[{"tausps", "*", 
         RowBox[{"Deltasps", "/", "c"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TdiffacrossSPt", "=", " ", 
       RowBox[{
        RowBox[{"tauspt", "*", 
         RowBox[{"Deltaspt", "/", "c"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tdiffalong", "=", " ", 
       RowBox[{
        RowBox[{"tauL", "*", 
         RowBox[{"Lpnum", "/", "c"}]}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Tdiffsca1obs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "gammavalue"}], ")"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"3", "*", "tauradscanum", "*", 
           RowBox[{"Hscanum", "/", "c"}]}], ",", 
          RowBox[{"Hscanum", "/", "c"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tdiffsca2obs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "gammavalue"}], ")"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{
            RowBox[{"Deltaspt", "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"lambdascanum", "*", "c"}], ")"}]}]}], ",", 
          RowBox[{"Deltaspt", "/", "c"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tdiffsca3obs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "gammavalue"}], ")"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{
            RowBox[{"Deltapetp", "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"lambdascanum", "*", "c"}], ")"}]}]}], ",", 
          RowBox[{"Deltapetp", "/", "c"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Tdiffabs1obs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "gammavalue"}], ")"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"3", "*", "tauradabsnum", "*", 
           RowBox[{"Habsnum", "/", "c"}]}], ",", 
          RowBox[{"Habsnum", "/", "c"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tdiffabs2obs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "gammavalue"}], ")"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{
            RowBox[{"Deltaspt", "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"lambdaabsnum", "*", "c"}], ")"}]}]}], ",", 
          RowBox[{"Deltaspt", "/", "c"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tdiffabs3obs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "gammavalue"}], ")"}], "*", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{
            RowBox[{"Deltapetp", "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"lambdaabsnum", "*", "c"}], ")"}]}]}], ",", 
          RowBox[{"Deltapetp", "/", "c"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Below", " ", "is", " ", "one", " ", "special", " ", "case", " ", 
        "when", " ", "Lp", " ", "should", " ", "really", " ", "be", " ", 
        "used", " ", "since", " ", "directly", " ", "along", " ", "single", 
        " ", "current", " ", "layer"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Ejection", " ", "particle", " ", "velocity", " ", "is", " ", "Alfven",
         " ", "velocity", " ", "outside", " ", "layer"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"vtransit", "=", "vaout"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ttransit", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Lpnum", "/", "vtransit"}], ")"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ttransitobs", "=", 
       RowBox[{"Ttransit", "/", "gammavalue"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "So", " ", "photons", " ", "leak", " ", "out", " ", "and", " ", "cool",
         " ", "layer", " ", "before", " ", "transiting", " ", "fluid", " ", 
        "is", " ", "heated"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "16"}], ")"}]}], " ", "just", " ", "avoids", " ", 
         "warning", " ", "messages", " ", "about", " ", 
         RowBox[{"1", "/", "0"}], " ", "when", " ", "mmode"}], "=", "0"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"TF", "=", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"Pi", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"mmode", "+", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "16"}], ")"}]}]}], ")"}], "*", "omegafvalue"}], 
           ")"}]}]}], "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Nslabs", "=", "10"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"assumes", " ", "vr"}], "=", 
        RowBox[{"0.1", "c"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"NpulsesperT", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "TF"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "/", "Nslabs"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dtminobs", "=", 
       RowBox[{"10", "*", "TF"}]}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4649148355709424`*^9, 3.4649148422505474`*^9}, {
   3.465144574963088*^9, 3.465144624504325*^9}, {3.4651857502266736`*^9, 
   3.4651857689435873`*^9}, {3.4651858631891055`*^9, 
   3.4651858710303807`*^9}, {3.466531982150339*^9, 3.466531992955877*^9}, {
   3.4670842302044*^9, 3.4670842308752003`*^9}, {3.4672013955996833`*^9, 
   3.467201415538354*^9}, {3.4673255819308577`*^9, 3.4673255889309235`*^9}, 
   3.467340708842288*^9, {3.4681004227135468`*^9, 3.468100448310353*^9}, {
   3.4917491441621776`*^9, 3.4917491451936607`*^9}, {3.493588144718357*^9, 
   3.493588231693421*^9}, {3.493588290608136*^9, 3.4935884479944468`*^9}, {
   3.493588513899213*^9, 3.493588584620906*^9}, {3.493588719725176*^9, 
   3.4935888265688095`*^9}, {3.4935892654198465`*^9, 
   3.4935892848277535`*^9}, {3.49358932710855*^9, 3.4935893317452173`*^9}, {
   3.4935895190345263`*^9, 3.493589525383656*^9}, 3.4936043087510943`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getdtobs", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"observed", " ", "reconnection", " ", "time", " ", "scale"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"dtobs", "=", 
         RowBox[{"Ttransit", "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"gammavalue", "^", "2"}]}], ")"}]}]}], ";", " ", 
        RowBox[{"--", " ", "no"}]}], ",", " ", 
       RowBox[{
       "not", " ", "a", " ", "photon", " ", "catching", " ", "up", " ", 
        "with", " ", "shock"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dttransitobs", "=", 
       RowBox[{"Ttransit", "/", 
        RowBox[{"(", "gammavalue", ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "rfast", " ", "is", " ", "location", " ", "where", " ", "fast", " ", 
        "reconnection", " ", "occurs"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rtransfast", "=", 
       RowBox[{"rfast", " ", "+", " ", 
        RowBox[{"dttransitobs", "*", "c"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"radiation", " ", "timescale", " ", "for", " ", "observer"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dtradobs", "=", 
       RowBox[{"dtrad", "/", "gammavalue"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Get", " ", "luminosity", " ", "of", " ", "sheets"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"below", " ", "wrong"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vrecon", "=", 
       RowBox[{"0.1", "*", "vaout"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lrobs1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "gammavalue", ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"2", "*", "bsqvalue", "*", "vrecon"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"2", "*", "Pi", "*", "Rjet"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"2", "*", "Lpnum"}], ")"}]}], "//.", "consts"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Below", " ", "wrong"}], ",", " ", 
        RowBox[{
        "new", " ", "calculation", " ", "shows", " ", "luminosity", " ", "is",
          " ", "just", " ", "jet", " ", "luminosity"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Lrobsf", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "gammavalue", ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"fcover", "*", 
             RowBox[{"Rjet", "/", "Deltapetp"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"2", "*", "bsqvalue", "*", "vrecon"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi", "*", "Rjet"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Lpnum"}], ")"}]}], "//.", "consts"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Lrobsf", "=", 
       RowBox[{
        RowBox[{"gammavalue", "^", "2"}], "*", "bsqvalue", "*", "c", "*", 
        "Pi", "*", 
        RowBox[{"Rjet", "^", "2"}]}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.465234200701691*^9, 3.4652342091939025`*^9}, {
  3.465234370986549*^9, 3.465234372438637*^9}, {3.465234518698949*^9, 
  3.465234527241232*^9}, {3.465236756847248*^9, 3.465236774392477*^9}, {
  3.465236905561088*^9, 3.465236911479598*^9}, {3.4652370279570847`*^9, 
  3.465237044891435*^9}, {3.465237261322648*^9, 3.465237269484384*^9}, {
  3.4652376366323166`*^9, 3.465237636772518*^9}, {3.466532021997637*^9, 
  3.4665320349061985`*^9}, {3.4670713605984497`*^9, 3.46707136730645*^9}, {
  3.4689804241538544`*^9, 3.468980546970456*^9}, {3.4689805819006834`*^9, 
  3.4689806022599583`*^9}, {3.4720205353744*^9, 3.472020554722221*^9}, {
  3.4720205857768755`*^9, 3.472020596922902*^9}, {3.4924401778051376`*^9, 
  3.4924401797078733`*^9}, {3.4935887440000815`*^9, 3.4935887514708242`*^9}, {
  3.4935894744103603`*^9, 3.493589477995515*^9}, {3.493594148431272*^9, 
  3.493594165455752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getidealValidity", ":=", 
   RowBox[{"Module", "[", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"netotnum", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ne", "[", "rhobnorm", "]"}], "+", "npairs"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"with", " ", 
        RowBox[{"pairs", " ", "--"}], 
        RowBox[{"i", ".", "e", ".", " ", "inside"}], " ", "SP", " ", 
        "layer"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vdprime", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "*", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"bsqvalue", "*", "4", "*", "Pi"}], "]"}], "/", 
            "Lpnum"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "Pi", "*", "q", "*", "netotnum"}], ")"}]}], "//.",
         "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vdprime", "/", "c"}], "//.", "solsT"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"without", " ", "pairs"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vdprime", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "*", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"bsqvalue", "*", "4", "*", "Pi"}], "]"}], "/", 
            "Lpnum"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "Pi", "*", "q", "*", "netotnum"}], ")"}]}], "//.",
         "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vdprime", "/", "c"}], "//.", "solsT"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"with", " ", "current"}], "-", 
        RowBox[{"carrying", " ", "electrons"}], "+", "positrons"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Jenc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Bphivalue"}], "*", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"4", "*", "Pi"}], "]"}], "*", "Rjet", "*", "2", "*", "c"}],
          ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"4", "*", "Pi", "*", 
          RowBox[{"Rjet", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vdprime", "=", 
       RowBox[{
        RowBox[{"Jenc", "/", 
         RowBox[{"(", 
          RowBox[{"q", "*", "netotforomegape"}], ")"}]}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vdprime", "/", "c"}], "//.", "solsT"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Cthermg", "=", 
       RowBox[{
        RowBox[{"Ttransit", "*", "nucg"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ctherms", "=", 
       RowBox[{
        RowBox[{"Ttransit", "*", "nucs"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Cthermnu", "=", 
       RowBox[{
        RowBox[{"Ttransit", "*", "nucnu"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tp", "=", 
       RowBox[{
        RowBox[{"Lpnum", "/", "vaout"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"V1g", "=", 
       RowBox[{
        RowBox[{"Tp", "*", "nucg"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"V1s", "=", 
       RowBox[{
        RowBox[{"Tp", "*", "nucs"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"V2g", "=", 
       RowBox[{
        RowBox[{"Lpnum", "/", "lambdamfpg"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"V2s", "=", 
       RowBox[{
        RowBox[{"Lpnum", "/", "lambdamfps"}], "//.", "solsT"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dv", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"0.2", "*", "Lpnum", "*", 
          RowBox[{"(", "omegafvalue", ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V3g", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dv", "*", 
          RowBox[{"Lpnum", "/", 
           RowBox[{"(", 
            RowBox[{"vth", "*", "lambdamfpg"}], ")"}]}]}], "//.", "consts"}], 
        "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V3s", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dv", "*", 
          RowBox[{"Lpnum", "/", 
           RowBox[{"(", 
            RowBox[{"vth", "*", "lambdamfps"}], ")"}]}]}], "//.", "consts"}], 
        "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V5e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tp", "*", 
          RowBox[{"omegape", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi"}], ")"}]}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V5p", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tp", "*", 
          RowBox[{"omegapp", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi"}], ")"}]}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V6", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Lp", "/", "lambdaD"}], ")"}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V7", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Exp", "[", "logL", "]"}], ")"}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V8a", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"wge", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi", "*", "nucg"}], ")"}]}], ")"}], "//.", 
         "consts"}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V8b", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"wge", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi", "*", "nucs"}], ")"}]}], ")"}], "//.", 
         "consts"}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V8c", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"wgp", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi", "*", "nucg"}], ")"}]}], ")"}], "//.", 
         "consts"}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V8d", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"wgp", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi", "*", "nucs"}], ")"}]}], ")"}], "//.", 
         "consts"}], "//.", "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V9a", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"vth", "/", "vdprime"}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V9b", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dv", "/", "vdprime"}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V10", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tp", "*", 
          RowBox[{"wge", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "Pi"}], ")"}]}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V11", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "/", "Rl"}], "//.", "consts"}], "//.", "solsT"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V12e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tp", "*", 
          RowBox[{
           RowBox[{"omegape", "^", "2"}], "/", "wge"}]}], "//.", "consts"}], "//.",
         "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V12p", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tp", "*", 
          RowBox[{
           RowBox[{"omegapp", "^", "2"}], "/", "wgp"}]}], "//.", "consts"}], "//.",
         "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V13e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Lp", "/", "Rl"}], ")"}], "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"Tp", "*", "omegape"}], ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V13p", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Lp", "/", "Rlp"}], ")"}], "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"Tp", "*", "omegapp"}], ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V14g", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "*", 
          RowBox[{"dv", "/", "etac"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V14s", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "*", 
          RowBox[{"dv", "/", "etab"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V15e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tp", "*", "omegape"}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V15p", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tp", "*", "omegapp"}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V16e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"omegape", "^", "2"}], "/", "wge"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"dv", "/", 
            RowBox[{"c", "^", "2"}]}], ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V16p", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"omegapp", "^", "2"}], "/", "wgp"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"dv", "/", 
            RowBox[{"c", "^", "2"}]}], ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V17e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "*", "dv", "*", 
          RowBox[{"wge", "/", 
           RowBox[{"vth", "^", "2"}]}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V17p", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "*", "dv", "*", 
          RowBox[{"wgp", "/", 
           RowBox[{"vthp", "^", "2"}]}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V18e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "*", 
          RowBox[{"wge", "/", "vth"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V18p", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Lp", "*", 
          RowBox[{"wgp", "/", "vthp"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"netotnum", "=", 
       RowBox[{"netot", "[", 
        RowBox[{"rhobrad", ",", "npairsrad"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"q", "^", "2"}], " ", "=", " ", 
        RowBox[{"g", " ", 
         RowBox[{
          RowBox[{"cm", "^", "3"}], "/", 
          RowBox[{"s", "^", "2"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Jcur", " ", "=", " ", 
        RowBox[{"q", "/", 
         RowBox[{"(", 
          RowBox[{"s", " ", 
           RowBox[{"cm", "^", "2"}], "  ", "as", " ", "desired"}], " "}]}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Jcur", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "*", "c", "*", "Rjet", "*", "Bphivalue"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"Rjet", "^", "2"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vdrifte", "=", 
       RowBox[{"Jcur", "/", 
        RowBox[{"(", 
         RowBox[{"netotnum", "*", "q"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vdrifteperc", "=", 
       RowBox[{"vdrifte", "/", "c"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"dimensionless", " ", "as", " ", "required"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"V19a", "=", 
       RowBox[{"vth", "/", "vdrifte"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V19b", "=", 
       RowBox[{"1", "/", "vdrifteperc"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"space", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"V20e", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dv", "/", 
          RowBox[{"(", 
           RowBox[{"vth", "*", 
            RowBox[{"Rl", "/", "Lp"}]}], ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V20p", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"dv", "/", 
          RowBox[{"(", 
           RowBox[{"vthp", "*", 
            RowBox[{"Rlp", "/", "Lp"}]}], ")"}]}], "//.", "consts"}], "//.", 
        "solsT"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.468665559447818*^9, 3.468665622869013*^9}, {
   3.4686656601626387`*^9, 3.468665660883675*^9}, {3.46866591275585*^9, 
   3.4686659583614273`*^9}, {3.4686660009326415`*^9, 
   3.4686660179871645`*^9}, {3.4686660845929394`*^9, 
   3.4686660912324867`*^9}, {3.4686661345147233`*^9, 3.468666257040907*^9}, {
   3.4686663397698655`*^9, 3.468666436408826*^9}, {3.4686665287816515`*^9, 
   3.4686665680781565`*^9}, {3.468666615596485*^9, 3.4686667589125633`*^9}, {
   3.468666794333496*^9, 3.46866689257476*^9}, {3.4686669936400847`*^9, 
   3.468667294622877*^9}, {3.468667337013832*^9, 3.468667420403741*^9}, {
   3.4686675598342323`*^9, 3.4686675814753504`*^9}, {3.468667797315714*^9, 
   3.468667798897989*^9}, {3.46866811933876*^9, 3.4686681195090046`*^9}, {
   3.468669870977493*^9, 3.4686698719589043`*^9}, {3.477163873790578*^9, 
   3.477163873960822*^9}, 3.4771741478138976`*^9, {3.4917491453839345`*^9, 
   3.491749156169443*^9}, {3.4922069751161394`*^9, 3.492206992040475*^9}, {
   3.492209010643083*^9, 3.4922090108433714`*^9}, {3.4934295526507406`*^9, 
   3.4934296787921233`*^9}, {3.4934297753709965`*^9, 
   3.4934297886400766`*^9}, {3.493429860142893*^9, 3.4934299331378546`*^9}, {
   3.493430052369301*^9, 3.4934300715669055`*^9}, {3.493430103623*^9, 
   3.493430106607291*^9}, {3.493430788307528*^9, 3.493430817819965*^9}, {
   3.4934308641265507`*^9, 3.493430937522088*^9}, {3.4934312616581726`*^9, 
   3.493431263370635*^9}, {3.494059005615723*^9, 3.494059014027819*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.493415729003312*^9, 3.4934157854644995`*^9}, {
  3.4934258558850527`*^9, 3.493425869104061*^9}, {3.493426852968789*^9, 
  3.4934269305503454`*^9}, {3.493426974343317*^9, 3.493426993721181*^9}, {
  3.4934270357516174`*^9, 3.4934270437531233`*^9}, {3.493429890626726*^9, 
  3.4934298915580654`*^9}, {3.493439902953746*^9, 3.4934399415192003`*^9}, {
  3.4934405749900866`*^9, 3.4934405882791953`*^9}, {3.493587983246171*^9, 
  3.493588018597003*^9}, {3.49358846580005*^9, 3.4935884966143584`*^9}, {
  3.493588598911454*^9, 3.4935886339017677`*^9}, {3.493588727566451*^9, 
  3.493588728027114*^9}, {3.4938417964416227`*^9, 3.493841826444765*^9}, {
  3.4939368945259523`*^9, 3.4939368995531807`*^9}, {3.4939376081120386`*^9, 
  3.4939376163739185`*^9}, {3.4939376594859104`*^9, 3.4939377282047234`*^9}, {
  3.4939381934937763`*^9, 3.493938194294928*^9}, {3.4939382278431683`*^9, 
  3.493938246540053*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "things", " ", "not", " ", "needed", " ", "by", " ", "any", " ", 
     "internal", " ", "calculation"}], ",", " ", 
    RowBox[{
    "but", " ", "things", " ", "reported", " ", "to", " ", "diag", " ", 
     "file"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getfinalnum", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"etanumcenternorm", "=", 
        RowBox[{"myetae", "[", 
         RowBox[{"rhobcenter", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"etanumcenternormtrue", "=", 
        RowBox[{"myetaetrue", "[", 
         RowBox[{"rhobcenter", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"etanumcenterrad", "=", 
          RowBox[{"myetae", "[", 
           RowBox[{"rhobcenter", ",", "Trad"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"etanumingoing", "=", 
          RowBox[{"myetae", "[", 
           RowBox[{"rhobingoing", ",", "Tnorm"}], "]"}]}], ";"}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{"not", " ", "really", " ", "T", " ", "out", " ", 
          RowBox[{"there", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "HACK", " ", "for", " ", "speed", " ", "for", " ", "now", " ", 
         "since", " ", "Aum", " ", "never", " ", "anything", " ", "but", " ", 
         "1"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"etanumcenterrad", "=", "etanumcenternorm"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"etanumingoing", "=", "etanumcenternorm"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"beta", "-", 
         RowBox[{"eq", " ", "Ye"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Yebetanum", "=", 
        RowBox[{"Yebeta", "[", 
         RowBox[{"rhobrad", ",", "Trad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"see", " ", "if", " ", "nucleons", " ", "are", " ", "degen"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"degennucnum", "=", 
        RowBox[{"degennuc", "[", 
         RowBox[{"rhobrad", ",", "Trad"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"non", "-", 
         RowBox[{"QED", " ", "accurate", " ", "versions"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"npairs0true", "=", 
        RowBox[{"npairs0noqed", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ppairs0true", "=", 
        RowBox[{"Ppairs0noqed", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Upairs0true", "=", 
        RowBox[{"Upairs0noqed", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"non", "-", 
         RowBox[{
         "QED", " ", "accurate", " ", "with", " ", "accurate", " ", "eta"}]}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"npairs0truetrue", "=", 
        RowBox[{"npairs0noqedtrue", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ppairs0truetrue", "=", 
        RowBox[{"Ppairs0noqedtrue", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Upairs0truetrue", "=", 
        RowBox[{"Upairs0noqedtrue", "[", 
         RowBox[{"rhobnorm", ",", "Tnorm"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.49393830891975*^9, 3.4939383316023664`*^9}, {
  3.4939384591357503`*^9, 3.4939384594862547`*^9}, {3.493938939045827*^9, 
  3.493938939596619*^9}, {3.4939403645355806`*^9, 3.4939403649662*^9}, {
  3.493969248741192*^9, 3.4939692571428537`*^9}, {3.49396951325836*^9, 
  3.493969527057514*^9}, {3.4939695591921196`*^9, 3.493969559342328*^9}, {
  3.4939714894295692`*^9, 3.493971495598255*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Klein", "-", "Nishina"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"kncalc", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Klein", "-", 
        RowBox[{
        "Nishina", " ", "for", " ", "a", " ", "given", " ", "photon", " ", 
         "energy"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"alphaqm", "=", 
        RowBox[{
         RowBox[{"q", "^", "2"}], "/", 
         RowBox[{"(", 
          RowBox[{"hbar", "*", "c"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmat", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"8", "*", 
           RowBox[{"Pi", "/", "3"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alphaqm", "*", 
            RowBox[{"hbar", "/", 
             RowBox[{"(", 
              RowBox[{"me", "*", "c"}], ")"}]}]}], ")"}], "^", "2"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"sigmat2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"8", "*", 
           RowBox[{"Pi", "/", "3"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", "^", "4"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"me", "^", "2"}], "*", 
             RowBox[{"c", "^", "4"}]}], ")"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AA", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "*", "Pi", "*", 
           RowBox[{"q", "^", "4"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"me", "^", "2"}], "*", 
           RowBox[{"c", "^", "4"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmaknnew", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "/", "4"}], ")"}], "*", "sigmat", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "alphakn"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"alphakn", "^", "2"}], ")"}]}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", "alphakn"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", "*", "alphakn"}]}], ")"}]}]}], "-", 
              RowBox[{
               RowBox[{"1", "/", "alphakn"}], "*", 
               RowBox[{"Log", "[", 
                RowBox[{"1", "+", 
                 RowBox[{"2", "*", "alphakn"}]}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "alphakn"}], ")"}]}], "*", 
            RowBox[{"Log", "[", 
             RowBox[{"1", "+", 
              RowBox[{"2", "*", "alphakn"}]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"3", "*", "alphakn"}]}], ")"}], "/", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", "*", "alphakn"}]}], ")"}], "^", "2"}]}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmaknfreq", "=", 
        RowBox[{"sigmaknnew", "//.", 
         RowBox[{"{", 
          RowBox[{"alphakn", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"h", "*", "freqgamma"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"me", "*", 
              RowBox[{"c", "^", "2"}]}], ")"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "checks", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result1", "=", 
        RowBox[{
         RowBox[{"Limit", "[", 
          RowBox[{"sigmaknnew", ",", 
           RowBox[{"alphakn", "\[Rule]", "0"}]}], "]"}], "/", "sigmat"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"result2", "=", 
        RowBox[{"sigmat", "-", 
         RowBox[{"Limit", "[", 
          RowBox[{"sigmaknnew", ",", 
           RowBox[{"alphakn", "\[Rule]", "0"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result3", "=", 
        RowBox[{"sigmat2", "-", 
         RowBox[{"Limit", "[", 
          RowBox[{"sigmaknnew", ",", 
           RowBox[{"alphakn", "\[Rule]", "0"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result4", "=", 
        RowBox[{"Series", "[", 
         RowBox[{"sigmaknnew", ",", 
          RowBox[{"{", 
           RowBox[{"alphakn", ",", "Infinity", ",", "1"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"mysigmakn", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sigmaknnew", "//.", 
           RowBox[{"{", 
            RowBox[{"alphakn", "\[Rule]", "ep"}], "}"}]}], ")"}], "/", 
         "sigmat"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"diffsigmakn", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"sigmakngen", "-", "sigmaknfreq"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "optical", " ", "depth", " ", "appendix", " ", "in", " ", "paper"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "nep", ",", "fep", ",", "totalep", ",", "al", ",", "epmin", ",", "epmax",
       ",", "alphasp", ",", "sigmaggpersigmaes", ",", "sigmagg", ",", "sol", 
      ",", "etaep", ",", "epminann"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nep", "[", 
      RowBox[{"ep_", ",", "al_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", "ep", ")"}], "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "al"}], "-", "1"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fep", "[", 
      RowBox[{"ep_", ",", "al_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", "ep", ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "al"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"A1", ":", " ", 
     RowBox[{"I", " ", "in", " ", "paper"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totaleptemp", "[", 
      RowBox[{"epmin_", ",", "epmax_", ",", "alphasp_"}], "]"}], "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"fep", "[", 
          RowBox[{"ep", ",", "alphasp"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ep", ",", "epmin", ",", "epmax"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"epmin", ">", "0"}], ",", 
         RowBox[{"epmax", ">", "epmin"}], ",", 
         RowBox[{"epmax", ">", "0"}], ",", 
         RowBox[{"alphasp", ">", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totalep", "[", 
      RowBox[{
       RowBox[{"epmin_", "?", "NumericQ"}], ",", 
       RowBox[{"epmax_", "?", "NumericQ"}], ",", 
       RowBox[{"alphasp_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"totaleptemp", "[", 
       RowBox[{"epmin", ",", "epmax", ",", "alphasp"}], "]"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"A1b", ":", " ", 
     RowBox[{"I", " ", "in", " ", "paper"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totaleptemp2", "[", 
      RowBox[{"epmin_", ",", "epmax_", ",", "alphasp_"}], "]"}], "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"ep", "*", 
          RowBox[{"fep", "[", 
           RowBox[{"ep", ",", "alphasp"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ep", ",", "epmin", ",", "epmax"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"epmin", ">", "0"}], ",", 
         RowBox[{"epmax", ">", "epmin"}], ",", 
         RowBox[{"epmax", ">", "0"}], ",", 
         RowBox[{"alphasp", ">", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totalep2", "[", 
      RowBox[{
       RowBox[{"epmin_", "?", "NumericQ"}], ",", 
       RowBox[{"epmax_", "?", "NumericQ"}], ",", 
       RowBox[{"alphasp_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"totaleptemp2", "[", 
       RowBox[{"epmin", ",", "epmax", ",", "alphasp"}], "]"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totalxinttemp", "[", 
      RowBox[{"ep_", ",", "epmin_", ",", "epmax_", ",", "alphasp_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"x", "^", 
           RowBox[{"(", 
            RowBox[{"-", "alphasp"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "eplower", ",", "epmax"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"alphasp", ">", "1"}], ",", 
          RowBox[{"eplower", ">", "0"}], ",", 
          RowBox[{"epmax", ">", "eplower"}]}], "}"}]}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{"eplower", "\[Rule]", 
        RowBox[{"Max", "[", 
         RowBox[{"ep", ",", "epmin"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totalxint", "[", 
      RowBox[{
       RowBox[{"ep_", "?", "NumericQ"}], ",", 
       RowBox[{"epmin_", "?", "NumericQ"}], ",", 
       RowBox[{"epmax_", "?", "NumericQ"}], ",", 
       RowBox[{"alphasp_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"totalxinttemp", "[", 
       RowBox[{"ep", ",", "epmin", ",", "epmax", ",", "alphasp"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"A5", ":", " ", 
     RowBox[{"sigmagg", " ", "in", " ", "paper"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Get", " ", "sigma_", 
     RowBox[{"{", 
      RowBox[{"\\", "gamma", "\\", "gamma"}], "}"}], " ", "averaged", " ", 
     "over", " ", "photon", " ", "spectra", " ", "for", " ", "those", " ", 
     "photons", " ", "that", " ", "can", " ", "annihilate"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"epminann", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"etaep", "[", "al_", "]"}], ":=", 
     RowBox[{
      RowBox[{"4", "^", "al"}], "*", "6", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", "al"}], "]"}], "^", "2"}], "/", 
        RowBox[{"Gamma", "[", 
         RowBox[{"5", "+", 
          RowBox[{"2", "*", "al"}]}], "]"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"14", "+", 
         RowBox[{"20", "*", "al"}], "+", 
         RowBox[{"9", "*", 
          RowBox[{"al", "^", "2"}]}], "+", 
         RowBox[{"al", "^", "3"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "+", "al"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"2", "+", "al"}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sol", "[", "al_", "]"}], "=", 
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nep", "[", 
            RowBox[{"ep", ",", "al"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"etaep", "[", "al", "]"}], "/", "ep"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ep", ",", "epminann", ",", "Infinity"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"al", ">=", "1"}], "}"}]}], "]"}], "/", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"nep", "[", 
           RowBox[{"ep", ",", "al"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ep", ",", "epminann", ",", "Infinity"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"al", ">=", "1"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sigmaggpersigmaes", "[", "alphasp_", "]"}], "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"sol", "[", 
       RowBox[{"alphasp", "-", "1"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"al", "\[Rule]", 
     RowBox[{"alphasp", "-", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"gives", " ", 
      RowBox[{"11", "/", "180"}], " ", "for", " ", "alphasp"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "as", " ", "in", " ", "Lithwith"}], " ", "&"}], " ", 
      "Sari", " ", 
      RowBox[{"(", "2001", ")"}], " ", "when", " ", "using", " ", "epmax", 
      " ", "of", " ", "Infinity"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sigmagg", "[", "alphasp_", "]"}], ":=", 
     RowBox[{
      RowBox[{"sigmaggpersigmaes", "[", "alphasp", "]"}], "*", "sigmat"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tauhighe", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "foo", ",", "eminobsMeV", ",", "eminobs", ",", "epmin", ",", "epmax", 
         ",", "alphasp", ",", "Area", ",", "al", ",", "Ng", ",", "Ntot", ",", 
         "Ntotold", ",", "deltat", ",", "minmethodtau", ",", "epmaxnum", ",", 
         "epmaxerror", ",", "epthicknum", ",", "epmaxobs", ",", "fakeepthick",
          ",", "startepmax", ",", "solepmax", ",", "myminsols", ",", "mymin", 
         ",", "depmaxnum", ",", "epmaxminnum", ",", "startepmaxmin", ",", 
         "solepmaxmin", ",", "depmaxminnum", ",", "epmaxminerror", ",", 
         "epmaxminobs", ",", "startepmaxmax", ",", "solepmaxmax", ",", 
         "epmaxmaxnum", ",", "depmaxmaxnum", ",", "epmaxmaxerror", ",", 
         "epmaxmaxobs", ",", "errormin"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"minmethodtau", "=", "2"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"\[Equal]", 
           RowBox[{"1", " ", "more", " ", "robust", " ", "than", " ", 
            RowBox[{"FindRoot", "."}]}], "  ", "\[Equal]", 
           RowBox[{
            RowBox[{"2", " ", "forces", " ", "to", " ", 
             RowBox[{"avoid", " ", "\\", "gamma"}]}], "+", 
            RowBox[{"pairs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\\", "gamma"}], "+", 
               RowBox[{"\\", "gamma"}]}], ")"}]}]}]}], " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"\\", "gamma"}], " ", "+", " ", "pairs"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"\[Equal]", 
           RowBox[{
            RowBox[{
            "2", " ", "is", " ", "useful", " ", "since", " ", "typically", 
             " ", "that", " ", "process", " ", "is", " ", "not", " ", 
             "important", " ", "and", " ", "other", " ", "method", " ", 
             "only", " ", "relies", " ", "upon", " ", "1"}], "-", 
            RowBox[{"D", " ", 
             RowBox[{"procedure", ".", "  ", "But"}], " ", "then", " ", 
             "typically", " ", "2", " ", "mins"}]}]}], ",", " ", 
          RowBox[{
           RowBox[{"and", " ", "want", " ", "higher"}], "-", 
           RowBox[{
           "energy", " ", "version", " ", "where", " ", "photons", " ", "are",
             " ", "always", " ", "optically", " ", "thick", " ", "for", " ", 
            "higher", " ", "energies"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eminobsMeV", "=", "0.1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eminobsMeV", "=", "1.0"}], ";"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eminobs", "=", 
         RowBox[{"eminobsMeV", "*", 
          RowBox[{"ergPmev", "/", 
           RowBox[{"(", 
            RowBox[{"me", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}]}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"most", " ", "strict", " ", "lower"}], "-", 
          RowBox[{"limit", " ", "for", " ", "highest"}], "-", 
          RowBox[{"energy", " ", "photon"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"epmin", "=", 
         RowBox[{"eminobs", "/", "gammavalue"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"alphasp", "=", "2.00001"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"shocks", "?"}], " ", "*)"}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"for", " ", "exactly", " ", "2"}], ",", " ", 
          RowBox[{
           RowBox[{
           "choose", " ", "something", " ", "like", " ", "2.00001", " ", "so",
             " ", 
            RowBox[{"don", "'"}], "t", " ", "have", " ", "to", " ", "worry", 
            " ", "about", " ", "ensuring", " ", "mathematica", " ", 
            "integrated", " ", "to", " ", "get", " ", "general", " ", 
            "solution", " ", "that", " ", "allows", " ", "log", " ", 
            "version", " ", 
            RowBox[{"when", " ", "\\", "alpha"}]}], "=", "2"}]}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"Area", "=", 
         RowBox[{"Pi", "*", "Rjet", "*", "Lpnum"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"deltat", "=", "Ttransit"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"A3", ":", " ", 
          RowBox[{"Ntot", " ", "in", " ", "paper"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ntotold", "[", 
          RowBox[{"epmin_", ",", "epmin_", ",", "alphasp_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{"Qradnum", "*", "Habsnum"}], ")"}], "*", "Area", "*", 
          "deltat"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ntot", "[", 
          RowBox[{"epmin_", ",", "epmax_", ",", "alphasp_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"totalep", "[", 
           RowBox[{"epmin", ",", "epmax", ",", "alphasp"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"Uradnum", "*", "Habsnum"}], ")"}], "*", 
          RowBox[{"Area", "/", 
           RowBox[{"totalep2", "[", 
            RowBox[{"epmin", ",", "epmax", ",", "alphasp"}], "]"}]}]}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "could", " ", "use", " ", "fastest", " ", "rate", " ", "of", " ", 
           "dissipation", " ", "of", " ", "magnetic", " ", "energy", " ", 
           "into", " ", "current", " ", "sheet"}], ",", " ", 
          RowBox[{"corresponding", " ", "to"}], ",", " ", "say", ",", " ", 
          RowBox[{"non", "-", 
           RowBox[{"thermal", " ", "production", " ", "in", " ", "non"}], "-", 
           RowBox[{"SP", " ", 
            RowBox[{"sheet", ".", "  ", "Found"}], " ", "similar"}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Ntot", "=", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"bgaussrad", "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"8", "*", "Pi"}], ")"}]}], "*", "c"}], ")"}], "*", 
            "Area", "*", "deltat"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"A2", ",", 
          RowBox[{"A4", ":", " ", 
           RowBox[{"N", ">", 
            RowBox[{"e", " ", "in", " ", "paper"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ng", "[", 
          RowBox[{"ep0_", ",", "epmin_", ",", "epmax_"}], "]"}], ":=", 
         RowBox[{"Module", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"result", ",", "ep"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ep", "=", "ep0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ep", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"ep", ",", "epmin"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ep", "=", 
             RowBox[{"Min", "[", 
              RowBox[{"ep", ",", "epmax"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"result", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Ntot", "[", 
                 RowBox[{"epmin", ",", "epmax", ",", "alphasp"}], "]"}], "/", 
                RowBox[{"totalep", "[", 
                 RowBox[{"epmin", ",", "epmax", ",", "alphasp"}], "]"}]}], 
               ")"}], "*", 
              RowBox[{"totalxint", "[", 
               RowBox[{"ep", ",", "epmin", ",", "epmax", ",", "alphasp"}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"return", " ", "result"}], " ", "*)"}], 
            "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"taugg", "[", 
          RowBox[{
           RowBox[{"ep_", "?", "NumericQ"}], ",", 
           RowBox[{"epmin_", "?", "NumericQ"}], ",", 
           RowBox[{"epmax_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"sigmagg", "[", "alphasp", "]"}], "*", 
          RowBox[{
           RowBox[{"Ng", "[", 
            RowBox[{
             RowBox[{"1", "/", "ep"}], ",", "epmin", ",", "epmax"}], "]"}], 
           "/", "Area"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "kncalc", ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "below", " ", "removes", " ", "KN", " ", "term", " ", "from", " ", 
           "sigmaes", " ", "but", " ", "keeps", " ", "QED"}], "-", 
          RowBox[{"thermal", " ", "term"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sigmagetemp", "[", "ep_", "]"}], "=", 
         RowBox[{"sigmat", "*", 
          RowBox[{"(", 
           RowBox[{"sigmaesnum", "/", "sigmaknnum"}], ")"}], "*", 
          RowBox[{"Evaluate", "[", "mysigmakn", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sigmage", "[", "ep_", "]"}], ":=", 
         RowBox[{"sigmagetemp", "[", "ep", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "number", " ", "of", " ", "pairs", " ", "produced", " ", "by", " ", 
          "photon", " ", "annihilation"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Nee", "[", 
          RowBox[{"epmin_", ",", "epmax_", ",", "epthick_"}], "]"}], ":=", 
         RowBox[{"Ng", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", "epthick"}], "]"}], ",", "epmin", ",", 
           "epmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"already", "-", 
           RowBox[{
           "present", " ", "thermal", " ", "pairs", " ", "should", " ", 
            "also", " ", "be", " ", 
            RowBox[{"used", " ", "--"}], " ", "no"}]}], ",", " ", 
          RowBox[{
          "these", " ", "are", " ", "included", " ", "below", " ", 
           "already"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Nee2", ":=", 
           RowBox[{"npairsrad", "*", "Area", "*", "Habsnum"}]}], ";"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Nee2", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Neetot", "[", 
          RowBox[{"epmin_", ",", "epmax_", ",", "epthick_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Nee", "[", 
           RowBox[{"epmin", ",", "epmax", ",", "epthick"}], "]"}], "+", 
          "Nee2"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"gamma", "+", "gamma", "+", "gamma"}], " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"e", "^", 
            RowBox[{"+", " ", 
             RowBox[{"+", " ", 
              RowBox[{"e", "^", 
               RowBox[{"-", " ", 
                RowBox[{"+", "gamma"}]}]}]}]}]}], " ", "\[Rule]", " ", 
           RowBox[{"gamma", " ", "+", " ", 
            RowBox[{"e", " ", "scattering"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tauggge", "[", 
          RowBox[{"ep_", ",", "epmin_", ",", "epmax_", ",", "epthick_"}], 
          "]"}], ":=", 
         RowBox[{
          RowBox[{"sigmage", "[", "ep", "]"}], "*", 
          RowBox[{
           RowBox[{"Neetot", "[", 
            RowBox[{"epmin", ",", "epmax", ",", "epthick"}], "]"}], "/", 
           "Area"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "similar", " ", "to", " ", "taualongjet", " ", "calculation"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tauge1", "[", "ep_", "]"}], ":=", 
         RowBox[{
          RowBox[{"sigmage", "[", "ep", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"npairs", "//.", "solsTrad"}], ")"}], "*", "Nscalayers",
              "*", "Lpnum"}], "+", 
            RowBox[{
             RowBox[{"ne", "[", "rhobrad", "]"}], "*", "Rjet"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "now", " ", "integrate", " ", "up", " ", "rest", " ", "of", " ", 
          RowBox[{"jet", "'"}], "s", " ", "electrons", " ", "associated", " ",
           "with", " ", "baryons"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tauge2", "[", "ep_", "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"sigmage", "[", "ep", "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "gammavalue"}], ")"}]}], "*", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"ne", "[", 
             RowBox[{"rhobrad", "/", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rcep", "/", "Ljet"}], ")"}], "^", "2"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"rcep", ",", "Ljet", ",", "Infinity"}], "}"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"below", " ", "is", " ", "final", " ", 
          RowBox[{"opacity", " ", "--"}], " ", "no", " ", "pair", " ", 
          "production", " ", "due", " ", "to", " ", "escaping", " ", 
          "photons", " ", "for", " ", "a", " ", "given", " ", "emax", " ", 
          "yet", " ", "included"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tauge", "[", "ep_", "]"}], ":=", 
         RowBox[{
          RowBox[{"tauge1", "[", "ep", "]"}], "+", 
          RowBox[{"tauge2", "[", "ep", "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"taugtot", "[", 
          RowBox[{
           RowBox[{"ep_", "?", "NumericQ"}], ",", 
           RowBox[{"epmin_", "?", "NumericQ"}], ",", 
           RowBox[{"epmax_", "?", "NumericQ"}], ",", 
           RowBox[{"epthick_", "?", "NumericQ"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"taugg", "[", 
           RowBox[{"ep", ",", "epmin", ",", "epmax"}], "]"}], "+", 
          RowBox[{"tauggge", "[", 
           RowBox[{"ep", ",", "epmin", ",", "epmax", ",", "epthick"}], "]"}], 
          "+", 
          RowBox[{"tauge", "[", "ep", "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "taugtot", " ", "tends", " ", "to", " ", "be", " ", "a", " ", 
           "cubic", " ", "that", " ", "falls"}], ",", " ", "rises", ",", " ", 
          RowBox[{"and", " ", "eventually", " ", "falls", " ", "again"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Whether", " ", "any", " ", "high", " ", "point", " ", "breaches", 
           " ", "taugtot"}], "\[Equal]", 
          RowBox[{
          "1", " ", "is", " ", "dependent", " ", "upon", " ", "many", " ", 
           "factors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Sometimes", ",", " ", 
          RowBox[{"only", " ", "one", " ", "point", " ", 
           RowBox[{"(", 
            RowBox[{"say", " ", "first", " ", "region"}], ")"}], " ", 
           "breaches"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"funDslow", "[", "epmax_", "]"}], ":=", 
         RowBox[{"Module", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"fooin", ",", "epmaxlocal", ",", "result"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"taugtot", "[", 
                RowBox[{
                "epmaxlocal", ",", "epmin", ",", "epmaxlocal", ",", "1"}], 
                "]"}], ",", "epmaxlocal"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"result", "//.", 
             RowBox[{"{", 
              RowBox[{"epmaxlocal", "\[Rule]", "epmax"}], "}"}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"funD", "[", "epmax_", "]"}], ":=", 
         RowBox[{"Module", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "fooin", ",", "epmaxlocal", ",", "result", ",", "offset", ",", 
             "xr", ",", "xl", ",", "tr", ",", "tl"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"offset", "=", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "5"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"xr", "=", 
             RowBox[{"epmax", "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", "offset"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"xl", "=", 
             RowBox[{"epmax", "*", 
              RowBox[{"(", 
               RowBox[{"1", "-", "offset"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tr", "=", 
             RowBox[{"taugtot", "[", 
              RowBox[{"xr", ",", "epmin", ",", "xr", ",", "1"}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"tl", "=", 
             RowBox[{"taugtot", "[", 
              RowBox[{"xl", ",", "epmin", ",", "xl", ",", "1"}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"result", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"tr", "-", "tl"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"xr", "-", "xl"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"minmethodtau", "\[Equal]", "2"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"find", " ", "min", " ", "in", " ", "tau"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myminsols", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"funD", "[", "epmax", "]"}], "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"epmax", ",", "2"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mymin", "=", 
            RowBox[{"myminsols", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"errormin", "=", 
            RowBox[{"Abs", "[", 
             RowBox[{"funD", "[", "mymin", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"errormin", ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}]}]}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", "\"\<Warning: Did not find min for tau calc\>\"", 
               "]"}], ";", 
              RowBox[{"mymin", "=", "2"}], ";"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "find", " ", "root", " ", "with", " ", "positive", " ", 
             "derivative"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"fakeepthick", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"startepmax", "=", 
            RowBox[{"2", "*", "mymin"}]}], ";", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "move", " ", "to", " ", "higher", " ", "energy", " ", "by", " ", 
             "factor", " ", "of", " ", "2", " ", "so", " ", "head", " ", 
             "towards", " ", "desired", " ", "root"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"solepmax", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{"0", "==", 
               RowBox[{"1", "-", 
                RowBox[{"taugtot", "[", 
                 RowBox[{"x", ",", "epmin", ",", "x", ",", "fakeepthick"}], 
                 "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "startepmax"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"epmaxnum", "=", 
            RowBox[{"solepmax", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"depmaxnum", "=", 
            RowBox[{"funD", "[", "epmaxnum", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"depmaxnum", ">", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"epmaxerror", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"1", "-", 
                 RowBox[{"taugtot", "[", 
                  RowBox[{
                  "epmaxnum", ",", "epmin", ",", "epmaxnum", ",", 
                   "fakeepthick"}], "]"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"depmaxnum", "\[LessEqual]", "0"}], "||", " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Re", "[", "depmaxnum", "]"}], "]"}], "<", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", "10", ")"}]}], "*", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", "depmaxnum", "]"}], "]"}]}]}]}], ",", ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"epmaxerror", "=", 
               RowBox[{"10", "^", "30"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"register", " ", "as", " ", "not", " ", "found"}], " ",
                "*)"}], "\[IndentingNewLine]", 
              RowBox[{"depmaxmaxnum", "=", 
               RowBox[{"Abs", "[", "depmaxnum", "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"NOTE", ":", " ", 
              RowBox[{
              "Might", " ", "not", " ", "have", " ", "found", " ", "min"}]}], 
             ",", " ", 
             RowBox[{"may", " ", "have", " ", "found", " ", 
              RowBox[{"max", ".", "  ", "But"}], " ", "then", " ", "probably",
               " ", "no", " ", "solution", " ", "anyways"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "find", " ", "root", " ", "with", " ", "negative", " ", 
             "derivative", " ", "on", " ", "left", " ", "side"}], " ", "*)"}],
            "\[IndentingNewLine]", 
           RowBox[{"fakeepthick", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"startepmaxmin", "=", 
            RowBox[{"mymin", "/", "2"}]}], ";", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "move", " ", "to", " ", "lower", " ", "energy", " ", "by", " ", 
             "factor", " ", "of", " ", "2", " ", "so", " ", "head", " ", 
             "towards", " ", "desired", " ", "root"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"solepmaxmin", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{"0", "==", 
               RowBox[{"1", "-", 
                RowBox[{"taugtot", "[", 
                 RowBox[{"x", ",", "epmin", ",", "x", ",", "fakeepthick"}], 
                 "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "startepmaxmin"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"epmaxminnum", "=", 
            RowBox[{"solepmaxmin", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"depmaxminnum", "=", 
            RowBox[{"funD", "[", "epmaxminnum", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"depmaxminnum", "<", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"epmaxminerror", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"1", "-", 
                 RowBox[{"taugtot", "[", 
                  RowBox[{
                  "epmaxminnum", ",", "epmin", ",", "epmaxminnum", ",", 
                   "fakeepthick"}], "]"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"depmaxminnum", "\[GreaterEqual]", "0"}], "||", " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Re", "[", "depmaxminnum", "]"}], "]"}], "<", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", "10", ")"}]}], "*", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", "depmaxminnum", "]"}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"epmaxminerror", "=", 
               RowBox[{"10", "^", "30"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"register", " ", "as", " ", "not", " ", "found"}], " ",
                "*)"}], "\[IndentingNewLine]", 
              RowBox[{"depmaxmaxnum", "=", 
               RowBox[{"Abs", "[", "depmaxminnum", "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "find", " ", "root", " ", "with", " ", "negative", " ", 
             "derivative", " ", "on", " ", "right", " ", "side"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"fakeepthick", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"startepmaxmax", "=", 
            RowBox[{"10", "^", "10"}]}], ";", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "if", " ", "even", " ", "higher", " ", "than", " ", "this"}], 
             ",", " ", 
             RowBox[{"then", " ", "not", " ", "interesting"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"solepmaxmax", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{"0", "==", 
               RowBox[{"1", "-", 
                RowBox[{"taugtot", "[", 
                 RowBox[{"x", ",", "epmin", ",", "x", ",", "fakeepthick"}], 
                 "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "startepmaxmax"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"epmaxmaxnum", "=", 
            RowBox[{"solepmaxmax", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"depmaxmaxnum", "=", 
            RowBox[{"funD", "[", "epmaxmaxnum", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"depmaxmaxnum", "<", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"epmaxmaxerror", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"1", "-", 
                 RowBox[{"taugtot", "[", 
                  RowBox[{
                  "epmaxmaxnum", ",", "epmin", ",", "epmaxmaxnum", ",", 
                   "fakeepthick"}], "]"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"depmaxmaxnum", "\[GreaterEqual]", "0"}], " ", "||", 
              " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Re", "[", "depmaxmaxnum", "]"}], "]"}], "<", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", "10", ")"}]}], "*", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Im", "[", "depmaxmaxnum", "]"}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"epmaxmaxerror", "=", 
               RowBox[{"10", "^", "30"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"register", " ", "as", " ", "not", " ", "found"}], " ",
                "*)"}], "\[IndentingNewLine]", 
              RowBox[{"depmaxmaxnum", "=", 
               RowBox[{"Abs", "[", "depmaxmaxnum", "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epthicknum", "=", "fakeepthick"}], ";"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"fake", "!"}], " ", "*)"}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"minmethodtau", "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"eqblob", "[", 
             RowBox[{
              RowBox[{"epmax_", "?", "NumericQ"}], ",", 
              RowBox[{"epthick_", "?", "NumericQ"}]}], "]"}], ":=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"taugtot", "[", 
                 RowBox[{
                 "epmax", ",", "epmin", ",", "epmax", ",", "epthick"}], "]"}],
                 "-", "1"}], ")"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"taugg", "[", 
                 RowBox[{"epthick", ",", "epmin", ",", "epmax"}], "]"}], "-", 
                "1"}], ")"}], "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"solepmax", "=", 
            RowBox[{"NMinimize", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"eqblob", "[", 
                 RowBox[{"x", ",", "y"}], "]"}], ",", 
                RowBox[{"x", ">", "0"}], ",", 
                RowBox[{"y", ">", "0"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"MaxIterations", "\[Rule]", "1000"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"epmaxerror", "=", 
            RowBox[{"Abs", "[", 
             RowBox[{"solepmax", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"epmaxnum", "=", 
            RowBox[{"solepmax", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"epthicknum", "=", 
            RowBox[{"solepmax", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"dummy", " ", "assignments"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"epmaxminerror", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxminnum", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxminobs", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxmaxerror", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxmaxnum", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxmaxobs", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"minmethodtau", "\[Equal]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"taugg", "[", 
             RowBox[{"ep", "=", "epthick"}], "]"}], "\[Equal]", 
            RowBox[{"1", " ", "defines", " ", "epthick"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"solepmax", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"taugtot", "[", 
                  RowBox[{
                  "epmax", ",", "epmin", ",", "epmax", ",", "epthick"}], 
                  "]"}], "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"taugg", "[", 
                  RowBox[{"epthick", ",", "epmin", ",", "epmax"}], "]"}], 
                 "\[Equal]", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"epmax", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"epthick", ",", "2"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"epmaxerror", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxnum", "=", 
            RowBox[{"solepmax", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"epthicknum", "=", 
            RowBox[{"solepmax", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"dummy", " ", "assignments"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"epmaxminerror", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxminnum", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxminobs", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxmaxerror", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxmaxnum", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"epmaxmaxobs", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"epmax", " ", "is", " ", "highest"}], "-", 
          RowBox[{
          "energy", " ", "photon", " ", "that", " ", "can", " ", "escape"}]}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "epmaxobs", " ", "is", " ", "maximum", " ", "for", " ", "observed", 
          " ", "photon"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"epmaxobs", "=", 
         RowBox[{"epmaxnum", "*", "gammavalue", "*", "me", "*", 
          RowBox[{
           RowBox[{"c", "^", "2"}], "/", "ergPmev"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"MeV", " ", "units"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"epmaxminobs", "=", 
         RowBox[{"epmaxminnum", "*", "gammavalue", "*", "me", "*", 
          RowBox[{
           RowBox[{"c", "^", "2"}], "/", "ergPmev"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"MeV", " ", "units"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"epmaxmaxobs", "=", 
         RowBox[{"epmaxmaxnum", "*", "gammavalue", "*", "me", "*", 
          RowBox[{
           RowBox[{"c", "^", "2"}], "/", "ergPmev"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"MeV", " ", "units"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "epmaxerror", ",", "epmaxnum", ",", "epthicknum", ",", "epmaxobs", 
          ",", "epmaxminerror", ",", "epmaxminnum", ",", "epmaxminobs", ",", 
          "epmaxmaxerror", ",", "epmaxmaxnum", ",", "epmaxmaxobs"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.493435310089531*^9, 3.4934354054967203`*^9}, {
   3.4934354656932783`*^9, 3.49343547919269*^9}, {3.4934355639445567`*^9, 
   3.493435596952019*^9}, {3.493435902511392*^9, 3.493435903442731*^9}, 
   3.493436106895282*^9, {3.4934361711076145`*^9, 3.49343617460264*^9}, {
   3.4934363115896177`*^9, 3.4934363488431854`*^9}, {3.4934364381516047`*^9, 
   3.4934364530930896`*^9}, {3.4934366089171534`*^9, 
   3.4934367046247745`*^9}, {3.493437372685398*^9, 3.49343738509324*^9}, {
   3.493437418451206*^9, 3.493437456876459*^9}, {3.493437498766694*^9, 
   3.4934375329358273`*^9}, {3.4934380814745874`*^9, 3.49343809160916*^9}, {
   3.4934381763409986`*^9, 3.4934381884083505`*^9}, {3.493438334979109*^9, 
   3.4934383759279904`*^9}, {3.493438431678155*^9, 3.4934384428842688`*^9}, {
   3.4934394676978784`*^9, 3.4934394935650735`*^9}, {3.493439571407005*^9, 
   3.4934396271070976`*^9}, {3.4934396679958925`*^9, 
   3.4934396896470256`*^9}, {3.4934398204350896`*^9, 
   3.4934398976160707`*^9}, {3.4934399474877825`*^9, 3.493440076062664*^9}, {
   3.4934401399345074`*^9, 3.4934401478058257`*^9}, {3.493440196836328*^9, 
   3.49344024329313*^9}, {3.4934403505473537`*^9, 3.4934403608221283`*^9}, {
   3.4934405376163454`*^9, 3.4934405496336255`*^9}, {3.4934405934966974`*^9, 
   3.493440593857216*^9}, {3.4934406345757666`*^9, 3.4934408375976973`*^9}, {
   3.493440870705304*^9, 3.4934408861475086`*^9}, {3.4934409436501937`*^9, 
   3.4934410359028463`*^9}, {3.4934410732565584`*^9, 3.493441341101701*^9}, {
   3.493441447805133*^9, 3.4934414921188526`*^9}, {3.4934415719135923`*^9, 
   3.4934415891884317`*^9}, {3.4934416456396046`*^9, 
   3.4934416923667955`*^9}, {3.4934417398550797`*^9, 
   3.4934417588123393`*^9}, {3.4934418287128515`*^9, 
   3.4934419580788703`*^9}, {3.4934419913867645`*^9, 
   3.4934420870042562`*^9}, {3.4934422083487406`*^9, 
   3.4934422126449184`*^9}, {3.493442283586928*^9, 3.493442470525733*^9}, {
   3.493442511284341*^9, 3.493442529560621*^9}, {3.4934426121293488`*^9, 
   3.4934426535489073`*^9}, {3.4934427196038895`*^9, 3.493442721246251*^9}, 
   3.493442780871989*^9, {3.4934428695895586`*^9, 3.49344295510252*^9}, {
   3.4934429990056496`*^9, 3.4934430034520435`*^9}, {3.4934431896698112`*^9, 
   3.493443198532555*^9}, {3.4934434554419727`*^9, 3.493443456223096*^9}, {
   3.493443530229512*^9, 3.4934435434084625`*^9}, {3.493443600660787*^9, 
   3.493443609673747*^9}, {3.493443646546768*^9, 3.4934437575463777`*^9}, {
   3.493443887242872*^9, 3.4934438963459616`*^9}, {3.4934439664167185`*^9, 
   3.49344402514116*^9}, {3.493444059400422*^9, 3.493444083024392*^9}, {
   3.4934441137285423`*^9, 3.4934442164161997`*^9}, {3.493444271225011*^9, 
   3.493444316660344*^9}, {3.49344435227155*^9, 3.493444423153474*^9}, {
   3.493444469269786*^9, 3.493444473956525*^9}, {3.493444527944155*^9, 
   3.4934445281845007`*^9}, 3.49344459737399*^9, {3.493444647636264*^9, 
   3.493444657179987*^9}, {3.49344471772705*^9, 3.4934447346413713`*^9}, {
   3.4934448906957664`*^9, 3.4934448920276814`*^9}, {3.493445002095952*^9, 
   3.493445005560934*^9}, {3.493445124672208*^9, 3.493445155085941*^9}, {
   3.4934453020372467`*^9, 3.493445318961582*^9}, {3.493445459123125*^9, 
   3.493445479963091*^9}, {3.493445850395747*^9, 3.4934458728079743`*^9}, {
   3.4934460423016944`*^9, 3.4934460583047056`*^9}, {3.493446100204955*^9, 
   3.4934461181107025`*^9}, {3.493446506128645*^9, 3.4934465907903824`*^9}, {
   3.4934478442427588`*^9, 3.4934478602958417`*^9}, {3.4934487337518096`*^9, 
   3.493448740992221*^9}, {3.4934499969882545`*^9, 3.4934499998223295`*^9}, {
   3.4934500859161263`*^9, 3.4934502280204625`*^9}, {3.493450481324696*^9, 
   3.4934505168457727`*^9}, {3.4934506080569277`*^9, 
   3.4934507503315086`*^9}, {3.49345080855523*^9, 3.4934508284438286`*^9}, {
   3.49345098439808*^9, 3.4934509906470656`*^9}, {3.493451046417259*^9, 
   3.4934511242391615`*^9}, {3.493451571812741*^9, 3.4934516099275475`*^9}, {
   3.493451709250366*^9, 3.4934517487571745`*^9}, {3.4934518635922995`*^9, 
   3.493451960171173*^9}, {3.4934520240029583`*^9, 3.493452133770797*^9}, {
   3.493452190582488*^9, 3.4934521921046767`*^9}, {3.4934522524814944`*^9, 
   3.493452252611682*^9}, {3.493452414394314*^9, 3.4934524207434435`*^9}, {
   3.493452533495573*^9, 3.4934525881842113`*^9}, {3.49345271855167*^9, 
   3.4934527204143486`*^9}, {3.4935025582710896`*^9, 3.493502562517195*^9}, {
   3.4935032782263346`*^9, 3.493503282512498*^9}, {3.4935152551783457`*^9, 
   3.493515284210091*^9}, {3.4935156889721107`*^9, 3.4935157009893904`*^9}, {
   3.4935157562688785`*^9, 3.4935159543937683`*^9}, {3.4935160177448626`*^9, 
   3.49351602529572*^9}, {3.4935164653685136`*^9, 3.493516475563173*^9}, {
   3.4935165973282623`*^9, 3.493516629634717*^9}, {3.493516785568939*^9, 
   3.493516792068285*^9}, {3.4935170864315586`*^9, 3.4935170874830704`*^9}, {
   3.4935209699758205`*^9, 3.493520975243395*^9}, {3.493521056159747*^9, 
   3.4935210767193103`*^9}, {3.4935272883912563`*^9, 
   3.4935273805738077`*^9}, {3.4935276617381024`*^9, 3.493527841807029*^9}, {
   3.4935279775422063`*^9, 3.493527981958557*^9}, {3.4935314850858064`*^9, 
   3.4935314938784494`*^9}, {3.4935315425183907`*^9, 
   3.4935315767476096`*^9}, {3.49353162188251*^9, 3.493531844011917*^9}, {
   3.493531975410859*^9, 3.4935319815697155`*^9}, {3.4935320233898497`*^9, 
   3.4935320694560895`*^9}, {3.493532102493595*^9, 3.493532232410406*^9}, {
   3.4935322977443523`*^9, 3.493532492524432*^9}, {3.493543360521845*^9, 
   3.4935433899541664`*^9}, {3.493543434768606*^9, 3.4935434731437874`*^9}, {
   3.4935440792753615`*^9, 3.4935441424361825`*^9}, {3.493744387564536*^9, 
   3.493744388485861*^9}, {3.493744644503997*^9, 3.4937446513338175`*^9}, {
   3.493769394723064*^9, 3.493769407871971*^9}, {3.4938310056251907`*^9, 
   3.4938310224293537`*^9}, {3.49383135096176*^9, 3.4938313670949583`*^9}, {
   3.493832022928*^9, 3.493832040833747*^9}, {3.493832096984488*^9, 
   3.493832151092291*^9}, {3.49383248968917*^9, 3.4938324905303793`*^9}, {
   3.493832571847307*^9, 3.493832585637136*^9}, {3.4938329612372227`*^9, 
   3.4938329642816*^9}, {3.4938358207790413`*^9, 3.4938358259865294`*^9}, {
   3.493935881899867*^9, 3.4939359423668146`*^9}, {3.494149922688053*^9, 
   3.49414992657364*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4934380933516655`*^9, 3.4934381117481184`*^9}, 
   3.4934410970808163`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.468667744199336*^9, 3.4686677447401133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Overall", " ", "procedure"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"doprintdebug", "=", "0"}], ";"}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"default", ":", " ", 
    RowBox[{"whether", " ", "to", " ", "print", " ", "debug", " ", 
     RowBox[{"info", ":", " ", 
      RowBox[{"0", " ", "or", " ", "1"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"gammajetreconnectionall1", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "npairsnum", ",", "damptauiter", ",", "numdamptauiter"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"call", " ", "reconnection", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Start gammajetreconnectionall1\>\"", "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Setup", " ", "jet", " ", 
         RowBox[{"values", ":", " ", 
          RowBox[{
           RowBox[{"doesn", "'"}], "t", " ", "need", " ", "to", " ", "be", 
           " ", "iterated", " ", "upon", " ", "and", " ", "would", " ", "be", 
           " ", "slow", " ", "to", " ", "do", " ", "so", " ", "and", " ", 
           "so", " ", "avoid"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "setupvalues", ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after setupvalues\>\"", "]"}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"setup", " ", "iteration", " ", "guesses"}], " ", "*)"}], 
       "\[IndentingNewLine]", "setupiterguesses", ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after setupiterguesses\>\"", "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "iterate", " ", "over", " ", "part", " ", "of", " ", "solution", " ",
           "that", " ", "is", " ", "required", " ", "to", " ", "get", " ", 
          "T"}], ",", "npairs"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"numiterations", "=", "1"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"NEW", ":", " ", 
         RowBox[{
         "T", " ", "and", " ", "npairs", " ", "are", " ", "solved", " ", 
          "for", " ", "and", " ", 
          RowBox[{"that", "'"}], "s", " ", "all", " ", "that", " ", "is", " ",
           "required", " ", "for", " ", "iteration", " ", "for", " ", 
          "plasma", " ", "computations"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"overalliteration", "=", "1"}], ",", 
         RowBox[{"overalliteration", "\[LessEqual]", "numiterations"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<overalliteration\>\"", "]"}], ";", 
             RowBox[{"Print", "[", "overalliteration", "]"}], ";"}]}], "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "gets", " ", "functions", " ", "now", " ", "which", " ", "are", 
            " ", "dependent", " ", "on", " ", "all", " ", "indep", " ", 
            "vars"}], " ", "*)"}], "\[IndentingNewLine]", "getfullPUNQ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after getfullUPNQ\>\"", "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"iterate", " ", "beyond", " ", "initial", " ", "guess"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"overalliteration", "++"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "store", " ", "numerical", " ", "values", " ", "for", " ", "some", 
         " ", "quantities", " ", "now", " ", "that", " ", "have", " ", "T", 
         " ", "and", " ", "npairs"}], " ", "*)"}], "\[IndentingNewLine]", 
       "getradnums", ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after getradnums\>\"", "]"}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"iterate", " ", "over", " ", "plasma", " ", 
          RowBox[{"quantities", ":", " ", "netotforomegape"}]}], ",", " ", 
         RowBox[{
          RowBox[{"etc", ".", " ", "that"}], " ", "do", " ", "not", " ", 
          "change", " ", "T"}], ",", "npairs"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"numiterations", "=", "20"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "number", " ", "of", " ", "iterations", " ", "for", " ", "getting", 
         " ", "plasma", " ", "things", " ", "converged"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "things", " ", "ITERATED", " ", "that", " ", "can", " ", "check", " ",
          "to", " ", "see", " ", "if", " ", "need", " ", "to", " ", "keep", 
         " ", "iterating", " ", "on", " ", "them"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"netotforomegapeold", "=", "netotforomegape"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gammaeold", "=", "gammae"}], ";", "\[IndentingNewLine]", 
       RowBox[{"RELTOLPLASMA", "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"overalliteration", "=", "1"}], ",", 
         RowBox[{"overalliteration", "\[LessEqual]", "numiterations"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<overalliteration\>\"", "]"}], ";", 
             RowBox[{"Print", "[", "overalliteration", "]"}], ";"}]}], "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "computeplasmastuff", ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after computeplasmastuff\>\"", "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"OLD", " ", 
             RowBox[{"code", ":", " ", "gettemperature"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"Print", "[", "\"\<after gettemperature\>\"", "]"}], 
               ";"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          "gettaualongjet", ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after taualongjet\>\"", "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", "reportpressure", 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after reportpressure\>\"", "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", "getDelta", ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after getDelta\>\"", "]"}], ";"}]}], 
           "]"}], ";", "\[IndentingNewLine]", "getlarmor", ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after getlarmor\>\"", "]"}], ";"}]}], 
           "]"}], ";", "\[IndentingNewLine]", "getDeltasp", ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after getDeltasp\>\"", "]"}], ";"}]}],
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"getDeltasprel", ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"getDeltasprelum10", ";"}], "*)"}], "\[IndentingNewLine]", 
          "getDeltasprelorig", ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after getDeltasprel\>\"", "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", "getconditione", ";",
           "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after getconditione\>\"", "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", "getconditionp", ";",
           "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after getconditionp\>\"", "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"below", " ", "gets", " ", "new", " ", "taubet"}], " ", 
           "*)"}], "\[IndentingNewLine]", "gettaus", ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<after gettaus\>\"", "]"}], ";"}]}], 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"OLD", ":", " ", 
            RowBox[{
            "store", " ", "iterated", " ", "quantities", " ", "for", " ", 
             "diagnotic"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "npairs", " ", "netotforomegape", " ", "gammae", " ", "Hsca", " ", 
            "Habs", " ", "solsT", " ", "myT", " ", "Tc", " ", "Tout", " ", 
            "myie", " ", "myu4vel", " ", "myb"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"npairsnum", "=", 
             RowBox[{"npairs", "//.", "solsT"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"itercheckiter", "[", 
              RowBox[{"[", "overalliteration", "]"}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{
              "npairsnum", ",", " ", "netotforomegape", ",", " ", "gammae", 
               ",", " ", "Hsca", ",", " ", "Habs", ",", " ", "solsT", ",", 
               " ", "solsTrad", ",", " ", "myie", ",", " ", "myu4vel", ",", 
               " ", "myb", ",", "Q0ff", ",", "Q0synch", ",", "tauradscanum", 
               ",", "tauradabsnum"}], "}"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "see", " ", "if", " ", "really", " ", "need", " ", "to", " ", 
            "keep", " ", "iterating", " ", "on", " ", "plasma", " ", 
            "terms"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"errorplasma", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"compute", " ", "errors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"relerr1", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"netotforomegape", "-", "netotforomegapeold"}], ")"}], 
            "/", "netotforomegapeold"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"relerr2", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gammae", "-", "gammaeold"}], ")"}], "/", 
            "gammaeold"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"set", " ", "new", " ", "to", " ", 
            RowBox[{"old", " ", "--"}], " ", "assumes", " ", "converging", 
            " ", "towards", " ", 
            RowBox[{"solution", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"netotforomegapeold", "=", "netotforomegape"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gammaeold", "=", "gammae"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"check", " ", "errors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"errorplasma", "=", 
           RowBox[{"errorplasma", "+", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"relerr1", "<", "RELTOLPLASMA"}], ",", "0", ",", "1"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"errorplasma", "=", 
           RowBox[{"errorplasma", "+", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"relerr2", "<", "RELTOLPLASMA"}], ",", "0", ",", "1"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<errorplasma=\>\"", ",", "errorplasma", ",", "\"\< \>\"", 
               ",", "\"\<netotforomegape=\>\"", ",", 
               RowBox[{"SetPrecision", "[", 
                RowBox[{"netotforomegape", ",", "5"}], "]"}], ",", 
               "\"\< \>\"", ",", "\"\<gammae=\>\"", ",", 
               RowBox[{"SetPrecision", "[", 
                RowBox[{"gammae", ",", "5"}], "]"}]}], "]"}], ";"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"errorplasma", "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"overalliteration", "=", "numiterations"}], ";"}]}], 
           "]"}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "jump", " ", "out", " ", "of", " ", "loop", " ", "if", " ", 
            "already", " ", "converged"}], " ", "*)"}], "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"iterate", " ", "beyond", " ", "initial", " ", "guess"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"overalliteration", "++"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Computing Non-Iterated Quantities\>\"", "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "things", " ", "not", " ", "part", " ", "of", " ", "ANY", " ", 
         "iteration", " ", "but", " ", "reported", " ", "once", " ", 
         "converged", " ", "solution", " ", "already", " ", "obtained"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"not", " ", "needed"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"gettimeann", ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<after gettimeann\>\"", "]"}], ";"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "getTobs", ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after getTobs\>\"", "]"}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "getTdiffs", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after getTdiffs\>\"", "]"}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "getdtobs", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after getdtobs\>\"", "]"}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "getidealValidity", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after getidealValidity\>\"", "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "getfinalnum", ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after getfinalnum\>\"", "]"}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "epmaxerror", ",", "epmaxnum", ",", "epthicknum", ",", "epmaxobs", 
          ",", "epmaxminerror", ",", "epmaxminnum", ",", "epmaxminobs", ",", 
          "epmaxmaxerror", ",", "epmaxmaxnum", ",", "epmaxmaxobs"}], "}"}], 
        "=", "tauhighe"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<after tauhighe\>\"", "]"}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Some", " ", "results", " ", "reports"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"bgaussrad", "/", "Bc"}], "\[GreaterEqual]", "0.01"}]}], 
         ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<QED Matters\>\"", ",", " ", "\"\< bgaussrad/Bc=\>\"", ",", 
            RowBox[{"bgaussrad", "/", "Bc"}]}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"conditionpt", ">=", "1"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<FAST RECONNECTION\>\"", ",", " ", "\"\< conditionpt=\>\"", 
            ",", "conditionpt"}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"conditionpt", "<", "1"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<SLOW RECONNECTION\>\"", ",", " ", "\"\< conditionpt=\>\"", 
            ",", "conditionpt"}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"etanumcenterrad", ">=", "1"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Degenerate pairs&electrons\>\"", ",", 
            "\"\< etanumcenterrad=\>\"", ",", "etanumcenterrad"}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"etanumcenterrad", "<", "1"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Non-Degenerate pairs&electrons\>\"", ",", 
            "\"\< etanumcenterrad=\>\"", ",", "etanumcenterrad"}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<etasim=\>\"", ",", "etanumcenternorm", ",", 
            "\"\< etanumcenternormtrue=\>\"", ",", "etanumcenternormtrue"}], 
           "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<npairs0num=\>\"", ",", "npairs0num", ",", 
            "\"\< npairs0true=\>\"", ",", "npairs0true", ",", 
            "\"\< npairs0truetrue=\>\"", ",", "npairs0truetrue", ",", 
            "\"\< npairs0qednum=\>\"", ",", "npairs0qednum"}], "]"}], ";"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Upairs0num=\>\"", ",", "Upairs0num", ",", 
            "\"\< Upairs0true=\>\"", ",", "Upairs0true", ",", 
            "\"\< Upairs0truetrue=\>\"", ",", "Upairs0truetrue", ",", 
            "\"\< Upairs0qednum=\>\"", ",", "Upairs0qednum"}], "]"}], ";"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"doprintdebug", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Ppairs0num=\>\"", ",", "Ppairs0num", ",", 
            "\"\< Ppairs0true=\>\"", ",", "Ppairs0true", ",", 
            "\"\< Ppairs0truetrue=\>\"", ",", "Ppairs0truetrue", ",", 
            "\"\< Ppairs0qednum=\>\"", ",", "Ppairs0qednum"}], "]"}], ";"}]}],
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"Qnurat", ">", "0.1"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Neutrinos matter\>\"", ",", "\"\< Qnurat=\>\"", ",", 
            "Qnurat"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"epmaxerror", "<", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Got Max Energy\>\"", ",", "\"\< epmaxobs=\>\"", ",", 
            "epmaxobs", ",", "\"\< epmaxerror=\>\"", ",", "epmaxerror"}], 
           "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"epmaxminerror", "<", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Got Max Min Energy\>\"", ",", "\"\< epmaxminobs=\>\"", ",", 
            "epmaxminobs", ",", "\"\< epmaxminerror=\>\"", ",", 
            "epmaxminerror"}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doprintdebug", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"epmaxmaxerror", "<", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Got Max Max Energy\>\"", ",", "\"\< epmaxmaxobs=\>\"", ",", 
            "epmaxmaxobs", ",", "\"\< epmaxmaxerror=\>\"", ",", 
            "epmaxmaxerror"}], "]"}], ";"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4689744828506804`*^9, 3.468974489840731*^9}, {
   3.4689756997605104`*^9, 3.4689758211650815`*^9}, {3.468975853010874*^9, 
   3.4689758543728323`*^9}, {3.468975887069848*^9, 3.468975928739766*^9}, {
   3.4689899050366945`*^9, 3.468989921830843*^9}, {3.468989979934392*^9, 
   3.4689901095708*^9}, {3.4689904809748526`*^9, 3.4689904887259984`*^9}, {
   3.472031222321475*^9, 3.4720312294216847`*^9}, {3.4720880082735248`*^9, 
   3.472088010526765*^9}, {3.4771596044515696`*^9, 3.477159640964072*^9}, {
   3.477160067096821*^9, 3.4771600769810333`*^9}, {3.477161963533763*^9, 
   3.4771620391224546`*^9}, {3.4771631257950125`*^9, 
   3.4771631395848417`*^9}, {3.477163182907136*^9, 3.477163254079477*^9}, 
   3.477163531528429*^9, {3.4771712545936513`*^9, 3.477171256876934*^9}, {
   3.4771782476591854`*^9, 3.477178256491886*^9}, {3.477178330288*^9, 
   3.477178337678627*^9}, 3.4772601050983105`*^9, {3.4913376259580607`*^9, 
   3.4913376306548147`*^9}, {3.4913394159219027`*^9, 3.491339418665848*^9}, {
   3.4913415466958046`*^9, 3.4913415733240943`*^9}, {3.4913426728851857`*^9, 
   3.4913426729853296`*^9}, {3.491521918007013*^9, 3.4915219423920765`*^9}, {
   3.491521974097667*^9, 3.4915220128533955`*^9}, {3.491522120307907*^9, 
   3.491522150140805*^9}, {3.491522291053427*^9, 3.4915222925656013`*^9}, {
   3.4915224004707613`*^9, 3.491522400610963*^9}, {3.4915995919867105`*^9, 
   3.4915995960625715`*^9}, {3.4915996461445856`*^9, 3.491599651211872*^9}, {
   3.4916000120106754`*^9, 3.4916000138032527`*^9}, {3.4916001749549775`*^9, 
   3.4916001781495714`*^9}, {3.491600814534648*^9, 3.491600815275714*^9}, {
   3.491602913733147*^9, 3.4916029160665026`*^9}, {3.491603372042163*^9, 
   3.4916033721623363`*^9}, {3.4916259223479104`*^9, 3.491625958920499*^9}, 
   3.491743601782627*^9, {3.49174711520468*^9, 3.4917471156653423`*^9}, {
   3.4917493408750367`*^9, 3.491749342337139*^9}, {3.491755773434603*^9, 
   3.491755811178877*^9}, {3.491831627016698*^9, 3.4918316358093405`*^9}, {
   3.4918335370331664`*^9, 3.491833540127616*^9}, {3.491833799720893*^9, 
   3.4918338411404514`*^9}, {3.4918357418535423`*^9, 
   3.4918357450481358`*^9}, {3.4918411611561165`*^9, 3.491841162057413*^9}, {
   3.4918434302589264`*^9, 3.491843433223189*^9}, {3.492203479389531*^9, 
   3.4922035608066034`*^9}, {3.492203669082296*^9, 3.4922038149320173`*^9}, {
   3.4922088679679265`*^9, 3.492208876530238*^9}, {3.4922090249436464`*^9, 
   3.4922090346375856`*^9}, {3.492209583827282*^9, 3.4922098651518064`*^9}, {
   3.4922099058703566`*^9, 3.492209924296853*^9}, {3.49221005227087*^9, 
   3.492210064298165*^9}, {3.492210104365779*^9, 3.492210146386202*^9}, {
   3.4922103407356625`*^9, 3.4922103688060255`*^9}, {3.4922105061535215`*^9, 
   3.4922105135040913`*^9}, {3.492385488615946*^9, 3.4923854917804956`*^9}, {
   3.49245151816177*^9, 3.4924515254422383`*^9}, {3.4924519744979486`*^9, 
   3.4924519759800797`*^9}, {3.4931760064164624`*^9, 
   3.4931760105023375`*^9}, {3.4934156920301476`*^9, 
   3.4934157195997906`*^9}, {3.4934158027894115`*^9, 3.493415848745493*^9}, {
   3.493416075030875*^9, 3.4934160997263856`*^9}, {3.4934252561727085`*^9, 
   3.4934252948783646`*^9}, {3.493425549344269*^9, 3.493425550275608*^9}, {
   3.493425876825163*^9, 3.4934259083805375`*^9}, {3.4934511622438097`*^9, 
   3.4934511708762226`*^9}, {3.493452644975874*^9, 3.4934526452863197`*^9}, {
   3.4934526938661747`*^9, 3.493452750307333*^9}, {3.493527972394805*^9, 
   3.493527972925568*^9}, {3.493528047152301*^9, 3.493528053471387*^9}, 
   3.493532249024296*^9, 3.4935325106705246`*^9, {3.4935327971624804`*^9, 
   3.493532829729309*^9}, {3.4935886659578624`*^9, 3.4935886853657694`*^9}, 
   3.4935943486792145`*^9, {3.4935944102177024`*^9, 3.49359441851964*^9}, {
   3.49376913784369*^9, 3.4937691436520414`*^9}, {3.4939344606161613`*^9, 
   3.4939344629194736`*^9}, {3.4939369291958046`*^9, 
   3.4939369575265427`*^9}, {3.493937755473934*^9, 3.493937770886096*^9}, {
   3.4939378216991615`*^9, 3.4939379150634127`*^9}, {3.4939380092889023`*^9, 
   3.4939380405138016`*^9}, {3.4939382527089233`*^9, 
   3.4939382918752413`*^9}, {3.49393972370411*^9, 3.493939767757456*^9}, {
   3.49394398967828*^9, 3.4939440323496385`*^9}, 3.493947353985917*^9, {
   3.4941567769139457`*^9, 3.4941568023805647`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.4689758577076273`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.493415723815853*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.493503498903653*^9, 3.4935035021983905`*^9}, {
   3.4935035580486994`*^9, 3.493503568804165*^9}, 3.4935037486127167`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.4937468742301855`*^9, 3.4937468749712515`*^9}}]
},
WindowSize->{1211, 955},
WindowMargins->{{Automatic, 51}, {Automatic, 20}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 92, 1, 31, "Input"],
Cell[640, 23, 94, 1, 31, "Input"],
Cell[737, 26, 567, 13, 52, "Input"],
Cell[1307, 41, 7086, 161, 812, "Input"],
Cell[8396, 204, 17174, 442, 1272, "Input"],
Cell[25573, 648, 3333, 74, 472, "Input"],
Cell[28909, 724, 324, 4, 31, "Input"],
Cell[29236, 730, 14357, 297, 1312, "Input"],
Cell[43596, 1029, 9354, 204, 1032, "Input"],
Cell[52953, 1235, 1604, 34, 132, "Input"],
Cell[54560, 1271, 26246, 568, 1932, "Input"],
Cell[80809, 1841, 14427, 286, 1312, "Input"],
Cell[95239, 2129, 4676, 104, 532, "Input"],
Cell[99918, 2235, 27108, 564, 1372, "Input"],
Cell[127029, 2801, 21725, 495, 1252, "Input"],
Cell[148757, 3298, 94, 1, 31, "Input"],
Cell[148854, 3301, 20249, 467, 1312, "Input"],
Cell[CellGroupData[{
Cell[169128, 3772, 68483, 1521, 4572, "Input"],
Cell[237614, 5295, 3990, 58, 21, "Message"],
Cell[241607, 5355, 3990, 58, 21, "Message"],
Cell[245600, 5415, 3990, 58, 21, "Message"],
Cell[249593, 5475, 4102, 59, 21, "Message"],
Cell[253698, 5536, 4131, 60, 21, "Message"]
}, Open  ]],
Cell[257844, 5599, 37754, 879, 2612, "Input"],
Cell[295601, 6480, 8826, 205, 632, "Input"],
Cell[304430, 6687, 19585, 443, 1332, "Input"],
Cell[324018, 7132, 19112, 407, 1252, "Input"],
Cell[343133, 7541, 9046, 204, 652, "Input"],
Cell[352182, 7747, 8952, 221, 632, "Input"],
Cell[361137, 7970, 94, 1, 31, "Input"],
Cell[361234, 7973, 9789, 245, 592, "Input"],
Cell[371026, 8220, 70, 1, 31, "Input"],
Cell[371099, 8223, 25043, 604, 1326, "Input"],
Cell[396145, 8829, 1147, 33, 31, "Input"],
Cell[397295, 8864, 124, 2, 31, "Input"],
Cell[397422, 8868, 17958, 444, 1852, "Input"],
Cell[415383, 9314, 32482, 690, 2592, "Input"],
Cell[447868, 10006, 9932, 231, 1192, "Input"],
Cell[457803, 10239, 10286, 235, 952, "Input"],
Cell[468092, 10476, 6186, 152, 632, "Input"],
Cell[474281, 10630, 28026, 593, 2272, "Input"],
Cell[502310, 11225, 19713, 432, 1952, "Input"],
Cell[522026, 11659, 5819, 135, 672, "Input"],
Cell[527848, 11796, 38436, 760, 2452, "Input"],
Cell[566287, 12558, 20206, 439, 1732, "Input"],
Cell[586496, 12999, 70, 1, 31, "Input"],
Cell[586569, 13002, 10759, 228, 1292, "Input"],
Cell[597331, 13232, 10152, 244, 712, "Input"],
Cell[607486, 13478, 3565, 76, 292, "Input"],
Cell[611054, 13556, 1965, 39, 312, "Input"],
Cell[613022, 13597, 6782, 148, 392, "Input"],
Cell[619807, 13747, 348, 5, 31, "Input"],
Cell[620158, 13754, 7716, 201, 592, "Input"],
Cell[627877, 13957, 21083, 506, 1512, "Input"],
Cell[648963, 14465, 6584, 145, 792, "Input"],
Cell[655550, 14612, 2048, 41, 232, "Input"],
Cell[657601, 14655, 1298, 34, 192, "Input"],
Cell[658902, 14691, 3547, 68, 292, "Input"],
Cell[662452, 14761, 1394, 30, 212, "Input"],
Cell[663849, 14793, 4031, 104, 192, "Input"],
Cell[667883, 14899, 4587, 118, 252, "Input"],
Cell[672473, 15019, 3035, 72, 292, "Input"],
Cell[675511, 15093, 4033, 95, 412, "Input"],
Cell[679547, 15190, 5833, 134, 452, "Input"],
Cell[685383, 15326, 7370, 176, 612, "Input"],
Cell[692756, 15504, 4408, 98, 392, "Input"],
Cell[697167, 15604, 16057, 410, 1632, "Input"],
Cell[713227, 16016, 1003, 14, 72, "Input"],
Cell[714233, 16032, 4545, 100, 712, "Input"],
Cell[718781, 16134, 5347, 143, 472, "Input"],
Cell[724131, 16279, 51353, 1142, 4032, "Input"],
Cell[775487, 17423, 124, 2, 31, "Input"],
Cell[775614, 17427, 94, 1, 31, "Input"],
Cell[775711, 17430, 30280, 641, 2892, "Input"],
Cell[805994, 18073, 70, 1, 31, "Input"],
Cell[806067, 18076, 68, 1, 31, "Input"],
Cell[806138, 18079, 170, 2, 31, "Input"],
Cell[806311, 18083, 96, 1, 31, "Input"]
}
]
*)

