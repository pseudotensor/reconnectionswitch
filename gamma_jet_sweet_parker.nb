(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    259731,       5840]
NotebookOptionsPosition[    257631,       5772]
NotebookOutlinePosition[    258010,       5788]
CellTagsIndexPosition[    257967,       5785]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"see", " ", "also", " ", 
   RowBox[{"spscaling_wrapper", ".", "nb"}], " ", "and", " ", 
   RowBox[{"spscaling", ".", "nb"}], " ", "that", " ", "are", " ", "wrappers",
    " ", "for", " ", "this", " ", "file", " ", "used", " ", "to", " ", "only",
    " ", "get", " ", "SP", " ", "solution", " ", "itself"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.493602729550315*^9, 3.4936027478265953`*^9}, {
  3.4936028046683297`*^9, 3.493602810686984*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"AutoGeneratedPackage", "->", 
   ButtonBox["Automatic",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/Automatic"]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"AutoGeneratedPackage", "\[Rule]", 
  ButtonBox["Automatic",
   Appearance->Automatic,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Automatic",
   Evaluator->Automatic,
   Method->"Preemptive"]}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.47772082824465*^9, 3.477722869259485*^9, 3.477723022459776*^9, {
   3.4778149165469837`*^9, 3.477814916937546*^9}, {3.477815817362293*^9, 
   3.4778158176226673`*^9}, 3.4778165582376194`*^9, {3.477822502124509*^9, 
   3.4778225024149265`*^9}, 3.477822586926448*^9, 3.477828674469906*^9, 
   3.4778334585691023`*^9, 3.477853629313208*^9, {3.4779293258795247`*^9, 
   3.477929326360216*^9}, 3.477929692817155*^9, {3.4779297817850847`*^9, 
   3.4779297825962515`*^9}, 3.477930086903824*^9, 3.477930239503251*^9, {
   3.477951829638341*^9, 3.4779518301490755`*^9}, {3.47802217672248*^9, 
   3.4780221774134736`*^9}, 3.478022263917861*^9, 3.478022355078944*^9, 
   3.478022610626403*^9, 3.478022971214904*^9, 3.4780242437747555`*^9, 
   3.478026706616147*^9, 3.478028807947714*^9, 3.478031497525136*^9, 
   3.4780337479711185`*^9, 3.4780347615986433`*^9, {3.4783576504199667`*^9, 
   3.4783576513813486`*^9}, {3.4784664530805087`*^9, 3.4784664536212864`*^9}, 
   3.4784666950083838`*^9, 3.4784668201783695`*^9, 3.47846689435503*^9, {
   3.478470871283573*^9, 3.478470871894451*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InitializationCell", "\[Rule]", "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4778232666538477`*^9, 3.477823291910165*^9}}],

Cell[BoxData[
 RowBox[{"InitializationCell", "\[Rule]", "True"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.477823274194691*^9, 3.4778232924008703`*^9}, 
   3.4778286744899344`*^9, 3.4778334585891314`*^9, 3.477853629343251*^9, {
   3.4779293258895392`*^9, 3.4779293263702307`*^9}, 3.4779296928672276`*^9, {
   3.477929781805114*^9, 3.47792978261628*^9}, 3.4779300869138384`*^9, 
   3.47793023952328*^9, {3.4779518296483555`*^9, 3.4779518301590896`*^9}, {
   3.478022176762538*^9, 3.4780221789356623`*^9}, 3.4780222639679327`*^9, 
   3.4780223552692175`*^9, 3.478022610646432*^9, 3.478022971234933*^9, 
   3.478024243824827*^9, 3.4780267067162914`*^9, 3.4780288079677424`*^9, 
   3.4780314975752077`*^9, 3.478033748011176*^9, 3.4780347616286864`*^9, {
   3.4783576504500093`*^9, 3.478357651411392*^9}, {3.4784664530905232`*^9, 
   3.478466453631301*^9}, 3.4784666950183983`*^9, 3.478466820188384*^9, 
   3.47846689435503*^9, {3.478470871293587*^9, 3.4784708719545374`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"IF", " ", "ADD", " ", "NEW", " ", "CELLS"}], ",", " ", 
   RowBox[{
    RowBox[{
    "MUST", " ", "MAKE", " ", "THEM", " ", "INITIALZATION", " ", "CELL", " ", 
     "BY", " ", "GOING", " ", "TO", " ", "CELL"}], "\[Rule]", 
    RowBox[{
     RowBox[{"CELL", " ", "PROPERTIES"}], "\[Rule]", 
     RowBox[{"INITIALZATION", " ", "CELL"}]}]}]}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4778233827407727`*^9, 3.477823405283187*^9}, {
  3.477910660409898*^9, 3.4779106606202*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Setup", " ", "inflow", " ", "conditions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"setupsplocalrun", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eff2global", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"guidefactorglobal", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"whichaccuracy", "=", "14"}], ";", "\[IndentingNewLine]", 
        RowBox[{"whichprecision", "=", "14"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{
         "By", ",", "c", ",", "L", ",", "eta", ",", "rhoin", ",", "iein", ",",
           "gam", ",", "dzsp", ",", "whichvel", ",", "nonrel"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"constssprel", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"By", "\[Rule]", "1"}], ",", 
             RowBox[{"c", "\[Rule]", "1"}], ",", 
             RowBox[{"L", "\[Rule]", "1"}], ",", 
             RowBox[{"eta", "\[Rule]", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "10"}], ")"}]}]}], ",", 
             RowBox[{"rhoin", "\[Rule]", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "5"}], ")"}]}]}], ",", 
             RowBox[{"iein", "\[Rule]", "0"}], ",", 
             RowBox[{"gam", "\[Rule]", 
              RowBox[{"5", "/", "3"}]}], ",", 
             RowBox[{"dzsp", "\[Rule]", "1"}]}], "}"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Didn", "'"}], "t", " ", "hurt", " ", "solver", " ", "to", 
           " ", "have", " ", "By"}], "=", 
          RowBox[{"constant", "/", "gamx"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"bx0", "=", "1"}], ";", "\[IndentingNewLine]", 
        "setupspjetclearall", ";", "\[IndentingNewLine]", 
        RowBox[{"constssprel", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Bzin", "\[Rule]", 
            RowBox[{"guidefactor", "*", "By"}]}], ",", 
           RowBox[{"By", "\[Rule]", 
            RowBox[{"bx0", "/", "gamx"}]}], ",", 
           RowBox[{"c", "\[Rule]", "1"}], ",", 
           RowBox[{"L", "\[Rule]", "1"}], ",", 
           RowBox[{"eta", "\[Rule]", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "10"}], ")"}]}]}], ",", 
           RowBox[{"rhoin", "\[Rule]", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "5"}], ")"}]}]}], ",", 
           RowBox[{"iein", "\[Rule]", "0"}], ",", 
           RowBox[{"gam", "\[Rule]", 
            RowBox[{"5", "/", "3"}]}], ",", 
           RowBox[{"dzsp", "\[Rule]", "1"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bgauss", "=", 
         RowBox[{"By", "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Lpnum", "=", 
         RowBox[{"L", "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"etatotal", "=", 
         RowBox[{"eta", "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rhobvalue", "=", 
         RowBox[{"rhoin", "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UginfixedT", "=", 
         RowBox[{"iein", "//.", "consts"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PginfixedT", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gam", "-", "1"}], ")"}], "*", "pin"}], "//.", 
          "consts"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"workprec", "=", "500"}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxiter", "=", "5000"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "with", " ", "guide", " ", "field", " ", "stuff", " ", "there", " ", 
          "are", " ", "10", " ", "unknowns"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"numunknowns", "=", "10"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setupspjetrun", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"whichaccuracy", "=", "14"}], ";", "\[IndentingNewLine]", 
        RowBox[{"whichprecision", "=", "14"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"gamma_jet", 
          RowBox[{"_wrapper", ".", "nb"}], " ", "sets", " ", "these"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Jet", " ", "solution", " ", "is", " ", "in", " ", "HL", " ", 
           "units"}], ",", " ", 
          RowBox[{
          "while", " ", "this", " ", "file", " ", "is", " ", "all", " ", "in",
            " ", "Gaussian", " ", "units"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"gamma", "=", 
           RowBox[{
            RowBox[{"4", "/", "3"}], " ", "is", " ", 
            RowBox[{"approximate", " ", "--"}], " ", "otherwise", " ", "can", 
            " ", "fix", " ", "p"}]}], ",", 
          RowBox[{"u", " ", "and", " ", "iterate", " ", "over", " ", 
           RowBox[{"this", " ", "--"}], " ", "would", " ", "be", " ", "crazy",
            " ", "to", " ", "use", " ", "P", 
           RowBox[{"(", "T", ")"}]}], ",", 
          RowBox[{"U", 
           RowBox[{"(", "T", ")"}], " ", "internally", " ", "here"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "gamx", " ", "here", " ", "is", " ", "variable", " ", "so", " ", 
           "far"}], ",", " ", 
          RowBox[{
          "but", " ", "may", " ", "need", " ", "to", " ", "iterate", " ", 
           "on", " ", "it", " ", "or", " ", "something"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Didn", "'"}], "t", " ", "hurt", " ", "solver", " ", "to", 
           " ", "have", " ", "By"}], "=", 
          RowBox[{"constant", "/", "gamx"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "setupspjetclearall", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "with", " ", "guide", " ", "field", " ", "stuff", " ", "there", " ", 
          "are", " ", "10", " ", "unknowns"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"numunknowns", "=", "10"}], ";", "\[IndentingNewLine]", 
        "setupspversion1", ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"setupspversion2", ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"workprec", "=", "500"}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxiter", "=", "5000"}], ";", "\[IndentingNewLine]", 
        RowBox[{"constssprel", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"constssprel", ",", "workprec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eqieunits", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"rhobunits", "*", 
              RowBox[{
               RowBox[{"c", "^", "2"}], "/", 
               RowBox[{"L", "^", "3"}]}]}], "]"}], "//.", "constssprel"}], 
           ",", "workprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eqBunits", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"Sqrt", "[", "eqieunits", "]"}], "]"}], "//.", 
            "constssprel"}], ",", "workprec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eqrhobunits", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"eqieunits", "/", 
              RowBox[{"c", "^", "2"}]}], "]"}], "//.", "constssprel"}], ",", 
           "workprec"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eqetaunits", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"c", "*", "L"}], "]"}], "//.", "constssprel"}], ",", 
           "workprec"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.474343408050875*^9, 3.4743434081810627`*^9}, {
   3.4743445539886527`*^9, 3.474344554259042*^9}, {3.474344861610992*^9, 
   3.474344862141755*^9}, {3.4743460051653423`*^9, 3.4743460124658403`*^9}, 
   3.474346774731925*^9, {3.4743469659468784`*^9, 3.4743469660770655`*^9}, 
   3.4743473594627266`*^9, {3.474348574169389*^9, 3.4743485983842077`*^9}, 
   3.4743487736562366`*^9, {3.4743593692285347`*^9, 3.4743593811556845`*^9}, {
   3.4743594764226723`*^9, 3.4743594808189936`*^9}, {3.4743609354105935`*^9, 
   3.4743609372332144`*^9}, {3.474361076293173*^9, 3.4743610854964066`*^9}, {
   3.4743625794846563`*^9, 3.474362581387392*^9}, {3.474372838025714*^9, 
   3.474372838215987*^9}, {3.474372936607467*^9, 3.4743729475031347`*^9}, {
   3.47691128261512*^9, 3.476911338976163*^9}, {3.4769121483199425`*^9, 
   3.4769121588350625`*^9}, {3.4769179160762944`*^9, 3.476917918019088*^9}, {
   3.4769179541210003`*^9, 3.4769179744702606`*^9}, {3.476919182347102*^9, 
   3.4769191930424814`*^9}, {3.476919248492214*^9, 3.476919300667238*^9}, {
   3.4769209904770656`*^9, 3.476921016194045*^9}, {3.476921114034733*^9, 
   3.4769211191621056`*^9}, {3.4770936207378335`*^9, 
   3.4770937340006976`*^9}, {3.4770937761012354`*^9, 
   3.4770937859554048`*^9}, {3.4770943153566465`*^9, 
   3.4770943159875536`*^9}, {3.4771626379034595`*^9, 
   3.4771626390451007`*^9}, {3.477162709476376*^9, 3.4771627120400624`*^9}, {
   3.4771627528887997`*^9, 3.477162753519707*^9}, {3.477163351269229*^9, 
   3.477163394341163*^9}, {3.477164476296939*^9, 3.477164484208315*^9}, {
   3.4771647432908573`*^9, 3.4771647546371727`*^9}, {3.4771690009530754`*^9, 
   3.47716907957613*^9}, {3.47716920783055*^9, 3.477169213068082*^9}, 
   3.477169404052704*^9, {3.477170098531315*^9, 3.4771701051508336`*^9}, {
   3.4771701614818335`*^9, 3.4771701731586237`*^9}, {3.4771702238515167`*^9, 
   3.477170288774872*^9}, 3.4771703196392527`*^9, {3.4771703555108337`*^9, 
   3.4771703683292656`*^9}, {3.4771781360687265`*^9, 
   3.4771781375508575`*^9}, {3.477178427147277*^9, 3.477178428028544*^9}, {
   3.4771833486740847`*^9, 3.47718336477724*^9}, {3.4771834288694*^9, 
   3.4771834315833025`*^9}, {3.477529873973981*^9, 3.477529884779518*^9}, {
   3.477530008657646*^9, 3.4775300198136883`*^9}, {3.4775302081144514`*^9, 
   3.4775302476312733`*^9}, {3.4775302945086803`*^9, 
   3.4775303228394175`*^9}, {3.4775307595173297`*^9, 
   3.4775308913268623`*^9}, {3.4775309528853793`*^9, 3.477530958082853*^9}, {
   3.4775310308074255`*^9, 3.4775310576159744`*^9}, {3.4775311232403374`*^9, 
   3.4775311324535856`*^9}, {3.477531280125928*^9, 3.477531282228952*^9}, {
   3.477531353431336*^9, 3.4775313766847725`*^9}, {3.477533634030677*^9, 
   3.4775336359934993`*^9}, 3.4775338122769823`*^9, {3.4775339346529503`*^9, 
   3.477533937446968*^9}, {3.477534060704203*^9, 3.4775340773781796`*^9}, {
   3.477534853293891*^9, 3.4775348581909328`*^9}, {3.4775351033835025`*^9, 
   3.4775351470062284`*^9}, {3.477535356687736*^9, 3.4775353637679167`*^9}, {
   3.4775354943456783`*^9, 3.4775354995731955`*^9}, {3.4775560799563327`*^9, 
   3.4775560801466064`*^9}, {3.4775883289774275`*^9, 
   3.4775883663711967`*^9}, {3.477591028429048*^9, 3.4775910385235634`*^9}, {
   3.477591521798478*^9, 3.4775915332950096`*^9}, {3.47762415026591*^9, 
   3.4776241545721025`*^9}, {3.477624330785485*^9, 3.4776243360330305`*^9}, {
   3.4776243773224015`*^9, 3.4776243927946496`*^9}, {3.47762511089723*^9, 
   3.4776251132305856`*^9}, {3.4778153845599537`*^9, 
   3.4778153847802706`*^9}, {3.477815419690469*^9, 3.4778154267906785`*^9}, {
   3.477930206355587*^9, 3.4779302078076754`*^9}, {3.478021748286419*^9, 
   3.4780217696371202`*^9}, {3.4780218086331935`*^9, 3.478021831155579*^9}, {
   3.478022871271192*^9, 3.478022874205411*^9}, {3.478023977461816*^9, 
   3.478023983600643*^9}, {3.4780279730772285`*^9, 3.4780279780543857`*^9}, {
   3.4780284781134353`*^9, 3.4780284783337517`*^9}, {3.4780344390848913`*^9, 
   3.478034441037699*^9}, {3.4783492641010323`*^9, 3.478349279713482*^9}, {
   3.4783493486826544`*^9, 3.4783493500345984`*^9}, {3.478352905707405*^9, 
   3.4783529219006896`*^9}, {3.478444450322096*^9, 3.478444455960203*^9}, {
   3.4784549936226177`*^9, 3.4784549947342157`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"setupspversion1", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"constssprel", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"By", "\[Rule]", 
           RowBox[{"bgauss", "/", "gamx"}]}], ",", 
          RowBox[{"L", "\[Rule]", "Lpnum"}], ",", 
          RowBox[{"eta", "\[Rule]", "etatotal"}], ",", 
          RowBox[{"rhoin", "\[Rule]", 
           RowBox[{"rhobvalue", "*", 
            RowBox[{"c", "^", "2"}]}]}], ",", 
          RowBox[{"iein", "\[Rule]", "UginfixedT"}], ",", 
          RowBox[{"gam", "\[Rule]", 
           RowBox[{"4", "/", "3"}]}], ",", 
          RowBox[{"dzsp", "\[Rule]", "1"}]}], "}"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Munits", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"rhobvalue", "*", 
         RowBox[{"Lpnum", "^", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ieunits", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"rhobvalue", "*", 
         RowBox[{"c", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Bunits", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"Sqrt", "[", "ieunits", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rhobunits", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"ieunits", "/", 
         RowBox[{"c", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"etaunits", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"c", "*", "Lpnum"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lunits", "=", 
       RowBox[{"Evaluate", "[", "Lpnum", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "and", " ", "make", " ", "rho", " ", "into", " ", "energy", " ", 
        "density", " ", "units"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "unitslist", " ", "should", " ", "have", " ", "numunknown", " ", 
        "items"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"unitslist", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{
         "Lpnum", ",", "c", ",", "rhobunits", ",", "ieunits", ",", 
          "rhobunits", ",", "ieunits", ",", "Bunits", ",", "c", ",", "Bunits",
           ",", "Bunits"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "FindRoot", " ", "works", " ", "best", " ", "with", " ", "mostly", 
         " ", "similar", " ", "values"}], ",", " ", 
        RowBox[{
         RowBox[{"so", " ", "have", " ", "c"}], "=", "1"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"for", " ", "compatibility", " ", "and", " ", "ease"}], ",", 
        " ", 
        RowBox[{
         RowBox[{"don", "'"}], "t", " ", "put", " ", "c", " ", "into", " ", 
         "constssprel"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"constssprel", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Bzin", "\[Rule]", 
          RowBox[{"guidefactor", "*", "By"}]}], ",", 
         RowBox[{"By", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"bgauss", "/", "gamx"}], ")"}], "/", "Bunits"}]}], ",", 
         RowBox[{"L", "\[Rule]", "1"}], ",", 
         RowBox[{"eta", "\[Rule]", 
          RowBox[{"etatotal", "/", "etaunits"}]}], ",", 
         RowBox[{"rhoin", "\[Rule]", 
          RowBox[{"rhobvalue", "/", "rhobunits"}]}], ",", 
         RowBox[{"iein", "\[Rule]", 
          RowBox[{"UginfixedT", "/", "ieunits"}]}], ",", 
         RowBox[{"gam", "\[Rule]", 
          RowBox[{"4", "/", "3"}]}], ",", 
         RowBox[{"dzsp", "\[Rule]", "1"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"for", " ", "now"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PginfixedT", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setupspversion2", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Munits", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ieunits", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Bunits", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhobunits", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"etaunits", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lunits", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"unitslist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "numunknowns"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"constssprel", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Bzin", "->", 
          RowBox[{"guidefactor", "*", "By"}]}], ",", 
         RowBox[{"By", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"bgauss", "/", "gamx"}], ")"}]}], ",", 
         RowBox[{"L", "\[Rule]", "Lpnum"}], ",", 
         RowBox[{"eta", "\[Rule]", "etatotal"}], ",", 
         RowBox[{"rhoin", "\[Rule]", "rhobvalue"}], ",", 
         RowBox[{"iein", "\[Rule]", "UginfixedT"}], ",", 
         RowBox[{"gam", "\[Rule]", 
          RowBox[{"4", "/", "3"}]}], ",", 
         RowBox[{"dzsp", "\[Rule]", "1"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"for", " ", "now"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PginfixedT", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4775353671728125`*^9, 3.4775354077711906`*^9}, {
  3.477535489909299*^9, 3.4775354918821363`*^9}, {3.4775392694339886`*^9, 
  3.4775392765842705`*^9}, {3.4775560112074766`*^9, 3.477556074137966*^9}, {
  3.477598524618038*^9, 3.4775985427240734`*^9}, {3.4776241123614063`*^9, 
  3.477624133381632*^9}, {3.4776241869486575`*^9, 3.477624213737178*^9}, {
  3.477624270348581*^9, 3.4776242719208417`*^9}, {3.4776243561619744`*^9, 
  3.4776243670075693`*^9}, {3.477625183451558*^9, 3.4776252053430367`*^9}, {
  3.477625251128874*^9, 3.4776252566067505`*^9}, {3.477815575164029*^9, 
  3.477815593650611*^9}, {3.478349288405981*^9, 3.4783492952858734`*^9}, {
  3.4783493565940304`*^9, 3.4783493636541824`*^9}, {3.478352051459056*^9, 
  3.4783520619140897`*^9}, {3.4783529261467953`*^9, 3.478352966154323*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setupspjetclearall", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"below", " ", "required", " ", "for", " ", "non"}], "-", 
       RowBox[{
       "rel", " ", "setup", " ", "since", " ", "otherwise", " ", "gamx", " ", 
        "gets", " ", "set", " ", "as", " ", "for", " ", "rel", " ", "version",
         " ", "when", " ", "back", " ", "here"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "for", " ", "now", " ", "only", " ", "actually", " ", "required", " ", 
       "for", " ", "gamx"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{"ieout", ",", "iec"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{"rhoout", ",", "rhoc"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{
       "vx", ",", "vy", ",", "ux", ",", "uy", ",", "gamx", ",", "gamy", ",", 
        "whichvx", ",", "whichvy"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{
       "bsqcent", ",", "by", ",", "By", ",", "bx", ",", "Bx", ",", "bzin", 
        ",", "bzout", ",", "bsqin", ",", "bsqout", ",", "Bzc"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "gam", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.47717030533869*^9, 3.4771703610688257`*^9}, {
  3.477703578520765*^9, 3.477703581224653*^9}, {3.4783510306512065`*^9, 
  3.478351032894432*^9}, {3.4783511309153795`*^9, 3.478351132477626*^9}, {
  3.4783517377479615`*^9, 3.4783517379282207`*^9}, {3.4783526625577726`*^9, 
  3.478352662818147*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setupsprelinputs", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myfun", "[", "x_", "]"}], ":=", "x"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", 
        RowBox[{"ieout", ",", "iec"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", 
        RowBox[{"rhoout", ",", "rhoc"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"whichvel", "=", "3"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"whichvel", "=", "4"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "factoreq6", " ", "controls", " ", "compressibility", " ", "through",
           " ", "layer"}], ",", " ", 
         RowBox[{
          RowBox[{
          "but", " ", "only", " ", "important", " ", "for", " ", "non"}], "-", 
          RowBox[{"ideal", " ", "EOS"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"factoreq6", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"eff1", " ", "is", " ", "eff", " ", "in", " ", 
         RowBox[{"paper", " ", "--"}], " ", "NO", " ", "LONGER", " ", 
         "CHANGE", " ", "from", " ", "exactly", " ", "1"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"eff1", "=", "1"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "now", " ", "eff2", " ", "and", " ", "guidefactor", " ", "are", " ", 
         "set", " ", "outside", " ", "as", " ", "calling", " ", "terms"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eff2", "=", "eff2global"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "strength", " ", "of", " ", "guide", " ", "field", " ", "relative", 
         " ", "to", " ", "ingoing", " ", "field", " ", "that", " ", 
         "generates", " ", "current"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"can", " ", "be"}], " ", "-", "infinity"}], " ", ".."}], 
         " ", "infinity"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"guidefactor", "=", "guidefactorglobal"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Afactor", "=", "Afactorglobal"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"ensure", " ", "precision"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"factoreq6", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"factoreq6", ",", "workprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eff2", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"eff2", ",", "workprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eff1", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"eff1", ",", "workprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"guidefactor", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"guidefactor", ",", "workprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Afactor", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Afactor", ",", "workprec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pin", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"gam", "-", "1"}], ")"}], "*", "iein"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pcent", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"gam", "-", "1"}], ")"}], "*", "iec"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pout", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"gam", "-", "1"}], ")"}], "*", "ieout"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.47435820980136*^9, 3.4743582292192817`*^9}, {
   3.4743586802478285`*^9, 3.4743586871477504`*^9}, {3.474359167057827*^9, 
   3.4743591728261213`*^9}, {3.4743593891371613`*^9, 3.474359399361864*^9}, {
   3.4769112863504915`*^9, 3.4769112867410526`*^9}, {3.4769113407086544`*^9, 
   3.4769113419604545`*^9}, 3.477164670566285*^9, {3.478346635511306*^9, 
   3.478346641760291*^9}, {3.47834711245712*^9, 3.4783471517836685`*^9}, {
   3.478347203488016*^9, 3.4783472534498577`*^9}, {3.4783493754511456`*^9, 
   3.4783494044328194`*^9}, {3.478350837032797*^9, 3.478350891410989*^9}, {
   3.4783510693668766`*^9, 3.478351071049296*^9}, {3.478351114241403*^9, 
   3.4783511144817486`*^9}, 3.478352188355904*^9, {3.478352285715901*^9, 
   3.478352305844845*^9}, {3.478352893479822*^9, 3.478352893980542*^9}, {
   3.4783530834029183`*^9, 3.4783530843943443`*^9}, {3.4783535191094337`*^9, 
   3.478353522253955*^9}, {3.4783558151609936`*^9, 3.4783558942547245`*^9}, {
   3.4783566034645185`*^9, 3.4783566036447773`*^9}, {3.4784443734715905`*^9, 
   3.4784444402175665`*^9}, {3.478577952038136*^9, 3.4785779557034063`*^9}, {
   3.478578669319536*^9, 3.4785786768904223`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setupsprelvelocity", "[", "nonrelsprel0_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", ",", 
       RowBox[{"nonrelsprel", "=", "nonrelsprel0"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{
       "vx", ",", "vy", ",", "ux", ",", "uy", ",", "gamx", ",", "gamy", ",", 
        "whichvx", ",", "whichvy"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"3", "-", "velocity"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"whichvel", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "relativistic", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonrelsprel", "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gamx", "=", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"vx", "/", "c"}], ")"}], "^", "2"}]}], "]"}]}]}], 
            ";", 
            RowBox[{"gamxgamxm1", "=", 
             RowBox[{"gamx", "*", 
              RowBox[{"(", 
               RowBox[{"gamx", "-", "1"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"gamy", "=", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"vy", "/", "c"}], ")"}], "^", "2"}]}], "]"}]}]}], 
            ";", 
            RowBox[{"gamygamym1", "=", 
             RowBox[{"gamy", "*", 
              RowBox[{"(", 
               RowBox[{"gamy", "-", "1"}], ")"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"non", "-", 
           RowBox[{
           "rel", " ", "limit", " ", "that", " ", "can", " ", "be", " ", 
            "solved", " ", "analytically"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonrelsprel", "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gamx", "=", "1"}], ";", 
            RowBox[{"gamxgamxm1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vx", "^", "2"}], "/", 
                RowBox[{"c", "^", "2"}]}], ")"}], "/", "2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"gamy", "=", "1"}], ";", 
            RowBox[{"gamygamym1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vy", "^", "2"}], "/", 
                RowBox[{"c", "^", "2"}]}], ")"}], "/", "2"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"mixed", " ", "limit"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonrelsprel", "\[Equal]", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gamx", "=", "1"}], ";", 
            RowBox[{"gamxgamxm1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"vx", "^", "2"}], "/", 
                RowBox[{"c", "^", "2"}]}], ")"}], "/", "2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"gamy", "=", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"vy", "/", "c"}], ")"}], "^", "2"}]}], "]"}]}]}], 
            ";", 
            RowBox[{"gamygamym1", "=", 
             RowBox[{"gamy", "*", 
              RowBox[{"(", 
               RowBox[{"gamy", "-", "1"}], ")"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ux", "=", 
          RowBox[{"vx", "*", "gamx"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"uy", "=", 
          RowBox[{"vy", "*", "gamy"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"numunknowns", " ", "things"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"myvarssimple", "=", 
          RowBox[{"{", 
           RowBox[{
           "d", ",", "vx", ",", "rhoc", ",", "iec", ",", "rhoout", ",", 
            "ieout", ",", "Bx", ",", "vy", ",", "Bzc", ",", "Bzout"}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"whichvx", "=", "vx"}], ";", "\[IndentingNewLine]", 
         RowBox[{"whichvy", "=", "vy"}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Got here whichvel==3\>\"", "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Got here 0\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"4", "-", "velocity"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"whichvel", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "relativistic", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "nonrelsprel", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonrelsprel", "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gamx", "=", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"ux", "^", "2"}], "/", 
                RowBox[{"c", "^", "2"}]}]}], "]"}]}], ";", 
            RowBox[{"gamxgamxm1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"ux", "^", "4"}], "/", 
                 RowBox[{"c", "^", "4"}]}], "+", 
                RowBox[{
                 RowBox[{"ux", "^", "2"}], "/", 
                 RowBox[{"c", "^", "2"}]}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"ux", "^", "2"}], "/", 
                 RowBox[{"c", "^", "2"}]}], "+", "1", "+", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ux", "^", "2"}], "/", 
                   RowBox[{"c", "^", "2"}]}], "+", "1"}], "]"}]}], ")"}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"gamy", "=", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"uy", "^", "2"}], "/", 
                RowBox[{"c", "^", "2"}]}]}], "]"}]}], ";", 
            RowBox[{"gamygamym1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"uy", "^", "4"}], "/", 
                 RowBox[{"c", "^", "4"}]}], "+", 
                RowBox[{
                 RowBox[{"uy", "^", "2"}], "/", 
                 RowBox[{"c", "^", "2"}]}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"uy", "^", "2"}], "/", 
                 RowBox[{"c", "^", "2"}]}], "+", "1", "+", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"uy", "^", "2"}], "/", 
                   RowBox[{"c", "^", "2"}]}], "+", "1"}], "]"}]}], ")"}]}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"non", "-", 
           RowBox[{
           "rel", " ", "limit", " ", "that", " ", "can", " ", "be", " ", 
            "solved", " ", "analytically"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonrelsprel", "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gamx", "=", "1"}], ";", 
            RowBox[{"gamxgamxm1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ux", "^", "2"}], "/", 
                RowBox[{"c", "^", "2"}]}], ")"}], "/", "2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"gamy", "=", "1"}], ";", 
            RowBox[{"gamygamym1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"uy", "^", "2"}], "/", 
                RowBox[{"c", "^", "2"}]}], ")"}], "/", "2"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"mixed", " ", "limit"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nonrelsprel", "\[Equal]", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gamx", "=", "1"}], ";", 
            RowBox[{"gamxgamxm1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ux", "^", "2"}], "/", 
                RowBox[{"c", "^", "2"}]}], ")"}], "/", "2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"gamy", "=", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"uy", "/", "c"}], ")"}]}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"assume", " ", 
               RowBox[{"uy", "/", "c"}]}], "<", "0"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"gamygamym1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"uy", "/", "c"}], ")"}], "^", "2"}]}], ";"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"uy", "/", "c"}], ")"}], "^", "2"}], "+", 
             RowBox[{"(", 
              RowBox[{"uy", "/", "c"}], ")"}], "+", 
             RowBox[{"1", " ", "assuming", " ", 
              RowBox[{"uy", "/", "c"}]}]}], "<", "0"}], " ", "*)"}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"vx", "=", 
          RowBox[{"ux", "/", "gamx"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vy", "=", 
          RowBox[{"uy", "/", "gamy"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"numunknowns", " ", "things"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"myvarssimple", "=", 
          RowBox[{"{", 
           RowBox[{
           "d", ",", "ux", ",", "rhoc", ",", "iec", ",", "rhoout", ",", 
            "ieout", ",", "Bx", ",", "uy", ",", "Bzc", ",", "Bzout"}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"whichvx", "=", "ux"}], ";", "\[IndentingNewLine]", 
         RowBox[{"whichvy", "=", "uy"}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Got here whichvel==4\>\"", "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4743583095848417`*^9, 3.47435838530372*^9}, {
   3.4743585408473806`*^9, 3.474358560004928*^9}, {3.4743586895311775`*^9, 
   3.474358690021883*^9}, {3.4743591754198513`*^9, 3.4743592179109507`*^9}, {
   3.4743604818183603`*^9, 3.4743605462209663`*^9}, 3.4743606074590225`*^9, {
   3.4743606666941986`*^9, 3.4743606823066483`*^9}, {3.4769115596534815`*^9, 
   3.4769115759769535`*^9}, {3.476911641150669*^9, 3.4769116528875456`*^9}, {
   3.477925104859997*^9, 3.47792517699372*^9}, {3.4779256754604797`*^9, 
   3.4779257441192064`*^9}, {3.4779258468769646`*^9, 3.477925865814195*^9}, {
   3.4779274898494434`*^9, 3.4779274983015966`*^9}, {3.4779277058500366`*^9, 
   3.4779277306757345`*^9}, {3.4783552596722403`*^9, 3.478355278499312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "^", "i"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"B", "^", "i"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"b", "^", "t"}], " ", 
          RowBox[{"u", "^", "i"}]}]}], ")"}], "/", 
       RowBox[{"u", "^", "t"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"B", "^", "i"}], "/", 
         RowBox[{"u", "^", "t"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"b", "^", "t"}], " ", 
         RowBox[{"v", "^", "i"}]}]}], " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"B", "^", "i"}], "/", 
         RowBox[{"u", "^", "t"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"B", "^", "j"}], " ", 
         RowBox[{"u", "^", "t"}], " ", 
         RowBox[{"v", "^", "j"}], " ", 
         RowBox[{"v", "^", "i"}]}]}]}]}]}], " ", ";", "  ", 
    RowBox[{
     RowBox[{"b", "^", "t"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"B", "^", "i"}], " ", "u_i"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"B", "^", "i"}], " ", 
       RowBox[{"u", "^", "t"}], " ", 
       RowBox[{"v", "^", "i"}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"btin", "=", "0"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"since", " ", "perp"}], " ", "*)"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"btout", "=", "0"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"since", " ", "perp"}], " ", "*)"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"setupsprelb", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{
        "gammac", ",", "bycent", ",", "bzcent", ",", "bsqcent", ",", "by", 
         ",", "By", ",", "bx", ",", "Bx", ",", "bzin", ",", "bzout", ",", 
         "bsqin", ",", "bsqout", ",", "Bzc"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bycent", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "eff1"}], ")"}], "*", 
         RowBox[{"by", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gammac", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"bzcent", "=", 
        RowBox[{"Bzc", "/", "gammac"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bsqcent", "=", 
        RowBox[{
         RowBox[{"bycent", "^", "2"}], "+", 
         RowBox[{"bzcent", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"by", "=", 
        RowBox[{"By", "/", "gamx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bzin", "=", 
        RowBox[{"Bzin", "/", "gamx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bsqin", "=", 
        RowBox[{
         RowBox[{"by", "^", "2"}], " ", "+", " ", 
         RowBox[{"bzin", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bx", "=", 
        RowBox[{"Bx", "/", "gamy"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bzout", "=", 
        RowBox[{"Bzout", "/", "gamy"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bsqout", "=", 
        RowBox[{
         RowBox[{"bx", "^", "2"}], " ", "+", " ", 
         RowBox[{"bzout", "^", "2"}]}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.474358425181061*^9, 3.474358435355691*^9}, {
  3.474358618759413*^9, 3.474358618949686*^9}, {3.474358707046363*^9, 
  3.4743587075070257`*^9}, {3.474359405200259*^9, 3.474359415505077*^9}, {
  3.4783509050005293`*^9, 3.4783509141837344`*^9}, {3.4783509458592815`*^9, 
  3.4783509679410334`*^9}, {3.478351012234725*^9, 3.478351013847043*^9}, {
  3.478351119749323*^9, 3.478351127129936*^9}, {3.4783514462988787`*^9, 
  3.478351446729498*^9}, {3.4783514849043903`*^9, 3.478351497292203*^9}, {
  3.478351595954072*^9, 3.4783515966150227`*^9}, {3.4783516704812365`*^9, 
  3.478351718850789*^9}, {3.4783526687066145`*^9, 3.478352673623685*^9}, {
  3.4783537300928125`*^9, 3.4783537632805347`*^9}, {3.4783577638831186`*^9, 
  3.478357764003291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"START", " ", "COMPACT"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"solvespsimple", "[", "nonrelsprel0_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", 
         RowBox[{"nonrelsprel", "=", "nonrelsprel0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"setupsprelinputs", ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"CHOOSE", ":", " ", 
          RowBox[{"nonrelsprel", "\[Equal]", 
           RowBox[{
            RowBox[{"1", " ", "for", " ", "pure", " ", "non"}], "-", 
            "rel"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"CHOOSE", ":", " ", 
          RowBox[{"nonrelsprel", "\[Equal]", 
           RowBox[{
            RowBox[{"2", " ", "for", " ", "non"}], "-", 
            RowBox[{"rel", " ", "inflow", " ", "and", " ", "ultra"}], "-", 
            RowBox[{"rel", " ", "outflow"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"setupsprelvelocity", "[", "nonrelsprel", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Got here 0.5\>\"", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "setupsprelb", ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Got here1\>\"", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"auxvars", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"etap", "\[Rule]", 
              RowBox[{"eta", "*", "4", "*", 
               RowBox[{"Pi", "/", 
                RowBox[{"c", "^", "2"}]}]}]}], ",", 
             RowBox[{"Ez", "\[Rule]", 
              RowBox[{"etap", "*", 
               RowBox[{"Jz", "/", "Afactor"}]}]}], ",", 
             RowBox[{"Jz", "->", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"c", "/", 
                 RowBox[{"(", 
                  RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Bx", "/", "L"}], "-", 
                 RowBox[{"By", "/", "d"}]}], ")"}]}]}]}], "}"}]}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"auxvars", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"etap", "\[Rule]", 
            RowBox[{"eta", "*", "4", "*", 
             RowBox[{"Pi", "/", 
              RowBox[{"c", "^", "2"}]}]}]}], ",", 
           RowBox[{"Ez", "\[Rule]", 
            RowBox[{"etap", "*", 
             RowBox[{"Jz", "/", "Afactor"}]}]}], ",", 
           RowBox[{"Jz", "->", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"c", "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "By"}], "/", "d"}], ")"}]}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "setupfulleqns", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eqnscompact", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"{", 
           RowBox[{
           "eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5", ",", "eq6", 
            ",", "eq7", ",", "eq8", ",", "eq9", ",", "eq10"}], "}"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"eqns0", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"eq1", "\[Equal]", "0"}], ",", 
           RowBox[{"eq2", "\[Equal]", "0"}], ",", 
           RowBox[{"eq3", "\[Equal]", "0"}], ",", 
           RowBox[{"eq4", "\[Equal]", "0"}], ",", 
           RowBox[{"eq5", "\[Equal]", "0"}], ",", 
           RowBox[{"eq6", "\[Equal]", "0"}], ",", 
           RowBox[{"eq7", "\[Equal]", "0"}], ",", 
           RowBox[{"eq8", "\[Equal]", "0"}], ",", 
           RowBox[{"eq9", "\[Equal]", "0"}], ",", 
           RowBox[{"eq10", "\[Equal]", "0"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myeqns0", "=", "eqns0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nummyeqns0", "=", 
         RowBox[{"myeqns0", "//.", "constssprel"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numeffEM", "=", 
         RowBox[{"effEM", "//.", "constssprel"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"fsols", "=", 
           RowBox[{"NSolve", "[", 
            RowBox[{"nummyeqns0", ",", "myvarssimple", ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}]}], ";"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "sometimes", " ", "have", " ", "to", " ", "really", " ", "increase", 
          " ", "this", " ", "at", " ", "high", " ", "S", " ", "in", " ", 
          "order", " ", "to", " ", "get", " ", "all", " ", "roots", " ", 
          "and", " ", "to", " ", "ensure", " ", "desired", " ", "root", " ", 
          "is", " ", "found"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fsols", "=", 
         RowBox[{"NSolve", "[", 
          RowBox[{"nummyeqns0", ",", "myvarssimple", ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "workprec"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Dimensions of Nsolve:\>\"", ",", 
          RowBox[{"Dimensions", "[", "fsols", "]"}], ",", 
          "\"\<nonrelsprel=\>\"", ",", "nonrelsprel"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dodebugprint", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"Dimensions", "[", "fsols", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"whichi", "=", 
         RowBox[{"picksimplesol", "[", "fsols", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"whichi", "\[Equal]", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"whichi", "=", 
            RowBox[{"picksimplesolalternative", "[", "fsols", "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"whichi", ">", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Used Alt\>\"", "]"}], ";"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Alt failed\>\"", "]"}], ";"}]}], 
            "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"whichi", ">", 
           RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"dodebugprint", "\[Equal]", "1"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Picked i=\>\"", ",", "whichi"}], "]"}], ";"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"mysol", "=", 
            RowBox[{"fsols", "[", 
             RowBox[{"[", "whichi", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"errorvec", "=", 
            RowBox[{
             RowBox[{"eqnscompact", "//.", "constssprel"}], "//.", 
             "mysol"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"error", "=", 
            RowBox[{"errorvec", ".", "errorvec"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"dodebugprint", "\[Equal]", "1"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Error=\>\"", ",", "error"}], "]"}], ";"}]}], 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"simplevector", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"mysol", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "numunknowns"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "convert", " ", "solution", " ", "to", " ", "be", " ", "closer", 
             " ", "to", " ", "rel", " ", "answer"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nonrelsprel", "\[Equal]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nonrelsolution", "=", "1"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fsolsnonrel", "=", "fsols"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mysolnonrel", "=", "mysol"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mysolnonrelconverted", "=", 
               RowBox[{"convertotherrel2relall", "[", 
                RowBox[{"nonrelsprel", ",", "mysolnonrel"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"numeffEMnonrel", "=", 
               RowBox[{"numeffEM", "//.", "mysolnonrel"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nonrelsprel", "\[Equal]", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"mixedrelsolution", "=", "1"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fsolsmixedrel", "=", "fsols"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mysolmixedrel", "=", "mysol"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mysolmixedrelconverted", "=", 
               RowBox[{"convertotherrel2relall", "[", 
                RowBox[{"nonrelsprel", ",", "mysolmixedrel"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"numeffEMmixedrel", "=", 
               RowBox[{"numeffEM", "//.", "mysolmixedrel"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<After2\>\"", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"whichi", "\[Equal]", 
           RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<No good solution found!\>\"", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"deathfsols", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"d", "\[Rule]", "0"}], ",", 
              RowBox[{"whichvx", "\[Rule]", "0"}], ",", 
              RowBox[{"rhoc", "\[Rule]", "0"}], ",", 
              RowBox[{"iec", "\[Rule]", "0"}], ",", 
              RowBox[{"rhoout", "\[Rule]", "0"}], ",", 
              RowBox[{"ieout", "\[Rule]", "0"}], ",", 
              RowBox[{"Bx", "\[Rule]", "0"}], ",", 
              RowBox[{"whichvy", "\[Rule]", "0"}], ",", 
              RowBox[{"Bzc", "\[Rule]", "0"}], ",", 
              RowBox[{"Bzout", "\[Rule]", "0"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"deathmysol", "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "d", ",", "whichvx", ",", "rhoc", ",", "iec", ",", "rhoout", 
                 ",", "ieout", ",", "Bx", ",", "whichvy", ",", "Bzc", ",", 
                 "Bzout"}], "}"}], "//.", "deathfsols"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"deathmysol", "=", "deathfsols"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nonrelsprel", "\[Equal]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nonrelsolution", "=", "0"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fsolsnonrelbackup", "=", "fsols"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fsolsnonrel", "=", "deathfsols"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mysolnonrel", "=", "deathmysol"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mysolnonrelconverted", "=", "mysolnonrel"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"numeffEMnonrel", "=", "0"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nonrelsprel", "\[Equal]", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"mixedrelsolution", "=", "0"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fsolsmixedrelbackup", "=", "fsols"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fsolsmixedrel", "=", "deathfsols"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mysolmixedrel", "=", "deathmysol"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mysolmixedrelconverted", "=", "mysolmixedrel"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"numeffEMmixedrel", "=", "0"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "formrelguess", " ", "depends", " ", "upon", " ", "whichvx", " ", "and", 
      " ", "whichvy"}], ",", " ", 
     RowBox[{"but", " ", "assume", " ", "whichvel", " ", 
      RowBox[{"doesn", "'"}], "t", " ", "change", " ", "regardless", " ", 
      "of", " ", "using", " ", "nonrel", " ", "or", " ", "mixedrel", " ", 
      "solutions"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"formrelguess", "[", "mysol0_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", "myvars", ",", 
        RowBox[{"mysol", "=", "mysol0"}], ",", "varreplace"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Form", " ", "initial", " ", "guess", " ", "from", " ", "NSolve", " ", 
        "since", " ", "otherwise", " ", "has", " ", "problems"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"numunknown", " ", "items"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"varreplace", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"vxvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"rhocvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"iecvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"rhooutvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"5", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"ieoutvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"6", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"Bxvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"7", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"vyvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"8", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"Bzcvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"9", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"Bzoutvar", "\[Rule]", 
           RowBox[{"mysol", "[", 
            RowBox[{"[", 
             RowBox[{"10", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"numunknown", " ", "items"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"myvars", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d", ",", "dvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"whichvx", ",", "vxvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"rhoc", ",", "rhocvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"iec", ",", "iecvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"rhoout", ",", "rhooutvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ieout", ",", "ieoutvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Bx", ",", "Bxvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"whichvy", ",", "vyvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Bzc", ",", "Bzcvar"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Bzout", ",", "Bzoutvar"}], "}"}]}], "}"}], "//.", 
         "varreplace"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"return", " ", "value"}], " ", "*)"}], "\[IndentingNewLine]", 
       "myvars"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"picksimplesol", "[", "fsols0_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", "whichi", ",", 
         RowBox[{"fsols", "=", "fsols0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"whichi", "=", 
         RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{
            RowBox[{"Dimensions", "[", "fsols", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "4", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "5", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "6", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "<", 
               RowBox[{"0.95", "*", 
                RowBox[{"(", 
                 RowBox[{"L", "//.", "constssprel"}], ")"}]}]}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Im", "[", 
                 RowBox[{"fsols", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                "]"}], "<", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "13"}], ")"}]}], "*", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Re", "[", 
                  RowBox[{"fsols", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "]"}]}]}]}], ",", 
             RowBox[{
              RowBox[{"mysol", "=", 
               RowBox[{"fsols", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", 
              RowBox[{"whichi", "=", "i"}], ";"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Im", "[", 
             RowBox[{"fsols", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"Re", "[", 
             RowBox[{"fsols", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "whichi"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"picksimplesolalternative", "[", "fsols0_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", "whichi", ",", 
         RowBox[{"fsols", "=", "fsols0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"whichi", "=", 
         RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{
            RowBox[{"Dimensions", "[", "fsols", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "4", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "5", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "6", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], ">",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Im", "[", 
                 RowBox[{"fsols", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                "]"}], "<", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "13"}], ")"}]}], "*", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Re", "[", 
                  RowBox[{"fsols", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "]"}]}]}]}], ",", 
             RowBox[{
              RowBox[{"mysol", "=", 
               RowBox[{"fsols", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", 
              RowBox[{"whichi", "=", "i"}], ";"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Im", "[", 
             RowBox[{"fsols", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"Re", "[", 
             RowBox[{"fsols", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "whichi"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"fsols", "=", 
      RowBox[{"FindRoot", "[", 
       RowBox[{"nummyeqns0", ",", "myvars", ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "20"}], ",", 
        RowBox[{"MaxIterations", "\[Rule]", "1000"}]}], "]"}]}], ";"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Check", ":", " ", "result"}], "=", 
      RowBox[{
       RowBox[{"myeqns", "//.", "constssprel"}], "//.", "fsols"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"error", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"result", ".", "result"}], "]"}]}], ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4743428740630383`*^9, 3.4743428835967474`*^9}, {
   3.474343109591712*^9, 3.474343153374669*^9}, {3.4743432338704157`*^9, 
   3.474343236414074*^9}, {3.474343437863744*^9, 3.474343442570512*^9}, {
   3.4743434891775293`*^9, 3.4743435121505632`*^9}, {3.474344939152491*^9, 
   3.4743450387557135`*^9}, {3.474345073896243*^9, 3.4743450962083263`*^9}, {
   3.474345127543384*^9, 3.4743451659285793`*^9}, {3.474345203682867*^9, 
   3.474345247535925*^9}, {3.474345732673518*^9, 3.4743457766667776`*^9}, {
   3.474345807891677*^9, 3.4743458213510303`*^9}, {3.4743458518949504`*^9, 
   3.474345857793432*^9}, {3.474345895047*^9, 3.474345927693944*^9}, {
   3.47434601631137*^9, 3.4743460620671635`*^9}, {3.4743461863759103`*^9, 
   3.4743463353901825`*^9}, {3.474347474698427*^9, 3.4743474759602413`*^9}, {
   3.4743476543367343`*^9, 3.474347704959526*^9}, {3.4743580467068415`*^9, 
   3.474358120302667*^9}, {3.47435820229056*^9, 3.474358239474027*^9}, 
   3.4743583059796576`*^9, {3.474358397871792*^9, 3.4743584181609664`*^9}, {
   3.4743585329660482`*^9, 3.4743585365311747`*^9}, {3.47435871118231*^9, 
   3.474358718592966*^9}, {3.4743591264093776`*^9, 3.4743591268099537`*^9}, {
   3.474360576634699*^9, 3.474360580540315*^9}, {3.474361105314904*^9, 
   3.4743611069472513`*^9}, {3.47436460390563*^9, 3.4743646475283566`*^9}, {
   3.474364736886848*^9, 3.4743647536309247`*^9}, {3.47436479160553*^9, 
   3.4743648105828176`*^9}, {3.4743649635928354`*^9, 
   3.4743650014873247`*^9}, {3.474365057227475*^9, 3.4743650576180367`*^9}, {
   3.4743651180949984`*^9, 3.474365161056774*^9}, {3.4743652045693426`*^9, 
   3.474365204689515*^9}, {3.474365526702547*^9, 3.474365565958995*^9}, {
   3.474365650550632*^9, 3.4743656506908336`*^9}, {3.4743658269743166`*^9, 
   3.4743658310501776`*^9}, {3.4743726791973295`*^9, 3.4743726821215343`*^9}, 
   3.4743727949437647`*^9, {3.4743728293232*^9, 3.474372834430544*^9}, {
   3.4769109576378255`*^9, 3.4769110503611555`*^9}, {3.4769115409265537`*^9, 
   3.4769115450725155`*^9}, {3.4769115940028734`*^9, 
   3.4769116022146816`*^9}, {3.476911665115128*^9, 3.4769116771524367`*^9}, {
   3.476917919701507*^9, 3.476917922805971*^9}, {3.477164671697912*^9, 
   3.4771646738009357`*^9}, {3.4771781387626*^9, 3.4771781427283025`*^9}, {
   3.4771826101521425`*^9, 3.4771826109532948`*^9}, {3.4772626408946066`*^9, 
   3.4772626461121087`*^9}, {3.477447658251384*^9, 3.4774476588822913`*^9}, {
   3.4775352210827456`*^9, 3.4775352211528463`*^9}, {3.4775355418139343`*^9, 
   3.4775355421544237`*^9}, {3.4775355755524483`*^9, 3.477535608279507*^9}, {
   3.4775393876639953`*^9, 3.4775393943836575`*^9}, {3.477539447570136*^9, 
   3.477539480317224*^9}, {3.477541833901512*^9, 3.477541883072216*^9}, {
   3.4775556406646624`*^9, 3.4775556411253247`*^9}, {3.4775560935959454`*^9, 
   3.4775560942669106`*^9}, {3.477599507571456*^9, 3.477599525246872*^9}, {
   3.4776235897699566`*^9, 3.4776236130434227`*^9}, {3.4776249116407137`*^9, 
   3.4776249173989935`*^9}, {3.4776836359147053`*^9, 
   3.4776836413324957`*^9}, {3.47770897636248*^9, 3.477709019754875*^9}, {
   3.4777090513603215`*^9, 3.477709058660819*^9}, {3.477709192272944*^9, 
   3.477709260591181*^9}, {3.4777093018104515`*^9, 3.4777093434002542`*^9}, {
   3.4777093778998623`*^9, 3.4777093883949537`*^9}, {3.477709455351232*^9, 
   3.477709468420024*^9}, {3.477709521296056*^9, 3.477709575103427*^9}, {
   3.477709617684656*^9, 3.477709638734925*^9}, {3.4777141643324146`*^9, 
   3.4777141784527187`*^9}, {3.477714245008421*^9, 3.477714259258912*^9}, {
   3.4778154572644978`*^9, 3.4778154652860317`*^9}, {3.477822325560622*^9, 
   3.477822325871069*^9}, {3.477822802776826*^9, 3.47782281480412*^9}, {
   3.477822859047739*^9, 3.4778228606099854`*^9}, 3.4778232065974913`*^9, {
   3.4778232548769135`*^9, 3.4778232573504705`*^9}, {3.477909898253971*^9, 
   3.4779098983641295`*^9}, {3.4779190304854755`*^9, 3.477919031206512*^9}, {
   3.4779260840880575`*^9, 3.4779261123787374`*^9}, {3.4779262236086783`*^9, 
   3.4779262492755857`*^9}, {3.477926289323171*^9, 3.4779262964133663`*^9}, {
   3.4779266274193296`*^9, 3.477926640778539*^9}, {3.4779266727845616`*^9, 
   3.477926679554296*^9}, {3.4779273671429996`*^9, 3.4779274379548225`*^9}, {
   3.4779276118248353`*^9, 3.4779276382227936`*^9}, {3.477928114367456*^9, 
   3.477928115769472*^9}, {3.477928319222022*^9, 3.477928323137653*^9}, {
   3.477951655588069*^9, 3.477951665231936*^9}, {3.4779517618708963`*^9, 
   3.4779517911129436`*^9}, {3.478021857233077*^9, 3.4780218596165037`*^9}, {
   3.4780225366300015`*^9, 3.4780225429390736`*^9}, {3.478312042799429*^9, 
   3.478312071700987*^9}, {3.478312188058301*^9, 3.478312188629122*^9}, {
   3.4783146684949937`*^9, 3.478314673582309*^9}, {3.4783466021933966`*^9, 
   3.4783466207600946`*^9}, {3.4783521113351536`*^9, 3.478352116162094*^9}, {
   3.4783523293987136`*^9, 3.4783523295689583`*^9}, {3.4783523643990417`*^9, 
   3.478352365680885*^9}, {3.478352396375021*^9, 3.4783524169345837`*^9}, {
   3.4783525676513042`*^9, 3.4783525722378993`*^9}, {3.478352634096848*^9, 
   3.4783526501198883`*^9}, {3.4783531869117565`*^9, 
   3.4783531905569983`*^9}, {3.4783538150349536`*^9, 3.478353881109965*^9}, {
   3.478354344055648*^9, 3.478354344886843*^9}, {3.4784644841292963`*^9, 
   3.4784645427035217`*^9}, {3.478464599665429*^9, 3.4784647959176254`*^9}, {
   3.4784664849363155`*^9, 3.4784664981953807`*^9}, {3.4784666756705775`*^9, 
   3.4784666814789295`*^9}, {3.478466864101528*^9, 3.478466881536598*^9}, {
   3.4784809361160913`*^9, 3.4784810019807997`*^9}, {3.478481498294464*^9, 
   3.4784815041629024`*^9}, {3.478576217974675*^9, 3.478576221750104*^9}, 
   3.4785778790932465`*^9, {3.4785787319195504`*^9, 3.478578732440299*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"5", ":", " ", "rhoin"}], ",", " ", "iein", ",", " ", 
    RowBox[{"Byin", "=", "By"}], ",", " ", "Bzin", ",", " ", 
    RowBox[{"Bxin", "=", "0"}], ",", " ", 
    RowBox[{"vxin", "=", "vx"}], ",", " ", 
    RowBox[{"vyin", "=", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"3", ":", " ", "rhoc"}], ",", " ", "iec", ",", " ", 
    RowBox[{"Bxc", "=", 
     RowBox[{"Byc", "=", "0"}]}], ",", " ", "Bzc", ",", " ", 
    RowBox[{"vxc", "=", 
     RowBox[{"vyc", "=", "0"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"5", ":", " ", "rhoout"}], ",", " ", "ieout", ",", " ", 
    RowBox[{"Bxout", "=", "Bx"}], ",", " ", 
    RowBox[{"Byout", "=", "0"}], ",", " ", "Bzout", ",", " ", 
    RowBox[{"vyout", "=", "vy"}], ",", " ", 
    RowBox[{"vxout", "=", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"1", " ", ":", " ", "d"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"14", " ", "total", " ", "variables"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"4", ":", " ", "rhoin"}], ",", " ", "iein", ",", " ", "Byin", ",",
     " ", 
    RowBox[{"Bzin", " ", "considered", " ", "knowns"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"10", " ", 
     RowBox[{"unkonwns", ":", " ", "d"}]}], ",", "vx", ",", "rhoc", ",", 
    "iec", ",", "rhout", ",", "ieout", ",", "Bx", ",", "vy", ",", "Bzc", ",", 
    "Bzout"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"So", " ", "we", " ", "need", " ", "10", " ", "equations"}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Aux", " ", 
     RowBox[{"variables", ":", " ", "Ez"}]}], ",", " ", "Jz", ",", " ", 
    "np"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"UpperRight", " ", "x"}], "-", 
     RowBox[{"y", " ", 
      RowBox[{"quad", ":", " ", 
       RowBox[{"sign", "[", "By", "]"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"sign", "[", "Bx", "]"}], " ", "and", " ", 
      RowBox[{"sign", "[", "vx", "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"sign", "[", "vy", "]"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"UpperLeft", " ", "x"}], "-", 
     RowBox[{"y", " ", 
      RowBox[{"quad", ":", " ", 
       RowBox[{"sign", "[", "By", "]"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sign", "[", "Bx", "]"}]}], " ", "and", " ", 
      RowBox[{"sign", "[", "vx", "]"}]}], "=", 
     RowBox[{"sign", "[", "vy", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"LowerRight", " ", "x"}], "-", 
     RowBox[{"y", " ", 
      RowBox[{"quad", ":", " ", 
       RowBox[{"sign", "[", "By", "]"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sign", "[", "Bx", "]"}]}], " ", "and", " ", 
      RowBox[{"sign", "[", "vx", "]"}]}], "=", 
     RowBox[{"sign", "[", "vy", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"LowerLeft", " ", "x"}], "-", 
     RowBox[{"y", " ", 
      RowBox[{"quad", ":", " ", 
       RowBox[{"sign", "[", "By", "]"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"sign", "[", "Bx", "]"}], " ", "and", " ", 
      RowBox[{"sign", "[", "vx", "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"sign", "[", "vy", "]"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solvespfullsetup1", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", "nonrelsprel"}], "}"}], ",", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"setupsprelinputs", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"nonrelsprel", "\[Equal]", 
         RowBox[{
         "0", " ", "means", " ", "full", " ", "rel", " ", "equations"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"nonrelsprel", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"setupsprelvelocity", "[", "nonrelsprel", "]"}], ";", 
       "\[IndentingNewLine]", "setupsprelb", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "correct", " ", "even", " ", "in", " ", "relativistic", " ", "steady",
          " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"auxvars", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"etap", "\[Rule]", 
           RowBox[{"eta", "*", "4", "*", 
            RowBox[{"Pi", "/", 
             RowBox[{"c", "^", "2"}]}]}]}], ",", 
          RowBox[{"Ez", "\[Rule]", 
           RowBox[{"etap", "*", 
            RowBox[{"Jz", "/", "Afactor"}]}]}], ",", 
          RowBox[{"Jz", "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"c", "/", 
              RowBox[{"(", 
               RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Bx", "/", "L"}], "-", 
              RowBox[{"By", "/", "d"}]}], ")"}]}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"L", ">>", "d"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"auxvars", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"etap", "\[Rule]", 
             RowBox[{"eta", "*", "4", "*", 
              RowBox[{"Pi", "/", 
               RowBox[{"c", "^", "2"}]}]}]}], ",", 
            RowBox[{"Ez", "\[Rule]", 
             RowBox[{"etap", "*", 
              RowBox[{"Jz", "/", "Afactor"}]}]}], ",", 
            RowBox[{"Jz", "->", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"c", "/", 
                RowBox[{"(", 
                 RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "By"}], "/", "d"}], ")"}]}]}]}], "}"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "equations"}], " ", "*)"}], "\[IndentingNewLine]",
        "setupfulleqns", ";"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"simplifyfulleqns", ";"}], "*)"}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4740905924759455`*^9, 3.4740906843780947`*^9}, {
   3.4740910450567245`*^9, 3.4740911078470125`*^9}, {3.474091183115243*^9, 
   3.474091184727562*^9}, {3.474096814312507*^9, 3.474096871494731*^9}, {
   3.474152535537888*^9, 3.4741525421574063`*^9}, 3.4743253476312675`*^9, {
   3.474327271127118*^9, 3.474327293569389*^9}, {3.474327715666334*^9, 
   3.4743277160468817`*^9}, {3.4743283936111712`*^9, 
   3.4743283965954623`*^9}, {3.474344627203931*^9, 3.474344705506525*^9}, {
   3.4743447391749372`*^9, 3.474344739956061*^9}, {3.4743447718218813`*^9, 
   3.4743447720121555`*^9}, {3.4743460711101665`*^9, 
   3.4743461123194227`*^9}, {3.474358144757832*^9, 3.4743581563645215`*^9}, {
   3.4743584877410173`*^9, 3.474358526356544*^9}, {3.4743586122901106`*^9, 
   3.4743586424735117`*^9}, {3.4743605889824543`*^9, 3.474360590995349*^9}, {
   3.474360722093859*^9, 3.474360734601845*^9}, {3.474360766677968*^9, 
   3.4743608062949343`*^9}, {3.474360837980496*^9, 3.4743608606230545`*^9}, {
   3.474372854088811*^9, 3.4743728726655235`*^9}, {3.476911064972165*^9, 
   3.476911168120485*^9}, {3.4769179237172813`*^9, 3.4769179292552447`*^9}, {
   3.4771646746421456`*^9, 3.4771646813517933`*^9}, {3.4774478693549356`*^9, 
   3.4774478700158863`*^9}, {3.4775395662307615`*^9, 3.477539589293925*^9}, {
   3.477541769809352*^9, 3.4775417701898994`*^9}, {3.4775419265647554`*^9, 
   3.477541943308832*^9}, {3.4775561236291313`*^9, 3.477556124460326*^9}, {
   3.4775992047960863`*^9, 3.477599209813301*^9}, {3.477599412815203*^9, 
   3.4775994190341454`*^9}, {3.4777007972014236`*^9, 
   3.4777007979725327`*^9}, {3.477701640183573*^9, 3.477701641665704*^9}, {
   3.4779261167850733`*^9, 3.4779261241456575`*^9}, {3.477927533452141*^9, 
   3.477927546851408*^9}, {3.4783543330297937`*^9, 3.478354423339653*^9}, {
   3.478577848349038*^9, 3.4785778597554398`*^9}, {3.478578733031149*^9, 
   3.4785787336219983`*^9}, {3.478578979415432*^9, 3.4785789881680174`*^9}, {
   3.478579197378848*^9, 3.478579197529064*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", ":", " ", "eq1"}], ",", "eq2", ",", "eq5", ",", 
    RowBox[{"eq7", ":", " ", 
     RowBox[{"eq1", "\[IndentingNewLine]", 
      RowBox[{"ux", ":", " ", 
       RowBox[{"*", "eq1"}]}]}]}], ",", "eq2", ",", 
    RowBox[{"~", "eq3"}], ",", 
    RowBox[{"*", "eq5"}], ",", 
    RowBox[{"*", "eq7"}], ",", 
    RowBox[{"Xeq8", ":", " ", 
     RowBox[{"eq7", "\[IndentingNewLine]", 
      RowBox[{"rhoc", ":", " ", 
       RowBox[{"eq6", ":", " ", 
        RowBox[{"eq6", "\[IndentingNewLine]", 
         RowBox[{"iec", ":", " ", "eq3"}]}]}]}]}]}], ",", "eq4", ",", 
    RowBox[{"eq8", ":", " ", 
     RowBox[{"eq3", "\[IndentingNewLine]", 
      RowBox[{"rhoout", ":", " ", "eq4"}]}]}], ",", "eq5", ",", "eq6", ",", 
    RowBox[{"~", 
     RowBox[{"eq7", ":", " ", 
      RowBox[{"eq5", "\[IndentingNewLine]", 
       RowBox[{"ieout", ":", " ", "eq4"}]}]}]}], ",", 
    RowBox[{"~", "eq7"}], ",", 
    RowBox[{"eq8", ":", " ", 
     RowBox[{"eq8", ":", "\[IndentingNewLine]", 
      RowBox[{"Bx", ":", " ", 
       RowBox[{"~", "eq1"}]}]}]}], ",", 
    RowBox[{"**", "eq2"}], ",", 
    RowBox[{"*", "eq4"}], ",", 
    RowBox[{"Xeq7", " ", ":", " ", 
     RowBox[{"eq2", "\[IndentingNewLine]", 
      RowBox[{"uy", ":", " ", "Xeq2"}]}]}], ",", "eq4", ",", "eq5", ",", 
    RowBox[{"eq7", ":", " ", "eq4"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SPFindRootone", "[", 
      RowBox[{
      "whichvar0_", ",", "whicheq0_", ",", "sols00_", ",", "eqns0_", ",", 
       "constssprel0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", 
         RowBox[{"whichvar", "=", "whichvar0"}], ",", 
         RowBox[{"whicheq", "=", "whicheq0"}], ",", 
         RowBox[{"sols0", "=", "sols00"}], ",", 
         RowBox[{"eqns", "=", "eqns0"}], ",", 
         RowBox[{"constssprel", "=", "constssprel0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myvars", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sols0", "[", 
             RowBox[{"[", 
              RowBox[{"whichvar", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"sols0", "[", 
             RowBox[{"[", 
              RowBox[{"whichvar", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"thevar", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"sols0", "[", 
           RowBox[{"[", 
            RowBox[{"whichvar", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eqnums", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"ii", ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", "numunknowns"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"othereqs", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"eqnums", ",", "whichvar"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"sols0", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "othereqs"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tosolve", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"eqns", "[", 
            RowBox[{"[", "whicheq", "]"}], "]"}], "//.", "constssprel"}], "//.",
           "sol"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"result1", "=", 
           RowBox[{"NSolve", "[", 
            RowBox[{
             RowBox[{"0", "\[Equal]", "tosolve"}], ",", "thevar", ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "400"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result2", "=", 
           RowBox[{"SPFindRootpicksol", "[", 
            RowBox[{"whichvar", ",", "sols0", ",", "result1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "result2"}], "\[IndentingNewLine]", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"DampingFactor", "\[Rule]", ".8"}], ",", 
          RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<SPFindRootone\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result1", "=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{"0", "\[Equal]", "tosolve"}], ",", "myvars", ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "workprec"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "result1"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SPFindRootpicksol", "[", 
      RowBox[{"whichvar0_", ",", "sols00_", ",", "fsols0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f00", ",", 
         RowBox[{"whichvar", "=", "whichvar0"}], ",", 
         RowBox[{"sols0", "=", "sols00"}], ",", 
         RowBox[{"fsols", "=", "fsols0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sols0", "[", 
            RowBox[{"[", 
             RowBox[{"whichvar", ",", "2"}], "]"}], "]"}], ">=", "0"}], ",", 
          RowBox[{
           RowBox[{"resultpick", "=", 
            RowBox[{"SPFindRootpicksolpos", "[", "fsols", "]"}]}], ";"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sols0", "[", 
            RowBox[{"[", 
             RowBox[{"whichvar", ",", "2"}], "]"}], "]"}], "<", "0"}], ",", 
          RowBox[{
           RowBox[{"resultpick", "=", 
            RowBox[{"SPFindRootpicksolneg", "[", "fsols", "]"}]}], ";"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "resultpick"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SPFindRootpicksolneg", "[", "fsols0_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", 
         RowBox[{"fsols", "=", "fsols0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{
            RowBox[{"Dimensions", "[", "fsols", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"whichi", "=", "i"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], "<",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Im", "[", 
                 RowBox[{"fsols", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                "]"}], "<", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "13"}], ")"}]}], "*", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Re", "[", 
                  RowBox[{"fsols", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "]"}]}]}]}], ",", 
             RowBox[{
              RowBox[{"finalsol", "=", 
               RowBox[{"fsols", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "finalsol"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SPFindRootpicksolpos", "[", "fsols0_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", 
         RowBox[{"fsols", "=", "fsols0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{
            RowBox[{"Dimensions", "[", "fsols", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"whichi", "=", "i"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"fsols", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], ">=",
                "0"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Im", "[", 
                 RowBox[{"fsols", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                "]"}], "<", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "13"}], ")"}]}], "*", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Re", "[", 
                  RowBox[{"fsols", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "]"}]}]}]}], ",", 
             RowBox[{
              RowBox[{"finalsol", "=", 
               RowBox[{"fsols", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "finalsol"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SPFindRootonereplacesols", "[", 
      RowBox[{
      "whichvar0_", ",", "whicheq0_", ",", "sols00_", ",", "eqns0_", ",", 
       "constssprel0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", 
         RowBox[{"whichvar", "=", "whichvar0"}], ",", 
         RowBox[{"whicheq", "=", "whicheq0"}], ",", 
         RowBox[{"sols0", "=", "sols00"}], ",", 
         RowBox[{"eqns", "=", "eqns0"}], ",", 
         RowBox[{"constssprel", "=", "constssprel0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"solstouse", "=", "sols0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"resultre", "=", 
         RowBox[{"SPFindRootone", "[", 
          RowBox[{
          "whichvar", ",", "whicheq", ",", "solstouse", ",", "eqns", ",", 
           "constssprel"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"solsnew", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{"solstouse", ",", "whichvar"}], "]"}], ",", 
           RowBox[{"resultre", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "whichvar"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SPFindRootall", "[", 
      RowBox[{"sols00_", ",", "eqns0_", ",", "constssprel0_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", "i", ",", "whichvar", ",", "whicheq", ",", 
         RowBox[{"sols0", "=", "sols00"}], ",", 
         RowBox[{"eqns", "=", "eqns0"}], ",", 
         RowBox[{"constssprel", "=", "constssprel0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"solstouse", "=", "sols0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"numunknowns", " ", "things"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"vareqmap", "=", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "7", ",", "6", ",", "3", ",", "5", ",", "8", ",", "2", 
           ",", "4", ",", "9", ",", "10"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"varorder", "=", 
         RowBox[{"RandomSample", "[", 
          RowBox[{"Range", "[", "numunknowns", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Here\>\"", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "numunknowns"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"whichvar", "=", 
            RowBox[{"varorder", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"whicheq", "=", 
            RowBox[{"vareqmap", "[", 
             RowBox[{"[", "whichvar", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<blob\>\"", ",", "whichvar", ",", "whicheq", ",", "i"}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"solstouse", "=", 
            RowBox[{"SPFindRootonereplacesols", "[", 
             RowBox[{
             "whichvar", ",", "whicheq", ",", "solstouse", ",", "eqns", ",", 
              "constssprel"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", "solstouse"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SPFindRoot", "[", 
      RowBox[{
      "numiter0_", ",", "sols00_", ",", "eqns0_", ",", "constssprel0_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"foo", ",", 
         RowBox[{"numiter", "=", "numiter0"}], ",", 
         RowBox[{"sols0", "=", "sols00"}], ",", 
         RowBox[{"eqns", "=", "eqns0"}], ",", 
         RowBox[{"constssprel", "=", "constssprel0"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"solstouse", "=", "sols0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "numiter"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"solstouse", "=", 
            RowBox[{"SPFindRootall", "[", 
             RowBox[{"solstouse", ",", "eqns", ",", "constssprel"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "solstouse"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setupfulleqns", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"E_z", " ", "dissipation", " ", "at", " ", "center"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "ideal", " ", "MHD", " ", "outside", " ", "each", " ", "face"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"E_z", " ", "constant"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "correct", " ", "even", " ", "in", " ", "relativistic", " ", "case"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eq1", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"eqBunits", "*", 
            RowBox[{"myfun", "[", 
             RowBox[{
              RowBox[{"-", "Ez"}], "-", 
              RowBox[{"vx", "*", 
               RowBox[{"By", "/", "c"}]}]}], "]"}]}], ")"}], "//.", 
          "auxvars"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eq2", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"eqBunits", "*", 
            RowBox[{"myfun", "[", 
             RowBox[{
              RowBox[{"-", "Ez"}], "+", 
              RowBox[{"vy", "*", 
               RowBox[{"Bx", "/", "c"}]}]}], "]"}]}], ")"}], "//.", 
          "auxvars"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"x", "-", 
           RowBox[{
           "momentum", " ", "flux", " ", "dissipates", " ", "completely"}]}], 
          ",", " ", 
          RowBox[{
           RowBox[{"then", " ", "y"}], "-", 
           RowBox[{"momentum", " ", "is", " ", "created"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"C", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "rho", " ", "+", " ", "u", " ", "+", " ", "p", " ", "+", " ", 
              "bsq"}], ")"}], 
            RowBox[{"v", "^", "i"}], " ", 
            RowBox[{"v", "^", "j"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"bsq", "/", "2"}], "+", "pg"}], ")"}], "\\", 
            RowBox[{"delta", "^", "i_j"}]}], " ", "-", " ", 
           RowBox[{
            RowBox[{"b", "^", "i"}], " ", "b_j"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"along", " ", "x"}], "-", 
          RowBox[{"direction", ":"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"C", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "rho", " ", "+", " ", "u", " ", "+", " ", "p", " ", "+", " ", 
              "bsq"}], ")"}], 
            RowBox[{"v", "^", "x"}], " ", 
            RowBox[{"v", "^", "x"}]}], " ", "+", " ", 
           RowBox[{"bsq", "/", "2"}], "+", "p", " ", "-", " ", 
           RowBox[{
            RowBox[{"b", "^", "x"}], " ", "b_x"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"no", " ", "stress"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"C", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "rho", " ", "+", " ", "u", " ", "+", " ", "p", " ", "+", " ", 
              "bsq"}], ")"}], 
            RowBox[{"vx", "^", "2"}]}], " ", "+", " ", 
           RowBox[{"bsq", "/", "2"}], "+", "p"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"from", " ", "in", " ", "to", " ", "c"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq3", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"By", "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"8", "*", "Pi"}], ")"}]}], "+", "pin"}], ")"}], 
            "\[Equal]", "pcent"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"-", "bx"}], "*", 
          RowBox[{"bx", "/", 
           RowBox[{"(", 
            RowBox[{"4", "*", "Pi"}], ")"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eq3", "=", 
         RowBox[{"myfun", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rhoin", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"iein", "+", "pin", "+", 
                 RowBox[{"bsqin", "/", 
                  RowBox[{"(", 
                   RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}], "/", 
               RowBox[{"c", "^", "2"}]}]}], ")"}], "*", 
            RowBox[{"ux", "^", "2"}]}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bsqin", "/", 
              RowBox[{"(", 
               RowBox[{"8", "*", "Pi"}], ")"}]}], "+", "pin"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bsqcent", "/", 
              RowBox[{"(", 
               RowBox[{"8", "*", "Pi"}], ")"}]}], "+", "pcent"}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq3", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"By", "^", "2"}], "/", "2"}], "+", "0"}], ")"}], 
            "\[Equal]", "pcent"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"from", " ", "in", " ", "to", " ", "out"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"bsqin", "/", "2"}], " ", "+", " ", "pin"}], " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "rhoout", " ", "+", " ", "uout", " ", "+", " ", "pout", " ", "+",
               " ", "bsqout"}], ")"}], 
            RowBox[{"vx", "^", "2"}]}], " ", "+", " ", 
           RowBox[{"bsqout", "/", "2"}], "+", "pout"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"By", "^", "2"}], "/", "2"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gam", "-", "1"}], ")"}], "*", "iein"}]}], " ", 
          "\[Equal]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rhoout", " ", "+", " ", 
              RowBox[{"gam", "*", "ieout"}], " ", "+", " ", "0"}], ")"}], 
            RowBox[{"vy", "^", "2"}]}], " ", "+", " ", "0", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"gam", "-", "1"}], ")"}], "ieout"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq4", "=", 
           RowBox[{
            RowBox[{"pcent", " ", "*", "dzsp", "*", "L", "*", "d"}], 
            "\[Equal]", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"rhoout", " ", "+", " ", 
                  RowBox[{"gam", "*", "ieout"}]}], ")"}], "*", 
                RowBox[{"vy", "^", "2"}]}], " ", "+", "pout"}], ")"}], "*", 
             "dzsp", "*", "d"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"non", "-", "rel"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq4", "=", 
           RowBox[{"pcent", "\[Equal]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", "rhoout", ")"}], "*", 
               RowBox[{"vy", "^", "2"}]}], " ", "+", "pout"}], ")"}]}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"-", "bx"}], "*", 
          RowBox[{"bx", "/", 
           RowBox[{"(", 
            RowBox[{"4", "*", "Pi"}], ")"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eq4", "=", 
         RowBox[{"myfun", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"bsqcent", "/", 
                RowBox[{"(", 
                 RowBox[{"8", "*", "Pi"}], ")"}]}], "+", "pcent"}], ")"}], 
             ")"}]}], "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rhoout", " ", "+", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ieout", "+", "pout", "+", 
                 RowBox[{"bsqout", "/", 
                  RowBox[{"(", 
                   RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}], "/", 
               RowBox[{"c", "^", "2"}]}]}], ")"}], "*", 
            RowBox[{"uy", "^", "2"}]}], " ", "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bsqout", "/", 
              RowBox[{"(", 
               RowBox[{"8", "*", "Pi"}], ")"}]}], "+", "pout"}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"rest", " ", "mass", " ", 
          RowBox[{"conservation", ":", " ", 
           RowBox[{"applies", " ", "to", " ", "UpperRight", " ", "quad"}]}]}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"eq5", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"L", "*", "dzsp"}], ")"}]}], ")"}], "*", 
          RowBox[{"myfun", "[", 
           RowBox[{
            RowBox[{"rhoin", "*", "c", "*", 
             RowBox[{"(", 
              RowBox[{"-", "ux"}], ")"}], "*", "L", "*", "dzsp"}], "-", 
            RowBox[{"rhoout", "*", "c", "*", "uy", "*", "d", "*", "dzsp"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"assumption", " ", "by", " ", "Dmitri"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Dmitri", " ", "version"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eq6", "=", 
         RowBox[{
          RowBox[{"c", "^", "2"}], "*", 
          RowBox[{"myfun", "[", 
           RowBox[{"rhoc", "-", 
            RowBox[{"factoreq6", "*", "rhoout"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"jon", " ", "version"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"uth", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"2", "*", 
             RowBox[{"iec", "/", "rhoc"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eq6", "=", 
           RowBox[{"myfun", "[", 
            RowBox[{
             RowBox[{"uth", "*", "rhoc"}], "-", 
             RowBox[{"vy", "*", "rhoout"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"jon", " ", "test"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq6", "=", 
           RowBox[{"rhoc", "\[Equal]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", "rhoout"}]}]}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"energy", " ", "conservation"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "rho"}], " ", "u_t"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rho", "+", "u", "+", "p", "+", "bsq"}], ")"}], 
           RowBox[{"u", "^", "i"}], " ", "u_t"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"b", "^", "i"}], " ", "b_t"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], "*", "rho", "*", 
              RowBox[{"v", "^", "2"}]}], " ", "+", " ", "u", "+", "p", "+", 
             "bsq"}], ")"}], "*", 
           RowBox[{"v", "^", "i"}]}], " ", "-", " ", 
          RowBox[{
           RowBox[{"b", "^", "i"}], " ", "b_t"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"assume", " ", "no", " ", "stress"}], " ", ",", " ", 
          RowBox[{
          "and", " ", "no", " ", "incoming", " ", "inertia", " ", "not", " ", 
           "dominating"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"0", "\\", "sim"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", "rhoin", "*", 
          RowBox[{"vx", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq7", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}], "*", "rhoin", "*", 
                RowBox[{"vx", "^", "2"}]}], "+", "iein", " ", "+", " ", "pin",
                "+", 
               RowBox[{
                RowBox[{"By", "^", "2"}], "/", 
                RowBox[{"(", 
                 RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}], "*", "vx", "  ", 
             "*", " ", "L", " ", "*", " ", "dzsp"}], "\[Equal]", " ", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}], "*", "rhoout", "*", 
                RowBox[{"vy", "^", "2"}]}], "+", "ieout", "+", "pout", "+", 
               RowBox[{
                RowBox[{"Bx", "^", "2"}], "/", 
                RowBox[{"(", 
                 RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}], "*", "vy", " ", 
             "*", " ", "d", " ", "*", " ", "dzsp"}]}]}], ";"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq7", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{"By", "^", "2"}], ")"}], "*", "vx", "  ", "*", " ", "L",
              " ", "*", " ", "dzsp"}], "\[Equal]", " ", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}], "*", "rhoout", "*", 
                RowBox[{"vy", "^", "2"}]}], "+", "pout"}], ")"}], "*", "vy", 
             " ", "*", " ", "d", " ", "*", " ", "dzsp"}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Applies", " ", "to", " ", "UpperRight", " ", "quad"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq7", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"c", "*", "L", "*", "dzsp"}], ")"}]}], ")"}], "*", 
            RowBox[{"myfun", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"rhoin", "*", "gamx", "*", 
                   RowBox[{"(", 
                    RowBox[{"gamx", "-", "1"}], ")"}], "*", 
                   RowBox[{"c", "^", "2"}]}], "+", "iein", " ", "+", " ", 
                  "pin", "+", 
                  RowBox[{"bsqin", "/", 
                   RowBox[{"(", 
                    RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"-", "ux"}], ")"}], "*", "gamx", "  ", "*", " ", "L",
                 " ", "*", " ", "dzsp"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"rhoout", "*", "gamy", "*", 
                   RowBox[{"(", 
                    RowBox[{"gamy", "-", "1"}], ")"}], "*", 
                   RowBox[{"c", "^", "2"}]}], "+", "ieout", "+", "pout", "+", 
                  RowBox[{"bsqout", "/", 
                   RowBox[{"(", 
                    RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}], "*", "uy", 
                "*", "gamy", "*", " ", "d", " ", "*", " ", "dzsp"}], ")"}]}], 
             "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"EdotMAin", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"rhoin", "*", "gamxgamxm1", "*", 
              RowBox[{"c", "^", "2"}]}], "+", "iein", " ", "+", " ", "pin"}], 
            ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"-", "ux"}], ")"}], "*", "gamx", "  ", "*", " ", "L", " ",
            "*", " ", "dzsp"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"EdotEMin", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{"bsqin", "/", 
             RowBox[{"(", 
              RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"-", "ux"}], ")"}], "*", "gamx", "  ", "*", " ", "L", " ",
            "*", " ", "dzsp"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Edotin", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"rhoin", "*", "gamxgamxm1", "*", 
                RowBox[{"c", "^", "2"}]}], "+", "iein", " ", "+", " ", "pin", 
               "+", 
               RowBox[{"bsqin", "/", 
                RowBox[{"(", 
                 RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"-", "ux"}], ")"}], "*", "gamx", "  ", "*", " ", "L", 
             " ", "*", " ", "dzsp"}], ")"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Edotin", "=", 
         RowBox[{"EdotMAin", "+", "EdotEMin"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"EdotMAout", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"rhoout", "*", "gamygamym1", "*", 
              RowBox[{"c", "^", "2"}]}], "+", "ieout", "+", "pout"}], ")"}], 
           "*", "uy", "*", "gamy", "*", " ", "d", " ", "*", " ", "dzsp"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"EdotEMout", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{"bsqout", "/", 
             RowBox[{"(", 
              RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", "uy", "*", 
           "gamy", "*", " ", "d", " ", "*", " ", "dzsp"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Edotout", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"rhoout", "*", "gamygamym1", "*", 
                RowBox[{"c", "^", "2"}]}], "+", "ieout", "+", "pout", "+", 
               RowBox[{"bsqout", "/", 
                RowBox[{"(", 
                 RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}], "*", "uy", "*", 
             "gamy", "*", " ", "d", " ", "*", " ", "dzsp"}], ")"}]}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Edotout", "=", 
         RowBox[{"EdotMAout", "+", "EdotEMout"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"effEM", "=", 
         RowBox[{"1", "-", 
          RowBox[{"EdotEMout", "/", "EdotEMin"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq7", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"c", "*", "L", "*", "dzsp"}], ")"}]}], ")"}], "*", 
          RowBox[{"myfun", "[", 
           RowBox[{"Edotin", "-", "Edotout"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Dmitri", " ", "assumption"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"--", " ", "below"}], " ", "equivalent", " ", "to", " ", 
           "pin"}], "=", "pout"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq8", "=", 
           RowBox[{
            RowBox[{"pcent", "-", "pout"}], "==", 
            RowBox[{"pin", "+", 
             RowBox[{"bsqin", "/", 
              RowBox[{"(", 
               RowBox[{"8", "*", "Pi"}], ")"}]}]}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"other", " ", "choices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq8", "=", 
           RowBox[{
            RowBox[{"pcent", "-", "pout"}], "\[Equal]", "0"}]}], ";", " ", 
          RowBox[{
           RowBox[{"--", " ", "not"}], " ", 
           RowBox[{"allowed", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq8", "=", 
           RowBox[{"pout", "\[Equal]", 
            RowBox[{"pcent", "/", "4.7"}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Dmitri", " ", 
          RowBox[{"assumption", " ", "--"}], " ", "what", " ", "was", " ", 
          "using", " ", "before"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq8", "=", 
           RowBox[{"myfun", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pcent", "-", "pout"}], ")"}], "-", 
             RowBox[{"eff2", "*", 
              RowBox[{"(", 
               RowBox[{"pin", "+", 
                RowBox[{
                 RowBox[{"by", "^", "2"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"8", "*", "Pi"}], ")"}]}]}], ")"}]}]}], "]"}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"eq8", "=", 
           RowBox[{"myfun", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"pcent", "-", "pout"}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{"bsqin", "/", 
               RowBox[{"(", 
                RowBox[{"8", "*", "Pi"}], ")"}]}], ")"}]}], "]"}]}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Jon", " ", "simplification", " ", "with", " ", "detachment", " ", 
          "from", " ", "inflow", " ", "field"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eq8", "=", 
         RowBox[{"myfun", "[", 
          RowBox[{"pout", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "eff2"}], ")"}], "*", "pcent"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"for", " ", "guide", " ", "field"}], ",", " ", 
          RowBox[{
          "2", " ", "extra", " ", "equations", " ", "to", " ", "determine", 
           " ", "Bzc", " ", "and", " ", "Bzout"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"eq9", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"eqBunits", "/", 
            RowBox[{"(", 
             RowBox[{"c", "*", "L"}], ")"}]}], ")"}], "*", 
          RowBox[{"myfun", "[", 
           RowBox[{
            RowBox[{"L", "*", "vx", "*", "Bzin"}], "-", 
            RowBox[{"d", "*", "vy", "*", "Bzout"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq10", "=", 
         RowBox[{
          RowBox[{"(", "eqBunits", ")"}], "*", 
          RowBox[{"myfun", "[", 
           RowBox[{"bzcent", "-", "bzout"}], "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simplifyfulleqns", ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eq1", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"eq1", "*", "L", "*", "d", "*", "gamx"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq2", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"eq2", "*", "L", "*", "d", "*", "gamy"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq3", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"eq3", "*", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"ux", "^", "2"}]}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq4", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"eq4", "*", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"uy", "^", "2"}]}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq5", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"eq5", "*", "dzsp", "*", "L"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq6", "=", 
         RowBox[{"FullSimplify", "[", "eq6", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq7", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"eq7", "*", 
           RowBox[{"(", 
            RowBox[{"4", " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["ux", "2"]}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"4", " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["uy", "2"]}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["ux", "2"], "+", 
             SqrtBox[
              RowBox[{"1", "+", 
               SuperscriptBox["ux", "2"]}]]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["uy", "2"], "+", 
             SqrtBox[
              RowBox[{"1", "+", 
               SuperscriptBox["uy", "2"]}]]}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq8", "=", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"eq8", "*", 
           RowBox[{"(", 
            RowBox[{"8", "*", "Pi", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"ux", "^", "2"}]}], ")"}]}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq9", "=", 
         RowBox[{"FullSimplify", "[", "eq9", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eq10", "=", 
         RowBox[{"FullSimplify", "[", "eq10", "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4775992124571023`*^9, 3.477599220158176*^9}, {
   3.4775994337252703`*^9, 3.4775994564679728`*^9}, {3.4776723777462544`*^9, 
   3.4776724024517794`*^9}, {3.4776725303857393`*^9, 
   3.4776725533687873`*^9}, {3.47767258744779*^9, 3.477672682734806*^9}, {
   3.4776727676368895`*^9, 3.4776727798845005`*^9}, {3.4776728382384095`*^9, 
   3.477672857856619*^9}, {3.47767291566975*^9, 3.477672925724208*^9}, {
   3.477672970728922*^9, 3.4776729998207536`*^9}, {3.4776731133139486`*^9, 
   3.477673175653589*^9}, {3.4776732377829266`*^9, 3.477673277660267*^9}, {
   3.4776733462989645`*^9, 3.4776733463890944`*^9}, {3.477673404763032*^9, 
   3.47767354516492*^9}, {3.477673575979229*^9, 3.4776737543557215`*^9}, {
   3.4776738700420704`*^9, 3.4776739226977854`*^9}, {3.4776739978258142`*^9, 
   3.477674039425632*^9}, {3.4776741281732445`*^9, 3.4776742288379936`*^9}, {
   3.4776743307745714`*^9, 3.4776743380249968`*^9}, {3.4776744050513763`*^9, 
   3.4776744490246067`*^9}, {3.47767448401492*^9, 3.4776744920564833`*^9}, {
   3.477674572622331*^9, 3.4776745789914894`*^9}, {3.47767465667319*^9, 
   3.477674747583914*^9}, {3.4776748003798304`*^9, 3.477675005584901*^9}, {
   3.477675065781459*^9, 3.4776751417206545`*^9}, {3.4776752044608707`*^9, 
   3.4776754104670925`*^9}, {3.4776754811988*^9, 3.4776754890000176`*^9}, {
   3.477675585148272*^9, 3.4776755913872433`*^9}, {3.4776757083554354`*^9, 
   3.477675708886198*^9}, {3.4776757691428432`*^9, 3.477675801709672*^9}, {
   3.4776758665428977`*^9, 3.4776758666630707`*^9}, {3.4776760216459246`*^9, 
   3.4776760611627474`*^9}, {3.4776763268347645`*^9, 3.477676643570208*^9}, {
   3.477676735472357*^9, 3.4776767371447616`*^9}, {3.4776767872468047`*^9, 
   3.4776767903913264`*^9}, {3.477676844899706*^9, 3.4776768465020094`*^9}, {
   3.477676933817563*^9, 3.4776769401366496`*^9}, {3.477677011298976*^9, 
   3.477677011429163*^9}, {3.477677129559026*^9, 3.4776771326434608`*^9}, 
   3.4776773885714674`*^9, {3.477677460244528*^9, 3.4776775287530384`*^9}, {
   3.477677698907709*^9, 3.477677805991688*^9}, {3.4776787673140016`*^9, 
   3.4776788125490465`*^9}, {3.4776791122399807`*^9, 3.4776791172972527`*^9}, 
   3.4776791673091664`*^9, {3.4776792308004627`*^9, 3.4776793733554463`*^9}, {
   3.4776794331414146`*^9, 3.477679436366051*^9}, {3.47767949906621*^9, 
   3.4776794993365984`*^9}, {3.4776795568292685`*^9, 
   3.4776796079627953`*^9}, {3.4776798124969006`*^9, 3.477679841428502*^9}, {
   3.4776801367531586`*^9, 3.477680142631611*^9}, {3.47768018771644*^9, 
   3.477680201416139*^9}, {3.477680274641432*^9, 3.4776803045043726`*^9}, {
   3.477680390107464*^9, 3.4776803903377953`*^9}, {3.477680477453061*^9, 
   3.4776805018581533`*^9}, {3.4777007626617584`*^9, 
   3.4777007848736973`*^9}, {3.4777008911164675`*^9, 3.477700904876253*^9}, {
   3.477909822625222*^9, 3.477909822715352*^9}, {3.4779099120538144`*^9, 
   3.477909915739114*^9}, {3.477910326449686*^9, 3.4779103437245264`*^9}, {
   3.4779190093050194`*^9, 3.47791900987584*^9}, {3.4780218726051807`*^9, 
   3.478021874668147*^9}, {3.478346837501754*^9, 3.4783468651214685`*^9}, {
   3.4783511741375294`*^9, 3.478351215837491*^9}, {3.4783512962731524`*^9, 
   3.478351299557875*^9}, {3.4783518073480415`*^9, 3.478351831292472*^9}, {
   3.4783518682456083`*^9, 3.4783518907379503`*^9}, {3.478352680293275*^9, 
   3.478352681064384*^9}, {3.478353237935125*^9, 3.478353278593589*^9}, {
   3.4783533129529953`*^9, 3.4783533576973343`*^9}, {3.478353455477936*^9, 
   3.4783534586725297`*^9}, {3.4783535037373295`*^9, 3.478353511458432*^9}, {
   3.4783535583358383`*^9, 3.478353589510666*^9}, {3.4783540104659696`*^9, 
   3.4783540199195633`*^9}, {3.4783547420078754`*^9, 3.478354747866299*^9}, {
   3.4783574181459727`*^9, 3.478357459124898*^9}, {3.478463590294024*^9, 
   3.478463600158208*^9}, {3.4784638328227634`*^9, 3.478463843778517*^9}, {
   3.4784639312242575`*^9, 3.4784639497909555`*^9}, {3.4784656138437457`*^9, 
   3.478465621304474*^9}, {3.478465669944414*^9, 3.4784656731189795`*^9}, {
   3.478466074956794*^9, 3.478466080054123*^9}, {3.4784700887483425`*^9, 
   3.478470104240619*^9}, {3.4784804421958685`*^9, 3.478480489023203*^9}, {
   3.4784805673157825`*^9, 3.478480660359573*^9}, {3.478480860226968*^9, 
   3.478480879654904*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solvespfullsetup2", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "if", " ", "setup", " ", "magnetically"}], "-", 
       "dominated"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"By", "^", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"8", "*", "Pi"}], ")"}]}], "-", 
         RowBox[{"(", "pin", ")"}]}], ")"}], "//.", "constssprel"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Original", " ", "SP", " ", 
         RowBox[{"solution", ":", " ", 
          RowBox[{"Used", " ", "as", " ", "initial", " ", "guess"}]}]}], ",", 
        " ", 
        RowBox[{
        "since", " ", "otherwise", " ", "can", " ", "miss", " ", "finding", 
         " ", "solution", " ", "for", " ", "some", " ", "inflow", " ", 
         "values", " ", "for", " ", "no", " ", "good", " ", "reason"}]}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"original", " ", "SP", " ", 
         RowBox[{"delta", ":", " ", "delta"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eta", " ", 
           RowBox[{"L", "/", "va"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"vaold", "=", 
       RowBox[{
        RowBox[{"c", "*", 
         RowBox[{"By", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "*", "4", "*", "Pi", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rhoin", "*", 
               RowBox[{"c", "^", "2"}]}], "+", "iein", "+", "pin", "+", 
              RowBox[{
               RowBox[{"By", "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}]}], "]"}]}]}], "//.",
         "constssprel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"olddelta", "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"eta", "*", 
          RowBox[{"L", "/", "vaold"}]}], "]"}], "//.", "constssprel"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Slund", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "*", "L", "*", 
          RowBox[{"vaold", "/", "eta"}]}], "//.", "constssprel"}], "//.", 
        RowBox[{"{", 
         RowBox[{"ux", "\[Rule]", "0"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Slund=\>\"", ",", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"Slund", ",", "10"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigma", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "*", 
          RowBox[{
           RowBox[{
            RowBox[{"By", "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"8", "*", "Pi"}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"rhoin", "*", 
             RowBox[{"c", "^", "2"}]}], ")"}]}]}], "//.", "constssprel"}], "//.", 
        RowBox[{"{", 
         RowBox[{"ux", "\[Rule]", "0"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<sigma=\>\"", ",", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"sigma", ",", "10"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"UpperRight", " ", "quad"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"vxold", "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"vaold", "*", 
          RowBox[{"Slund", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rhoold", "=", 
       RowBox[{"rhoin", "//.", "constssprel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ieold", "=", 
       RowBox[{"iein", "//.", "constssprel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"UpperRight", " ", "quad"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"guess", " ", "on", " ", "Ez"}], "=", "constant"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Bxold", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "By"}], "*", 
         RowBox[{"vxold", "/", "vaold"}]}], "//.", "constssprel"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"olddelta", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"eta", "*", 
           RowBox[{"L", "/", "vaold"}]}], "]"}], "//.", "constssprel"}], "//.", 
        RowBox[{"{", 
         RowBox[{"ux", "\[Rule]", "0"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vextreme", "=", 
       RowBox[{"1", "-", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "5"}], ")"}]}]}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.474348346261674*^9, 3.4743484198875427`*^9}, {
   3.47435974525924*^9, 3.474359748463848*^9}, {3.4769111716956253`*^9, 
   3.4769111964512224`*^9}, {3.4769116163450003`*^9, 3.476911627410912*^9}, {
   3.476911954641446*^9, 3.4769119548918066`*^9}, {3.477167911186067*^9, 
   3.477167926878632*^9}, {3.477169338798874*^9, 3.4771693652669325`*^9}, {
   3.477178143369224*^9, 3.477178148005891*^9}, 3.477433580478541*^9, {
   3.4777111568078065`*^9, 3.4777111570080943`*^9}, {3.477721467343629*^9, 
   3.4777214702678337`*^9}, {3.4783577830106225`*^9, 
   3.4783577858747406`*^9}, {3.478357916412445*^9, 3.4783579507918797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solvespfull", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "foo", ",", "errorroot", ",", "errormessage", ",", "rootmyprec", ",", 
       "varmyprec"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eqnsfull", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{
         "eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5", ",", "eq6", 
          ",", "eq7", ",", "eq8", ",", "eq9", ",", "eq10"}], "}"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"eqns0", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"eq1", "\[Equal]", "0"}], ",", 
         RowBox[{"eq2", "\[Equal]", "0"}], ",", 
         RowBox[{"eq3", "\[Equal]", "0"}], ",", 
         RowBox[{"eq4", "\[Equal]", "0"}], ",", 
         RowBox[{"eq5", "\[Equal]", "0"}], ",", 
         RowBox[{"eq6", "\[Equal]", "0"}], ",", 
         RowBox[{"eq7", "\[Equal]", "0"}], ",", 
         RowBox[{"eq8", "\[Equal]", "0"}], ",", 
         RowBox[{"eq9", "\[Equal]", "0"}], ",", 
         RowBox[{"eq10", "\[Equal]", "0"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"myeqns0", "=", "eqns0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nummyeqns0", "=", 
       RowBox[{"myeqns0", "//.", "constssprel"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numeffEM", "=", 
       RowBox[{"effEM", "//.", "constssprel"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"fsols", ";", 
        RowBox[{"=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"nummyeqns0", ",", "myvars", ",", 
           RowBox[{"MaxIterations", "\[Rule]", "10000"}], ",", 
           RowBox[{"DampingFactor", "\[Rule]", "0.5"}]}], "]"}]}]}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"was", " ", "good"}], " ", "*)"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"fsols", "=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"nummyeqns0", ",", "myvars", ",", 
           RowBox[{"MaxIterations", "\[Rule]", "10000"}], ",", 
           RowBox[{"DampingFactor", "\[Rule]", "0.5"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "50"}], ",", 
           RowBox[{"AccuracyGoal", "\[Rule]", "14"}], ",", 
           RowBox[{"PrecisionGoal", "\[Rule]", "14"}]}], "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"normalsolve", "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<FindRoot0\>\"", "]"}], ";", 
           RowBox[{"fsolsspotherunits", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{"nummyeqns0", ",", "myvars"}], "]"}]}], ";"}]}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "if", " ", "takes", " ", "more", " ", "than", " ", "2000", " ", 
         "iterations"}], ",", " ", 
        RowBox[{
        "probably", " ", "going", " ", "to", " ", "fail", " ", "to", " ", 
         "converge"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<FindRoot1\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"errorroot", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"fsolsspotherunits", "=", 
           RowBox[{"FindRoot", "[", 
            RowBox[{"nummyeqns0", ",", "myvars", ",", 
             RowBox[{"MaxIterations", "\[Rule]", "maxiter"}], ",", 
             RowBox[{"DampingFactor", "\[Rule]", "0.8"}], ",", 
             RowBox[{"WorkingPrecision", "\[Rule]", "workprec"}], ",", 
             RowBox[{"AccuracyGoal", "\[Rule]", "whichaccuracy"}], ",", 
             RowBox[{"PrecisionGoal", "\[Rule]", "whichprecision"}]}], 
            "]"}]}], ",", 
          RowBox[{"errorroot", "=", "1"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rootmyprec", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{"nummyeqns0", ",", "workprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"varmyprec", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{"myvars", ",", "workprec"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"fsolsspotherunits", "=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"rootmyprec", ",", "varmyprec", ",", 
           RowBox[{"MaxIterations", "\[Rule]", "maxiter"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "workprec"}], ",", 
           RowBox[{"AccuracyGoal", "\[Rule]", "whichaccuracy"}], ",", 
           RowBox[{"PrecisionGoal", "\[Rule]", "whichprecision"}]}], "]"}]}], 
        ",", 
        RowBox[{"errorroot", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"numeffEMrel", "=", 
       RowBox[{"numeffEM", "//.", "fsolsspotherunits"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<FindRoot2\>\"", "]"}], ";", 
        RowBox[{"fsolsspotherunits", "=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"nummyeqns0", ",", "myvars", ",", 
           RowBox[{"MaxIterations", "\[Rule]", "100000"}], ",", 
           RowBox[{"DampingFactor", "\[Rule]", "0.001"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "800"}], ",", 
           RowBox[{"AccuracyGoal", "\[Rule]", "whichaccuracy"}], ",", 
           RowBox[{"PrecisionGoal", "\[Rule]", "whichprecision"}]}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"stupid", " ", "mathematica", " ", 
         RowBox[{"doesn", "''"}], "t", " ", "give", " ", "message", " ", 
         "till", " ", "after", " ", 
         RowBox[{"If", "[", "]"}], " ", "apparently"}], ",", " ", 
        RowBox[{"so", " ", 
         RowBox[{"can", "'"}], "t", " ", "put", " ", "the", " ", "below", " ",
          "check", " ", "inside", " ", 
         RowBox[{"If", " ", "--"}], " ", "so", " ", 
         RowBox[{"FindRoot", "[", "]"}], " ", "should", " ", "be", " ", 
         "last", " ", "command", " ", "or", " ", "remove", " ", 
         RowBox[{"If", "[", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"default", " ", "no", " ", "error"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"errorroot", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"errormessage", "==", 
           RowBox[{"{", 
            TagBox[
             RowBox[{"FindRoot", "::", "\"\<cvmit\>\""}],
             HoldForm], "}"}]}], ",", 
          RowBox[{
           RowBox[{"errorroot", "=", "1"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"errormessage", "\[Equal]", 
           RowBox[{"{", 
            RowBox[{"FindRoot", "::", "\"\<lstol\>\""}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"errorroot", "=", "2"}], ";"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"fsolsspotherunits", "=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"nummyeqns0", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"d", ",", "olddelta"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"vx", ",", "vxold"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"rhoc", ",", "rhoold"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"iec", ",", "ieold"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"rhoout", ",", "rhoold"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ieout", ",", "ieold"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Bx", ",", "Bxold"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"vy", ",", "vaold"}], "}"}]}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "20"}], ",", 
           RowBox[{"MaxIterations", "\[Rule]", "1000"}]}], "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{" ", 
         RowBox[{
          RowBox[{"MaxIterations", "\[Rule]", "10000"}], ",", 
          RowBox[{"WorkingPrecision", "\[Rule]", "50"}]}], "]"}], ";"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"computefullerror", ";", " ", 
        RowBox[{"errorsolve0", "=", 
         RowBox[{"Abs", "[", "normalizederror1", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"errorsolve0", ">", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "4"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"fsolsspotherunits", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{"nummyeqns0", ",", "myvars", ",", 
              RowBox[{"MaxIterations", "\[Rule]", "100000"}], ",", 
              RowBox[{"DampingFactor", "\[Rule]", "0.8"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "100"}], ",", 
              RowBox[{"AccuracyGoal", "\[Rule]", "whichaccuracy"}], ",", 
              RowBox[{"PrecisionGoal", "\[Rule]", "whichprecision"}]}], 
             "]"}]}], ";", "computefullerror", ";"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"return", " ", "error", " ", "value"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Full Errorroot=\>\"", ",", "errorroot"}], "]"}], ";", 
      "\[IndentingNewLine]", "errorroot"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4743277664393425`*^9, 3.474327862467424*^9}, {
   3.474328430374034*^9, 3.4743285394809217`*^9}, 3.4743285895228786`*^9, {
   3.474331776916125*^9, 3.474331789464168*^9}, {3.476911202930539*^9, 
   3.4769112068061123`*^9}, {3.4769114535308847`*^9, 
   3.4769114548627996`*^9}, {3.4769115105829215`*^9, 3.476911513877659*^9}, {
   3.4769120001368656`*^9, 3.4769120806726704`*^9}, {3.4770947976501503`*^9, 
   3.47709481535561*^9}, {3.477178148646813*^9, 3.4771781508299522`*^9}, {
   3.4774307094602194`*^9, 3.4774307098507805`*^9}, {3.4775311957946653`*^9, 
   3.4775311986487694`*^9}, {3.4775332992292557`*^9, 
   3.4775332992793283`*^9}, {3.477555017829069*^9, 3.477555054191355*^9}, {
   3.477556143858219*^9, 3.477556157547904*^9}, {3.477556834441229*^9, 
   3.477556844415571*^9}, {3.477588313745525*^9, 3.4775883436184797`*^9}, {
   3.477590986899331*^9, 3.477590987800627*^9}, {3.4775923593327937`*^9, 
   3.477592383507555*^9}, {3.47759242173252*^9, 3.4775924585754976`*^9}, {
   3.4775924913526287`*^9, 3.477592531009653*^9}, {3.4775932230948224`*^9, 
   3.4775932500335584`*^9}, {3.4775984741154194`*^9, 
   3.4775984756776657`*^9}, {3.4776122903922496`*^9, 3.477612327705904*^9}, {
   3.477612415512163*^9, 3.4776124178955903`*^9}, {3.477623049042429*^9, 
   3.4776230707135906`*^9}, {3.4776236250607023`*^9, 
   3.4776236516188912`*^9}, {3.4776237677959456`*^9, 
   3.4776237683767805`*^9}, {3.4776238618912477`*^9, 
   3.4776238643347616`*^9}, {3.4776247290081005`*^9, 
   3.4776247384917374`*^9}, {3.4776249241086416`*^9, 
   3.4776249265120974`*^9}, {3.4776256123382673`*^9, 3.477625702287608*^9}, {
   3.4776257389803696`*^9, 3.4776257401820974`*^9}, {3.4777099956080832`*^9, 
   3.4777100010258737`*^9}, {3.4777109938034177`*^9, 3.477710997438645*^9}, {
   3.4778256353698945`*^9, 3.4778256384142723`*^9}, {3.477828158197542*^9, 
   3.4778281602605085`*^9}, {3.4778470895795326`*^9, 3.477847096960146*^9}, {
   3.477847578492555*^9, 3.4778475957974386`*^9}, {3.4778535178128786`*^9, 
   3.477853517892994*^9}, {3.477908520803294*^9, 3.4779085254399614`*^9}, {
   3.477908601078725*^9, 3.477908601138811*^9}, {3.4779103605787616`*^9, 
   3.477910381869376*^9}, {3.4779127581462946`*^9, 3.4779128026302595`*^9}, {
   3.477913000775178*^9, 3.477913074310917*^9}, {3.4779131223499937`*^9, 
   3.4779131531542883`*^9}, {3.477915269397296*^9, 3.47791527024852*^9}, {
   3.4779162428570623`*^9, 3.4779162959634256`*^9}, {3.477916589575619*^9, 
   3.4779166443844304`*^9}, {3.477916714274928*^9, 3.477916790664771*^9}, {
   3.477916928052325*^9, 3.477916931567379*^9}, {3.4779171479485197`*^9, 
   3.4779171738657875`*^9}, {3.4779176501406364`*^9, 3.477917681405594*^9}, {
   3.4779190019344206`*^9, 3.477919002034565*^9}, {3.477922327225955*^9, 
   3.477922350108859*^9}, {3.4779225232177773`*^9, 3.4779225356055903`*^9}, {
   3.477922754720662*^9, 3.477922770062723*^9}, {3.4779228011374063`*^9, 
   3.4779228012375507`*^9}, {3.477922916092704*^9, 3.4779229337581053`*^9}, {
   3.477923066078373*^9, 3.4779230735391006`*^9}, {3.478021881007262*^9, 
   3.478021883170373*^9}, {3.478023997390472*^9, 3.4780239987223873`*^9}, {
   3.478027792787986*^9, 3.478027795852392*^9}, {3.4780279102068253`*^9, 
   3.478027925508829*^9}, {3.4780292826102448`*^9, 3.47802933952208*^9}, {
   3.4783540315562963`*^9, 3.4783540415306387`*^9}, {3.478466791156638*^9, 
   3.478466791677387*^9}, {3.478481026195619*^9, 3.478481088004496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"computefullerror", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "foo", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"fsolsspotherunits", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "numunknowns"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"resultfull", "=", 
       RowBox[{
        RowBox[{"eqnsfull", "//.", "constssprel"}], "//.", 
        "fsolsspotherunits"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"error", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"resultfull", ".", "resultfull"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"normalizederror", "=", 
         RowBox[{"(", 
          RowBox[{"error", "/", "eqieunits"}], ")"}]}], ";", " ", "NO"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"normalizederror1", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"error", "/", 
           RowBox[{"(", 
            RowBox[{"iec", "//.", "fsolsspotherunits"}], ")"}]}], ")"}], "//.",
          "constssprel"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"normalizederror2", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"error", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rhoc", "*", 
              RowBox[{"c", "^", "2"}]}], "//.", "fsolsspotherunits"}], 
            ")"}]}], ")"}], "//.", "constssprel"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"compare", " ", "simple", " ", "and", " ", "real"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"diffvector", "=", 
       RowBox[{"vector", "-", "simplevector"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diffvectorratio", "=", 
       RowBox[{"diffvector", "/", 
        RowBox[{"(", 
         RowBox[{"simplevector", "+", "vector"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deltaspfinalotherunits", "=", 
       RowBox[{"fsolsspotherunits", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vanewish", "=", 
       RowBox[{
        RowBox[{"c", "*", 
         RowBox[{"By", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "*", "4", "*", "Pi", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rhoout", "*", 
               RowBox[{"c", "^", "2"}]}], "+", "iein", "+", "pin", "+", 
              RowBox[{
               RowBox[{"By", "^", "2"}], "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}]}], "]"}]}]}], "//.",
         "constssprel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"olddeltanewish", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"eta", "*", 
           RowBox[{"L", "/", "vanewish"}]}], "]"}], "//.", "constssprel"}], "//.",
         "fsolsspotherunits"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.477625618667368*^9, 3.4776256255372467`*^9}, {
  3.4783544576790304`*^9, 3.4783544598321266`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setSsigmava", "[", 
    RowBox[{
    "rho0_", ",", "b0_", ",", "ug0_", ",", "pg0_", ",", "l0_", ",", "eta0_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", ",", 
       RowBox[{"rho", "=", "rho0"}], ",", 
       RowBox[{"b", "=", "b0"}], ",", 
       RowBox[{"ug", "=", "ug0"}], ",", 
       RowBox[{"pg", "=", "pg0"}], ",", 
       RowBox[{"l", "=", "l0"}], ",", 
       RowBox[{"eta", "=", "eta0"}], ",", "mysigma", ",", "myva", ",", 
       "myS"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"bgauss", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"8", "*", "Pi", "*", "mysigma", "*", "rhobvalue", "*", 
          RowBox[{"c", "^", "2"}]}], "]"}]}], ";"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mysigma", "=", 
       RowBox[{
        RowBox[{"b", "^", "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"8", "*", "Pi", "*", "rho", "*", 
          RowBox[{"c", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myva", "=", 
       RowBox[{"c", "*", 
        RowBox[{"b", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "*", "4", "*", "Pi", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rho", "*", 
              RowBox[{"c", "^", "2"}]}], "+", "ug", "+", "pg", "+", 
             RowBox[{
              RowBox[{"b", "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"4", "*", "Pi"}], ")"}]}]}], ")"}]}], "]"}]}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"myS", "=", 
       RowBox[{"l", "*", 
        RowBox[{"myva", "/", "eta"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"return", " ", "value"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"mysigma", ",", "myva", ",", "myS"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478331931177512*^9, 3.4783320623761663`*^9}, {
  3.4783577934656563`*^9, 3.4783577984327984`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"based", " ", "upon", " ", 
    RowBox[{"spreconfitrats", ".", "nb"}], " ", "and", " ", "SM", " ", 
    "plots", " ", "using", " ", 
    RowBox[{"reconnection_norad", ".", "m"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"convertotherrel2rel", "[", 
     RowBox[{"nonrelsprel0_", ",", "which0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", 
        RowBox[{"nonrelsprel", "=", "nonrelsprel0"}], ",", 
        RowBox[{"which", "=", "which0"}], ",", "mysigma", ",", "myva", ",", 
        "myS", ",", "conditiontomodify1", ",", "conditiontomodify2", ",", 
        "conditiontomodify3", ",", "conditiontomodify4", ",", 
        "conditiontomodify5", ",", "cuti", ",", "fun", ",", "dratconsts", ",",
         "uxratconsts", ",", "rhocratconsts", ",", "iecratconsts", ",", 
        "rhooutratconsts", ",", "ieoutratconsts", ",", "Bxratconsts", ",", 
        "uyratconsts", ",", "Bzcratconsts", ",", "Bzoutratconsts", ",", "a1", 
        ",", "b1", ",", "a2", ",", "b2", ",", "f3", ",", "e3", ",", "d3", ",",
         "c3", ",", "a3", ",", "b3", ",", "npow", ",", "signtouse", ",", 
        "allconsts"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "rhobvalue", ",", "\"\< \>\"", ",", "bgauss", ",", "\"\< \>\"", ",", 
          "UginfixedT", ",", "\"\< \>\"", ",", "PginfixedT", ",", "\"\< \>\"",
           ",", "Lpnum", ",", "\"\< \>\"", ",", "etatotal"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mysigma", ",", "myva", ",", "myS"}], "}"}], "=", 
        RowBox[{"setSsigmava", "[", 
         RowBox[{
         "rhobvalue", ",", "bgauss", ",", "UginfixedT", ",", "PginfixedT", 
          ",", "Lpnum", ",", "etatotal"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"conditiontomodify1", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"150", "*", "mysigma"}], ">", 
           RowBox[{"myS", "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "4"}], ")"}]}]}], ",", "1", ",", "0"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"conditiontomodify2", "=", 
          RowBox[{
           RowBox[{"10", "*", "mysigma"}], "-", 
           RowBox[{"myS", "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"conditiontomodify2", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"8", "*", "mysigma"}], ">", 
           RowBox[{"myS", "^", 
            RowBox[{"(", 
             RowBox[{"3", "/", "5"}], ")"}]}]}], ",", "1", ",", "0"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"conditiontomodify3", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"0.5", "*", "mysigma"}], ">", 
            RowBox[{"myS", "^", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]}]}], " ", "&&", " ", 
           RowBox[{"mysigma", "<", "0.001"}]}], ",", "1", ",", "0"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"conditiontomodify4", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"10", "^", "4"}], "*", "mysigma"}], "<", 
            RowBox[{"myS", "^", 
             RowBox[{"(", 
              RowBox[{"4", "/", "5"}], ")"}]}]}], " ", "&&", " ", 
           RowBox[{"mysigma", "\[GreaterEqual]", "0.5"}]}], ",", "1", ",", 
          "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"conditiontomodify5", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"0.5", "*", "mysigma"}], ">", 
            RowBox[{"myS", "^", 
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}]}]}], " ", "&&", "  ", 
           RowBox[{"mysigma", ">=", "0.001"}], " ", "&&", " ", 
           RowBox[{"mysigma", "<", "10"}]}], ",", "1", ",", "0"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"rats", " ", 
          RowBox[{"for", ":", " ", "1"}]}], "=", 
         RowBox[{
          RowBox[{"d", " ", "2"}], "=", 
          RowBox[{
           RowBox[{"ux", " ", "3"}], "=", 
           RowBox[{
            RowBox[{"rhoc", " ", "4"}], "=", 
            RowBox[{
             RowBox[{"iec", " ", "5"}], "=", 
             RowBox[{
              RowBox[{"rhoout", " ", "6"}], "=", 
              RowBox[{
               RowBox[{"ieout", " ", "7"}], "=", 
               RowBox[{
                RowBox[{"Bx", " ", "8"}], "=", 
                RowBox[{
                 RowBox[{"uy", " ", "9"}], "=", 
                 RowBox[{
                  RowBox[{"Bzc", " ", "10"}], "=", 
                  "Bzout"}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "default", " ", "is", " ", "no", " ", "cut", " ", "or", " ", 
         "modification"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cuti", "=", 
        RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fun", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nonrelsprel", "\[Equal]", "1"}], " ", "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"conditiontomodify2", "<=", "0"}], "&&", 
            RowBox[{"conditiontomodify1", ">", "0"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"CUT", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"signtouse", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cuti", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.04786021708046376"}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.43477355192455974"}]}], ",", 
             RowBox[{"a2", "\[Rule]", "0.9992035139365585"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.1258579448348711"}]}], ",", 
             RowBox[{"f3", "\[Rule]", "1."}], ",", 
             RowBox[{"e3", "\[Rule]", "1."}], ",", 
             RowBox[{"d3", "\[Rule]", "1."}], ",", 
             RowBox[{"c3", "\[Rule]", "1."}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.0001352757261747089"}]}], ",", 
             RowBox[{"b3", "\[Rule]", "1."}], ",", 
             RowBox[{"npow", "\[Rule]", "1."}]}], "}"}]}], ";", 
          RowBox[{"uxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.13111103399207727"}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.33863473165404434"}]}], ",", 
             RowBox[{"a2", "\[Rule]", "0.9995749855188978"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.12701964662835039"}]}], ",", 
             RowBox[{"f3", "\[Rule]", "1."}], ",", 
             RowBox[{"e3", "\[Rule]", "1."}], ",", 
             RowBox[{"d3", "\[Rule]", "1."}], ",", 
             RowBox[{"c3", "\[Rule]", "1."}], ",", 
             RowBox[{"a3", "\[Rule]", "0.0000364445243039451"}], ",", 
             RowBox[{"b3", "\[Rule]", "1."}], ",", 
             RowBox[{"npow", "\[Rule]", "1."}]}], "}"}]}], ";", 
          RowBox[{"rhocratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.3478973290172718"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.3000649958225696"}], ",", 
             RowBox[{"a2", "\[Rule]", "1.000359978989461"}], ",", 
             RowBox[{"b2", "\[Rule]", "0.4814920337896888"}], ",", 
             RowBox[{"f3", "\[Rule]", "1."}], ",", 
             RowBox[{"e3", "\[Rule]", "1."}], ",", 
             RowBox[{"d3", "\[Rule]", "1."}], ",", 
             RowBox[{"c3", "\[Rule]", "1."}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.000029218334036272235"}]}], ",", 
             RowBox[{"b3", "\[Rule]", "1."}], ",", 
             RowBox[{"npow", "\[Rule]", "1."}]}], "}"}]}], ";", 
          RowBox[{"iecratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.4774086634607869"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.10436175109739151"}], ",", 
             RowBox[{"a2", "\[Rule]", "1.1083328583839787"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.06996569064290178"}]}], ",", 
             RowBox[{"f3", "\[Rule]", "1."}], ",", 
             RowBox[{"e3", "\[Rule]", "1."}], ",", 
             RowBox[{"d3", "\[Rule]", "1."}], ",", 
             RowBox[{"c3", "\[Rule]", "1."}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.9996081499207383"}]}], ",", 
             RowBox[{"b3", "\[Rule]", "1."}], ",", 
             RowBox[{"npow", "\[Rule]", "1."}]}], "}"}]}], ";", 
          RowBox[{"rhooutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.3478973290172718"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.3000649958225696"}], ",", 
             RowBox[{"a2", "\[Rule]", "1.000359978989461"}], ",", 
             RowBox[{"b2", "\[Rule]", "0.4814920337896888"}], ",", 
             RowBox[{"f3", "\[Rule]", "1."}], ",", 
             RowBox[{"e3", "\[Rule]", "1."}], ",", 
             RowBox[{"d3", "\[Rule]", "1."}], ",", 
             RowBox[{"c3", "\[Rule]", "1."}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.000029218334036272235"}]}], ",", 
             RowBox[{"b3", "\[Rule]", "1."}], ",", 
             RowBox[{"npow", "\[Rule]", "1."}]}], "}"}]}], ";", 
          RowBox[{"ieoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.20174289234914577"}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.06023988735369447"}]}], ",", 
             RowBox[{"a2", "\[Rule]", "0.9951654754134456"}], ",", 
             RowBox[{"b2", "\[Rule]", "0.14319755643633134"}], ",", 
             RowBox[{"f3", "\[Rule]", "1."}], ",", 
             RowBox[{"e3", "\[Rule]", "1."}], ",", 
             RowBox[{"d3", "\[Rule]", "1."}], ",", 
             RowBox[{"c3", "\[Rule]", "1."}], ",", 
             RowBox[{"a3", "\[Rule]", "0.00002501130110008313"}], ",", 
             RowBox[{"b3", "\[Rule]", "1."}], ",", 
             RowBox[{"npow", "\[Rule]", "1."}]}], "}"}]}], ";", 
          RowBox[{"Bxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.5866660067799973"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.37814722851199023"}], ",", 
             RowBox[{"a2", "\[Rule]", "1.0007535416662767"}], ",", 
             RowBox[{"b2", "\[Rule]", "0.6335763867874434"}], ",", 
             RowBox[{"f3", "\[Rule]", "1."}], ",", 
             RowBox[{"e3", "\[Rule]", "1."}], ",", 
             RowBox[{"d3", "\[Rule]", "1."}], ",", 
             RowBox[{"c3", "\[Rule]", "1."}], ",", 
             RowBox[{"a3", "\[Rule]", "0.00002446979874962092"}], ",", 
             RowBox[{"b3", "\[Rule]", "1."}], ",", 
             RowBox[{"npow", "\[Rule]", "1."}]}], "}"}]}], ";", 
          RowBox[{"uyratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.027190372433796167"}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.20788024641957578"}]}], ",", 
             RowBox[{"a2", "\[Rule]", "1.0001696739359327"}], ",", 
             RowBox[{"b2", "\[Rule]", "0.17938246113425677"}], ",", 
             RowBox[{"f3", "\[Rule]", "1."}], ",", 
             RowBox[{"e3", "\[Rule]", "1."}], ",", 
             RowBox[{"d3", "\[Rule]", "1."}], ",", 
             RowBox[{"c3", "\[Rule]", "1."}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.000029555074703701793"}]}], ",", 
             RowBox[{"b3", "\[Rule]", "1."}], ",", 
             RowBox[{"npow", "\[Rule]", "1."}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzcratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"nonrelsprel", "\[Equal]", "1"}], " ", "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"conditiontomodify2", ">", "0"}], "&&", 
            RowBox[{"conditiontomodify1", ">", "0"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"CUT", " ", "2"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"signtouse", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cuti", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.07055247866577966"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.448982194291537"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.05986469793826613"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.018010885872619124"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.15523330952567427"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.023252128642946977"}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.03345954445329196"}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.5449909641846628"}]}], ",", 
             RowBox[{"a3", "\[Rule]", "0.005383907383868816"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.002759038867109294"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"uxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.02761020412828064"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.6192660713845041"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.12493335170994431"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.0635265019931846"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.17290616783764642"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.061900970059541836"}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.08474620367635682"}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.45776809947060937"}]}], ",", 
             RowBox[{"a3", "\[Rule]", "0.015731247387578057"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.026117621945494274"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"rhocratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.046337284629318874"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.7271223431987213"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.15809581617443028"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.09366194936983281"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.1234636831696684"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.08197981342515699"}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.10529862619092822"}], ",", 
             RowBox[{"c3", "\[Rule]", "0.1805181679711891"}], ",", 
             RowBox[{"a3", "\[Rule]", "0.021809909612323763"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.03749291397889188"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"iecratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.4642385375882243"}]}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.18001561718834166"}]}], ",", 
             RowBox[{"a2", "\[Rule]", "0.07038723409470067"}], ",", 
             RowBox[{"b2", "\[Rule]", "0.01268057552350868"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.25825101028380587"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.13331853067892963"}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.18089993642200625"}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "1.1081608015268947"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.032945325983724426"}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.10436363413749772"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"rhooutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.046337284629318874"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.7271223431987213"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.15809581617443028"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.09366194936983281"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.1234636831696684"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.08197981342515699"}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.10529862619092822"}], ",", 
             RowBox[{"c3", "\[Rule]", "0.1805181679711891"}], ",", 
             RowBox[{"a3", "\[Rule]", "0.021809909612323763"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.03749291397889188"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"ieoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.02884157400886772"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.696367332776852"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.17442920876874596"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.1009561104396555"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.16983642508962582"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.08978196463875894"}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.1195367594594502"}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.1490044081231664"}]}], ",", 
             RowBox[{"a3", "\[Rule]", "0.023547012078865337"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.042383140817311364"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"Bxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.26351598618645555"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.5714524905317424"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.21402442815562692"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.12444459381870066"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.12352775993489748"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.06802380307360031"}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.07923046392848619"}], ",", 
             RowBox[{"c3", "\[Rule]", "0.09024495566091298"}], ",", 
             RowBox[{"a3", "\[Rule]", "0.02009971601675062"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.025831145492941653"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"uyratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.010339311036673992"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.3324285243013885"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0021513940838879236"}]}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.0020220453279061407"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.10283089872533453"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.0002720579250887734"}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.0007170492344859532"}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.523123891280456"}]}], ",", 
             RowBox[{"a3", "\[Rule]", "0.00021220258474655514"}], ",", 
             RowBox[{"b3", "\[Rule]", "0.01293251818106794"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzcratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"allow", " ", "override", " ", "by", " ", "cuti"}], "=", 
          "3"}], ",", "4", ",", "5"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nonrelsprel", "\[Equal]", "1"}], " ", "&&", 
          RowBox[{"(", " ", 
           RowBox[{"conditiontomodify3", ">", "0"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"CUT", " ", "3"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"signtouse", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cuti", "=", "3"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.012189775518847094"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.9653734952043307"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.0019406626014562948"}], ",", 
             RowBox[{"b2", "\[Rule]", "0.0011001138713430626"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.002729899401083556"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.00006720151615874917"}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.00004876507151268549"}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.13621575619029758"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.000028132749600590663"}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.00018424580551701828"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"uxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.014805502012962548"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.9930628461867431"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0021734536737175185"}]}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.0013087690745298816"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.004018762822581118"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.00007640147659236001"}], ",", 
             RowBox[{"d3", "\[Rule]", "0.000058443946106580106"}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.21010997382606122"}]}], ",", 
             RowBox[{"a3", "\[Rule]", "0.00003318113750579658"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.00013679404309485777"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"rhocratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.00031502033967914484"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.9846210822176993"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.000017955422190740494"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.00001757293530833211"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.0023584255679888083"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "2.52531"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"8.57138", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", "0.44454006208940416"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"3.30557", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.00011484164744344336"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"iecratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "1.1964362696003015"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "1.0852001528025308"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.06868659093692647"}], ",", 
             RowBox[{"b2", "\[Rule]", "0.04143399061380359"}], ",", 
             RowBox[{"f3", "\[Rule]", "0.09267951717284528"}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.007977966289384903"}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.009172557915425709"}]}], ",", 
             RowBox[{"c3", "\[Rule]", "0.15511200943287143"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.0028363644111612544"}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.0009089001240110444"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"rhooutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.00031502033967914484"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.9846210822176993"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.000017955422190740494"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.00001757293530833211"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.0023584255679888083"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "2.52531"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"8.57138", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", "0.44454006208940416"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"3.30557", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.00011484164744344336"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"ieoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.014815343153346457"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.9945865370933509"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0021727973755730234"}]}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.001309300107065623"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.003782761310623364"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.00007639008246340802"}], ",", 
             RowBox[{"d3", "\[Rule]", "0.00005846787116309578"}], ",", 
             RowBox[{"c3", "\[Rule]", "0.09397167815065427"}], ",", 
             RowBox[{"a3", "\[Rule]", "0.00003319075133546133"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.00012522582858348697"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"Bxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0027421961007336538"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.9896531581642275"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0003444747572799879"}]}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.0002329570678662876"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.0020722393993344397"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.000012438865724398912"}], ",", 
             RowBox[{"d3", "\[Rule]", "0.000010445954902817104"}], ",", 
             RowBox[{"c3", "\[Rule]", "0.5943435464897215"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"5.79936", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.00009097476022563219"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"uyratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0002813539720275817"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.9754507028305147"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.00001558318256036524"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.000015782412292221592"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.003777311384180067"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "2.07158"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"7.84817", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", "0.12503436195274745"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"2.9884", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.00018434319802684382"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzcratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"nonrelsprel", "\[Equal]", "2"}], " ", "&&", 
          RowBox[{"(", 
           RowBox[{"conditiontomodify4", ">", "0"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"CUT", " ", "4"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"signtouse", "=", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"cuti", "=", "4"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.01107342079331653"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.41758950542143974"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0012806236314584236"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.0007577320543266084"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.1627594949627593"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.00002235382651247665"}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.00028571453360875474"}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.7047937951982105"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"-", "0.00001577361645609262"}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.011745247857082617"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"uxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.004055181709634218"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.5186370975820438"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.005053420315384705"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.0001253808037152951"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.143553126069433"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.0001353125546809919"}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.00033538475150473213"}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.6433756303345691"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"1.50018", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.010879440755332358"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"rhocratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.0074845468002893625"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.6308792717337779"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0029996889575357112"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.00044429180703149353"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.1058675034371879"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.00007267451315033938"}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.000326745539462483"}]}], ",", 
             RowBox[{"c3", "\[Rule]", "0.09757200946920445"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "8.00354"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.0077532636293906375"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"iecratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.9072205212996106"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.6083061854143571"}], ",", 
             RowBox[{"a2", "\[Rule]", "0.0672131576640778"}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.011196194941098655"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.2485678142947526"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"-", "0.0038803737195037594"}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.004486509376558615"}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.43434536319080386"}]}], ",", 
             RowBox[{"a3", "\[Rule]", "0.00042466641259343194"}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.051054137607309126"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"rhooutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.0074845468002893625"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.6308792717337779"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0029996889575357112"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.00044429180703149353"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.1058675034371879"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.00007267451315033938"}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.000326745539462483"}]}], ",", 
             RowBox[{"c3", "\[Rule]", "0.09757200946920445"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "8.00354"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.0077532636293906375"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"ieoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.004946759914445769"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.5632166566764654"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.005487852792890134"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.00017740368092618867"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.13063200930898658"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.00014488742720258284"}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.00039782079336360914"}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.29608263612383606"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "7.60011"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.009892760882350035"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"Bxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0007546336498103159"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.7132803528137435"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0011016959976825236"}]}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.00008656460039820905"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.07542401837639147"}]}], ",", 
             RowBox[{"e3", "\[Rule]", "0.000027271326595091544"}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"-", "0.0001077740617752087"}]}], ",", 
             RowBox[{"c3", "\[Rule]", "0.30514646488288116"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"2.46082", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.004135851648515479"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"uyratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0009650088111134972"}], ",", 
             RowBox[{"b1", "\[Rule]", "0.3697950396933458"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.00008742384133042377"}]}], ",", 
             RowBox[{"b2", "\[Rule]", 
              RowBox[{"-", "0.00007258636320059408"}]}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.17715155428277513"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"3.14544", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"7.67761", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.4915689540078929"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{"1.63193", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", 
              RowBox[{"-", "0.012489350611914274"}]}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzcratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nonrelsprel", "\[Equal]", "1"}], " ", "&&", 
          RowBox[{"(", " ", 
           RowBox[{"conditiontomodify5", ">", "0"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"CUT", " ", "5"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"signtouse", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cuti", "=", "5"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.0005317335326220828"}]}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.09372354482251724"}]}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.00001301318837760367"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.000032666628625851564"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.04083288109209074"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"2.31536", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"4.82528", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "1.3172170356825086"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "6.3131"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.0021768151038864237"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"uxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.0005048807798997877"}]}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.08712210634872507"}]}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.000012183524304644456"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.00003100262225739979"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.04148474564442021"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"2.10858", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"4.83108", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "1.3378345851068068"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "5.98784"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.0021955529447943625"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"rhocratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.00044473479382601075"}]}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.07749894954224297"}]}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "7.68865"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.000027147012164638565"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.04242693395353735"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"6.51619", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "8"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"6.71829", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.7662468887427943"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "5.20485"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.0022217527348302136"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"iecratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "1.001747142281031"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.7055316050121079"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.0000904823506477582"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.0001546219219634157"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.007646264530656149"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "1.24584"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", "0.000018511330886478776"}], ",", 
             RowBox[{"c3", "\[Rule]", "0.15400828198209965"}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "4.08923"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.0004283447303474846"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"rhooutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.00044473479382601075"}]}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.07749894954224297"}]}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "7.68865"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.000027147012164638565"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.04242693395353735"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"6.51619", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "8"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"6.71829", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "0.7662468887427943"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "5.20485"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.0022217527348302136"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"ieoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.0004957926862960113"}]}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.08387088326808903"}]}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"-", "0.000012026960526710944"}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.00003044240537512275"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.04180291032244257"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{"2.07116", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"4.82454", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "1.0469824998003052"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "5.87881"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.002204554555073312"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"Bxratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.0038007861354831685"}]}], ",", 
             RowBox[{"b1", "\[Rule]", "0.6214230943451922"}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{"7.75157", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.00021508454918630997"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.14935272949255085"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "9.21673"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"2.83926", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "2.803908538515292"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "3.87336"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.00743658560365399"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          RowBox[{"uyratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", 
              RowBox[{"-", "0.0005174931269572766"}]}], ",", 
             RowBox[{"b1", "\[Rule]", 
              RowBox[{"-", "0.09712425886934724"}]}], ",", 
             RowBox[{"a2", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "6.08815"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}]}], ",", 
             RowBox[{"b2", "\[Rule]", "0.000031442405816196946"}], ",", 
             RowBox[{"f3", "\[Rule]", 
              RowBox[{"-", "0.040505064883148846"}]}], ",", 
             RowBox[{"e3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "6.62145"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "9"}]}]}]}], ",", 
             RowBox[{"d3", "\[Rule]", 
              RowBox[{"8.46203", "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"c3", "\[Rule]", 
              RowBox[{"-", "1.005883947226965"}]}], ",", 
             RowBox[{"a3", "\[Rule]", 
              RowBox[{
               RowBox[{"-", "6.00371"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "7"}]}]}]}], ",", 
             RowBox[{"b3", "\[Rule]", "0.0021669275126324473"}], ",", 
             RowBox[{"npow", "\[Rule]", "0."}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzcratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bzoutratconsts", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "\[Rule]", "0.0"}], ",", 
             RowBox[{"b1", "\[Rule]", "0"}], ",", 
             RowBox[{"a2", "\[Rule]", "0"}], ",", 
             RowBox[{"b2", "\[Rule]", "0"}], ",", 
             RowBox[{"f3", "\[Rule]", "0."}], ",", 
             RowBox[{"e3", "\[Rule]", "0."}], ",", 
             RowBox[{"d3", "\[Rule]", "0."}], ",", 
             RowBox[{"c3", "\[Rule]", "0."}], ",", 
             RowBox[{"a3", "\[Rule]", "0"}], ",", 
             RowBox[{"b3", "\[Rule]", "0"}], ",", 
             RowBox[{"npow", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Using CUT=\>\"", ",", "cuti", ",", "\"\< for which=\>\"", ",", 
         "which", ",", "\"\< for nonrelsprel=\>\"", ",", "nonrelsprel"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"allconsts", "=", 
        RowBox[{"{", 
         RowBox[{
         "dratconsts", ",", "uxratconsts", ",", "rhocratconsts", ",", 
          "iecratconsts", ",", "rhooutratconsts", ",", "ieoutratconsts", ",", 
          "Bxratconsts", ",", "uyratconsts", ",", "Bzcratconsts", ",", 
          "Bzoutratconsts"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"non", "-", 
         RowBox[{"default", " ", "rescaling"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cuti", "\[NotEqual]", 
          RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fun", "=", 
           RowBox[{"otherrel2relfun", "[", 
            RowBox[{"cuti", ",", "which", ",", 
             RowBox[{"allconsts", "[", 
              RowBox[{"[", "which", "]"}], "]"}], ",", "myS", ",", "mysigma", 
             ",", 
             RowBox[{"signtouse", "[", 
              RowBox[{"[", "which", "]"}], "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "return", " ", "ratio", " ", "of", " ", "rel", " ", "to", " ", 
         "otherrel"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{"fun", ",", "workprec"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4778155178716464`*^9, 3.477815521216456*^9}, {
   3.477816629710392*^9, 3.477816660094082*^9}, {3.477825770934827*^9, 
   3.4778257797875566`*^9}, {3.4778261586022654`*^9, 3.477826203777224*^9}, {
   3.477827148155173*^9, 3.4778271695259027`*^9}, {3.477827200790859*^9, 
   3.4778272010312047`*^9}, 3.477827233027213*^9, {3.4778274694171247`*^9, 
   3.4778275026048465`*^9}, 3.4778276562858286`*^9, 3.4778276915265026`*^9, {
   3.47782773813352*^9, 3.477827785892194*^9}, {3.477831626955371*^9, 
   3.4778318380889664`*^9}, {3.4778318726686897`*^9, 3.477832026199456*^9}, {
   3.477832151850133*^9, 3.477832190906293*^9}, {3.4778322800745106`*^9, 
   3.4778323149947233`*^9}, {3.477832352468608*^9, 3.4778323863072653`*^9}, {
   3.477832819790584*^9, 3.4778328219536943`*^9}, {3.477832862622173*^9, 
   3.4778328802174735`*^9}, {3.4778329200046844`*^9, 
   3.4778329288473997`*^9}, {3.4778333702521086`*^9, 
   3.4778333760905037`*^9}, {3.4778334243198547`*^9, 3.4778334454001665`*^9}, 
   3.4778352657376833`*^9, 3.4778354294931517`*^9, 3.477835558027976*^9, 
   3.4778357809485197`*^9, {3.4778358983873887`*^9, 3.477835922522093*^9}, 
   3.477835999062152*^9, {3.4778360625434337`*^9, 3.4778360821916866`*^9}, {
   3.4778370235853443`*^9, 3.4778370339602623`*^9}, {3.4778408602121425`*^9, 
   3.4778408605025597`*^9}, {3.477846587217171*^9, 3.4778467804249907`*^9}, {
   3.47785150589989*^9, 3.4778515493724003`*^9}, {3.477851624350213*^9, 
   3.477851625301581*^9}, {3.477852004046189*^9, 3.477852024635795*^9}, {
   3.477901068567506*^9, 3.47790111389268*^9}, {3.477901364202608*^9, 
   3.4779013822185135`*^9}, {3.4779057281676817`*^9, 3.477905735007517*^9}, {
   3.477905824335965*^9, 3.4779058796555104`*^9}, {3.477906010363459*^9, 
   3.477906041498229*^9}, {3.4779060821466784`*^9, 3.4779062496675615`*^9}, {
   3.477906465117363*^9, 3.4779065389234915`*^9}, {3.477909572826029*^9, 
   3.477909589530048*^9}, {3.477910873396157*^9, 3.477910894386339*^9}, {
   3.477910944748757*^9, 3.4779109456700816`*^9}, {3.4779115797518463`*^9, 
   3.4779115799621487`*^9}, {3.4780231198987007`*^9, 
   3.4780231246054688`*^9}, {3.4783114311098623`*^9, 3.478311441865328*^9}, {
   3.4783115048759327`*^9, 3.4783115300921917`*^9}, {3.4783115602755938`*^9, 
   3.4783115728737087`*^9}, {3.4783116131315966`*^9, 
   3.4783116501047616`*^9}, {3.478311697382744*^9, 3.4783116991953506`*^9}, {
   3.4783122837358785`*^9, 3.47831228462716*^9}, {3.478313493395283*^9, 
   3.4783135413742733`*^9}, {3.478313587710902*^9, 3.4783136367814627`*^9}, {
   3.4783143151569185`*^9, 3.478314346792408*^9}, 3.4783143786682434`*^9, {
   3.4783145187196274`*^9, 3.4783145677701583`*^9}, {3.478314690887192*^9, 
   3.4783147002706847`*^9}, {3.4783147552096834`*^9, 3.478314791161379*^9}, {
   3.478314833502262*^9, 3.4783148623036766`*^9}, {3.4783313218413296`*^9, 
   3.47833134954116*^9}, {3.478331395156752*^9, 3.478331395887803*^9}, {
   3.4783314692132397`*^9, 3.478331469343427*^9}, {3.4783319177381873`*^9, 
   3.4783319270515795`*^9}, {3.478332074633792*^9, 3.4783320797010784`*^9}, {
   3.4783321109460063`*^9, 3.4783321643528013`*^9}, {3.478335622765755*^9, 
   3.4783356959009185`*^9}, {3.4783357878331103`*^9, 3.478335788053427*^9}, {
   3.4783358581041555`*^9, 3.4783359096683006`*^9}, {3.478336588794837*^9, 
   3.4783366243960285`*^9}, {3.4783367191022096`*^9, 3.4783367217560253`*^9}, 
   3.4783381176832705`*^9, {3.4783382031661887`*^9, 3.47833823343972*^9}, {
   3.478338418255472*^9, 3.47833846001552*^9}, {3.4783384995924287`*^9, 
   3.4783385373567314`*^9}, {3.478338569092365*^9, 3.478338604653499*^9}, {
   3.478338951842733*^9, 3.4783389630488462`*^9}, {3.4783392270384445`*^9, 
   3.478339250171709*^9}, {3.4783392803250675`*^9, 3.4783392866241245`*^9}, {
   3.4783393167173967`*^9, 3.478339335424296*^9}, {3.4783411828407507`*^9, 
   3.478341194667757*^9}, {3.4783412248311296`*^9, 3.478341256686936*^9}, {
   3.478341299127963*^9, 3.478341319397109*^9}, {3.4783540922535744`*^9, 
   3.4783541366173663`*^9}, {3.4783541759238863`*^9, 3.478354247847307*^9}, {
   3.4783542990309057`*^9, 3.478354302475859*^9}, {3.478354959921219*^9, 
   3.4783549926282496`*^9}, {3.4783578034399986`*^9, 3.478357803560171*^9}, 
   3.4784434633228607`*^9, {3.478443498603592*^9, 3.4784435251317377`*^9}, {
   3.47844356514928*^9, 3.478443671482179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"convertotherrel2relall", "[", 
    RowBox[{"nonrelsprel0_", ",", "mysol00_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", ",", "mysol", ",", 
       RowBox[{"nonrelsprel", "=", "nonrelsprel0"}], ",", 
       RowBox[{"mysol0", "=", "mysol00"}], ",", "ii", ",", "convertfactor"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"convertfactor", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"convertotherrel2rel", "[", 
          RowBox[{"nonrelsprel", ",", "ii"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "numunknowns"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"mysol", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mysol0", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "1"}], "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"mysol0", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "2"}], "]"}], "]"}], "*", 
           RowBox[{"convertfactor", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "numunknowns"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"return", " ", "value"}], " ", "*)"}], "\[IndentingNewLine]", 
      "mysol"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4778161319045825`*^9, 3.4778161357300835`*^9}, {
  3.4778227128475137`*^9, 3.47782271491048*^9}, {3.477822980091792*^9, 
  3.477822985779971*^9}, {3.477823118360613*^9, 3.477823118771203*^9}, {
  3.477823455405259*^9, 3.4778234575984125`*^9}, {3.4783117027304335`*^9, 
  3.478311708428627*^9}, {3.4783147052077837`*^9, 3.4783147253968143`*^9}, {
  3.478354494391821*^9, 3.478354495082814*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"otherrel2relfun", "[", 
    RowBox[{
    "cuti0_", ",", "choosei0_", ",", "ratconsts0_", ",", "S0_", ",", 
     "sigma0_", ",", "signtouse0_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"foo", ",", 
       RowBox[{"cuti", "=", "cuti0"}], ",", 
       RowBox[{"choosei", "=", "choosei0"}], ",", 
       RowBox[{"initratconsts", "=", "ratconsts0"}], ",", 
       RowBox[{"S", "=", "S0"}], ",", 
       RowBox[{"sigma", "=", "sigma0"}], ",", 
       RowBox[{"signtouse", "=", "signtouse0"}], ",", "lfit1", ",", "fit1", 
       ",", "lfit2", ",", "fit2", ",", "lfit3", ",", "fit3", ",", "upmodel", 
       ",", "model", ",", "x", ",", "y", ",", "a1", ",", "b1", ",", "a2", ",",
        "b2", ",", "f3", ",", "e3", ",", "d3", ",", "c3", ",", "a3", ",", 
       "b3", ",", "npow", ",", "values", ",", "ratconsts", ",", "numfitparms",
        ",", "numiters", ",", "npowlist", ",", "npowa"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "values", " ", "should", " ", "be", " ", "same", " ", "order", " ", 
       "as", " ", "used", " ", "in", " ", 
       RowBox[{"spreconfitrats", ".", "nb"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"values", "=", 
       RowBox[{"{", 
        RowBox[{
        "a1", ",", "b1", ",", "a2", ",", "b2", ",", "f3", ",", "e3", ",", 
         "d3", ",", "c3", ",", "a3", ",", "b3", ",", "npow"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numfitparms", "=", "11"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ratconsts", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"values", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", 
          RowBox[{"initratconsts", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "numfitparms"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "S"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "sigma"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "below", " ", "from", " ", 
        RowBox[{"spreconfitrats", ".", "nb"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"default", " ", "model"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"numiters", "=", "200"}], ";", "\[IndentingNewLine]", 
      RowBox[{"model", "=", 
       RowBox[{"c3", "+", 
        RowBox[{"a1", "*", "x"}], "+", 
        RowBox[{"b1", "*", "y"}], "+", 
        RowBox[{"a2", "*", "x", "*", "y"}], "+", 
        RowBox[{"b2", "*", 
         RowBox[{"x", "^", "2"}]}], "+", 
        RowBox[{"f3", "*", 
         RowBox[{"y", "^", "2"}]}], "+", 
        RowBox[{"e3", "*", 
         RowBox[{"x", "^", "2"}], "*", "y"}], "+", 
        RowBox[{"d3", "*", 
         RowBox[{"y", "^", "2"}], "*", "x"}], "+", 
        RowBox[{"a3", "*", 
         RowBox[{"x", "^", "3"}]}], "+", 
        RowBox[{"b3", "*", 
         RowBox[{"y", "^", "3"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cuti", "\[Equal]", "1"}], " ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numiters", "=", "100"}], ";", "\[IndentingNewLine]", 
         RowBox[{"lfit1", "=", 
          RowBox[{
           RowBox[{"a1", "*", "y"}], "+", "b1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fit1", "=", 
          RowBox[{"10", "^", "lfit1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lfit2", "=", 
          RowBox[{
           RowBox[{"a2", "*", "y"}], "+", "b2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fit2", "=", 
          RowBox[{"10", "^", "lfit2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lfit3", "=", 
          RowBox[{"a3", "*", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fit3", "=", 
          RowBox[{"10", "^", "lfit3"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"upmodel", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1", "/", 
                  RowBox[{"fit1", "^", "npow"}]}], "+", 
                 RowBox[{"1", "/", 
                  RowBox[{"fit2", "^", "npow"}]}]}], ")"}]}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "/", "npow"}], ")"}]}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "fitting", " ", "procedure", " ", "poor", " ", "job", " ", "most", 
            " ", "of", " ", "the", " ", "time", " ", "for", " ", "npow"}], 
           ",", " ", 
           RowBox[{
           "so", " ", "use", " ", "npow", " ", "from", " ", "when", " ", 
            "was", " ", "good", " ", "fit"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"npowlist", "=", 
          RowBox[{"{", 
           RowBox[{
           "0.73001", ",", "0.763018", ",", "1.00885", ",", "1.00885", ",", 
            "1.00885", ",", "1.00885", ",", "1.82356", ",", "0.725738", ",", 
            "1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"npowa", "=", 
          RowBox[{"npowlist", "[", 
           RowBox[{"[", "choosei", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"upmodel", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"fit1", "^", "npowa"}]}], "+", 
               RowBox[{"1", "/", 
                RowBox[{"fit2", "^", "npowa"}]}]}], ")"}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", "npowa"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"cuti", "\[Equal]", "1"}], ",", 
             RowBox[{"model", "=", 
              RowBox[{"Log", "[", 
               RowBox[{"10", ",", "upmodel"}], "]"}]}], " ", ",", 
             RowBox[{
              RowBox[{"model", "=", 
               RowBox[{
                RowBox[{"Log", "[", 
                 RowBox[{"10", ",", "upmodel"}], "]"}], " ", "+", " ", 
                "lfit3"}]}], ";"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"model", "=", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"10", ",", "upmodel"}], "]"}], " ", "+", " ", "lfit3"}]}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "now", " ", "return", " ", "answer", " ", "as", " ", "a", " ", 
        "linear", " ", "function", " ", "of", " ", "actual", " ", "fit", " ", 
        "to", " ", "function", " ", "without", " ", "1", " ", "subtracted"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"10", "^", "model"}]}], ")"}], "//.", "ratconsts"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQ3S4bWpXx8qUjx7M5YHqFA289iH5xLBlMVzksnwCi
Oxva5oBo3gsx3dlA+oEQex+Idgpb8XIikFYzePYXRPes5mCaBKRbXk0H05Xc
7dwgOkT9nQCILjr2RHMKkJ604xuYVvs6OwtEr9pbXAKiZWTUKkE0A8c5MH2r
pr9nGpB+mfEETOc7/50LogUyTs0H0eduTt4Bog+58e8C0T/eF+wH0SF8v8H0
wmWS/0F0zbZbTNOBtPPah8lRr4D2dbwF0zeev/8Bov+lLfoJon/ZZv0D0Zfj
zjFGA+k6J5G9sUB6y67zYPrRzOTnBUBa6Np0ML0kjP/dTCD91dgGTB+Tf3Fr
FpC+9qP2PogGAL7m0yA=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"after", " ", "setup"}], ",", " ", 
    RowBox[{"get", " ", "complete", " ", "rel", " ", "solution"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solvespcomplete", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "foo", ",", "errorroot", ",", "vel4togorel", ",", "sigmatogorel", " ", 
        ",", "mysigma", ",", "myva", ",", "myS", ",", "mysolaveraged"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"get", " ", "non"}], "-", 
        RowBox[{"rel", " ", "solution"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"solvespsimple", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "mixed", " ", "rel", " ", "solution"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"solvespsimple", "[", "2", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mysigma", ",", "myva", ",", "myS"}], "}"}], "=", 
        RowBox[{"setSsigmava", "[", 
         RowBox[{
         "rhobvalue", ",", "bgauss", ",", "UginfixedT", ",", "PginfixedT", 
          ",", "Lpnum", ",", "etatotal"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "generically", " ", "expect", " ", "NSolve", " ", "to", " ", "find", 
         " ", "solution", " ", "at", " ", "least", " ", "in", " ", "certain", 
         " ", "gross", " ", 
         RowBox[{"regimes", " ", "--"}], " ", "else", " ", "no", " ", 
         "solution", " ", "at", " ", "all"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"sigmatogorel", " ", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "default", " ", "is", " ", "no", " ", "solution", " ", "at", " ", 
         "all"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"errorroot", "=", 
        RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fsolsspotherunits", "=", "fsolsnonrel"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"nonrelsolution", "\[Equal]", "1"}], " ", "&&", 
           RowBox[{"mysigma", "\[LessEqual]", "sigmatogorel"}]}], "||", " ", 
          RowBox[{
           RowBox[{"mixedrelsolution", "\[Equal]", "1"}], "&&", 
           RowBox[{"mysigma", "\[GreaterEqual]", "sigmatogorel"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "now", " ", "default", " ", "is", " ", "solution", " ", "is", " ", 
           "present", " ", "and", " ", "can", " ", "be", " ", "solved", " ", 
           "for"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"errorroot", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"check", " ", "-", 
            RowBox[{"uy", " ", "for", " ", "relativistic", " ", "outflow"}]}],
            " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vel4togorel", "=", "2.0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "sigma", " ", "to", " ", "start", " ", "using", " ", "mixedrel", 
            " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sigmatogorel", " ", "=", "0.5"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"for", " ", "sigma"}], "\[GreaterEqual]", "1"}], ",", 
            " ", 
            RowBox[{
            "mixedrel", " ", "solution", " ", "is", " ", "actually", " ", 
             "more", " ", "accurate", " ", "independent", " ", "of", " ", 
             "uy", " ", "or", " ", "sigma"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"mysigma", "\[GreaterEqual]", "sigmatogorel"}], " ", "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"mysolnonrel", "[", 
                   RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                 "vel4togorel"}], "||", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"mysolmixedrel", "[", 
                   RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                 "vel4togorel"}], "||", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"mysolnonrelconverted", "[", 
                   RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                 "vel4togorel"}], "||", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"mysolmixedrelconverted", "[", 
                   RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                 "vel4togorel"}]}], ")"}]}], ")"}], ",", 
            RowBox[{
             RowBox[{"mysol", "=", "mysolmixedrelconverted"}], ";", 
             RowBox[{"Print", "[", "\"\<Using mixedrelconverted\>\"", "]"}], 
             ";"}], ",", 
            RowBox[{
             RowBox[{"mysol", "=", "mysolnonrelconverted"}], ";", 
             RowBox[{"Print", "[", "\"\<Using nonrelconverted\>\"", "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "form", " ", "guess", " ", "for", " ", "rel", " ", "calculation"}],
            " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"myvars", "=", 
           RowBox[{"formrelguess", "[", "mysol", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"start", " ", "rel", " ", "calculation", " ", "process"}], 
           " ", "*)"}], "\[IndentingNewLine]", "solvespfullsetup1", ";", 
          "\[IndentingNewLine]", "solvespfullsetup2", ";", 
          "\[IndentingNewLine]", 
          RowBox[{"errorroot", "=", "solvespfull"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"fsolsspotherunitsnormal", "=", "fsolsspotherunits"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numeffEMrelnormal", "=", "numeffEMrel"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"if", " ", "errorroot"}], "\[Equal]", "1"}], ",", " ", 
            RowBox[{
            "then", " ", "FindRoot", " ", "failed", " ", "in", " ", "some", 
             " ", "way"}], ",", " ", 
            RowBox[{
             RowBox[{
             "so", " ", "see", " ", "if", " ", "in", " ", "middle", " ", "of",
               " ", "non"}], "-", 
             RowBox[{
             "rel", " ", "to", " ", "rel", " ", "regime", " ", "and", " ", 
              "use", " ", "average", " ", "of", " ", "converted", " ", "rel", 
              " ", "and", " ", "mixedrel", " ", "to", " ", "see", " ", "if", 
              " ", "can", " ", "still", " ", "get", " ", "solution"}]}]}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"check", " ", "-", 
            RowBox[{
            "uy", " ", "for", " ", "mildy", " ", "relativistic", " ", 
             "outflow"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vel4togorel", "=", "0.5"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "sigma", " ", "to", " ", "start", " ", "using", " ", "mixedrel", 
            " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sigmatogorel", " ", "=", "0.1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"errorroot", "\[Equal]", "1"}], " ", "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"mysigma", "\[GreaterEqual]", "sigmatogorel"}], " ", "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"mysolnonrel", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                  "vel4togorel"}], "||", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"mysolmixedrel", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                  "vel4togorel"}], "||", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"mysolnonrelconverted", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                  "vel4togorel"}], "||", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"mysolmixedrelconverted", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "2"}], "]"}], "]"}], "]"}], ">", 
                  "vel4togorel"}]}], ")"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "then", " ", "average", " ", "converted", " ", "and", " ", 
              "mixedrel", " ", "solutions"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"mysolaveraged", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"mysolnonrelconverted", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "1"}], "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mysolnonrelconverted", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"mysolmixedrel", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], ")"}], "*", 
                  "0.5"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"ii", ",", "1", ",", "numunknowns"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"now", " ", "try", " ", "again"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"mysol", "=", "mysolaveraged"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "form", " ", "guess", " ", "for", " ", "rel", " ", 
               "calculation"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"myvars", "=", 
              RowBox[{"formrelguess", "[", "mysol", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "start", " ", "rel", " ", "calculation", " ", "process"}], " ", 
              "*)"}], "\[IndentingNewLine]", "solvespfullsetup1", ";", 
             "\[IndentingNewLine]", "solvespfullsetup2", ";", 
             "\[IndentingNewLine]", 
             RowBox[{"errorroot", "=", "solvespfull"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
             "fsolsspotherunitsfromaveraged", "=", "fsolsspotherunits"}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"numeffEMrelfromaveraged", "=", "numeffEMrel"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"errorroot", "\[Equal]", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"trust", " ", "non"}], "-", 
                 RowBox[{
                 "averaged", " ", "version", " ", "as", " ", "probably", " ", 
                  "much", " ", "closer", " ", "if", " ", "averaged", " ", 
                  "version", " ", "also", " ", "failed", " ", "to", " ", 
                  "converge"}]}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"fsolsspotherunits", "=", "fsolsspotherunitsnormal"}],
                 ";", "\[IndentingNewLine]", 
                RowBox[{"numeffEMrel", "=", "numeffEMrelnormal"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"errorroot", "\[Equal]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<Recovered!\>\"", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "end", " ", "if", " ", "some", " ", "NSolve", " ", "solution", " ", 
          "in", " ", "appropriate", " ", "regimes"}], " ", "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "fsolsspotherunits", " ", "is", " ", "also", " ", "grabbed", " ", 
         "as", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
       "errorroot"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.477952167123621*^9, 3.4779524044749155`*^9}, {
   3.477952481425565*^9, 3.4779525905324526`*^9}, {3.4779526573285007`*^9, 
   3.4779526948124*^9}, {3.478031149024016*^9, 3.4780311593288336`*^9}, {
   3.4780314342942142`*^9, 3.4780314918870287`*^9}, {3.4780315250146637`*^9, 
   3.478031569248269*^9}, {3.478032065261501*^9, 3.478032123084646*^9}, {
   3.478040854860323*^9, 3.4780408788848686`*^9}, {3.4780409465321407`*^9, 
   3.478040961713971*^9}, {3.478312171083893*^9, 3.4783121862957664`*^9}, {
   3.47831235297544*^9, 3.4783123667151966`*^9}, {3.4783124910640016`*^9, 
   3.478312509550584*^9}, {3.4783151251516333`*^9, 3.4783151430774097`*^9}, {
   3.4783162444310784`*^9, 3.4783162481063633`*^9}, 3.4783178095616255`*^9, {
   3.4783321453254414`*^9, 3.478332238499419*^9}, {3.4783426155008144`*^9, 
   3.4783426864828815`*^9}, {3.478343022806491*^9, 3.4783430352844334`*^9}, 
   3.4783545135593824`*^9, {3.4784648882203503`*^9, 3.4784651775563955`*^9}, {
   3.4784665880746207`*^9, 3.4784666104267616`*^9}, {3.478481127691563*^9, 
   3.4784811547905293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "called", " ", "by", " ", "external", " ", 
    "file"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"solvespfullall", "[", 
     RowBox[{"eff20_", ",", "guidefactor0_", ",", "Afactor0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"foo", ",", "errorroot", ",", 
        RowBox[{"eff2", "=", "eff20"}], ",", 
        RowBox[{"guidefactor", "=", "guidefactor0"}], ",", 
        RowBox[{"Afactor", "=", "Afactor0"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "some", " ", "global", " ", "model", " ", "parameter", " ",
         "constants"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eff2global", "=", "eff2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"guidefactorglobal", "=", "guidefactor"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Afactorglobal", "=", "Afactor"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "physical", " ", "constants"}], " ", "*)"}], 
       "\[IndentingNewLine]", "getconstants", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "setupsplocalrun", "*)"}], "\[IndentingNewLine]", 
       "setupspjetrun", ";", "\[IndentingNewLine]", 
       RowBox[{"errorroot", "=", "solvespcomplete"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"numunknowns", " ", "things"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"blob", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{
           "d", ",", "ux", ",", "rhoc", ",", "iec", ",", "rhoout", ",", 
            "ieout", ",", "Bx", ",", "uy", ",", "Bzc", ",", "Bzout"}], "}"}], 
          ")"}], "//.", "fsolsspotherunits"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"blob", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"blob", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "*", 
           RowBox[{"unitslist", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "numunknowns"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dodebugprint", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Dblob\>\"", ",", 
            RowBox[{"Dimensions", "[", "blob", "]"}]}], "]"}], ";"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"numunknowns", " ", "things"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"fsolssp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"ux", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"rhoc", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{"iec", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ",", 
          RowBox[{"rhoout", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], ",", 
          RowBox[{"ieout", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], ",", 
          RowBox[{"Bx", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "7", "]"}], "]"}]}], ",", 
          RowBox[{"uy", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "8", "]"}], "]"}]}], ",", 
          RowBox[{"Bzc", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "9", "]"}], "]"}]}], ",", 
          RowBox[{"Bzout", "\[Rule]", 
           RowBox[{"blob", "[", 
            RowBox[{"[", "10", "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaspfinal", "=", 
        RowBox[{"(", 
         RowBox[{"deltaspfinalotherunits", "*", "Lunits"}], ")"}]}], ";", 
       "\[IndentingNewLine]", "getconstants", ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"deltaspfinal", ";", "\[IndentingNewLine]", 
         RowBox[{"olddelta", "/", "deltaspfinal"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"olddeltanewish", "/", "deltaspfinal"}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Final Errorroot=\>\"", ",", "errorroot"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"return", " ", "error", " ", "value"}], " ", "*)"}], 
       "\[IndentingNewLine]", "errorroot"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdxVtIU3EcB/CTIE2SSBMEweUaJupEKzFLTY54GTNFxhCnUXMpFEiORBlC
oxxLRWqoeURDpy8SXsa8PnmLVkjgqJmCl7MMWnrEdA8ZUSL+vv+HDx+FsVZb
HcRxXCzBvmWjfGJH4nv/flDg44ozBuwx91VibdmkCUeEr7BHShqeY/VRaRMe
Euumz+5KvH4pchF7ku1ufBDxi/22r2odW3X+H/hWaXCqjB61hrEtL3oOEumU
Ahfb4IzOE2nRtq/GOcv7VrzW9bMZB9ydeh8tvC6rwM7KjPptuqFKYA+oHylP
6HKHnx1jcyZgS3tzEr77/d9YmiTx7uyvLiw7euXopt9FZgzihfzwL/305+p4
L9aasuMcdNT5qSTceinzGtZctNzGDw3Xc/FL79U8vNe2Wog/2gNFeMOUpcOu
p7ls3Xy6B3+KdXlxY3/8Bs7Xp7DnOfk3/KBOyZ6RRZ0boGPs0eyarXFhmPZl
PuvGoY1xK7hF9Yf9xNqhXKMLxfdsTWixCqsU/mR8/2aNpnZP4o2BkDuYS72y
ju/NKjfx3Ez9jTf0YM8uj3u5C/Ih2iwssUMemxVj9KH4/zL2OAXDFm2T/Tbi
U8dBVP8=
  "]],

Cell[BoxData[
 RowBox[{"(*", " ", "DONE", " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4769104203352222`*^9, 3.476910421346677*^9}}]
},
AutoGeneratedPackage->Automatic,
WindowSize->{786, 969},
WindowMargins->{{Automatic, 168}, {Automatic, 11}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 53, 1, 31, "Input",
 InitializationCell->True],
Cell[601, 23, 497, 9, 52, "Input"],
Cell[CellGroupData[{
Cell[1123, 36, 200, 6, 31, "Input",
 InitializationCell->True],
Cell[1326, 44, 1363, 24, 40, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2726, 73, 170, 3, 31, "Input",
 InitializationCell->True],
Cell[2899, 78, 990, 14, 30, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[3904, 95, 563, 13, 52, "Input",
 InitializationCell->True],
Cell[4470, 110, 12933, 258, 972, "Input",
 InitializationCell->True],
Cell[17406, 370, 6666, 149, 712, "Input",
 InitializationCell->True],
Cell[24075, 521, 1850, 39, 232, "Input",
 InitializationCell->True],
Cell[25928, 562, 5331, 113, 692, "Input",
 InitializationCell->True],
Cell[31262, 677, 12412, 297, 1192, "Input",
 InitializationCell->True],
Cell[43677, 976, 4166, 103, 372, "Input",
 InitializationCell->True],
Cell[47846, 1081, 32404, 710, 2732, "Input",
 InitializationCell->True],
Cell[80253, 1793, 8713, 203, 652, "Input",
 InitializationCell->True],
Cell[88969, 1998, 47085, 1137, 3699, "Input",
 InitializationCell->True],
Cell[136057, 3137, 5842, 149, 472, "Input",
 InitializationCell->True],
Cell[141902, 3288, 13489, 277, 1012, "Input",
 InitializationCell->True],
Cell[155394, 3567, 3464, 88, 312, "Input",
 InitializationCell->True],
Cell[158861, 3657, 2163, 56, 192, "Input",
 InitializationCell->True],
Cell[161027, 3715, 66091, 1368, 4552, "Input",
 InitializationCell->True],
Cell[227121, 5085, 1974, 46, 152, "Input",
 InitializationCell->True],
Cell[229098, 5133, 7890, 186, 712, "Input",
 InitializationCell->True],
Cell[236991, 5321, 14789, 311, 1592, "Input",
 InitializationCell->True],
Cell[251783, 5634, 5682, 131, 632, "Input",
 InitializationCell->True],
Cell[257468, 5767, 159, 3, 31, "Input",
 InitializationCell->True]
}
]
*)

(* End of internal cache information *)
